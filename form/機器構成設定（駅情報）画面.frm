VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "COMDLG32.OCX"
Object = "{5E9E78A0-531B-11CF-91F6-C2863C385E30}#1.0#0"; "MSFLXGRD.OCX"
Begin VB.Form frmKikiData 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "ã@äÌç\ê¨ê›íË"
   ClientHeight    =   9000
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   12000
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   11.25
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   ScaleHeight     =   9000
   ScaleMode       =   0  '’∞ªﬁ∞
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "   ¥›∫∞ƒﬁ∫∞≈    çÜã@èÓïÒíËã`âÊñ Ç÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   555
      Index           =   7
      Left            =   7200
      TabIndex        =   14
      Top             =   7800
      Width           =   2175
   End
   Begin VB.ComboBox CmbCornerName 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Left            =   8280
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   13
      Top             =   480
      Width           =   3495
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   600
      Top             =   480
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "â¸éDã@âÊñ Ç÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   6
      Left            =   7200
      TabIndex        =   11
      Top             =   8400
      Width           =   2175
   End
   Begin VB.Timer tmrMail 
      Enabled         =   0   'False
      Left            =   120
      Top             =   480
   End
   Begin VB.ComboBox cmbEkiInfo 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   9480
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   9
      Top             =   960
      Width           =   2295
   End
   Begin VB.CommandButton cmdCancel 
      Caption         =   " ã@äÌèÓïÒê›íË   âÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   9720
      TabIndex        =   8
      Top             =   7800
      Width           =   2055
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "î}ëÃéÊäO"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   5
      Left            =   4850
      TabIndex        =   6
      Top             =   8400
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "àÍéûï€ë∂"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   2
      Left            =   120
      TabIndex        =   5
      Top             =   8400
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "àÍéûï€ë∂ÉfÅ[É^ éÊçû"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   3
      Left            =   2450
      TabIndex        =   4
      Top             =   8400
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "ê›íËîΩâf"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   0
      Left            =   120
      TabIndex        =   3
      Top             =   7800
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "î}ëÃèoóÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   1
      Left            =   2450
      TabIndex        =   2
      Top             =   7800
      Width           =   2175
   End
   Begin VB.TextBox txtDummy 
      Height          =   330
      IMEMode         =   3  'µÃå≈íË
      Left            =   120
      TabIndex        =   0
      Text            =   "Text1"
      Top             =   10560
      Width           =   1095
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "î}ëÃì¸óÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   4
      Left            =   4850
      TabIndex        =   1
      Top             =   7800
      Width           =   2175
   End
   Begin MSFlexGridLib.MSFlexGrid GridIni 
      Height          =   6195
      Left            =   120
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   1440
      Width           =   11775
      _ExtentX        =   20770
      _ExtentY        =   10927
      _Version        =   393216
      Rows            =   12
      Cols            =   4
      FixedCols       =   2
      WordWrap        =   -1  'True
      Redraw          =   -1  'True
      AllowBigSelection=   0   'False
      FocusRect       =   2
      HighLight       =   0
      GridLines       =   2
      GridLinesFixed  =   1
      ScrollBars      =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label LblEkiName 
      Caption         =   "âwñºÅFÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   390
      Left            =   120
      TabIndex        =   12
      Top             =   960
      Width           =   8295
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "ã@äÌç\ê¨ê›íËÅiâwèÓïÒÅj"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   403
      Left            =   0
      TabIndex        =   7
      Top             =   0
      Width           =   12015
   End
End
Attribute VB_Name = "frmKikiData"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFã@äÌèÓïÒê›íËÅiâwèÓïÒÅjâÊñ .frm
'//  ÉpÉbÉPÅ[ÉWñºÅFã@äÌèÓïÒê›íËÅiâwèÓïÒÅjâÊñ ÇÃÉtÉHÅ[ÉÄÉÇÉWÉÖÅ[Éã
'//
'//  äTóvÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ 
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.4.0.1) 2009-03-23   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@Åué©â¸âÊñ Ç÷Åvñtèàóùí«â¡
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ñtÇÃâüâ∫â¬Å^ïsâ¬èàóùí«â¡
'//                 ÉRÉìÉsÉÖÅ[É^ñºÅAÉlÉbÉgÉèÅ[ÉNïœçXèàóùí«â¡
'//                 ÉfÉBÉXÉNèÓïÒéÊìæà íuïœçX
'//                 ÉtÉ@ÉCÉãåüçıèàóùçÌèú
'//                 î}ëÃÉtÉ@ÉCÉãñºÇå≈íËñºèÃÇ…ïœçX
'//                 âÊñ ÉçÉbÉNèàóùÅ^âÊñ ÉçÉbÉNâèúèàóùí«â¡
'//     REVISIONS :(1.13.0.1) 2009-11-19   REVISED BY [TCC] S.Terao
'//                 ÅuàÍéûï€ë∂ÉfÅ[É^éÊçûÅvñtèàóùÇèCê≥
'//                  É{É^ÉìñºèÃïœçXÇ…ÇÊÇÈÉ|ÉbÉvÉAÉbÉvïœçX
'//     REVISIONS :(1.17.0.1) 2009-12-24  REVISED BY [TCC] E.Watanabe
'//                 ïsãÔçáèCê≥
'//     REVISIONS :(1.17.0.1) 2009-01-05   REVISED BY [TCC] S.Terao
'//                âÊñ çƒëOñ ï\é¶èCê≥(ïsãÔçáèCê≥)
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                 ÉtÉHÉãÉ_ëIëâÊñ ÇOSédólÇ…ïœçX
'//                 ÉtÉ@ÉCÉãëIëâÊñ ÇOSédólÇ…ïœçX
'//                 ÉJÅ[É\Éãà⁄ìÆÇÃèàóùÇçÌèú
'//                 ê›íËîΩâfÉ{É^ÉìÇ™âüÇ≥ÇÍÇ∏Ç…âÊñ ëJà⁄Ç∑ÇÈÇ∆Ç´ÇÃåxçêï\é¶Çí«â¡
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 É|ÉbÉvÉAÉbÉvämîFâÊñ ÇÃÉ^ÉCÉgÉãèCê≥
'//     REVISIONS :(2.5.0.1) 2010-10-29  REVISED BY [TCC] S.Terao
'//                 î}ëÃéÊäOïsãÔçáèCê≥
'//     REVISIONS :(2.7.0.1) 2011-01-18  REVISED BY [TCC] S.Terao
'//                 ÇdÇfÇq_ÇiÇdëŒâû
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V5.2.0.1) 2012-03-12  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.12.0.1) 2012-05-18  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V8.1.0.1) 2014-06-05  REVISED BY  [TCC] S.Kuroda
'//                 2014îNìxé{çÙ ÅyEG20_KANSI05_01Åz
'//     REVISIONS :(EG20 V30.4.0.1) 2015-01-15 REVISED BY  [TCC] S.Kuroda
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇRëŒâûÅyHKRK_kansi02_001_01Åz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit

Private Const MN_MAIL_INTERVAL = 1000                   'ÉÅÉCÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl
Private bScroll As Boolean
Private GamenDataTbl() As EKI_DATA_TBL                  'âÊñ ï\é¶ópÉfÅ[É^ÉeÅ[ÉuÉã(îzóÒÇÃóvëf[0]ÇÕñ¢égóp)
Private KikiDataUpDateFlg As Boolean                    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉO

Private SetteiHaneiFlg As Boolean                       'ê›íËîΩâfÉtÉâÉO     'V1.20.0.1 ADD

Private Const TITOL_EKI_NAME = "âwñºÅF"                 'âwñºÉ^ÉCÉgÉã       ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjâÊñ (ÉAÉNÉeÉBÉuéûÅFÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ)
'//  ã@î\äTóv  : ç≈ëOëOï\é¶èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.17.0.1) 2009-12-24  REVISED BY [TCC] E.Watanabe
'//                 ïsãÔçáèCê≥
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'é©âÊñ ç≈ëOñ ï\é¶èàóùÇçsÇ§ÅB
    pfFormActive (hwnd)
    
'V1.17.0.1 ADD START
    'ÉtÉHÅ[ÉJÉXà íuÇê›íË
    cmdCancel.SetFocus
'V1.17.0.1 ADD END
    
    'É^ÉCÉ}ÇãNìÆÇ∑ÇÈ
    tmrMail.Enabled = True
    
End Sub

'EG20 V2.1.0.1 ADD START ÅyÉtÉFÅ[ÉYÇQëŒâûÅz
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjâÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÅAÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-11-26   CODED   BY [TCC] M.Matsumoto
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
On Error Resume Next
    'É^ÉCÉ}Çí‚é~Ç∑ÇÈ
    tmrMail.Enabled = False
End Sub
'EG20 V2.1.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjâÊñ (ÉçÅ[ÉhéûÅFÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ)
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfÉtÉâÉOí«â¡
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()

    Dim bRet                 As Boolean         'ä÷êîñﬂÇËíl
    Dim lErrCode             As Long            'ÉGÉâÅ[ÉRÅ[Éh
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_START, 0)
    
    '----------------------------------------------------
    'âÊñ èâä˙ílê›íË
    '----------------------------------------------------
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000
    
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅiçXêVê›íËÅj
    KikiDataUpDateFlg = True
    
    'ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÏê¨
    bRet = dllGetKikiIniData(0, 0, KIKI_DATA_SET_EKI_INFO_FILE, EKI_SETTI_FILE, KIKI_DATA_FILE, lErrCode)
    If bRet = False Then
        'ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÌèú
        Kill KIKI_DATA_SET_EKI_INFO_FILE
        'àŸèÌÉçÉOèoóÕ
        Call pfOutPutErrLog(lErrCode)
    End If
    
    'âwèÓïÒÉRÉìÉ{É{ÉbÉNÉXèâä˙ílê›íË
    cmbEkiInfo.Clear
    cmbEkiInfo.AddItem "äƒéã"
    cmbEkiInfo.AddItem "ÉlÉbÉgÉèÅ[ÉN"
    cmbEkiInfo.ListIndex = 0
    
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    'ÉRÅ[Éiê›íËÉRÉìÉ{É{ÉbÉNÉXÇÃèâä˙âªèàóù
    Call InitCornerComboBox
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
    
    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅií èÌê›íËÅj
    KikiDataUpDateFlg = False
    
    'ÉÅÉCÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈ
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False
    
    'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
    SetteiHaneiFlg = False     'V1.20.0.1 ADD
    
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMópÉ^ÉCÉ}èàóùÅiÉ^ÉCÉÄÉAÉbÉvéûÅFÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉÅj
'//  ã@î\äTóv  : îƒópÉÅÉCÉãéÛêMèàóùÇçsÇ§
'//
'//              å^        ñºèÃ     Å@Å@Å@à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        Å@Å@ à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.17.0.1) 2009-01-05   REVISED BY [TCC] S.Terao
'//                âÊñ çƒëOñ ï\é¶èCê≥(ïsãÔçáèCê≥)
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22   CODED   BY [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V8.1.0.1) 2014-06-05  REVISED BY  [TCC] S.Kuroda
'//                 2014îNìxé{çÙ ÅyEG20_KANSI05_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()

    Dim udtReadMail As ML_KYOTU_INF  'ÉÅÅ[ÉãéÛêMÉGÉäÉA
    Dim lngLength As Long            'éÛêMÉÅÅ[ÉãÉoÉCÉgÉTÉCÉY
    Dim intStatus As Integer         'éÛêMÉÅÅ[ÉãÉ`ÉFÉbÉNåãâ 
    Dim iResponse As Integer
    
    On Error Resume Next
    
    'ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
    lngLength = DssMailRead(plMSlot_MN, udtReadMail)
    If lngLength > 0 Then
    'éÛêMÉÅÅ[ÉãÇ™Ç†ÇÍÇŒÅAÉÅÅ[ÉãÇhÇcñàÇÃèàóùÇÇ∑ÇÈÅB
        Select Case udtReadMail.udtlHeader.dwId        'ÉÅÅ[ÉãÇhÇc
            Case ML_ID_PROEND_ORD
                'ÅuÉvÉçÉZÉXèIóπéwé¶ÅvÇéÛêMÇµÇΩèÍçáÅA
                'ÅuÉvÉçÉZÉXèIóπéwé¶éÛêMê≥èÌÅvÉçÉOèoóÕ
                Call sLogTraceReq(LTYP_NORMAL, L3AN_RECV, PROCESS_END_ORD_RECV, 0)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
                'ÉvÉçÉZÉXÇÃèIóπèàóùÇçsÇ§
                pfAbortProc
            Case ML_ID_HOSHU_ACTIVE_REQ
                'Åuï€éÁâÊñ ÉAÉNÉeÉBÉuï\é¶ÅvÇéÛêMÇµÇΩèÍçá
                'Åuï€éÁâÊñ ÉAÉNÉeÉBÉuï\é¶óvãÅéÛêMê≥èÌÅvÉçÉOèoóÕ
                Call sLogTraceReq(LTYP_NORMAL, L3AN_RECV, HOSHU_ACTIVE_REQ_RECV, 0)
                'ï\é¶å≥âÊñ Åiï€éÁÉfÅ[É^é˚èWâÊñ ÅjÇÉAÉNÉeÉBÉuï\é¶Ç∑ÇÈÅB
'                AppActivate frmInputMstData.Caption, False     ' EG20 V8.1.0.1ÅyEG20_KANSI05_01ÅzDEL
                AppActivate frmKikiData.Caption, False          ' EG20 V8.1.0.1ÅyEG20_KANSI05_01ÅzADD
                pfFormActive (frmKikiData.hwnd)                 ' EG20 V8.1.0.1ÅyEG20_KANSI05_01ÅzADD
            Case ML_ID_HOSHU_OPERATE_PROG_SNDREQ_RES
                'Åuï€éÁëÄçÏëÏÉvÉçÉOÉâÉÄëóêMóvãÅÅvÇéÛêMÇµÇΩèÍçá
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
                If pubfuncRespCheckTakuProgramData(udtReadMail) = False Then
                    iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ")
                Else
                    iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "îΩâfèàóùê›íËîΩâfåãâ ")
                End If
                Call SetEnableTrue
            Case Else
                 'ÇªÇÃëºÇÃÉÅÅ[ÉãÇéÛêMÇµÇΩèÍçá
                 'ÅuÉÅÅ[ÉãIDïsê≥ÅvÉçÉOèoóÕ
                 Call sLogTraceReq(LTYP_ERROR, L3AN_RECV, MAIL_FUSEI_RECV, 0)
        End Select
    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdCancel_Click
'//  ã@î\ñºèÃ  : ÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : é©âÊñ Çè¡ãéÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfñtÇÃñ¢âüâ∫ÉÅÉbÉZÅ[ÉWí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdCancel_Click()
    
    Dim iResponse           As Integer          'MsgBoxñﬂÇËíl    'V1.20.0.1 ADD
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'V1.20.0.1 ADD START
    If SetteiHaneiFlg = True Then
        iResponse = MsgBox("âÊñ ï\é¶íÜÇ…ê›íËÇ≥ÇÍÇΩÉfÅ[É^Ç™é∏ÇÌÇÍÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                            "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                            vbYesNo + vbQuestion, _
                            "ê›íËîΩâfñtñ¢âüâ∫")
        
        If iResponse = vbNo Then Exit Sub
    End If
    'V1.20.0.1 ADD END
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_END, 0)
    
    Unload Me

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDisp
'//  ã@î\ñºèÃ  : âÊñ çƒï`âÊèàóù
'//  ã@î\äTóv  : âÊñ Ççƒï`âÊÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sDisp()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim nCornerIndex         As Integer         ' ÉRÅ[ÉiëIëèÛë‘

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    If CmbCornerName.ListIndex < 0 Then
        Exit Sub
    End If
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ

    'èâä˙ílê›íË
    strFileName = ""                            'ÉtÉ@ÉCÉãñº
    cmbEkiInfo.Enabled = False                  'âwèÓïÒÉRÉìÉ{É{ÉbÉNÉXëIëïsâ¬ê›íË
    CmbCornerName.Enabled = False               ' ÉRÅ[ÉiëIëïîëIëïsâ¬      ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    LblEkiName.Caption = TITOL_EKI_NAME         'âwñºÉâÉxÉãèâä˙âª           ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
    '----------------------------------------------------
    'ÉOÉäÉbÉhÉ^ÉCÉgÉãê›íË
    '----------------------------------------------------
    Call sDispGridTitol
    Erase GamenDataTbl
    ReDim GamenDataTbl(0)
    
    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOÉ`ÉFÉbÉN
    If KikiDataUpDateFlg = True Then
        Erase KikiDataTbl
        ReDim KikiDataTbl(0)
        Call pfKikiDataSet
    End If
    
    '----------------------------------------------------
    'åªç›âwê›íËÉtÉ@ÉCÉãåüçı
    '----------------------------------------------------
    strFileName = Dir(EKI_SETTI_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then
    
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_EKI_SETTI, 0)
        
        'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
        Call sDispDataClear(1, GridIni.Rows)

        'èàóùñtâüâ∫ïsâ¬î\ê›íË
        CmdKikiSetMenu(0).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
        CmdKikiSetMenu(1).Enabled = False           'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
        CmdKikiSetMenu(2).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

        Exit Sub
        
    End If
    
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    '----------------------------------------------------
    'âwñºÉâÉxÉãçXêV
    '----------------------------------------------------
    LblEkiName.Caption = TITOL_EKI_NAME & pfGetEkiNameInfo(NotEkiVer)
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
    
    'ã@äÌç\ê¨èÓïÒÅiâwèÓïÒÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãåüçı
    strFileName = Dir(KIKI_DATA_SET_EKI_INFO_FILE)
    
    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇΩèÍçá
    If strFileName <> "" Then
    
        'ÉOÉäÉbÉhÉfÅ[É^ïîê›íË
'        Call sDispDataSet(pfGetCodeDaiBunrui(cmbEkiInfo))                              ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
        nCornerIndex = CmbCornerName.ListIndex
        Call sDispDataSet(pfGetCodeDaiBunrui(cmbEkiInfo), nCornerIndex + 1)
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
    
        cmbEkiInfo.Enabled = True                   'âwèÓïÒÉRÉìÉ{É{ÉbÉNÉXëIëâ¬ê›íË
        CmbCornerName.Enabled = True                ' ÉRÅ[ÉiëIëïîëIëïsâ¬      ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
        'èàóùñtâüâ∫â¬î\ê›íË
        CmdKikiSetMenu(0).Enabled = True            'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
        CmdKikiSetMenu(1).Enabled = True            'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
        CmdKikiSetMenu(2).Enabled = True            'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

    Else
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_EKIINFO_IMAGE, 0)
        
        'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
        Call sDispDataClear(1, GridIni.Rows)
    
        'èàóùñtâüâ∫ïsâ¬î\ê›íË
        CmdKikiSetMenu(0).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
        CmdKikiSetMenu(1).Enabled = False           'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
        CmdKikiSetMenu(2).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDispGridTitol
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÉ^ÉCÉgÉãïîê›íËèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÇÃèâä˙ílÅAÉ^ÉCÉgÉãÇê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sDispGridTitol()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ÉOÉäÉbÉhÉ^ÉCÉgÉãê›íË
    With GridIni
    
        '----------------------------------
        'ÉOÉäÉbÉhÇÃèâä˙âª
        '----------------------------------
        .Clear
        .Width = 11550
        
        '----------------------------------
        'ÉOÉäÉbÉhÉZÉãêîê›íË
        '----------------------------------
        .Rows = 9
        .Cols = 4
        
        '----------------------------------
        'ÉOÉäÉbÉhïùê›íË
        '----------------------------------
        .ColWidth(0) = 400
        .ColWidth(1) = 3700
        .ColWidth(2) = 2500
'        .ColWidth(3) = 4825        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
        .ColWidth(3) = 5000         ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
        
        '----------------------------------
        'É^ÉCÉgÉãê›íË
        '----------------------------------
        'çÄñ⁄ê›íË
        .Col = 1
        .Row = 0: .Text = "çÄñ⁄"
        .CellAlignment = flexAlignCenterCenter

        'ê›íËílê›íË
        .Col = 2
        .Text = "ê›íËíl"
        .CellAlignment = flexAlignCenterCenter

        'è⁄ç◊ê›íË
        .Col = 3
        .Text = "ê›íËílè⁄ç◊"
        .CellAlignment = flexAlignCenterCenter
        
'        .RowHeight(0) = 700        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
        .RowHeight(0) = 450         ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
    End With
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDispDataClear
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^ïîÇÉNÉäÉAÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Integer   intStartRow  äJénçsà íu
'//              Integer   intEndRow    èIóπçsà íu
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sDispDataClear(intStartRow As Integer, intEndRow As Integer)
    
    Dim iLoopCnt             As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ÉOÉäÉbÉhèâä˙âª
    With GridIni
            .Rows = intEndRow

        For iLoopCnt = intStartRow To intEndRow - 1

            'í î‘ê›íË
            .Col = 0
            .Row = iLoopCnt: .Text = ""
            .CellAlignment = flexAlignLeftCenter

            'çÄñ⁄ê›íË
            .Col = 1
            .Text = ""
            .CellAlignment = flexAlignLeftCenter

            'ê›íËílê›íË
            .Col = 2
            .Text = "" & vbCrLf & _
                    "" & vbCrLf & _
                    ""
            .CellAlignment = flexAlignLeftCenter

            'è⁄ç◊ê›íË
            .Col = 3
            .Text = "" & vbCrLf & _
                    "" & vbCrLf & _
                    ""
            .CellAlignment = flexAlignLeftCenter

            .RowHeight(iLoopCnt) = 700
        Next

    End With
        
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDispDataSet
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÉfÅ[É^ïîê›íËèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^ïîÇê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Integer   iBunrui_Dai  ëÂï™óﬁ
'//            : Integer   iCorner      ÉRÅ[Éi  ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(2.7.0.1) 2011-01-18  REVISED BY [TCC] S.Terao
'//                 ÇdÇfÇq_ÇiÇdëŒâû
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Sub sDispDataSet(iBunrui_Dai As Integer)                       ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
Private Sub sDispDataSet(iBunrui_Dai As Integer, iCorner As Integer)    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
    Dim intFileNumber       As Integer                      ' ÉtÉ@ÉCÉãÉ|ÉCÉìÉ^
    Dim iLoopCnt            As Integer                      ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim iKikiDataCnt        As Integer                      ' ã@äÌèÓïÒÉfÅ[É^ÉJÉEÉìÉ^
    Dim iRowCnt             As Integer                      ' çsÉJÉEÉìÉ^
    
    Dim strBunrui_Dai       As String                       ' ëÂï™óﬁ
    Dim strBunrui_Tyu       As String                       ' íÜï™óﬁ
    Dim strBunrui_Sho       As String                       ' è¨ï™óﬁ
    Dim strNo               As String                       ' í î‘
    Dim strKomoku           As String                       ' çÄñ⁄
    Dim strKubun            As String                       ' ãÊï™
    Dim strData             As String                       ' ê›íËíl
    Dim strSetShosai        As String                       ' ê›íËílè⁄ç◊
                
    Dim byBuff()            As Byte                         ' ÉoÉCÉgÉoÉbÉtÉ@
    Dim iLoopCnt2           As Integer
    Dim iBuffCnt            As Integer                      'V2.7.0.1 ADDÅ@ÉGÉäÉAämï€êî
    
    Dim strCorner           As String                       ' ÉRÅ[Éi    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    Dim iCmpCorner          As Integer                      ' ÉRÅ[Éi    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'èâä˙ílê›íË
    iKikiDataCnt = 0
    iLoopCnt = 1
    GridIni.Rows = 1
    
    'ì‡ïîÉtÉ@ÉCÉãÉGÉâÅ[ÇÃÉgÉâÉbÉv
    On Error GoTo Err_LOG
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜéÊìæ
    intFileNumber = FreeFile
    
    'ã@äÌç\ê¨èÓïÒÅiâwèÓïÒÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
    Open KIKI_DATA_SET_EKI_INFO_FILE For Input As #intFileNumber
    
    GridIni.Visible = False
    Do While Not EOF(intFileNumber)
        
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúäJén
'        'ÇP çsì«Ç›çûÇ›
'        Input #intFileNumber, strBunrui_Dai, strBunrui_Tyu, strBunrui_Sho, strNo, _
'                              strKomoku, strKubun, strData, strSetShosai
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúèIóπ
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
        'ÇP çsì«Ç›çûÇ›
        Input #intFileNumber, strBunrui_Dai, strBunrui_Tyu, strBunrui_Sho, strCorner, strNo, _
                              strKomoku, strKubun, strData, strSetShosai
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
        
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOÉ`ÉFÉbÉN
        If KikiDataUpDateFlg = False Then
            strData = KikiDataTbl(iKikiDataCnt).strData
            strData = StrConv(strData, vbUnicode)
        End If
        
        'ã@äÌèÓïÒÉfÅ[É^ÉJÉEÉìÉ^ÉCÉìÉNÉäÉÅÉìÉg
        iKikiDataCnt = iKikiDataCnt + 1
        
        If iBunrui_Dai = strBunrui_Dai Then
        
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
        ' ÉRÅ[ÉiîªíËí«â¡
        ' ëIëÇµÇΩÉRÅ[ÉiÅAÇ‡ÇµÇ≠ÇÕÉRÅ[Éiñ≥ä÷åWÇÃÉåÉRÅ[ÉhÇÕçÃópÇ∑ÇÈ
        iCmpCorner = CInt(strCorner)
        If ((iCorner = iCmpCorner) Or (iCmpCorner = 0)) Then
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
        
            With GridIni
                
                'ç≈ëÂçsêîÉCÉìÉNÉäÉÅÉìÉg
                .Rows = iLoopCnt + 1
                
                'í î‘ê›íË
                .Col = 0
                .Row = iLoopCnt: If .Text = "" Then .Text = CStr(iLoopCnt)
                .CellAlignment = flexAlignLeftCenter
    
                'çÄñ⁄ê›íË
                .Col = 1
                If .Text = "" Then .Text = strKomoku
                .CellAlignment = flexAlignLeftCenter
    
                'ê›íËílê›íË
                .Col = 2
                .Text = strData
                .CellAlignment = flexAlignLeftCenter
    
                'âÊñ ï\é¶ópÉfÅ[É^ï€ë∂
                ReDim Preserve GamenDataTbl(.Rows - 1)
                GamenDataTbl(.Rows - 1).iBunrui_Dai = CInt(strBunrui_Dai)     'ëÂï™óﬁ
                GamenDataTbl(.Rows - 1).iBunrui_Tyu = CInt(strBunrui_Tyu)     'íÜï™óﬁ
                GamenDataTbl(.Rows - 1).iBunrui_Sho = CInt(strBunrui_Sho)     'è¨ï™óﬁ
                GamenDataTbl(.Rows - 1).iBunrui_Corner = iCmpCorner           ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
                
                'ê›íËíl
                If strData <> "" Then 'V2.7.0.1 ADD
                    byBuff = StrConv(strData, vbFromUnicode)
                'V2.7.0.1 ADD START
                Else
                   'îºäpÉXÉyÅ[ÉXÇë„ì¸
                   'îºäpÉXÉyÅ[ÉXÇ≈ïœä∑ÇÇ©ÇØÇƒÇ‡ÅA
                   'Åuê›íËîΩâfÅvéûÇÕâÊñ ì‡óeÇå©íºÇ≥ÇÍÇÈÇΩÇﬂ
                   'îºäpÉXÉyÅ[ÉXïœä∑åãâ (32)ÇÕ(0ÅjÇ∆Ç»ÇÈÅB
                    strData = "  "
                    byBuff = StrConv(strData, vbFromUnicode)
                End If
                'V2.7.0.1 ADD END
                'ìÆìIîzóÒÇÃì‡óeÇÉçÉOÉpÉâÉÅÅ[É^ç\ë¢ëÃÇÃê√ìIîzóÒÇ…äiî[Ç∑ÇÈÅB
                For iLoopCnt2 = 0 To UBound(GamenDataTbl(.Rows - 1).strData)
                    'NullílÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈÅB
                    If byBuff(iLoopCnt2) = vbVEmpty Then Exit For
                    
                    GamenDataTbl(.Rows - 1).strData(iLoopCnt2) = byBuff(iLoopCnt2)
                    
                    'ìÆìIîzóÒÇÃç≈ëÂóvëfÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈ
                    If iLoopCnt2 = UBound(byBuff) Then Exit For
                Next
                 
                'è⁄ç◊ê›íË
                .Col = 3
                If .Text = "" Then .Text = strSetShosai
                .CellAlignment = flexAlignLeftCenter
    
                .RowHeight(iLoopCnt) = 700
        
                'ÉCÉìÉNÉäÉÅÉìÉg
                iLoopCnt = iLoopCnt + 1             'ï\é¶çsêî
            
                'ï\é¶ÉfÅ[É^Ç™ÇPâÊñ Ç…ï\é¶ÇµÇ´ÇÍÇ»Ç¢èÍçá
                If .Rows > 8 Then
                    'ÉXÉNÉçÅ[ÉãÉoÅ[ï™ÅAÉOÉäÉbÉhÇçLÇ∞ÇÈ
                    .Width = 11775
                End If
                
            End With
        
        End If          ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
        End If
    
    Loop

    GridIni.Visible = True
    'ÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    Close #intFileNumber
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ï\é¶çsêîÇ…ñûÇΩÇ»Ç¢èÍçáÉfÅ[É^ÇÉNÉäÉAÇ∑ÇÈ
    If GridIni.Rows < 9 Then
        'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
'        Call sDispDataClear(GridIni.Rows - 1, 9) 'V1.8.0.1 DEL
         Call sDispDataClear(GridIni.Rows, 9) 'V1.8.0.1 ADD
    End If

    Exit Sub

'ÉGÉâÅ[èàóù
Err_LOG:

    If intFileNumber > 0 Then
        Close #intFileNumber
    End If
    
    'àŸèÌÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, FILE_ACCESS_ERROR, 0)
    
    'ÉOÉäÉbÉhÉ^ÉCÉgÉãê›íË
    Call sDispGridTitol
    
    'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
'    Call sDispDataClear(1, GridIni.Rows - 1)   'V1.8.0.1 DEL
     Call sDispDataClear(1, GridIni.Rows)       'V1.8.0.1 ADD
     
    GridIni.Visible = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmbEkiInfo_Change
'//  ã@î\ñºèÃ  : âwèÓïÒëIëèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^Ççƒê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ñtÇÃâüâ∫â¬Å^ïsâ¬èàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmbEkiInfo_Click()
    
    Dim iIndex          As Integer                  'ÉCÉìÉfÉbÉNÉX
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

'V1.12.0.1 ADD START
    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    Call SetEnableFalse
'V1.12.0.1 ADD END
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_EKIINFO_SELECT, 0)
    
    'âÊñ ï\é¶èàóù
    Call sDisp

'V1.12.0.1 ADD START
    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
    Call SetEnableTrue
'V1.12.0.1 ADD END

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GridIni_Click
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÇëIëÇ≥ÇÍÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub GridIni_Click()
    
    Dim iColSave        As Integer          'óÒï€ë∂ÉGÉäÉA
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ÉNÉäÉbÉNÇ≥ÇÍÇΩà íuÇ…É_É~Å[ÉeÉLÉXÉgÇà⁄ìÆÇµÅAÉtÉHÅ[ÉJÉXÇçáÇÌÇπÇÈ
    With GridIni
    
        'è⁄ç◊ê›íËílÇÕèàóùÇµÇ»Ç¢
        If .Col = 3 Then Exit Sub
        
        iColSave = .Col
        .Col = 0
        If .Text = "" Then
            .Col = iColSave
            Exit Sub
        End If
        .Col = iColSave
        
        txtDummy.Left = .Left + .CellLeft
        txtDummy.Top = .Top + .CellTop
        txtDummy.Width = .CellWidth
        txtDummy.Height = .CellHeight
        txtDummy.Text = .Text
        txtDummy.Visible = True
        txtDummy.SetFocus
        
        'É_É~Å[ÉeÉLÉXÉgÇÃç≈èIÇ…ÉtÉHÅ[ÉJÉXà⁄ìÆ
        SendKeys "{END}"
    
    End With

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GridIni_KeyPress
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÇâüâ∫Ç≥ÇÍÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub GridIni_KeyPress(KeyAscii As Integer)
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

' EG20 V3.5.0.1í«â¡äJén
    If GridIni.Col = 3 Then
        Exit Sub
    End If
' EG20 V3.5.0.1í«â¡èIóπ

    'ÉNÉäÉbÉNÇ≥ÇÍÇΩà íuÇ…É_É~Å[ÉeÉLÉXÉgÇà⁄ìÆÇµÅAÉtÉHÅ[ÉJÉXÇçáÇÌÇπÇÈ
    With GridIni
        
        txtDummy.Left = .Left + .CellLeft
        txtDummy.Top = .Top + .CellTop
        txtDummy.Width = .CellWidth
        txtDummy.Height = .CellHeight
        If KeyAscii <> 13 Then
            txtDummy.Text = .Text & Chr(KeyAscii)
        Else
            txtDummy.Text = .Text
        End If
        txtDummy.Visible = True
        txtDummy.SetFocus
        
        'É_É~Å[ÉeÉLÉXÉgÇÃç≈èIÇ…ÉtÉHÅ[ÉJÉXà⁄ìÆ
        SendKeys "{END}"
    
    End With

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GridIni_Scroll
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÇÉXÉNÉçÅ[ÉãÇµÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃîÒï\é¶
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub GridIni_Scroll()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ÉOÉäÉbÉhÇ™ÉXÉNÉçÅ[ÉãÇ≥ÇÍÇΩéûÅAÉ_É~Å[ÉeÉLÉXÉgÇîÒï\é¶Ç…Ç∑ÇÈ
    If bScroll = False Then
        txtDummy.Visible = False
    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : txtDummy_Change
'//  ã@î\ñºèÃ  : É_É~Å[ÉeÉLÉXÉgÇ™ïœçXÇ≥ÇÍÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : ÉOÉäÉbÉhÇ÷ÇÃîΩâf
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfÉtÉâÉOí«â¡
'//                ãÛîíÉZÉãì¸óÕéûÇÃâÒîèàóùÇí«â¡
'//     REVISIONS :(EG20 V5.12.0.1) 2012-05-18  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V6.4.0.1) 2012-06-17 REVISED BY [TCC] H.Sugimoto
'//                Åyëçì_åüèCê≥ëŒâûÅFîºäpÉXÉyÅ[ÉXÇÃì¸óÕÇó}é~Ç∑ÇÈëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub txtDummy_Change()
    
    Dim iLoopCnt            As Integer                      ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim iLoopCnt2           As Integer                      ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim byBuff()            As Byte                         ' ÉoÉCÉgÉoÉbÉtÉ@
    Dim szWork              As String                       ' ÉèÅ[ÉN    ' EG20 V6.4.0.1í«â¡
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
' EG20 V6.4.0.1í«â¡äJén
    If InStr(txtDummy.Text, " ") > 0 Then
        szWork = Replace(txtDummy.Text, " ", "")
        txtDummy.Text = szWork
        MsgBox "ÉXÉyÅ[ÉXÇÃì¸óÕÇ≈Ç´Ç‹ÇπÇÒÅB" & vbCrLf & _
                "ì¸óÕì‡óeÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbCritical, "ê›íËílì¸óÕàŸèÌ"
        Exit Sub
    End If
' EG20 V6.4.0.1í«â¡èIóπ
    
    'V1.20.0.1 ADD START
    If GridIni.Text <> txtDummy.Text Then
        'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ†ÇËÅj
        SetteiHaneiFlg = True
    End If
    'V1.20.0.1 ADD END
    
    'ÉOÉäÉbÉhÇ…ì¸óÕçÄñ⁄ÇîΩâfÇ≥ÇπÇÈ
    GridIni.Text = txtDummy.Text
    
    'V1.20.0.1 ADD START
    'ÉfÅ[É^Ç™Ç»Ç¢çsÇÉNÉäÉbÉNÇµÇΩèÍçá
    If UBound(GamenDataTbl) < GridIni.Row Then
        Exit Sub
    End If
    'V1.20.0.1 ADD END
    
    'âÊñ ï\é¶ÉfÅ[É^ï€ë∂
    byBuff = StrConv(GridIni.Text, vbFromUnicode)
    'ìÆìIîzóÒÇÃì‡óeÇÉçÉOÉpÉâÉÅÅ[É^ç\ë¢ëÃÇÃê√ìIîzóÒÇ…äiî[Ç∑ÇÈÅB
    Erase GamenDataTbl(GridIni.Row).strData
    For iLoopCnt2 = 0 To UBound(GamenDataTbl(GridIni.Row).strData)
        'NullílÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈÅB
        If byBuff(iLoopCnt2) = vbVEmpty Then Exit For
        
        GamenDataTbl(GridIni.Row).strData(iLoopCnt2) = byBuff(iLoopCnt2)
        
        'ìÆìIîzóÒÇÃç≈ëÂóvëfÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈ
        If iLoopCnt2 = UBound(byBuff) Then Exit For
    Next
    
    For iLoopCnt = 0 To UBound(KikiDataTbl) - 1
    
        'âÊñ èÓïÒÇ∆ã@äÌèÓïÒÇÃëÂï™óﬁÅAíÜï™óﬁÅAè¨ï™óﬁÇ™àÍívÇµÇΩèÍçá
' EG20 V5.12.0.1çÌèúäJén
'        If (GamenDataTbl(GridIni.Row).iBunrui_Dai = KikiDataTbl(iLoopCnt).iBunrui_Dai) And _
'           (GamenDataTbl(GridIni.Row).iBunrui_Tyu = KikiDataTbl(iLoopCnt).iBunrui_Tyu) And _
'           (GamenDataTbl(GridIni.Row).iBunrui_Sho = KikiDataTbl(iLoopCnt).iBunrui_Sho) Then
' EG20 V5.12.0.1çÌèúèIóπ
' EG20 V5.12.0.1í«â¡äJén
        If (GamenDataTbl(GridIni.Row).iBunrui_Dai = KikiDataTbl(iLoopCnt).iBunrui_Dai) And _
           (GamenDataTbl(GridIni.Row).iBunrui_Tyu = KikiDataTbl(iLoopCnt).iBunrui_Tyu) And _
           (GamenDataTbl(GridIni.Row).iBunrui_Sho = KikiDataTbl(iLoopCnt).iBunrui_Sho) And _
           (GamenDataTbl(GridIni.Row).iBunrui_Corner = KikiDataTbl(iLoopCnt).iBunrui_Corner) Then
' EG20 V5.12.0.1í«â¡èIóπ
            'ã@äÌç\ê¨èÓïÒÉfÅ[É^ï€ë∂
            'ìÆìIîzóÒÇÃì‡óeÇÉçÉOÉpÉâÉÅÅ[É^ç\ë¢ëÃÇÃê√ìIîzóÒÇ…äiî[Ç∑ÇÈÅB
            Erase KikiDataTbl(iLoopCnt).strData
            For iLoopCnt2 = 0 To UBound(KikiDataTbl(iLoopCnt).strData)
                'NullílÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈÅB
                If byBuff(iLoopCnt2) = vbVEmpty Then Exit For
                
                KikiDataTbl(iLoopCnt).strData(iLoopCnt2) = byBuff(iLoopCnt2)
                
                'ìÆìIîzóÒÇÃç≈ëÂóvëfÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈ
                If iLoopCnt2 = UBound(byBuff) Then Exit For
            Next
            Exit For
        End If

    Next

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : txtDummy_KeyDown
'//  ã@î\ñºèÃ  : ÉLÅ[É{Å[Éhâüâ∫éûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//                 ÉJÅ[É\Éãà⁄ìÆÇÃèàóùÇçÌèú
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub txtDummy_KeyDown(KeyCode As Integer, Shift As Integer)
    
    Dim iColSave        As Integer          'óÒï€ë∂ÉGÉäÉA
    Dim iRowSave        As Integer          'çsï€ë∂ÉGÉäÉA
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ì¡éÍÉLÅ[Çâüâ∫Ç≥ÇÍÇΩéûÅAâ∫ãLÇÃèàóùÇçsÇ§
    bScroll = True
    On Err GoTo ShoriErr
    
    With GridIni
        'V1.20.0.1 DEL START
'        'Å™Çâüâ∫Ç≥ÇÍÇΩéû
'        If KeyCode = 38 Then
'            If .Row <> 0 And .Row <> 1 Then
'                'ÉZÉãÇè„Ç…àÍÇ¬à⁄ìÆ
'                .Row = .Row - 1
'            End If
'        'Å´ÅAÇ‹ÇΩÇÕenterÇâüâ∫Ç≥ÇÍÇΩéû
'        ElseIf KeyCode = 40 Or KeyCode = 13 Then
        'V1.20.0.1 DEL END
        If KeyCode = 13 Then    'V1.20.0.1 ADD

            iColSave = .Col
            iRowSave = .Row
            .Col = 0
            .Row = .Row + 1
            If .Text = "" Then
                .Col = iColSave
                .Row = iRowSave
                Exit Sub
            End If
            .Col = iColSave
            .Row = iRowSave
            
            If .Row <> .Rows - 1 Then
                'ÉZÉãÇâ∫Ç…àÍÇ¬à⁄ìÆ
                .Row = .Row + 1
            End If
        'V1.20.0.1 DEL START
'        'Å©ÅAÇ‹ÇΩÇÕÅ®Çâüâ∫Ç≥ÇÍÇΩéû
'        ElseIf KeyCode = 37 Or KeyCode = 39 Then
'            Exit Sub
        'V1.20.0.1 DEL END
        End If

        'É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
        txtDummy.Left = .Left + .CellLeft
        txtDummy.Top = .Top + .CellTop
        txtDummy.Width = .CellWidth
        txtDummy.Height = .CellHeight
        txtDummy.Text = .Text
        txtDummy.Visible = True
        txtDummy.SetFocus
    End With
    bScroll = False

ShoriErr:

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : txtDummy_Change
'//  ã@î\ñºèÃ  : É_É~Å[ÉeÉLÉXÉgÇ©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄ìÆÇµÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇîÒï\é¶Ç…Ç∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub txtDummy_LostFocus()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'É_É~Å[ÉeÉLÉXÉgÇîÒï\é¶Ç…Ç∑ÇÈ
    txtDummy.Visible = False

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmdKikiSetMenu_Click
'//  ã@î\ñºèÃ  : äeñtâüâ∫éûèàóù
'//  ã@î\äTóv  : äeñtâüâ∫èàóùÇ…è]Ç§
'//
'//              å^        ñºèÃ     Å@Å@Å@à”ñ°
'//  à¯êî      : IntegerÅ@ Index          ëIëñtÇÃÉCÉìÉfÉbÉNÉX
'//
'//              å^        íl        Å@Å@ à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.4.0.1) 2009-03-23   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@Åué©â¸âÊñ Ç÷Åvñtèàóùí«â¡
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ñtÇÃâüâ∫â¬Å^ïsâ¬èàóùí«â¡
'//     REVISIONS :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfñtÇÃñ¢âüâ∫ÉÅÉbÉZÅ[ÉWí«â¡
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22   CODED   BY [TCC] H.Sugimoto
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmdKikiSetMenu_Click(Index As Integer)
    Dim iResponse           As Integer          'MsgBoxñﬂÇËíl   'V1.20.0.1 ADD
    Dim bUnlock             As Boolean          ' ÉçÉbÉNâèúÉtÉâÉO      ' EG20 V3.0.0.2 í«â¡

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
'V1.12.0.1 ADD START
    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    Call SetEnableFalse
'V1.12.0.1 ADD END
 ' EG20 V3.0.0.2 í«â¡äJén
' âüâ∫ÇµÇΩñtÇ…âûÇ∂ÇƒÉçÉbÉNâèúÇêßå¿Ç∑ÇÈ
' Å¶ÉÅÅ[ÉãéÛêMÇë“Ç¬ÇΩÇﬂ
    bUnlock = True
' EG20 V3.0.0.2 í«â¡èIóπ
   
    Select Case Index
        
        Case 0                                 ' ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_KIKIDATA_INSTOL, 0)
            
            'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâfèàóù
            Call sInstolKikiData
            bUnlock = False                     ' EG20 V3.0.0.2 í«â¡

        Case 1                                 ' ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_KIKIDATA_OUTPUT, 0)
            
            'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕèàóù
            Call sKikiDataOutPut
    
        Case 2                                 ' ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_KIKIDATA_SAVE, 0)
            
            'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂èàóù
            Call sKikiDataSave
        
        Case 3                                 ' ã@äÌç\ê¨ê›íËÉfÅ[É^ëIë
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_KIKIDATA_SELECT, 0)
            
            'ã@äÌç\ê¨ê›íËÉfÅ[É^ëIëèàóù
            Call sKikiDataSelect
    
        Case 4                                 ' î}ëÃì¸óÕ
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_EKIINFO_GAMEN_MEDIUM_INPUT, 0)
            
            'î}ëÃì¸óÕèàóù
            Call sInputMedium
    
        Case 5                                 ' î}ëÃéÊäO
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, USB_OUT, 0)
            
            'î}ëÃéÊäOèàóù
            Call pfRemove(Me)
'V1.4.0.1 ADD START
        Case 6                                 ' é©â¸âÊñ Ç÷
            'V1.20.0.1 ADD START
            If SetteiHaneiFlg = True Then
                iResponse = MsgBox("âÊñ ï\é¶íÜÇ…ê›íËÇ≥ÇÍÇΩÉfÅ[É^Ç™é∏ÇÌÇÍÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                                    "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                                    vbYesNo + vbQuestion, _
                                    "ê›íËîΩâfñtñ¢âüâ∫")
                If iResponse = vbNo Then
                    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
                    Call SetEnableTrue
                    Exit Sub
                End If
            End If
            'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
            SetteiHaneiFlg = False
            'V1.20.0.1 ADD END
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, GATE_GAMEN_GO_BUTTOM, 0)
            Unload Me
            Load frmKikiDataGate
            frmKikiDataGate.Show 1
            Exit Sub     'V1.20.0.1 ADD
'V1.4.0.1 ADD END
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
        Case 7                                 ' ÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@âÊñ Ç÷
            If SetteiHaneiFlg = True Then
                iResponse = MsgBox("âÊñ ï\é¶íÜÇ…ê›íËÇ≥ÇÍÇΩÉfÅ[É^Ç™é∏ÇÌÇÍÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                                    "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                                    vbYesNo + vbQuestion, _
                                    "ê›íËîΩâfñtñ¢âüâ∫")
                If iResponse = vbNo Then
                    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
                    Call SetEnableTrue
                    Exit Sub
                End If
            End If
            'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
            SetteiHaneiFlg = False
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKIINFSETMENU_GAMEN_SUBGATE, 0)
            
            'ï\é¶íÜâÊñ ÉAÉìÉçÅ[Éh
            Unload Me
            
            'ÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@âÊñ ï\é¶
            Load frmKikiDataSubGate
            frmKikiDataSubGate.Show 1
            Exit Sub
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ

        Case Else
            'èàóùÇ»Çµ
            
    End Select
'V1.12.0.1 ADD START
    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
' EG20 V3.0.0.2 í«â¡äJén
    If bUnlock = True Then
        Call SetEnableTrue
    End If
' EG20 V3.0.0.2 í«â¡èIóπ
'    Call SetEnableTrue                 ' EG20 V3.0.0.2 çÌèú
'V1.12.0.1 ADD END

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sInstolKikiData
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨çÄñ⁄ê›íËîΩâfÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : âÊñ ï\é¶ÉfÅ[É^ÇINIÉtÉ@ÉCÉãÇ÷îΩâfÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.10.0.1) 2009-10-23   REVISED BY [TCC] D.Yamashita
'//                 ÉtÉFÅ[ÉYÇRécåèçÄñ⁄ëŒâûÅ@ÉLÉÉÉìÉZÉãïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-16   REVISED BY [TCC] C.Terui
'//                 ÉRÉìÉsÉÖÅ[É^ñºÅAÉlÉbÉgÉèÅ[ÉNïœçXèàóùí«â¡
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfÉtÉâÉOí«â¡
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 É|ÉbÉvÉAÉbÉvämîFâÊñ ÇÃÉ^ÉCÉgÉãèCê≥
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22   CODED   BY [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.0.2.1) 2012-03-12  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyåãçáTR-No.76èCê≥ëŒâûÅz
'//     REVISIONS :(EG20 V30.3.0.1) 2014-10-08  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sInstolKikiData()

    Dim iResponse           As Integer          'MsgBoxñﬂÇËíl
    Dim bRet                As Boolean          'ä÷êîñﬂÇËíl
    Dim lErrCode            As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim strFileName         As String           'î}ëÃÉtÉ@ÉCÉãñº
    
    Dim bData()             As Byte             'ÉoÉCÉiÉäÉfÅ[É^
    Dim iLoopCnt            As Integer          'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim bSysChange          As Boolean          'ÉRÉìÉsÉÖÅ[É^ñºÅAÉlÉbÉgÉèÅ[ÉNïœçXèàóùîªíË   'V1.12.0.1 ADD
    
    Dim lResult             As Long             ' èàóùåãâ      ' EG20 V3.0.0.2[Mainte_03_01 âwìsìxëŒâû]í«â¡
' EG20 V30.0.3.1 í«â¡äJénÅiåvéZÇ…óòópÇ∑ÇÈïœêîÇLONGå^Ç…ïœçXÅj
    Dim lLoop               As Long             ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim lRecord             As Long             ' ÉåÉRÅ[Éh
    Dim lIndex              As Long             ' ÉCÉìÉfÉbÉNÉX
    Dim lSize               As Long             ' ÉTÉCÉY
' EG20 V30.0.3.1 í«â¡èIóπÅiåvéZÇ…óòópÇ∑ÇÈïœêîÇLONGå^Ç…ïœçXÅj
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
'V1.8.0.1 DEL START
'    iResponse = MsgBox("ã@äÌç\ê¨ÉfÅ[É^ÇÉCÉìÉXÉgÅ[ÉãÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH" & Chr(vbKeyReturn) & _
'                        "îΩâfÇÕçƒãNìÆå„Ç…Ç»ÇËÇ‹Ç∑ÅB", _
'                        vbYesNo + vbExclamation, _
'                        "î}ëÃì¸óÕämîF")
'V1.8.0.1 DEL END
'V1.8.0.1 ADD START
'V1.21.0.1 DEL START
'    iResponse = MsgBox("ã@äÌç\ê¨ÉfÅ[É^ÇÉCÉìÉXÉgÅ[ÉãÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH" & Chr(vbKeyReturn) & _
'                        "îΩâfÇÕçƒãNìÆå„Ç…Ç»ÇËÇ‹Ç∑ÅB", _
'                        vbOKCancel + vbExclamation, _
'                        "î}ëÃì¸óÕämîF")
'V1.21.0.1 DEL END
'V1.21.0.1 ADD START
    iResponse = MsgBox("ã@äÌç\ê¨ÉfÅ[É^ÇÉCÉìÉXÉgÅ[ÉãÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH" & Chr(vbKeyReturn) & _
                        "îΩâfÇÕçƒãNìÆå„Ç…Ç»ÇËÇ‹Ç∑ÅB", _
                        vbOKCancel + vbExclamation, _
                        "ê›íËîΩâfämîF")
'V1.21.0.1 ADD END
'V1.8.0.1 ADD END
'    If iResponse = vbNo Then Exit Sub      'V1.10.0.1 DEL
    If iResponse = vbCancel Then
        Call SetEnableTrue                      ' EG20 V5.0.2.1ÅyåãçáTR-No.76èCê≥ëŒâûÅzí«â¡
        Exit Sub   'V1.10.0.1 ADD
    End If
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
' EG20 V30.3.0.1 çÌèúäJénÅiåvéZÇ…óòópÇ∑ÇÈïœêîÇLONGå^Ç…ïœçXÅj
'    'ç\ë¢ëÃîzóÒÇÉoÉCÉiÉäîzóÒÇ…ïœä∑
'    ReDim bData((UBound(KikiDataTbl) + 1) * Len(KikiDataTbl(0))) As Byte
'    For iLoopCnt = 0 To UBound(KikiDataTbl)
'          MoveMemory bData(iLoopCnt * Len(KikiDataTbl(0))), KikiDataTbl(iLoopCnt), Len(KikiDataTbl(iLoopCnt))
'    Next
' EG20 V30.3.0.1 çÌèúèIóπÅiåvéZÇ…óòópÇ∑ÇÈïœêîÇLONGå^Ç…ïœçXÅj
' EG20 V30.3.0.1 í«â¡äJénÅiåvéZÇ…óòópÇ∑ÇÈïœêîÇLONGå^Ç…ïœçXÅj
    lSize = Len(KikiDataTbl(0))
    lRecord = UBound(KikiDataTbl)
    ReDim bData((lRecord + 1) * lSize) As Byte
    For lLoop = 0 To lRecord
        lIndex = lLoop * lSize
        MoveMemory bData(lIndex), KikiDataTbl(lLoop), lSize
    Next
' EG20 V30.3.0.1 í«â¡èIóπÅiåvéZÇ…óòópÇ∑ÇÈïœêîÇLONGå^Ç…ïœçXÅj
    
    'ã@äÌç\ê¨ÉfÅ[É^ÉCÉìÉXÉgÅ[Éãèàóù
    bRet = dllInstolKikiData(KIKI_DATA_FILE, EKI_SETTI_FILE, bData(0), UBound(KikiDataTbl) + 1, lErrCode)

    If bRet = False Then
        'àŸèÌÉçÉOèoóÕ
        Call pfOutPutErrLog(lErrCode)
        
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        'àŸèÌèIóπ
        'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃì¸óÕåãâ ") '1.21.0.1 DEL
        iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ") 'V1.21.0.1 ADD
        Call SetEnableTrue                      ' EG20 V5.0.2.1ÅyåãçáTR-No.76èCê≥ëŒâûÅzí«â¡
    Else
'        'ÉçÉOèoóÕ
'        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
'
'        'ê≥èÌèIóπ
'        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ")
'    End If
'V1.12.0.1 ADD START
            'ÉRÉìÉsÉÖÅ[É^ñºÅAÉlÉbÉgÉèÅ[ÉNïœçXèàóù
            bSysChange = pfNetWorkChng(Me)
            If bSysChange = False Then
                'àŸèÌÉçÉOèoóÕ
                Call pfOutPutErrLog(lErrCode)

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
                Call SetEnableTrue                      ' EG20 V5.0.2.1ÅyåãçáTR-No.76èCê≥ëŒâûÅzí«â¡
            Else
                
' EG20 V3.0.0.2[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
                ' //////////////////////////////////////////////
                ' // ëÄçÏëÏÉvÉçÉOÉâÉÄèàóù
                ' //////////////////////////////////////////////
                lResult = pubfuncTakuProgramData(2, EKI_SETTI_FILE)
                If lResult = 0 Then
                   'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                   Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
                   ' àŸèÌèIóπ
                   iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ")
                   Call SetEnableTrue
                   Exit Sub
                ElseIf lResult = 1 Then
                   ' ÉÅÅ[ÉãëóêMíÜ
                   ' ÉçÉOèoóÕ
                   Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
                   ' ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
                   SetteiHaneiFlg = False
                    
                   Exit Sub
                End If
' EG20 V3.0.0.2[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
                
                'ÉçÉOèoóÕ
                Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
                
                'ê≥èÌèIóπ
                'iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ")  'V1.21.0.1 DEL
                 iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "îΩâfèàóùê›íËîΩâfåãâ ")  'V1.21.0.1 ADD
                'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
                SetteiHaneiFlg = False      'V1.20.0.1 ADD
                Call SetEnableTrue                      ' EG20 V5.0.2.1ÅyåãçáTR-No.76èCê≥ëŒâûÅzí«â¡
            End If
        End If
'V1.12.0.1 ADD END
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sKikiDataOutPut
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇäOïîî}ëÃÇ…èoóÕÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ÉfÉBÉXÉNèÓïÒéÊìæà íuïœçX
'//     REVISIONS :(1.13.0.1) 2009-11-19   REVISED BY [TCC] S.Terao
'//                  É{É^ÉìñºèÃïœçXÇ…ÇÊÇÈÉ|ÉbÉvÉAÉbÉvïœçX
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                 ÉtÉHÉãÉ_ëIëâÊñ ÇOSédólÇ…ïœçX
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sKikiDataOutPut()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim sWriteDir            As String          'ÉtÉHÉãÉ_ñº
    Dim iResponse            As Integer         'MsgBoxñﬂÇËíl

    Dim iRet                 As Integer         'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXñﬂÇËíl
    Dim lSekuta              As Long            'ÉZÉNÉ^ÅiÉNÉâÉXÉ^ìñÇËÅj
    Dim lByte                As Long            'ÉoÉCÉgêîÅiÉZÉNÉ^ìñÇËÅj
    Dim lKurasuta            As Long            'ÉtÉäÅ[ÉNÉâÉXÉ^êî
    Dim lDrive               As Long               'ÉhÉâÉCÉuÇÃÉNÉâÉXÉ^êîÅiçáåvÅj
    Dim strDrive             As String       'ÉhÉâÉCÉu
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'èâä˙ílê›íË
    strFileName = ""

    '----------------------------------------------------
    'ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãåüçı
    '----------------------------------------------------
    strFileName = Dir(KIKI_DATA_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then
    
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_KIKI_DATA, 0)
        
        'àŸèÌèIóπ
        MsgBox "î}ëÃèoóÕÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB", _
                vbOKOnly + vbExclamation, _
                 "ÉfÅ[É^ñ≥åxçê"
        Exit Sub
        
    End If
    
    '----------------------------------------------------
    'î}ëÃèoóÕèàóù
    '----------------------------------------------------
    ''V1.20.0.1 DEL START
    ''ÉfÉBÉXÉNèÓïÒÇéÊìæ
''    iRet = GetDiskFreeSpace("A:\", lSekuta, lByte, lKurasuta, lDrive)      'V1.12.0.1 DEL
    'iRet = GetDiskFreeSpace("H:\", lSekuta, lByte, lKurasuta, lDrive)       'V1.12.0.1 ADD
    '
    'If lDrive = 0 Then
    '    strDrive = "d:"
    'Else
''        strDrive = "a:"    'V1.12.0.1 DEL
    '    strDrive = "H:"     'V1.12.0.1 ADD
    'End If
    'V1.20.0.1 DEL END
    
    'sWriteDir = pfDirSelection(strDrive, "ã@äÌç\ê¨ÉtÉ@ÉCÉãèëçûÇ›êÊÇÃÉfÉBÉåÉNÉgÉäëIë")    'V1.20.0.1 DEL
    sWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)    'V1.20.0.1 ADD
    If sWriteDir <> "" Then
    
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
        On Error GoTo COPY_ERROR
        'ÉtÉ@ÉCÉãÉRÉsÅ[
'        FileCopy KIKI_DATA_FILE, sWriteDir & Dir(KIKI_DATA_FILE)                                       ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
        FileCopy KIKI_DATA_FILE, sWriteDir & Trim(pfGetEkiNameInfo(NotEkiVer)) & "_" & Dir(KIKI_DATA_FILE)    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
        
        'ê≥èÌèIóπ
        'iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕåãâ ") 'V1.13.0.1 DEL
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃèoóÕåãâ ")              'V1.13.0.1 ADD
    
    End If
  
  Exit Sub
 
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' î}ëÃèoóÕãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case 71 ' î}ëÃÇ»Çµ
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_NOT_DISK, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ

    'àŸèÌèIóπ
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕåãâ ") 'V1.8.0.1 DEL
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕåãâ ") 'V1.8.0.1 ADD 'V1.13.0.1 DEL
     iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃèoóÕåãâ ") 'V1.13.0.1 ADD

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sKikiDataSave
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂Åvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇéwíËÉtÉHÉãÉ_Ç…èoóÕÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-16  REVISED BY [TCC] C.Terui
'//                 ÉtÉ@ÉCÉãåüçıèàóùçÌèú
'//     REVISIONS :(1.13.0.1) 2009-11-19  REVISED BY [TCC] S.Terao
'//                 ñtñºïœçXÇ…ÇÊÇÈÅAÉ|ÉbÉvÉAÉbÉvÉ^ÉCÉgÉãïœçX
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sKikiDataSave()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim sWriteDir            As String          'ÉtÉHÉãÉ_ñº
'    Dim sMyPath(1 To 3)      As String          'ÉtÉ@ÉCÉãÉpÉX      'V1.12.0.1 DEL
    Dim iResponse            As Integer         'MsgBoxñﬂÇËíl
    Dim iLoopCount           As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim intFileNo            As Integer         'ÉtÉ@ÉCÉãî‘çÜ

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'èâä˙ílê›íË
    strFileName = ""

'V1.12.0.1 DEL START
'    '----------------------------------------------------
'    'ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãåüçı
'    '----------------------------------------------------
'    strFileName = Dir(KIKI_DATA_FILE)
'
'    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
'    If strFileName = "" Then
'
'        'àŸèÌÉçÉOèoóÕ
'        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_KIKI_DATA, 0)
'
'        'àŸèÌèIóπ
'        MsgBox "î}ëÃèoóÕÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB", _
'                vbOKOnly + vbExclamation, _
'                 "ÉfÅ[É^ñ≥åxçê"
'        Exit Sub
'
'    End If
'
'    '----------------------------------------------------
'    'ì‡ïîï€ë∂ÉtÉ@ÉCÉãåüçı
'    '----------------------------------------------------
'    For iLoopCount = 1 To 3
'
'        'ÉtÉ@ÉCÉãÉpÉXéÊìæ
'        sMyPath(iLoopCount) = Replace(KIKI_DATA_S_FILE, "##", Format(iLoopCount, "0#"))
'
'        'ÉtÉ@ÉCÉãåüçı
'        strFileName = Dir(sMyPath(iLoopCount))
'
'        'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
'        If strFileName = "" Then
'
'            intFileNo = FreeFile                                        'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'            Open sMyPath(iLoopCount) For Output Access Write As #intFileNo
'            Close #intFileNo
'
'        End If
'
'    Next
'V1.12.0.1 DEL END

    '----------------------------------------------------
    'ì‡ïîï€ë∂èàóù
    '----------------------------------------------------
'V1.12.0.1 ADD START
    iResponse = MsgBox("ã@äÌç\ê¨ê›íËÇàÍéûï€ë∂ÇµÇ‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
    vbOKCancel + vbQuestion, "àÍéûï€ë∂ämîF")
    
    If iResponse = vbCancel Then Exit Sub
    
    'ÉtÉ@ÉCÉãåüçı
    strFileName = Dir(KIKI_DATA_S_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then

        intFileNo = FreeFile                                        'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
        Open KIKI_DATA_S_FILE For Output Access Write As #intFileNo
        Close #intFileNo
    End If
    
   'àÍéûï€ë∂ÉtÉ@ÉCÉãÇçÏê¨Ç∑ÇÈ
    Name KIKI_DATA_S_FILE As KIKI_DATA_S_TEMP_FILE
'V1.12.0.1 ADD END
    
    'ÉtÉ@ÉCÉãñºéÊìæ
'    sWriteDir = pfDispFileSelect("d:", FOLDER_KIKI_DATA, FILE_NAME_KIKI_DATA_S, "ì‡ïîï€ë∂Ãß≤ŸëIë")    'V1.12.0.1 DEL
    sWriteDir = KIKI_DATA_S_FILE  'V1.12.0.1 ADD
    
    If sWriteDir <> "" Then
    
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
        On Error GoTo COPY_ERROR
        'ÉtÉ@ÉCÉãÉRÉsÅ[
        FileCopy KIKI_DATA_FILE, sWriteDir
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
'V1.12.0.1 ADD START
        'àÍéûï€ë∂ÉtÉ@ÉCÉãçÌèú
        Kill KIKI_DATA_S_TEMP_FILE
'V1.12.0.1 ADD END
        
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
        
        'ê≥èÌèIóπ
        'iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂åãâ ")Å@Å@'V1.13.0.1 DEL
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "àÍéûï€ë∂åãâ ")     'V1.13.0.1 ADD
    End If
  
  Exit Sub
 
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' ãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

'V1.12.0.1 ADD START
        'ÉtÉ@ÉCÉãåüçı
        strFileName = Dir(KIKI_DATA_S_FILE)
        If strFileName <> "" Then
            'ÉtÉ@ÉCÉãçÌèú
            Kill KIKI_DATA_S_FILE
        End If
        'ÉtÉ@ÉCÉãñºèÃÇå≥Ç…ñﬂÇ∑
        Name KIKI_DATA_S_TEMP_FILE As KIKI_DATA_S_FILE
'V1.12.0.1 ADD END

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ

    'àŸèÌèIóπ
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂åãâ ") 'V1.8.0.1 DEL
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂åãâ ")    'V1.8.0.1 ADD  'V1.13.0.1 DEL
     iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "àÍéûï€ë∂åãâ ")    'V1.13.0.1 ADD
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sKikiDataSelect
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨ê›íËÉfÅ[É^ëIëÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ì‡ïîï€ë∂ÉtÉ@ÉCÉãÇã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇ…ÉRÉsÅ[Ç∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-16  REVISED BY [TCC] C.Terui
'//                 ÉtÉ@ÉCÉãåüçıèàóùçÌèú
'//     REVISIONS :(1.13.0.1) 2009-11-19   REVISED BY [TCC] S.Terao
'//                 ÉRÉsÅ[ÉtÉ@ÉCÉãÉpÉXéwíËÇèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfÉtÉâÉOí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sKikiDataSelect()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim sWriteDir            As String          'ÉtÉHÉãÉ_ñº
'    Dim sMyPath(1 To 3)      As String          'ÉtÉ@ÉCÉãÉpÉX      'V1.12.0.1 DEL
    Dim sMyPath              As String          'ÉtÉ@ÉCÉãÉpÉX       'V1.12.0.1 ADD
    Dim iResponse            As Integer         'MsgBoxñﬂÇËíl
    Dim iLoopCount           As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim intFileNo            As Integer         'ÉtÉ@ÉCÉãî‘çÜ
    Dim bRet                 As Boolean         'ä÷êîñﬂÇËíl
    Dim lErrCode             As Long            'ÉGÉâÅ[ÉRÅ[Éh

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
'V1.12.0.1 DEL START
'    '----------------------------------------------------
'    'ì‡ïîï€ë∂ÉtÉ@ÉCÉãåüçı
'    '----------------------------------------------------
'    For iLoopCount = 1 To 3
'
'        'ÉtÉ@ÉCÉãÉpÉXéÊìæ
'        sMyPath(iLoopCount) = Replace(KIKI_DATA_S_FILE, "##", Format(iLoopCount, "0#"))
'
'        'èâä˙ílê›íË
'        strFileName = ""
'
'        'ÉtÉ@ÉCÉãåüçı
'        strFileName = Dir(sMyPath(iLoopCount))
'
'        'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
'        If strFileName = "" Then
'
'            intFileNo = FreeFile                                        'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'            Open sMyPath(iLoopCount) For Output Access Write As #intFileNo
'            Close #intFileNo
'        End If
'
'    Next
'V1.12.0.1 DEL END

    '----------------------------------------------------
    'ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãçXêVèàóù
    '----------------------------------------------------
'V1.12.0.1 ADD START
    iResponse = MsgBox("ã@äÌç\ê¨ê›íËÇÃàÍéûï€ë∂ÉfÅ[É^ÇéÊçûÇ›Ç‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
    vbOKCancel + vbQuestion, "àÍéûï€ë∂ÉfÅ[É^éÊçûämîF")
    
    If iResponse = vbCancel Then Exit Sub
    
    'ÉtÉ@ÉCÉãåüçı
    strFileName = Dir(KIKI_DATA_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then

        intFileNo = FreeFile                                        'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
        Open KIKI_DATA_FILE For Output Access Write As #intFileNo
        Close #intFileNo
    End If
    
   'àÍéûï€ë∂ÉtÉ@ÉCÉãÇçÏê¨Ç∑ÇÈ
    Name KIKI_DATA_FILE As KIKI_DATA_BACKUP_FILE
'V1.12.0.1 ADD END
    
    'ÉtÉ@ÉCÉãñºéÊìæ
'    sWriteDir = pfDispFileSelect("d:", FOLDER_KIKI_DATA, FILE_NAME_KIKI_DATA_S, "ã@äÌç\ê¨Ãß≤ŸëIë")    'V1.12.0.1 DEL
'V1.12.0.1 ADD START
    strFileName = Dir(KIKI_DATA_S_FILE)
    sWriteDir = strFileName
'V1.12.0.1 ADD START
    If sWriteDir <> "" Then

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
        On Error GoTo COPY_ERROR
        'ÉtÉ@ÉCÉãÉRÉsÅ[
        'FileCopy sWriteDir, KIKI_DATA_FILEÅ@'V1.13.0.1 DEL
         FileCopy KIKI_DATA_S_FILE, KIKI_DATA_FILE  'V1.13.0.1 ADD
        
        'ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÏê¨
        bRet = dllGetKikiIniData(0, 1, KIKI_DATA_SET_EKI_INFO_FILE, EKI_SETTI_FILE, KIKI_DATA_FILE, lErrCode)
        If bRet = False Then
            'àŸèÌÉçÉOèoóÕ
            Call pfOutPutErrLog(lErrCode)
'V1.12.0.1 ADD START
            'ÉtÉ@ÉCÉãçÌèú
            Kill KIKI_DATA_FILE
            'ÉtÉ@ÉCÉãñºèÃÇå≥Ç…ñﬂÇ∑
            Name KIKI_DATA_BACKUP_FILE As KIKI_DATA_FILE
'V1.12.0.1 ADD END

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
            
            'àŸèÌèIóπ
            'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ") 'V1.8.0.1 DEL
            iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃì¸óÕåãâ ")  'V1.8.0.1 ADD
            Exit Sub
        End If
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
'V1.12.0.1 ADD START
        'àÍéûï€ë∂ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
        Kill KIKI_DATA_BACKUP_FILE
'V1.12.0.1 ADD END
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        'ê≥èÌèIóπ
'        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ã@äÌç\ê¨ê›íËÉfÅ[É^ëIëåãâ ") 'V1.13.0.1 DEL
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "àÍéûï€ë∂ÉfÅ[É^éÊçûåãâ ")      'V1.13.0.1 ADD
    
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅiçXêVê›íËÅj
        KikiDataUpDateFlg = True
        'âÊñ ï\é¶èàóù
        Call sDisp
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅií èÌê›íËÅj
        KikiDataUpDateFlg = False
        
        'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ†ÇËÅj
        SetteiHaneiFlg = True       'V1.20.0.1 ADD
    End If
  
  Exit Sub
 
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' ãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

'V1.12.0.1 ADD START
        'ÉtÉ@ÉCÉãåüçı
        strFileName = Dir(KIKI_DATA_FILE)
        If strFileName <> "" Then
            'ÉtÉ@ÉCÉãçÌèú
             Kill KIKI_DATA_FILE
        End If
        'ÉtÉ@ÉCÉãñºèÃÇå≥Ç…ñﬂÇ∑
        Name KIKI_DATA_BACKUP_FILE As KIKI_DATA_FILE
'V1.12.0.1 ADD END
    
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
    'àŸèÌèIóπ
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ã@äÌç\ê¨ê›íËÉfÅ[É^ëIëåãâ ") 'V1.8.0.1 DEL
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "ã@äÌç\ê¨ê›íËÉfÅ[É^ëIëåãâ ") 'V1.8.0.1 ADD  'V1.13.0.1 DEL
    iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "àÍéûï€ë∂ÉfÅ[É^éÊçûåãâ ")      'V1.13.0.1 ADD

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sInputMedium
'//  ã@î\ñºèÃ  : Åuî}ëÃì¸óÕÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : äOïîî}ëÃÇã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇ…ÉRÉsÅ[Ç∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] E.Watanabe
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 î}ëÃÉtÉ@ÉCÉãñºÇå≈íËñºèÃÇ…ïœçX
'//                 ÉfÉBÉXÉNèÓïÒéÊìæà íuïœçX
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ê›íËîΩâfÉtÉâÉOí«â¡
'//                ÉtÉ@ÉCÉãëIëâÊñ ÇOSédólÇ…ïœçX
'//     REVISIONS :(2.5.0.1) 2010-10-29  REVISED BY [TCC] S.Terao
'//                 î}ëÃéÊäOïsãÔçáèCê≥
'//     REVISIONS :(EG20 V5.0.2.1) 2012-03-12  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyåãçáTR-No.77èCê≥ëŒâûÅz
'//     REVISIONS :(EG20 V30.4.0.1) 2015-01-15 REVISED BY  [TCC] S.Kuroda
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇRëŒâûÅyHKRK_kansi02_001_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sInputMedium()

    Dim iResponse               As Integer      'MsgBoxñﬂÇËíl
    Dim bRet                    As Boolean      'ä÷êîñﬂÇËíl
    Dim lErrCode                As Long         'ÉGÉâÅ[ÉRÅ[Éh
    Dim strFileName             As String       'î}ëÃÉtÉ@ÉCÉãñº
    
    Dim iRet                    As Integer      'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXñﬂÇËíl
    Dim lSekuta                 As Long         'ÉZÉNÉ^ÅiÉNÉâÉXÉ^ìñÇËÅj
    Dim lByte                   As Long         'ÉoÉCÉgêîÅiÉZÉNÉ^ìñÇËÅj
    Dim lKurasuta               As Long         'ÉtÉäÅ[ÉNÉâÉXÉ^êî
    Dim lDrive                  As Long         'ÉhÉâÉCÉuÇÃÉNÉâÉXÉ^êîÅiçáåvÅj
    Dim strDrive                As String       'ÉhÉâÉCÉu
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg  'V1.20.0.1 ADD
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
'V1.12.0.1 ADD START
    iResponse = MsgBox("ã@äÌç\ê¨ê›íËÇÃî}ëÃì¸óÕÇçsÇ¢Ç‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
    vbOKCancel + vbQuestion, "î}ëÃì¸óÕämîF")
    
    'V1.20.0.1 DEL START
    'If iResponse = vbCancel Then Exit Sub
''V1.12.0.1 ADD END
    '
    ''ÉfÉBÉXÉNèÓïÒÇéÊìæ
''    iRet = GetDiskFreeSpace("A:\", lSekuta, lByte, lKurasuta, lDrive)      'V1.12.0.1 DEL
    'iRet = GetDiskFreeSpace("H:\", lSekuta, lByte, lKurasuta, lDrive)       'V1.12.0.1 ADD
    '
    'If lDrive = 0 Then
    '    strDrive = "d:"
    'Else
''        strDrive = "a:"        'V1.12.0.1 DEL
    '    strDrive = "H:"         'V1.12.0.1 ADD
    'End If
    '
    ''î}ëÃÉtÉ@ÉCÉãñºéÊìæ
''    strFileName = pfFileSelection(strDrive, "*.csv", "î}ëÃì¸óÕÃß≤ŸëIë")          'V1.12.0.1 DEL
    'strFileName = pfFileSelection(strDrive, "KIKI_DATA.CSV", "î}ëÃì¸óÕÃß≤ŸëIë")   'V1.12.0.1 ADD
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    If iResponse = vbCancel Then
        Set objFso = Nothing
        Exit Sub
    End If
    'éÊìæÉtÉ@ÉCÉãñºÇèâä˙âª
    CommonDialog1.FileName = ""
    'èâä˙ÉfÉBÉåÉNÉgÉäÇê›íË
    If objFso.FolderExists(SHOWFILE_DEFAULTFOLDER1) = True Then    'ÉtÉHÉãÉ_ëIëâÊñ ÉfÉtÉHÉãÉgÉpÉXÇPÇ™ë∂ç›Ç∑ÇÈÇ©
        'ë∂ç›Ç∑ÇÈÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇPÅiH:ÅjÇê›íË
        CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER1
    Else
        'ë∂ç›ÇµÇ»Ç¢ÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇQÅiC:ÅjÇê›íË
        CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER2
    End If
    Set objFso = Nothing
    'ägí£éqÇê›íË
'    CommonDialog1.Filter = "ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÅiKIKI_DATA.CSVÅj|KIKI_DATA.CSV|"    ' EG20 V5.0.2.1çÌèú
    CommonDialog1.Filter = "ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÅiKIKI_DATA.CSVÅj|*KIKI_DATA.CSV|"    ' EG20 V5.0.2.1í«â¡
    'ÉtÉ@ÉCÉãëIëâÊñ ÇäJÇ≠
    CommonDialog1.ShowOpen
    'ëIëÇµÇΩÉtÉ@ÉCÉãñºÇéÊìæ
    strFileName = CommonDialog1.FileName
    'V1.20.0.1 ADD END
    
    Call ChDrive("D")  'V2.5.0.1 ADD
    
    'ÉtÉ@ÉCÉãë∂ç›É`ÉFÉbÉN
    If strFileName <> "" Then

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ

        On Error GoTo COPY_ERROR

' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz DEL Start
        'ÉtÉ@ÉCÉãÉRÉsÅ[
'        FileCopy strFileName, KIKI_DATA_FILE
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz DEL End
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD Start
        'àÍéûï€ë∂ÉtÉHÉãÉ_Ç…ÉfÅ[É^ÇÉRÉsÅ[Çµì«éÊêÍópÇâèúÇ∑ÇÈ
        If pfChangeAttrNormal(strFileName, PATH_HOSHUTMP_KIKI_DATA, KIKI_DATA_FILE) = False Then
            GoTo COPY_ERROR
       End If
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD End
        
        'ã@äÌèÓïÒê›íËÅiâwèÓïÒÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÏê¨
        bRet = dllGetKikiIniData(0, 1, KIKI_DATA_SET_EKI_INFO_FILE, EKI_SETTI_FILE, KIKI_DATA_FILE, lErrCode)
        If bRet = False Then
            'àŸèÌÉçÉOèoóÕ
            Call pfOutPutErrLog(lErrCode)
            
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
            
            'àŸèÌèIóπ
            'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ") 'V1.8.0.1 DEL
            iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃì¸óÕåãâ ") 'V1.8.0.1 ADD
            
            Exit Sub
        End If
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        'ê≥èÌèIóπ
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ")
    
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅiçXêVê›íËÅj
        KikiDataUpDateFlg = True
        'âÊñ ï\é¶èàóù
        Call sDisp
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅií èÌê›íËÅj
        KikiDataUpDateFlg = False
        
        'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ†ÇËÅj
        SetteiHaneiFlg = True       'V1.20.0.1 ADD
    End If

  Exit Sub
  
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' ãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD Start
    'àÍéûï€ë∂ÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈ
    psDeleteFolder PATH_HOSHUTMP
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD End

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ

    'àŸèÌèIóπ
    'iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ") 'V1.8.0.1 DEL
    iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃì¸óÕåãâ ")  'V1.8.0.1 ADD

End Sub
'V1.12.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2009 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : SetEnableFalse
'//  ã@î\ñºèÃ  : âÊñ ÉçÉbÉNèàóù
'//  ã@î\äTóv  : âÊñ ÇÉçÉbÉNÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.12.0.1) 2009-11-10   CODED   BY [TCC] C.Terui
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçl ÅF
'///////////////////////////////////////////////////////////////////
Public Sub SetEnableFalse()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    CmdKikiSetMenu(3).Enabled = False
    CmdKikiSetMenu(4).Enabled = False
    CmdKikiSetMenu(5).Enabled = False
    CmdKikiSetMenu(6).Enabled = False
    CmdKikiSetMenu(7).Enabled = False               ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    cmdCancel.Enabled = False
    
    'ÉRÉìÉ{É{ÉbÉNÉXÅACmdKikiSetMenu(0)Å`(2)ÇÕèåèÇ…ÇÊÇ¡ÇƒÇÕå≥ÅXâüâ∫ïsâ¬ÇÃÇΩÇﬂîªíËÇçsÇ§
    If cmbEkiInfo.Enabled = True Then
        cmbEkiInfo.Enabled = False
        DoEvents
    End If
    
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    If CmbCornerName.Enabled = True Then
        CmbCornerName.Enabled = False
        DoEvents
    End If
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
    
    If CmdKikiSetMenu(0).Enabled = True Then
        CmdKikiSetMenu(0).Enabled = False
    End If
    
    If CmdKikiSetMenu(1).Enabled = True Then
        CmdKikiSetMenu(1).Enabled = False
    End If
    
    If CmdKikiSetMenu(2).Enabled = True Then
        CmdKikiSetMenu(2).Enabled = False
    End If
    
    DoEvents
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2009 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : SetEnableTrue
'//  ã@î\ñºèÃ  : âÊñ ÉçÉbÉNâèúèàóù
'//  ã@î\äTóv  : âÊñ ÇÃÉçÉbÉNÇâèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.12.0.1) 2009-11-10   CODED   BY [TCC] C.Terui
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçl ÅF
'///////////////////////////////////////////////////////////////////
Public Sub SetEnableTrue()
    
    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
    CmdKikiSetMenu(3).Enabled = True
    CmdKikiSetMenu(4).Enabled = True
    CmdKikiSetMenu(5).Enabled = True
    CmdKikiSetMenu(6).Enabled = True
    CmdKikiSetMenu(7).Enabled = True                ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    cmdCancel.Enabled = True
    
    'ÉRÉìÉ{É{ÉbÉNÉXÇ∆CmdKikiSetMenu(0)Å`(2)ÇÕèåèÇ…ÇÊÇ¡ÇƒÇÕå≥ÅXâüâ∫ïsâ¬ÇÃÇΩÇﬂÅAâÊñ ï\é¶ÇÃóLñ≥Ç≈îªíËÇçsÇ§
    strFileName = Dir(KIKI_DATA_SET_EKI_INFO_FILE)
    'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈèÍçá
    If strFileName <> "" Then
        cmbEkiInfo.Enabled = True
        CmbCornerName.Enabled = True                ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
        CmdKikiSetMenu(0).Enabled = True
        CmdKikiSetMenu(1).Enabled = True
        CmdKikiSetMenu(2).Enabled = True
    End If
    
    DoEvents
    
End Sub
'V1.12.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmbCornerName_Click
'//  ã@î\ñºèÃ  : ÉRÅ[ÉiëIëïîëIëèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^Ççƒê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//                 cmbEkiInfo_Click()ó¨óp
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmbCornerName_Click()

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    Call SetEnableFalse
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, EKITUDOKAKUNIN_GAMEN_CORNER_SELECT, 0)
    
    'âÊñ ï\é¶èàóù
    Call sDisp

    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
    Call SetEnableTrue

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : InitCornerComboBox
'//  ã@î\ñºèÃ  : ÉRÅ[Éiê›íËÉRÉìÉ{É{ÉbÉNÉXÇÃèâä˙âªèàóù
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub InitCornerComboBox()

    Dim intLoop   As Integer            ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim strCorner As String             ' ï∂éöóÒäiî[ÉGÉäÉA
    
    On Error Resume Next
    
    ' /////////////////////////////////////////////////////
    ' // èâä˙âªèàóù
    ' /////////////////////////////////////////////////////
    ' ÉRÅ[ÉiñºèÃê›íËèàóù
    Call gsGetCornerName
    
    CmbCornerName.Clear
    For intLoop = 0 To 5
    
        'ê›íËÇ†ÇËÇÃÉRÅ[ÉiÇäàê´Ç…Ç∑ÇÈ
        If gudtSettiCorner(intLoop).intGokiNum > 0 Then
            strCorner = gstrCornerName(intLoop)
            CmbCornerName.AddItem strCorner
        End If
    Next intLoop
    CmbCornerName.ListIndex = 0

End Sub

