VERSION 5.00
Begin VB.Form frmPass 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "ï€éÁàıÉpÉXÉèÅ[Éhì¸óÕ"
   ClientHeight    =   9000
   ClientLeft      =   2700
   ClientTop       =   2520
   ClientWidth     =   12000
   ClipControls    =   0   'False
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   NegotiateMenus  =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   Picture         =   "ÉpÉXÉèÅ[Éhì¸óÕâÊñ .frx":0000
   ScaleHeight     =   9000
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows ÇÃä˘íËíl
   Begin VB.CommandButton cmdKakutei 
      BackColor       =   &H00C0C0C0&
      Caption         =   "äm  íË"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   8280
      TabIndex        =   13
      Top             =   2040
      Width           =   1815
   End
   Begin VB.Frame fraPass 
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   5655
      Left            =   2160
      TabIndex        =   15
      Top             =   1920
      Width           =   4455
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Çb"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   11
         Left            =   2880
         TabIndex        =   12
         Top             =   4440
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "BS"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   10
         Left            =   1680
         TabIndex        =   11
         Top             =   4440
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "9"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   9
         Left            =   2880
         TabIndex        =   10
         Top             =   1200
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "8"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   8
         Left            =   1680
         TabIndex        =   9
         Top             =   1200
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "7"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   7
         Left            =   480
         TabIndex        =   8
         Top             =   1200
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "6"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   6
         Left            =   2880
         TabIndex        =   7
         Top             =   2280
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "5"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   5
         Left            =   1680
         TabIndex        =   6
         Top             =   2280
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "4"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   4
         Left            =   480
         TabIndex        =   5
         Top             =   2280
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "3"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   3
         Left            =   2880
         TabIndex        =   4
         Top             =   3360
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "2"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   2
         Left            =   1680
         TabIndex        =   3
         Top             =   3360
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   1
         Left            =   480
         TabIndex        =   2
         Top             =   3360
         Width           =   975
      End
      Begin VB.CommandButton cmdNumber 
         BackColor       =   &H00C0C0C0&
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Index           =   0
         Left            =   480
         TabIndex        =   1
         Top             =   4440
         Width           =   975
      End
      Begin VB.TextBox txtPass 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Left            =   480
         PasswordChar    =   "*"
         TabIndex        =   0
         Top             =   480
         Width           =   3375
      End
   End
   Begin VB.CommandButton cmdReturn 
      BackColor       =   &H00C0C0C0&
      Caption         =   "äƒéãâÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1455
      Left            =   8400
      TabIndex        =   14
      Top             =   7320
      Width           =   3015
   End
   Begin VB.Timer tmrMail 
      Left            =   600
      Top             =   720
   End
   Begin VB.Label lblGuide 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H0000FFFF&
      Caption         =   "  Ç±ÇÃâÊñ ÇÕÅAï€éÁàıêÍópÇ≈Ç∑ÅI       ï€éÁàıà»äOÇÃï˚ÇÕÅA "
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   360
      Index           =   0
      Left            =   2520
      TabIndex        =   16
      Top             =   480
      Width           =   7215
   End
   Begin VB.Label lblGuide 
      BackColor       =   &H0000FFFF&
      Height          =   255
      Index           =   2
      Left            =   2520
      TabIndex        =   20
      Top             =   360
      Width           =   7215
   End
   Begin VB.Label lblGuide 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H0000FFFF&
      Caption         =   "  âÊñ âEâ∫ÇÃÅuäƒéãâÊñ Ç÷ñﬂÇÈÅvÉ{É^ÉìÇâüÇµñﬂÇ¡Çƒâ∫Ç≥Ç¢ÅB"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   375
      Index           =   1
      Left            =   2520
      TabIndex        =   19
      Top             =   840
      Width           =   7215
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "ï€éÁàıÉpÉXÉèÅ[Éhì¸óÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Left            =   0
      TabIndex        =   18
      Top             =   0
      Width           =   12015
   End
   Begin VB.Label lblPass 
      BackStyle       =   0  'ìßñæ
      Caption         =   "ÉpÉXÉèÅ[ÉhÇì¸óÕÇµÇƒâ∫Ç≥Ç¢ÅB"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   2400
      TabIndex        =   17
      Top             =   1560
      Width           =   4095
   End
End
Attribute VB_Name = "frmPass"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFfrmPass.frm
'//  ÉpÉbÉPÅ[ÉWñºÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ 
'//
'//  äTóvÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ 
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//                 ÅEEG10ï€éÁÇÊÇËÅAÉpÉXÉèÅ[Éhì¸óÕâÊñ (frmPass.frm)Çó¨óp
'//     REVISIONS :(1.3.0.1) 2009-03-13   REVISED BY [TCC] C.Terui
'//                 ÅEÉåÉWÉXÉgÉäéÊìæàŸèÌéûèàóùïœçX
'//                 ÅEÉtÉHÅ[ÉÄÉAÉìÉçÅ[Éhèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-23   REVISED BY [TCC] S.Terao
'//                 ÅEâÊñ ï\é¶/è¡ãéÉ^ÉCÉ~ÉìÉOèCê≥
'//     REVISIONS :(1.7.0.1) 2009-07-28   REVISED BY [TCC] S.Terao
'//                 ï€éÁëçì_åüèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yoshimori
'//                 ÉpÉXÉèÅ[ÉhïsàÍívÇÃâÊñ ëJà⁄ïœçX
'//     REVISIONS :(2.1.0.1)  2010-05-28  REVISED BY [TCC] S.Yoshimori
'//                 ÇPÉâÉbÉ`ã§ìØégópâwëŒâû
'//     REVISIONS :(EG20 V30.3.0.1)  2014-09-18  REVISED BY [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû
'//                 ÅyHKRK_Kansi07_007_01Åz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit
Private Const MN_MAIL_INTERVAL = 1000   'ÉÅÅ[ÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : ÉpÉXÉèÅ[Éhì¸óÕâÊñ (ÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V2.1.0.1) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()
On Error Resume Next
    
    Dim iKansiAplChk As Integer     'ÉAÉvÉäãNìÆÉ`ÉFÉbÉNñﬂÇËílópÅ@' EG20 V2.1.0.1[Mainte_03_01]í«â¡
    
    'ç≈ëÂâªï\é¶Ç∑ÇÈÅB
    Me.WindowState = 2
    'ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ÇãNìÆÇ∑ÇÈÅB
    tmrMail.Enabled = True

' EG20 V2.1.0.1[Mainte_03_01]í«â¡äJén
    'äƒéãî’ãNìÆ/ñ¢ãNìÆÉ`ÉFÉbÉNÇçsÇ§ÅBÉ`ÉFÉbÉNèÛë‘Ç…ÇÊÇËèàóùï™äÚÇçsÇ§ÅB
     iKansiAplChk = CheckAppStart(PROC_KANRI)
     If iKansiAplChk <> 0 Then
        'äƒéãî’ãNìÆéûÅFñﬂÇÈñtÇÃï∂åæÅuäƒéãâÊñ Ç÷ñﬂÇÈÅv
        cmdReturn.Caption = "äƒéãâÊñ Ç÷ñﬂÇÈ"
    Else
        'äƒéãñ¢ãNìÆéûÅFñﬂÇÈñtÇÃï∂åæÅuWindowsÇ…ñﬂÇÈÅv
        cmdReturn.Caption = "WindowsÇ…ñﬂÇÈ"
    End If
' EG20 V2.1.0.1[Mainte_03_01]í«â¡èIóπ

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : ÉpÉXÉèÅ[Éhì¸óÕâÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
On Error Resume Next
    
    'ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}Çí‚é~Ç∑ÇÈÅB
    tmrMail.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : ÉpÉXÉèÅ[Éhì¸óÕâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.2.0.1) 2009-02-26   REVISED BY [TCC] S.Terao
'//             óßÇøè„Ç∞èàóùÅAÉåÉWÉXÉgÉäéÊìæàŸèÌéûãNìÆÇ≥ÇπÇ»Ç¢èCê≥
'//     REVISIONS :(1.3.0.1) 2009-03-13   REVISED BY [TCC] C.Terui
'//             ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgíléÊìæÇ…î∫Ç§èCê≥
'//     REVISIONS :(EG20 V2.1.0.1) 2011-12-09   REVISED BY [TCC] M.Matsumoto
'//             ÅyÉtÉFÅ[ÉYÇQëŒâûÅzÉçÉOèoóÕÉtÉHÉãÉ_ïœçX
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()
    Dim bRet As Boolean     'ñﬂÇËíl
    Dim lngErrCode As Long  'ä÷êîÉGÉâÅ[ÉRÅ[Éh
    Dim slogPath As String  'ï€éÁÉçÉO
    
    On Error Resume Next
   
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000
    
    'ï€éÁÉçÉOÉNÉâÉXÇê∂ê¨
'    slogPath = PATH_LOG & HOSHULOG_FILE            'EG20 V2.1.0.1 DEL ÅyÉtÉFÅ[ÉYÇQëŒâûÅz
    slogPath = PATH_HOSHULOG & HOSHULOG_FILE        'EG20 V2.1.0.1 ADD ÅyÉtÉFÅ[ÉYÇQëŒâûÅz
    bRet = dllHoshulogClass(slogPath, lngErrCode)
    
    'èââÒãNìÆ
    iStaFlag = 0
    'Åuï€éÁãNìÆÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, HOSHU_PROCESS_START, 0)
    'ãNìÆçœ
    iStaFlag = 1
    
     'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_GAMEN_START, 0)
    
    'ÉpÉXê›íË
    ChDrive App.Path
    ChDir App.Path
     
    'óßÇøè„Ç∞èàóùÇçsÇ§
    bRet = pfStartUpProc
    If bRet = False Then
    'óßÇøè„Ç∞èàóùàŸèÌéûÇÕã≠êßèIóπÇ∑ÇÈÅB
        'pbAbortFlag = True 'V1.2.0.1 DEL
        'V1.2.0.1 ADD START
        pfAbortProc
        End
        'V1.2.0.1 ADD END
    End If
   'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãèâä˙èàóùÇçsÇ§ÅB
    sPassFileInitialize
    
    'IDU/LDUÇÃÉpÉXÇÉåÉWÉXÉgÉäÇÊÇËéÊìæÇ∑ÇÈÅB
    bRet = sGetRegIDU_LDU_Path
' V1.3.0.1 DEL START
'   If False = bRet Then
'       'Exit Sub 'V1.2.0.1 DEL
'       'V1.2.0.1 ADD START
'       pfAbortProc
'       End
'       'V1.2.0.1 ADD END
'    End If
' V1.3.0.1 DEL START
    'ÉÅÅ[ÉãéÛêMópÇÃÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈ
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False

    pfFormActive (frmPass.hwnd)
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdKakutei_Click
'//  ã@î\ñºèÃ  : ÅuämíËÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ì¸óÕÉpÉXÉèÅ[ÉhÇÉ`ÉFÉbÉNÇµÅA
'//              ÉGÉâÅ[ÅFÅuÉpÉXÉèÅ[ÉhÉGÉâÅ[ÅvÉ|ÉbÉvÉAÉbÉvÇï\é¶ÅB
'//              ê≥Å@èÌÅFï€éÁâÊñ Çï\é¶ ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.3.0.1) 2009-03-13   REVISED BY [TCC] C.Terui
'//                ÅEÉtÉHÅ[ÉÄÉAÉìÉçÅ[Éhèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-23   REVISED BY [TCC] S.Terao
'//                 ÅEâÊñ ï\é¶/è¡ãéÉ^ÉCÉ~ÉìÉOèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yoshimori
'//                 ÉpÉXÉèÅ[ÉhïsàÍívÇÃâÊñ ëJà⁄ïœçX
'//     REVISIONS :(EG20 V3.3.0.1) 2012-01-20  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyëÄçÏëÏ åãçáNo.36ä÷òAÅz
'//     REVISIONS :(EG20 V30.3.0.1)  2014-09-18  REVISED BY [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû
'//                 ÅyHKRK_Kansi07_007_01Åz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdKakutei_Click()
    Dim iResponse As Integer      'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXï\é¶ñﬂÇËíl
    Dim bFlag As Boolean          'ì¸óÕÉpÉXÉèÅ[ÉhÉ`ÉFÉbÉNÉtÉâÉO(TrueÅFàÍívÅBFalse:ïsàÍív)
    Dim intPassFileNo As Integer  'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇÃÉtÉ@ÉCÉãî‘çÜ
    Dim sPassword As String       'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇÃÇPçsï™ÇÃÉfÅ[É^
    Dim sPassData As String       'ÉVÉXÉeÉÄåéì˙ÅB
    Dim sHoshuPass As String      'òAåãÉpÉXÉèÅ[Éh=ÉtÉ@ÉCÉãíËã`ÉpÉX+ÉVÉXÉeÉÄåéì˙
    Dim sPass As String           'ÉtÉ@ÉCÉãíËã`ÉpÉX
    
    'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFämíËñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAKUTEI_BUTTOM, 0)
 
    'ì¸óÕÉpÉXÉèÅ[ÉhÉ`ÉFÉbÉNÉtÉâÉOÇïsàÍívÇ≈èâä˙âªÇ∑ÇÈÅB
    bFlag = False
    
    'ñ¢ì¸óÕÇ≈ÇÃÅuämíËÅvñtâüâ∫éû
    If txtPass = "" Or IsNull(txtPass) Then
       'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉpÉXÉèÅ[Éhñ¢ì¸óÕàŸèÌÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, PASS_NOT_KEY, 0)
        'V1.20.0.1 DEL START
        ''ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}Çí‚é~Ç∑ÇÈ
        'tmrMail.Enabled = False
        ''ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ è¡ãéÅvÉçÉOèoóÕ
        ' Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_GAMEN_END, 0)
        ''èIóπèàóùÇçsÇ§
        'psEndProc
        ' 'ÉpÉXÉèÅ[Éhì¸óÕâÊñ Çï¬Ç∂ÇÈÅB
        'Unload Me
        'V1.20.0.1 DEL END
        'V1.20.0.1 ADD START
        'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈÅB
        iResponse = MsgBox("ÉpÉXÉèÅ[ÉhÇ™à·Ç¢Ç‹Ç∑ÅB", _
                            vbOKOnly, _
                            "ÉpÉXÉèÅ[ÉhÉGÉâÅ[")
        'V1.20.0.1 ADD END
        Exit Sub
    End If
    
    'ÉpÉXÉèÅ[ÉhåÖêîÉ`ÉFÉbÉNÇçsÇ§ÅB
    If (Len(txtPass) <= INPUT_PASSWORD_MAX) And (Len(txtPass) >= INPUT_PASSWORD_MIN) Then
       On Error GoTo FileError
       'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈÅB
       intPassFileNo = FreeFile
       'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇäJÇ≠ÅB
       Open PASSWORD_FILE_FULLPASS For Input As #intPassFileNo
       'ÉVÉXÉeÉÄåéì˙ÇÅuMMDDÅvÇ≈éÊìæÇ∑ÇÈÅB
       sPassData = Format(Date, "mmdd")
       'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈åJÇËï‘Ç∑ÅB
'       Do While Not EOF(1)                                 ' EG20 V3.3.0.1çÌèú
       Do While Not EOF(intPassFileNo)                      ' EG20 V3.3.0.1í«â¡
         'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇÃêÊì™Ç©ÇÁÇPçsÇ∏Ç¬ì«çûÇﬁÅB
         Line Input #intPassFileNo, sPassword
         'ÉpÉXÉèÅ[ÉhÇÃíËã`ê›íËÇ™Ç†ÇÈÇ©Ç«Ç§Ç©É`ÉFÉbÉNÇ∑ÇÈÅB
         If sPassword <> "" Then
           'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇ…Ç†ÇÈíËã`Ç∆éÊìæåéì˙ÇòAåãÇ≥ÇπÇÈÅB
           sPass = Mid(sPassword, 3, 8)
           If sPass <> "" Then
              sHoshuPass = sPass + sPassData
              'òAåãÉpÉXÉèÅ[ÉhÇ∆ÅAì¸óÕílÇî‰ärÇ∑ÇÈÅB
              If sHoshuPass = txtPass Then
                 'àÍívÇµÇΩèÍçáÅAÉpÉXÉèÅ[ÉhÉ`ÉFÉbÉNÉtÉâÉOÇàÍívÇ…Ç∑ÇÈÅB
                 bFlag = True
                 'àÍívÇµÇΩÉpÉXÉèÅ[ÉhïîÇÃÉÜÅ[ÉUÉåÉxÉãÇéÊìæÇ∑ÇÈÅB
                 pbUserLevel = CInt(Left$(sPassword, 1))
                 'Exit Do       'EG20 V30.3.0.1 DEL ÅyHKRK_Kansi07_007_01Åz
                 'EG20 V30.3.0.1 ADD START ÅyHKRK_Kansi07_007_01Åz
                 'ÉÜÅ[ÉUÉåÉxÉãÇ™ÅuàÍî ÅvÅuì¡å†ÅvÇÃèÍçáÇÃÇ›àÍívàµÇ¢Ç∆ÇµÅAÉãÅ[ÉvÇî≤ÇØÇÈÅB
                 If pbUserLevel = 0 Or pbUserLevel = 1 Then
                    Exit Do
                 Else
                    'ÇªÇÍà»äOÇÕÉãÅ[ÉvÇî≤ÇØÇ∏Ç…èàóùÇë±ÇØÇÈÅB
                    'ÉpÉXÉèÅ[ÉhÉGÉâÅ[àµÇ¢Ç»ÇÃÇ≈pbUserLevelÇÕÉäÉZÉbÉgÇ∑ÇÈÅB
                    'ÇªÇ§ÇµÇ»Ç¢Ç∆ÅApbUserLevelÇ…2Ç™ÉZÉbÉgÇ≥ÇÍÇƒÇ¢ÇΩèÍçáÅAñﬂÇÈñtâüâ∫éûÇ…ÉvÉçÉZÉXèIóπóvãÅÇÃï‚èïÉGÉäÉAÇ…2Ç™ÉZÉbÉgÇ≥ÇÍÇƒÇµÇ‹Ç¢ÅA
                    'ã∆ñ±ånï€éÁâÊñ Ç™ï\é¶Ç≥ÇÍÇƒÇµÇ‹Ç§ÅB
                    pbUserLevel = 0
                    bFlag = False
                 End If
                 'EG20 V30.3.0.1 DEL END ÅyHKRK_Kansi07_007_01Åz
              End If
           End If
         End If
       Loop
     'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇï¬Ç∂ÇÈÅB
     Close #intPassFileNo
    End If
    
    'ÉpÉXÉèÅ[ÉhÉGÉâÅ[ÇÃèÍçá
    If bFlag = False Then
        'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWÇï\é¶Ç∑ÇÈÅB
        iResponse = MsgBox("ÉpÉXÉèÅ[ÉhÇ™à·Ç¢Ç‹Ç∑ÅB", _
                            vbOKOnly, _
                            "ÉpÉXÉèÅ[ÉhÉGÉâÅ[")
        'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFì¸óÕÉpÉXÉèÅ[ÉhàŸèÌÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, PASS_KEY_ERROR, 0)
        'V1.20.0.1 DEL START
        ''ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}Çí‚é~Ç∑ÇÈÅB
        'tmrMail.Enabled = False
        ''èIóπèàóùÇçsÇ§ÅB
        'psEndProc
        'V1.20.0.1 DEL END
        'V1.20.0.1 ADD START
        'ì¸óÕÉpÉXÉèÅ[ÉhÇèâä˙âªÇ∑ÇÈ
        txtPass = ""
        'ÉpÉXÉèÅ[Éhì¸óÕâÊñ Çï¬Ç∂Ç∏ÅAèàóùÇèIóπÇ∑ÇÈ
        Exit Sub
        'V1.20.0.1 ADD END
        
    'ÉpÉXÉèÅ[Éhê≥èÌÇÃèÍçá
    Else
        'ã@äÌç\ê¨ÉfÅ[É^ÉNÉâÉXê∂ê¨èàóù
        Call MakeInitKikiClas
        
        'ÉpÉXÉèÅ[Éhì¸óÕÉçÉOÇï€éÁëÄçÏÉçÉOÇ…èoóÕÇ∑ÇÈÅB
        If pbUserLevel = 0 Then  'ÉÜÅ[ÉUÉåÉxÉã
          'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFì¸óÕÉpÉXÉèÅ[Éhê≥èÌÅvÉçÉOèoóÕ
           Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_OK, 0)
        ElseIf pbUserLevel = 1 Then
         'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFì¸óÕÉpÉXÉèÅ[Éhê≥èÌÅvÉçÉOèoóÕ
           Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_OK, 0)
        Else
            'EG20 V30.3.0.1 ADD STARTÅyHKRK_Kansi07_007_01Åz
            'ÉÜÅ[ÉUÉåÉxÉãÇ™0ÅAÇPà»äOÇÕbFlagÇFalseÇ…ÇµÇƒÇµÇ‹Ç¡ÇƒÇ¢ÇÈÇÃÇ≈ÅAÇ±Ç±Ç™é¿çsÇ≥ÇÍÇÈÇ±Ç∆ÇÕÇ»Ç¢Ç™îOÇÃÇΩÇﬂÅA
            'ã∆ñ±ånï€éÁÇ™ãNìÆÇµÇ»Ç¢ÇÊÇ§Ç…ÅAÇ±Ç±Ç≈Ç‡ÉpÉXÉèÅ[ÉhïsàÍívàµÇ¢Ç∆Ç∑ÇÈ
            iResponse = MsgBox("ÉpÉXÉèÅ[ÉhÇ™à·Ç¢Ç‹Ç∑ÅB", _
                                vbOKOnly, _
                                "ÉpÉXÉèÅ[ÉhÉGÉâÅ[")
            'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFì¸óÕÉpÉXÉèÅ[ÉhàŸèÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, PASS_KEY_ERROR, 0)
            'ì¸óÕÉpÉXÉèÅ[ÉhÇèâä˙âªÇ∑ÇÈ
            txtPass = ""
            'ÉpÉXÉèÅ[Éhì¸óÕâÊñ Çï¬Ç∂Ç∏ÅAèàóùÇèIóπÇ∑ÇÈ
            Exit Sub
            'EG20 V30.3.0.1 ADD ENDÅyHKRK_Kansi07_007_01Åz
            'EG20 V30.3.0.1 DEL START ÅyHKRK_Kansi07_007_01Åz
'         'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFì¸óÕÉpÉXÉèÅ[Éhê≥èÌÅvÉçÉOèoóÕ
'           Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_OK, 0)
'           'ì¡éÍÉÜÅ[ÉUÇÃèÍçáÇÕã∆ñ±èIóπÇµÅA
'           'ä«óùÇ…ÉvÉçÉZÉXèIóπóvãÅ“∞Ÿ(ï‚èïèÓïÒÅÅ’∞ªﬁ⁄ÕﬁŸÇê›íË)ÇëóêMÇ∑ÇÈÅB
'            tmrMail.Enabled = False
'            'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ è¡ãéÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_GAMEN_END, 0)
'            Call psEndProc
'            Unload Me
'            Exit Sub
            'EG20 V30.3.0.1 DEL END ÅyHKRK_Kansi07_007_01Åz
        End If
        'V1.6.0.1 ADD START
        'ÉÅÉìÉeÉiÉìÉXÉÅÉjÉÖÅ[âÊñ Çï\é¶Ç∑ÇÈ°
        frmHoshu.Show  'V1.6.0.1 DEL
        'V1.6.0.1 ADD END
        'ÉpÉXÉèÅ[Éhì¸óÕâÊñ ÇîÒÉAÉNÉeÉBÉuï\é¶Ç…Ç∑ÇÈ°
        'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ è¡ãéÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_GAMEN_END, 0)
        Me.Hide
        'ÉÅÉìÉeÉiÉìÉXÉÅÉjÉÖÅ[âÊñ Çï\é¶Ç∑ÇÈ°
        'frmHoshu.Show  'V1.6.0.1 DEL
    End If
' V1.3.0.1 ADD START
        'ÉpÉXÉèÅ[Éhì¸óÕâÊñ Çï¬Ç∂ÇÈÅB
        Unload Me
' V1.3.0.1 ADD END
  Exit Sub

FileError:
   'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ è¡ãéÅvÉçÉOèoóÕ
   Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_GAMEN_END, 0)
    'ÉpÉXÉèÅ[Éhì¸óÕâÊñ Çï¬Ç∂ÇÈÅB
   Unload Me
 End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdReturn_Click
'//  ã@î\ñºèÃ  : ÅuäƒéãâÊñ Ç÷ñﬂÇÈÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ÉvÉçÉZÉXèIóπèàóùÇÇµÅAâÊñ Çï¬Ç∂ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V2.1.0.1) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdReturn_Click()
  On Error Resume Next
  
  'ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}Çí‚é~Ç∑ÇÈ
  tmrMail.Enabled = False
  'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉpÉXÉèÅ[Éhì¸óÕâÊñ è¡ãéÅvÉçÉOèoóÕ
  Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_KEY_GAMEN_END, 0)
  
' EG20 V2.1.0.1[Mainte_03_01]í«â¡äJén
    If CheckAppStart(PROC_KANRI) = 0 Then
        'ä«óùÉvÉçÉZÉXÇ™ãNìÆÇµÇƒÇ¢Ç»Ç¢èÍçá
        psEndHoshuProc
    Else
' EG20 V2.1.0.1[Mainte_03_01]í«â¡èIóπ
        'èIóπèàóùÇçsÇ§
        psEndProc
    End If          ' EG20 V2.1.0.1[Mainte_03_01]í«â¡
  'ÉpÉXÉèÅ[Éhì¸óÕâÊñ Çï¬Ç∂ÇÈÅB
  Unload Me
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdNumber_Click
'//  ã@î\ñºèÃ  : ÉeÉìÉLÅ[äeñtâüâ∫éûèàóù
'//  ã@î\äTóv  : âüâ∫Ç≥ÇÍÇΩÉLÅ[Ç…è]Ç¡ÇƒÅAÉpÉXÉèÅ[Éhì¸óÕóìÇçXêVÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : IntegerÅ@IndexÅ@Å@Å@[IN]âüâ∫ÉLÅ[ÇÃéÌï 
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdNumber_Click(Index As Integer)
    
    'ÇaÇrÉLÅ[âüâ∫éû
    If Index = 10 Then
        'ì¸óÕílóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
        If (txtPass <> "") Then
            'ì¸óÕílÇ™óLÇ¡ÇΩèÍçáÅAññîˆì¸óÕílÇÇPï∂éöçÌèúÇ∑ÇÈÅB
            txtPass = Left(txtPass, Len(txtPass) - 1)
        End If
        'èàóùèIóπÅB
        Exit Sub
    End If
    
    'ÇbÉLÅ[âüâ∫éû
    If Index = 11 Then
        'ì¸óÕílÇëSÇƒçÌèúÇ∑ÇÈÅB
        txtPass = ""
        'èàóùèIóπÅB
        Exit Sub
    End If
    
    'ÇOÅ`ÇXÇ‹Ç≈ÇÃêîéöÉLÅ[Ç™âüâ∫éûÅAì¸óÕçœÇ›ï∂éöóÒÇÃññîˆÇ…í«â¡Ç∑ÇÈÅB
    txtPass = txtPass & Index
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMópÉ^ÉCÉ}ÅAÉ^ÉCÉÄÉAÉbÉvèàóù
'//  ã@î\äTóv  : ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()
On Error Resume Next
    
    'îƒópÉÅÅ[ÉãéÛêMèàóùÇçsÇ§
    If pfComMailRecieve = ML_ID_HOSHU_ACTIVE_REQ Then
        AppActivate frmPass.Caption, False
        pfFormActive (frmPass.hwnd)
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sPassFileInitialize
'//  ã@î\ñºèÃ  : ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãèâä˙èàóù
'//  ã@î\äTóv  : ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»ÇØÇÍÇŒçÏê¨ÇµÅA
'//              ÉfÉtÉHÉãÉgÇÃÉpÉXÉèÅ[ÉhÇäiî[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.7.0.1) 2009-07-28   REVISED BY [TCC] S.Terao
'//                 ï€éÁëçì_åüèCê≥
'//     REVISIONS :(EG20 V3.3.0.1) 2012-01-20  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyëÄçÏëÏ åãçáNo.36ä÷òAÅz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sPassFileInitialize()
    Dim intPassFileNo As Integer  'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇÃÉtÉ@ÉCÉãî‘çÜ
    Dim iLine As Integer          'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇÃçsÉJÉEÉìÉ^
    Dim sPassword As String       'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇÃÇPçsï™ÇÃÉfÅ[É^
    
    'çsÉJÉEÉìÉ^Ç0Ç…Çƒèâä˙âªÇ∑ÇÈÅB
    iLine = 0
    On Error GoTo FileError
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈÅB
    intPassFileNo = FreeFile
    'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇäJÇ≠ÅB
    Open PASSWORD_FILE_FULLPASS For Input As #intPassFileNo
    'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈åJÇËï‘Ç∑ÅB
'    Do While Not EOF(1)                                    ' EG20 V3.3.0.1çÌèú
    Do While Not EOF(intPassFileNo)                         ' EG20 V3.3.0.1í«â¡
      'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇ…óLå¯Ç»íËã`ê›íËÇ™óLÇÈÇ©É`ÉFÉbÉNÇ∑ÇÈÇΩÇﬂÅA1çsï™ì«Ç›çûÇﬁÅB
      Line Input #intPassFileNo, sPassword
        'íËã`ê›íËÇ™Ç†ÇÈèÍçáÅAçsÉJÉEÉìÉ^Å[ÇÉJÉEÉìÉgÉAÉbÉvÇ∑ÇÈÅB
        If sPassword <> "" Then
            iLine = iLine + 1
            Exit Do
        End If
    Loop

    'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇï¬Ç∂ÇÈÅB
    Close #intPassFileNo
'Exit Sub  'V1.7.0.1 DEL

FileError:
    'ÅuÉpÉXÉèÅ[Éhì¸óÕâÊñ ÅFÉfÉtÉHÉãÉgÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãçÏê¨ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, PASS_KEY_FILE_CREATE, 0)
    'çsÉJÉEÉìÉ^Å[Ç™0ÇÃèÍçá(=íËã`ê›íËñ≥Çµ)
    If iLine = 0 Then
        'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇäJÇ≠ÅB
        Open PASSWORD_FILE_FULLPASS For Output As #intPassFileNo
        'ÉfÉtÉHÉãÉgÇÃÉpÉXÉèÅ[ÉhÅu 'ì¡å†ÉÜÅ[ÉUópÅF"ÇP"ÅvÇèëÇ´çûÇﬁÅB
        Print #intPassFileNo, "1,1"
        'ÉpÉXÉèÅ[ÉhÉtÉ@ÉCÉãÇï¬Ç∂ÇÈÅB
        Close #intPassFileNo
    End If
End Sub
 
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sGetRegIDU_LDU_Path
'//  ã@î\ñºèÃ  : IDU/LDUÇÃÉpÉXÇÉåÉWÉXÉgÉäÇÊÇËéÊìæÇ∑ÇÈÅB
'//  ã@î\äTóv  : IDU/LDUÇÃÉpÉXÇÉåÉWÉXÉgÉäÇÊÇËéÊìæÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.3.0.1) 2009-03-13   REVISED BY [TCC] C.Terui
'//                 ÅEÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílê›íËãyÇ—èàóùïœçX
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sGetRegIDU_LDU_Path()
    
    On Error Resume Next
    
    sGetRegIDU_LDU_Path = False
    
    'IDUÅFÉAÉvÉäÉpÉXéÊìæ
    PATH_IDU_APP = pfGetReg(HKEY_LOCAL_MACHINE, "SOFTWARE\TOSHIBA\ID_RelayUnit", "AplRoot")
    If PATH_IDU_APP = "" Then
       'ÅuÉåÉWÉXÉgÉäèÓïÒéÊìæàŸèÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, GET_REGDATA_ERROR, 0)
' V1.3.0.1 ADD START
       'ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílÇéÊìæ
       PATH_IDU_APP = REG_IDU_APLROOT
' V1.3.0.1 ADD END
'       Exit Function                       ' V1.3.0.1 DEL
    End If

    'IDUÅFDBÉpÉXéÊìæ
    PATH_IDU_DB = pfGetReg(HKEY_LOCAL_MACHINE, "SOFTWARE\TOSHIBA\ID_RelayUnit", "DataRoot")
    If PATH_IDU_DB = "" Then
       'ÅuÉåÉWÉXÉgÉäèÓïÒéÊìæàŸèÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, GET_REGDATA_ERROR, 0)
' V1.3.0.1 ADD START
       'ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílÇéÊìæ
       PATH_IDU_DB = REG_IDU_DBROOT
' V1.3.0.1 ADD END
'       Exit Function                       ' V1.3.0.1 DEL
    End If
    
    'IDUÅFÉoÉbÉNÉAÉbÉvÉpÉXéÊìæ
    PATH_BUC = pfGetReg(HKEY_LOCAL_MACHINE, "SOFTWARE\TOSHIBA\ID_RelayUnit", "BackupRoot")
    If PATH_BUC = "" Then
       'ÅuÉåÉWÉXÉgÉäèÓïÒéÊìæàŸèÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, GET_REGDATA_ERROR, 0)
' V1.3.0.1 ADD START
       'ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílÇéÊìæ
       PATH_BUC = REG_IDU_BACKUPROOT
' V1.3.0.1 ADD END
'       Exit Function                       ' V1.3.0.1 DEL
    End If

    'IDUÅFÉçÉOÉpÉXéÊìæ
    PATH_IDU_LOG = pfGetReg(HKEY_LOCAL_MACHINE, "SOFTWARE\TOSHIBA\ID_RelayUnit", "LogRoot")
    If PATH_IDU_LOG = "" Then
       'ÅuÉåÉWÉXÉgÉäèÓïÒéÊìæàŸèÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, GET_REGDATA_ERROR, 0)
' V1.3.0.1 ADD START
       'ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílÇéÊìæ
       PATH_IDU_LOG = REG_IDU_LOGROOT
' V1.3.0.1 ADD END
'       Exit Function                       ' V1.3.0.1 DEL
    End If

'    LDUÉAÉvÉäÉpÉXéÊìæ
    PATH_LDU_APP = pfGetReg(HKEY_LOCAL_MACHINE, "SOFTWARE\TOSHIBA\LD_Utility", "AplRoot")
    If PATH_LDU_APP = "" Then
      'ÅuÉåÉWÉXÉgÉäèÓïÒéÊìæàŸèÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, GET_REGDATA_ERROR, 0)
' V1.3.0.1 ADD START
       'ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílÇéÊìæ
       PATH_LDU_APP = REG_LDU_APLROOT
' V1.3.0.1 ADD END
'       Exit Function                       ' V1.3.0.1 DEL
    End If
    
'    LDUÉçÉOÉpÉXéÊìæ
    PATH_LDU_LOG = pfGetReg(HKEY_LOCAL_MACHINE, "SOFTWARE\TOSHIBA\LD_Utility", "LogRoot")
    If PATH_LDU_LOG = "" Then
      'ÅuÉåÉWÉXÉgÉäèÓïÒéÊìæàŸèÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, GET_REGDATA_ERROR, 0)
' V1.3.0.1 ADD START
       'ÉåÉWÉXÉgÉäÇÃÉfÉtÉHÉãÉgílÇéÊìæ
       PATH_LDU_LOG = REG_LDU_LOGROOT
' V1.3.0.1 ADD END
'       Exit Function                       ' V1.3.0.1 DEL
    End If
    
    sGetRegIDU_LDU_Path = True
    
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : MakeInitKikiClas
'//  ã@î\ñºèÃ  : ã@äÌç\ê¨ÉfÅ[É^ÉNÉâÉXê∂ê¨èàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ÉNÉâÉXÇê∂ê¨Ç∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(2.1.0.1) 2010-05-28   REVISED BY [TCC] S.Yoshimori
'//                 ÇPÉâÉbÉ`ã§ìØégópâwëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub MakeInitKikiClas()

    Dim lErrCode As Long          'ÉGÉâÅ[ÉRÅ[Éh
    Dim bRet As Boolean           'ä÷êîñﬂÇËíl
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V2.1.0.1 ADD

    '---------------------------------------------
    'ã@äÌç\ê¨ÉfÅ[É^ÉNÉâÉXê∂ê¨
    '---------------------------------------------
    bRet = dllInitKikiClass(lErrCode)
    
    'ÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_CREATE_KIKICLASS, lErrCode)
    
    '---------------------------------------------
    'âwìsìxÉfÅ[É^ïRïtÇØÉtÉ@ÉCÉãÉÅÉÇÉäìWäJ
    '---------------------------------------------
    bRet = dllMemEkiDataChange(EKI_DATA_CHANGE_FILE, lErrCode)
    
    If bRet = False Then
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, PASS_CREATE_EKITUDOMAP_ERR, lErrCode)
    Else
        'ê≥èÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_CREATE_EKITUDOMAP, 0)
    End If
    
    'V2.1.0.1 ADD START
    '---------------------------------------------
    'âwÉ^ÉCÉvìsìxÉfÅ[É^ïRïtÇØÉtÉ@ÉCÉãÉÅÉÇÉäìWäJ
    '---------------------------------------------
    'âwÉ^ÉCÉvìsìxÉfÅ[É^ïRïtÇØÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈÇ»ÇÁèàóùÇçsÇ»Ç§
    If (objFso.FileExists(EKI_TYPE_DATA_CHANGE_FILE) = True) Then

        'âwÉ^ÉCÉvìsìxÉfÅ[É^ïRïtÇØÉtÉ@ÉCÉãÉÅÉÇÉäìWäJä÷êî
        bRet = dllMemEkiTypeDataChange(EKI_TYPE_DATA_CHANGE_FILE, lErrCode)
        
        If (False = bRet) Then
            'àŸèÌÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, PASS_CREATE_EKITYPE_TUDOMAP_ERR, lErrCode)
        Else
            'ê≥èÌÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, PASS_CREATE_EKITYPE_TUDOMAP, 0)
        End If
    Else
        'âwÉ^ÉCÉvìsìxÉfÅ[É^ïRïtÇØÉtÉ@ÉCÉãÇ»Çµ
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_WARNING, L3AN_FILE, PASS_NOT_EKITYPE_TUDOFILE, 0)
    End If
    
    Set objFso = Nothing
    'V2.1.0.1 ADD END
End Sub

