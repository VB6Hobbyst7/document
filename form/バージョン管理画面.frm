VERSION 5.00
Begin VB.Form frmVersion 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "ÉoÅ[ÉWÉáÉìä«óù"
   ClientHeight    =   9000
   ClientLeft      =   2175
   ClientTop       =   2430
   ClientWidth     =   12000
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
      Size            =   14.25
      Charset         =   128
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   NegotiateMenus  =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   9000
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows ÇÃä˘íËíl
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "Å@êVä≤ê¸Å@â¸éDã@"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   9
      Left            =   3320
      TabIndex        =   21
      Top             =   8040
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "ìùçáäƒéãî’"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   0
      Left            =   120
      TabIndex        =   18
      Top             =   7185
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "â¸éDã@"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   3
      Left            =   4920
      TabIndex        =   17
      Top             =   7185
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "ÇhÇcÇt"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   1
      Left            =   1720
      TabIndex        =   16
      Top             =   7185
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "ÇkÇcÇt"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   2
      Left            =   3320
      TabIndex        =   15
      Top             =   7185
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "ICã§í â^í¿"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   5
      Left            =   120
      TabIndex        =   14
      Top             =   8040
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "ëÄçÏëÏ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   6
      Left            =   1720
      TabIndex        =   13
      Top             =   8040
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "Å@VeràÍóóÅ@USBèoóÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   8
      Left            =   8120
      TabIndex        =   12
      Top             =   7185
      Width           =   1600
   End
   Begin VB.ListBox lstKan 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   5100
      Left            =   120
      TabIndex        =   11
      Top             =   1680
      Width           =   11530
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "î}ëÃéÊäO"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   7
      Left            =   8120
      TabIndex        =   10
      Top             =   8040
      Width           =   1600
   End
   Begin VB.CommandButton cmdFixedExe 
      Caption         =   "ÇhÇbÇl"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Index           =   4
      Left            =   6520
      TabIndex        =   9
      Top             =   7185
      Width           =   1600
   End
   Begin VB.Timer tmrMail 
      Left            =   11400
      Top             =   7320
   End
   Begin VB.Frame fraAllKansiVersion 
      Caption         =   "ëSëÃÉoÅ[ÉWÉáÉìÅFZ9.Z9.Z9.Z9"
      Height          =   1095
      Left            =   120
      TabIndex        =   1
      Top             =   480
      Width           =   11535
      Begin VB.Label lblVerName 
         Caption         =   "Z9.Z9.Z9.Z9"
         Height          =   375
         Index           =   5
         Left            =   8520
         TabIndex        =   8
         Top             =   650
         Width           =   2895
      End
      Begin VB.Label lblVerName 
         Caption         =   "Z9.Z9.Z9.Z9"
         Height          =   375
         Index           =   3
         Left            =   4500
         TabIndex        =   7
         Top             =   650
         Width           =   2535
      End
      Begin VB.Label lblVerName 
         Caption         =   "ÅEÇhÇcÇtÉAÉvÉäÉPÅ[ÉVÉáÉìÅF"
         Height          =   375
         Index           =   2
         Left            =   4320
         TabIndex        =   6
         Top             =   345
         Width           =   3255
      End
      Begin VB.Label lblVerName 
         Caption         =   "Z9.Z9.Z9.Z9"
         Height          =   375
         Index           =   1
         Left            =   450
         TabIndex        =   5
         Top             =   650
         Width           =   2295
      End
      Begin VB.Label lblVerName 
         Caption         =   "ÅEìùçáäƒéãî’ÅF "
         Height          =   375
         Index           =   0
         Left            =   240
         TabIndex        =   3
         Top             =   350
         Width           =   2535
      End
      Begin VB.Label lblVerName 
         Caption         =   "ÅEÇkÇcÇtÉAÉvÉäÉPÅ[ÉVÉáÉìÅF"
         Height          =   375
         Index           =   4
         Left            =   8355
         TabIndex        =   2
         Top             =   345
         Width           =   3015
      End
   End
   Begin VB.CommandButton cmdReturn 
      Caption         =   " ÉÅÉìÉeÉiÉìÉX   âÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   9720
      TabIndex        =   0
      Top             =   7800
      Width           =   2055
   End
   Begin VB.Label lbltitle 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "É^ÉCÉgÉã"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   645
      Index           =   0
      Left            =   120
      TabIndex        =   20
      Top             =   1800
      Width           =   1935
   End
   Begin VB.Label lbltitle 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ÉtÉ@ÉCÉãñº"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   6
      Left            =   2040
      TabIndex        =   19
      Top             =   1800
      Width           =   1935
   End
   Begin VB.Label Label3 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "ÉoÅ[ÉWÉáÉìä«óù"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Left            =   0
      TabIndex        =   4
      Top             =   0
      Width           =   12015
   End
End
Attribute VB_Name = "frmVersion"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFfrmVersion.frm
'//  ÉpÉbÉPÅ[ÉWñºÅFÉoÅ[ÉWÉáÉìä«óùâÊñ 
'//
'//  äTóvÅFÉoÅ[ÉWÉáÉìä«óùâÊñ 
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.3.0.1) 2009-03-16   REVISED BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÅEÉtÉFÅ[ÉYÇQëŒâûÅ@äƒéãÉtÉ@Å[ÉÄÅARASÉ}ÉCÉRÉìí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-11   REVISED BY [TCC] S.Terao
'//                 ÅEÉtÉFÅ[ÉYÇRëŒâûÅ@ÉoÅ[ÉWÉáÉìî}ëÃèoóÕí«â¡
'//     REVISIONS :(1.10.0.1) 2009-09-25   REVISED BY [TCC] T.Furuya
'//                 KKëŒâû
'//     REVISIONS :(1.20.0.1) 2010-03-11   REVISED BY [TCC] S.Yamazaki
'//                 âÊñ ÉåÉCÉAÉEÉgïœçX
'//     REVISIONS :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-21  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅy03ìùçáTR-No.18èCê≥ëŒâûÅz
'//     REVISIONS :(EG20 V5.6.0.1) 2012-04-04  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÇhÇbÇlÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉäÉXÉgëŒâûÅz
'//     REVISIONS :(EG20 V6.1.0.1) 2012-06-09  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÉoÅ[ÉWÉáÉìï\é¶ïsê≥ëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17 CODED BY  [TCC] T.Nakajima
'//                 Åyñkó§êVä≤ê¸äJã∆ëŒâûÅz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit
Private Const MN_MAIL_INTERVAL = 1000   'ÉÅÅ[ÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl
Dim uVersion() As MN_VERSION_JIKAI      'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉA

'V1.20.0.1 ADD START
Private Type DISP_FILE_INFO      'ï\é¶ÉoÅ[ÉWÉáÉìcsvÉtÉ@ÉCÉãì‡óe
    sTitle As String             'É^ÉCÉgÉã
    sFilePath As String          'ÉtÉ@ÉCÉãÉpÉX
    iType As Integer             'ï\é¶É^ÉCÉv
    iIdu As Integer              'ÇhÇcÇtèkëﬁëŒè€ÉtÉ@ÉCÉãóLñ≥
    iMaker As Integer            ' ÉÅÅ[ÉJî‘çÜÅiÉ^ÉCÉvÇQÅj             ' EG20 V5.6.0.1í«â¡
End Type

Private Const CSV_COMMENT_CHAR = ":"  'csvÉtÉ@ÉCÉãÇ≈ÉRÉÅÉìÉgÇ∆Ç∑ÇÈï∂éöóÒ
'V1.20.0.1 ADD END

' EG20 V2.1.0.1[Mainte_03_01] í«â¡äJén
Dim FileList() As String                     'ÉtÉ@ÉCÉãñºÉäÉXÉgàÍóóäiî[ÉGÉäÉA
Dim FileListType() As String                 'ÉtÉ@ÉCÉãÉäÉXÉgàÍóóäiî[ÉGÉäÉAÅiéüê¢ë„é©â¸É^ÉCÉvÇä‹ÇﬁÅj
' EG20 V2.1.0.1[Mainte_03_01] í«â¡èIóπ


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óùâÊñ (ÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()
   On Error Resume Next
    
    'ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ÇãNìÆÇ∑ÇÈÅB
    tmrMail.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óùâÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
    On Error Resume Next
   
    'ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}Çí‚é~Ç∑ÇÈÅB
    tmrMail.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óùâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.3.0.1) 2009-03-16   REVISED BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-18   REVISED BY [TCC] S.Terao
'//     REVISIONS :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-10-16 CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû ÅyHKRK_Kansi06_004_02Åz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()
   Dim strWork         As String   'çÏã∆ÉGÉäÉA
 
   On Error Resume Next
 
   'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
   Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_GAMEN_START, 0)

   Me.Top = 0
   Me.Left = 0
   Me.Height = 9000
   Me.Width = 12000
   
   'V1.4.0.1 DEL START
   'ÉoÅ[ÉWÉáÉìéÊìæèàóù
   'psGetVersion
   'V1.4.0.1 DEL END
   
   'é•ãCâ^í¿ëŒâûÉ`ÉFÉbÉN
'   psJikiCheck                                ' EG20 V2.1.0.1[Mainte_03_01] çÌèú
    
   'IDUèkëﬁÉ`ÉFÉbÉN
   psIDUCheck
    
   If pbIDUSts = 1 Then
     'IDUã∆ñ±îÒï\é¶
      cmdFixedExe(1).Visible = False
'      cmdFixedExe(5).Visible = False          ' EG20 V2.1.0.1[Mainte_03_01] çÌèú
'      cmdFixedExe(6).Visible = False          ' EG20 V2.1.0.1[Mainte_03_01] çÌèú
      cmdFixedExe(4).Visible = False           ' EG20 V2.1.0.1[Mainte_03_01] í«â¡
      cmdFixedExe(5).Visible = False           ' EG20 V2.1.0.1[Mainte_03_01] í«â¡
   End If
   
   'V1.4.0.1 ADD START
   'ÉoÅ[ÉWÉáÉìéÊìæèàóù
   psGetVersion
   'V1.4.0.1 ADD END

   'V1.3.0.1 ADD START
   'ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈÅB
   tmrMail.Interval = MN_MAIL_INTERVAL
   tmrMail.Enabled = False
   '1.3.0.1 ADD END
   'EG20 V30.3.0.1 ÅyHKRK_Kansi06_004_02Åz DEL START
   'EG20 V30.1.0.1 ADD START
'    If fIsExistCornerType(CORNER_TYPE_ZAIRAI) = False Then
'        'ç›óàê¸ÉRÅ[ÉiÅ[Ç™àÍÇ¬Ç‡ë∂ç›ÇµÇ»Ç¢ÇÃÇ≈ÅAâ¸éDã@ñtÇÕâüâ∫ïsâ¬Ç…Ç∑ÇÈÅB
'        cmdFixedExe(3).Enabled = False
'    End If
'
'    If fIsExistCornerType(CORNER_TYPE_KANSEN) = False Then
'        'ä≤ê¸ÉRÅ[ÉiÅ[Ç™àÍÇ¬Ç‡ë∂ç›ÇµÇ»Ç¢ÇÃÇ≈ÅAêVä≤ê¸â¸éDã@ñtÇÕâüâ∫ïsâ¬Ç…Ç∑ÇÈÅB
'        cmdFixedExe(9).Enabled = False
'    End If
   'EG20 V30.1.0.1 ADD END
   'EG20 V30.3.0.1 ÅyHKRK_Kansi06_004_02Åz DEL END
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdFixedExe_Click
'//  ã@î\ñºèÃ  : äeâÊñ ëJà⁄ñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ñtñºèÃâÊñ Ç…ëJà⁄Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : IntegerÅ@IndexÅ@Å@Å@[IN]âüâ∫ñtÉCÉìÉfÉbÉNÉX
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-18   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@äƒéãÉtÉ@Å[ÉÄÅAÉoÅ[ÉWÉáÉìêÿë÷Çí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-18   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRëŒâûÅ@ÉoÅ[ÉWÉáÉìî}ëÃèoóÕÇí«â¡
'//     REVISIONS :(1.20.0.1) 2010-03-17  REVISED BY [TCC] S.Yamazaki
'//                 ÉoÅ[ÉWÉáÉìêÿë÷Çî}ëÃéÊäOÇ…ïœçX
'//                 ÉoÅ[ÉWÉáÉìî}ëÃèoóÕñtÇVeràÍóóUSBèoóÕñtÇ…ïœçX
'//     REVISIONS :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-21  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅy03ìùçáTR-No.18èCê≥ëŒâûÅz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdFixedExe_Click(Index As Integer)
   Dim udtMail As ML_DISP_INF          'âÊñ ï\é¶óvãÅ
   Dim iResponse As Integer            'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXñﬂÇËíl
   Dim bRet As Boolean                 'ÉÅÅ[ÉãëóêMèàóùñﬂÇËíl
   Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    
    On Error Resume Next
    
    Select Case Index
        Case 0                                 'ÉoÅ[ÉWÉáÉìä«óùÅiäƒéãî’Åj
             'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFäƒéãî’ñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_KANSIBAN_BUTTOM, 0)
            Load frmKVer
            frmKVer.Show 1
        Case 1                                 'ÉoÅ[ÉWÉáÉìä«óùÅiIDUÅj
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFIDUñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_IDU_BUTTOM, 0)
            Load frmIDUVer
            frmIDUVer.Show 1
        Case 2                                 'ÉoÅ[ÉWÉáÉìä«óùÅiLDUÅj
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFLDUñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_LDU_BUTTOM, 0)
            Load frmLduVer
            frmLduVer.Show 1
' EG20 V2.1.0.1[Mainte_03_01] çÌèúäJén
'        Case 3                                 'ÉoÅ[ÉWÉáÉìä«óùÅiEG-Ré©â¸Åj
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFEG-Ré©â¸ñtâüâ∫ÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_EGRJIKAI_BUTTOM, 0)
'            gStrCurrentForm = sFormName_EJVer
'            Load frmJVer
'            frmJVer.Show 1
'        Case 4                                 'ÉoÅ[ÉWÉáÉìä«óùÅiNEGé©â¸Åj
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFNEGé©â¸ñtâüâ∫ÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_NEGJIKAI_BUTTOM, 0)
'            gStrCurrentForm = sFormName_NJVer
'            Load frmJVer
'            frmJVer.Show 1
'        Case 5                                 'ÉoÅ[ÉWÉáÉìä«óùÅiîªíËIC-MÅj
' EG20 V2.1.0.1[Mainte_03_01] çÌèúèIóπ
' EG20 V2.1.0.1[Mainte_03_01] í«â¡äJén
        Case 3                                 'ÉoÅ[ÉWÉáÉìä«óùÅiâ¸éDã@Åj
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFEG20é©â¸ñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_EG20JIKAI_BUTTOM, 0)
            gStrCurrentForm = sFormName_EG20JVer
            Load frmGateVerKanri
            frmGateVerKanri.Show 1
        Case 4                                 'ÉoÅ[ÉWÉáÉìä«óùÅiîªíËIC-MÅj
' EG20 V2.1.0.1[Mainte_03_01] í«â¡èIóπ
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFîªíËIC-Mñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_ICM_BUTTOM, 0)
            'âÊñ ï\é¶óvãÅ(îªíËICÅ|MâÊñ )ÇIDêßå‰Ç…ëóêMÇ∑ÇÈ
            udtMail.udtlHeader.dwId = ML_ID_DISP_STS_CMD
            udtMail.udtlHeader.dwSize = MlSize.DISP_STS_CMD
            udtMail.udtlHeader.dwProid = RHOSHU_ID
            udtMail.udtlHeader.dwSubArea = 0
            udtMail.dwDisp_Type = ML_DT_HANTEI_VER
            bRet = DssSendMail(MAIL_SLOT_IDSEI, Len(udtMail), udtMail.udtlHeader)
            If bRet = False Then
               'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï€éÁâÊñ ï\é¶óvãÅÉÅÅ[ÉãëóêMàŸèÌÅvÉçÉOèoóÕ
               lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_MAIL_IO + ECOD_MSEND
               Call sLogTraceReq(LTYP_ERROR, L3AN_SEND, HOSHU_MENU_GAMEN_CMD, lngErrCode)
               'ãNìÆé∏îsÉ|ÉbÉvÉAÉbÉvï\é¶
' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzçÌèúäJén
'               iResponse = MsgBox("îªíËIC-MñtÅAíËã`ÉGÉâÅ[ÅB" & _
'                                   Chr(vbKeyReturn) & _
'                                   "îªíËIC-MÉoÅ[ÉWÉáÉìä«óùâÊñ ÇãNìÆÇ≈Ç´Ç‹ÇπÇÒÅB", _
'                                   vbOKOnly, _
'                                   "âÊñ ãNìÆÉGÉâÅ[")
' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzçÌèúèIóπ
' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzí«â¡äJén
               iResponse = MsgBox("ÇhÇbÇlñtÅAíËã`ÉGÉâÅ[ÅB" & _
                                   Chr(vbKeyReturn) & _
                                   "ÇhÇbÇlÉoÅ[ÉWÉáÉìä«óùâÊñ ÇãNìÆÇ≈Ç´Ç‹ÇπÇÒÅB", _
                                   vbOKOnly, _
                                   "âÊñ ãNìÆÉGÉâÅ[")
' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzí«â¡èIóπ
               Exit Sub
            End If
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï€éÁâÊñ ï\é¶óvãÅÉÅÅ[ÉãëóêMê≥èÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_SEND, HOSHU_MENU_GAMEN_CMD, 0)
' EG20 V2.1.0.1[Mainte_03_01] í«â¡äJén
        Case 5                                 'ÉoÅ[ÉWÉáÉìä«óùÅiICã§í â^í¿Åj
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFICã§í â^í¿ñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_ICUNCHIN_BUTTOM, 0)
            'ï€éÁâÊñ ï\é¶óvãÅ(ICã§í â^í¿âÊñ )ÇIDêßå‰Ç…ëóêMÇ∑ÇÈ
            udtMail.udtlHeader.dwId = ML_ID_DISP_STS_CMD
            udtMail.udtlHeader.dwSize = MlSize.DISP_STS_CMD
            udtMail.udtlHeader.dwProid = RHOSHU_ID
            udtMail.udtlHeader.dwSubArea = 0
            udtMail.dwDisp_Type = ML_DT_PASMO_VER
            bRet = DssSendMail(MAIL_SLOT_IDSEI, Len(udtMail), udtMail.udtlHeader)
            If bRet = False Then
               'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï€éÁâÊñ ï\é¶óvãÅÉÅÅ[ÉãëóêMàŸèÌÅvÉçÉOèoóÕ
               lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_MAIL_IO + ECOD_MSEND
               Call sLogTraceReq(LTYP_ERROR, L3AN_SEND, HOSHU_MENU_GAMEN_CMD, lngErrCode)
               'ãNìÆé∏îsÉ|ÉbÉvÉAÉbÉvï\é¶
               iResponse = MsgBox("ICã§í â^í¿ñtÅAíËã`ÉGÉâÅ[ÅB" & _
                                  Chr(vbKeyReturn) & _
                                  "ICã§í â^í¿ÉfÅ[É^ÉoÅ[ÉWÉáÉìä«óùâÊñ ÇãNìÆÇ≈Ç´Ç‹ÇπÇÒÅB", _
                                  vbOKOnly, _
                                  "âÊñ ãNìÆÉGÉâÅ[")
                Exit Sub
            End If
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï€éÁâÊñ ï\é¶óvãÅÉÅÅ[ÉãëóêMê≥èÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_SEND, HOSHU_MENU_GAMEN_CMD, 0)
        Case 6                                 'ÉoÅ[ÉWÉáÉìä«óùÅiëÄçÏëÏÅj
' EG20 V2.1.0.1[Mainte_03_01 ëÄçÏëÏÉoÅ[ÉWÉáÉìä«óùâÊñ ]í«â¡äJén
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFEG20é©â¸ñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_TAKU_BUTTOM, 0)
            gStrCurrentForm = sFormName_EJVer
            Load frmSousaTakuVerKanri
            frmSousaTakuVerKanri.Show 1
' EG20 V2.1.0.1[Mainte_03_01 ëÄçÏëÏÉoÅ[ÉWÉáÉìä«óùâÊñ ]í«â¡èIóπ
' EG20 V2.1.0.1[Mainte_03_01] í«â¡èIóπ
' EG20 V2.1.0.1[Mainte_03_01] çÌèúäJén
'        Case 6                                 'ÉoÅ[ÉWÉáÉìä«óùÅiPASMOâ^í¿Åj
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFPASMOâ^í¿ñtâüâ∫ÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_PASMO_BUTTOM, 0)
'            'ï€éÁâÊñ ï\é¶óvãÅ(PASMOâ^í¿âÊñ )ÇIDêßå‰Ç…ëóêMÇ∑ÇÈ
'            udtMail.udtlHeader.dwId = ML_ID_DISP_STS_CMD
'            udtMail.udtlHeader.dwSize = MlSize.DISP_STS_CMD
'            udtMail.udtlHeader.dwProid = RHOSHU_ID
'            udtMail.udtlHeader.dwSubArea = 0
'            udtMail.dwDisp_Type = ML_DT_PASMO_VER
'            bRet = DssSendMail(MAIL_SLOT_IDSEI, Len(udtMail), udtMail.udtlHeader)
'            If bRet = False Then
'               'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï€éÁâÊñ ï\é¶óvãÅÉÅÅ[ÉãëóêMàŸèÌÅvÉçÉOèoóÕ
'               lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_MAIL_IO + ECOD_MSEND
'               Call sLogTraceReq(LTYP_ERROR, L3AN_SEND, HOSHU_MENU_GAMEN_CMD, lngErrCode)
'               'ãNìÆé∏îsÉ|ÉbÉvÉAÉbÉvï\é¶
'               iResponse = MsgBox("PASMOã§í â^í¿ñtÅAíËã`ÉGÉâÅ[ÅB" & _
'                                  Chr(vbKeyReturn) & _
'                                  "PASMOã§í â^í¿ÉfÅ[É^ÉoÅ[ÉWÉáÉìä«óùâÊñ ÇãNìÆÇ≈Ç´Ç‹ÇπÇÒÅB", _
'                                  vbOKOnly, _
'                                  "âÊñ ãNìÆÉGÉâÅ[")
'                Exit Sub
'            End If
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFï€éÁâÊñ ï\é¶óvãÅÉÅÅ[ÉãëóêMê≥èÌÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_SEND, HOSHU_MENU_GAMEN_CMD, 0)
'        Case 7                                 'ÉoÅ[ÉWÉáÉìä«óù(é•ãCâ^í¿)
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFé•ãCâ^í¿ñtâüâ∫ÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_JIKIUNCHIN_BUTTOM, 0)
'            Load frmJikiUnkaiFD
'            frmJikiUnkaiFD.Show 1
'        'V1.4.0.1 ADD START
'        Case 8                                 'ÉoÅ[ÉWÉáÉìä«óù(äƒéãÉtÉ@Å[ÉÄ)
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFäƒéãÉtÉ@Å[ÉÄñtâüâ∫ÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_FIRMWARE_BUTTOM, 0)
'            Load frmFirmWareVer
'            frmFirmWareVer.Show 1
' EG20 V2.1.0.1[Mainte_03_01] çÌèúèIóπ
'        Case 9                                 'ÉoÅ[ÉWÉáÉìä«óù(ÉoÅ[ÉWÉáÉìêÿë÷)         ' EG20 V1.1.1.1 çÌèú
        Case 7                                 'î}ëÃéÊäO                                ' EG20 V1.1.1.1 í«â¡
            'V1.20.0.1 DEL START
'            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìêÿë÷ñtâüâ∫ÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_CHANGEVER_BUTTOM, 0)
'            Load frmVerChang
'            frmVerChang.Show 1
            'V1.20.0.1 DEL END
            'V1.20.0.1 ADD START
            'Åuî}ëÃéÊäOñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, USB_OUT, 0)
 
            'î}ëÃéÊäOèàóù
            Call pfRemove(Me)
            'V1.20.0.1 ADD END
        'V1.4.0.1 ADD END
        'V1.6.0.1Å@ADD START
'        Case 10                                 'ÉoÅ[ÉWÉáÉìä«óù(ÉoÅ[ÉWÉáÉìî}ëÃèoóÕ)    ' EG20 V2.1.0.1[Mainte_03_01] çÌèú
        Case 8                                  'ÉoÅ[ÉWÉáÉìä«óù(ÉoÅ[ÉWÉáÉìî}ëÃèoóÕ)     ' EG20 V2.1.0.1[Mainte_03_01] í«â¡
        'V1.20.0.1 DEL START
'           'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìî}ëÃèoóÕñtâüâ∫ÅvÉçÉOèoóÕ
'           Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_VERSION_OUTPUT_BUTTOM, 0)
'           Load frmVerOutput
'           frmVerOutput.Show 1
        'V1.20.0.1 DEL END
        'V1.20.0.1 ADD START
           'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFVeràÍóóUSBèoóÕñtâüâ∫ÅvÉçÉOèoóÕ
           Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_VER_USB_OUTPUT_BUTTOM, 0)
           Call cmdVer_Output
        'V1.20.0.1 ADD END
        'V1.6.0.1 ADD END
        'V30.1.0.1 ADD START
        Case 9                                 'ÉoÅ[ÉWÉáÉìä«óùÅiêVä≤ê¸â¸éDã@Åj
            'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFêVä≤ê¸é©â¸ñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_EG30JIKAI_BUTTOM, 0)
            gStrCurrentForm = sFormName_EG30JVer
            Load frmKansenGateVerKanri
            frmKansenGateVerKanri.Show 1
        'V30.1.0.1 ADD END
    
    End Select
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdReturn_Click
'//  ã@î\ñºèÃ  : ÅuÉÅÉìÉeÉiÉìÉXâÊñ Ç÷ñﬂÇÈÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : é©âÊñ Çè¡ãéÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdReturn_Click()
    
    On Error Resume Next
    
    'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFè¡ãéÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_GAMEN_END, 0)
    Unload Me
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psGetVersion
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìéÊìæèàóù
'//  ã@î\äTóv  : ÉoÅ[ÉWÉáÉìéÊìæèàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÅEIDUèkëﬁéûîÒï\é¶èàóùÅAäƒéãÉtÉ@Å[ÉÄÅARASÉ}ÉCÉRÉìÉoÅ[ÉWÉáÉìèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-11   REVISED BY [TCC] S.Terao
'//                 ÅEÉtÉFÅ[ÉYÇRëŒâûÅ@ÇqÇ`ÇrÉ}ÉCÉRÉìï\é¶ïsóvÇÃÇΩÇﬂçÌèú
'//     REVISIONS :(1.10.0.1) 2009-09-25   REVISED BY [TCC] T.Furuya
'//                 KKëŒâû
'//     REVISIONS :(1.20.0.1) 2010-03-17  REVISED BY [TCC] S.Yamazaki
'//                 ÉâÉxÉãÇ÷ÇÃï\é¶ÇÅAÉäÉXÉgÇ÷ÇÃï\é¶Ç…ïœçX
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Public Sub psGetVersion()
  Dim sVersion  As String 'V1.4.0.1 ADD
  Dim sGetJikiVer As String 'V1.10.0.1 ADD
 
 'äƒéãî’ÅAEG-RëSëÃÉoÅ[ÉWÉáÉìéÊìæ
  psKansiGetVersion
 'IDUëSëÃÉoÅ[ÉWÉáÉìéÊìæ
 'psIDUGetVersion       'V1.4.0.1Å@DEL
 
 'V1.4.0.1Å@ADDÅ@START
 If pbIDUSts = 1 Then
    'IDUÉoÅ[ÉWÉáÉìîÒï\é¶
    lblVerName(2).Enabled = False
    lblVerName(3).Caption = ""
 Else
    'îÒèkëﬁéûÇÕï\é¶èàóù
    psIDUGetVersion
 End If
 'V1.4.0.1Å@ADDÅ@END
 
 'LDUëSëÃÉoÅ[ÉWÉáÉìéÊìæ
  psLDUVersion

'V1.4.0.1Å@DELÅ@START
' 'EG-Ré©â¸ÉoÅ[ÉWÉáÉìéÊìæ
'  psEGRJVersion
' 'NEGé©â¸ÉoÅ[ÉWÉáÉìéÊìæ
'  psNEGJVersion
'V1.4.0.1Å@DELÅ@END

'V1.20.0.1 ADD START
Call psListVersion
'V1.20.0.1 ADD END

'V1.20.0.1 DEL START
''V1.4.0.1Å@ADD START
' 'EG-Ré©â¸ÉoÅ[ÉWÉáÉìéÊìæ
'  'îªíËCPU
'  sVersion = psEGRJVersion(HANTEI_CPU)
'  lblVerName(11).Caption = sVersion
'  'ÉÅÉCÉìCPU
'  sVersion = psEGRJVersion(MAIN_CPU)
'  lblVerName(12).Caption = sVersion
' 'ÉTÉuCPU
'  sVersion = psEGRJVersion(SUB_CPU)
'  lblVerName(13).Caption = sVersion
' 'ÉÅÉCÉìOS
'  sVersion = psEGRJVersion(MAIN_OS)
'  lblVerName(14).Caption = sVersion
' 'ó\îıÇP
'  sVersion = psEGRJVersion(YOBI1)
'  lblVerName(15).Caption = sVersion
' 'ó\îıÇQ
'  sVersion = psEGRJVersion(YOBI2)
'  lblVerName(16).Caption = sVersion
' 'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉN
'  sVersion = psEGRJVersion(VER_CHK)
'  lblVerName(17).Caption = sVersion
'
' 'NEGé©â¸ÉoÅ[ÉWÉáÉìéÊìæ
'  sVersion = psNEGJVersion
'  lblVerName(20).Caption = sVersion
''V1.4.0.1Å@ADD END
'
' 'IC-MÉoÅ[ÉWÉáÉìéÊìæ
' 'psICMGetVersion     'V1.4.0.1Å@DEL
' 'V1.4.0.1Å@ADDÅ@START
' If pbIDUSts = 1 Then
'    'IDUÉoÅ[ÉWÉáÉìîÒï\é¶
'    lblVerName(21).Enabled = False
'    lblVerName(31).Caption = ""
' Else
'    'îÒèkëﬁéûÇÕï\é¶èàóù
'    sVersion = psICMGetVersion
'    lblVerName(31).Caption = sVersion
' End If
' 'V1.4.0.1Å@ADDÅ@END
'
' 'ã§í â^í¿ÉoÅ[ÉWÉáÉìéÊìæ
' 'psICUnchinGetVersion  'V1.4.0.1Å@DEL
' 'V1.4.0.1Å@ADDÅ@START
' If pbIDUSts = 1 Then
'    'IDUÉoÅ[ÉWÉáÉìîÒï\é¶
'    lblVerName(22).Enabled = False
'    lblVerName(33).Caption = ""
' Else
'    'îÒèkëﬁéûÇÕï\é¶èàóù
'    sVersion = psICUnchinGetVersion
'    lblVerName(33).Caption = sVersion
' End If
'
' 'äƒéãÉtÉ@Å[ÉÄÉoÅ[ÉWÉáÉìï\é¶èàóù
' sVersion = psKansiFirmVersion
' lblVerName(25).Caption = sVersion
'
''V1.10.0.1 ADD START
' 'é•ãCâ^í¿ì«Ç›çûÇ›
' sGetJikiVer = psJikiUnchinVersion
' lblVerName(27).Caption = CStr(sGetJikiVer)
''V1.10.0.1 ADD END
'
' 'V1.6.0.1 DEL START
' ''RASÉ}ÉCÉRÉìÉoÅ[ÉWÉáÉìï\é¶èàóù
' 'sVersion = psRASMICOMVersion
' 'lblVerName(27).Caption = sVersion
' 'V1.6.0.1 DEL END
'
' 'V1.4.0.1Å@ADDÅ@END
'V1.20.0.1 DEL END
 
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psKansiGetVersion
'//  ã@î\ñºèÃ  : äƒéãëïíuëSëÃÅAäƒéãî’ÉoÅ[ÉWÉáÉìéÊìæèàóù
'//  ã@î\äTóv  : KansiVersion.iniÇÊÇËÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Public Function psKansiGetVersion()
    Dim lSts As Long                                       'ä÷êîñﬂÇËíl
    Dim strKansiVersion As String * VERSION_GATE_SIZE      'äƒéãî’ëSëÃÉoÅ[ÉWÉáÉì
    Dim strKansiVersion2 As String * VERSION_GATE_SIZE     'äƒéãëïíuëSëÃÉoÅ[ÉWÉáÉì
    
    On Error Resume Next
    
    strKansiVersion = ""
    strKansiVersion2 = ""

    ' KansiVersion.iniÇ©ÇÁäƒéãëïíuÇÃëSëÃÉoÅ[ÉWÉáÉìÇéÊìæÇµï\é¶Ç∑ÇÈ
    lSts = GetPrivateProfileString(KANSIVERSION_SECTION_NAME, _
                                   KANSISYSTEMVERSION_KEY_NAME, _
                                   DEFAILT, _
                                   strKansiVersion, _
                                   Len(strKansiVersion), _
                                   KANSI_VERSION_FILE)
    If lSts > 0 Then
        'éÊìæÇµÇΩÉoÅ[ÉWÉáÉìî‘çÜÇï\é¶
        fraAllKansiVersion.Caption = "ëSëÃÉoÅ[ÉWÉáÉìÅF " & Left$(strKansiVersion, lSts) & ""
    Else
        'ÉoÅ[ÉWÉáÉìî‘çÜÇÃéÊìæàŸèÌÇÃèÍçáÅAÅu--,--,--,--ÅvÇï\é¶
        fraAllKansiVersion.Caption = "ëSëÃÉoÅ[ÉWÉáÉìÅF--.--.--.-- "
    End If
 
    ' KansiVersion.iniÇ©ÇÁäƒéãî’ÇÃëSëÃÉoÅ[ÉWÉáÉìÇéÊìæÇµï\é¶Ç∑ÇÈ
    lSts = GetPrivateProfileString(KANSIVERSION_SECTION_NAME, _
                                   KANSIVERSION_KEY_NAME, _
                                   DEFAILT, _
                                   strKansiVersion2, _
                                   Len(strKansiVersion2), _
                                   KANSI_VERSION_FILE)
     If lSts > 0 Then
        'éÊìæÇµÇΩÉoÅ[ÉWÉáÉìî‘çÜÇï\é¶
        lblVerName(1).Caption = Left$(strKansiVersion2, lSts)
    Else
        'ÉoÅ[ÉWÉáÉìî‘çÜÇÃéÊìæàŸèÌÇÃèÍçáÅAÅu--,--,--,--ÅvÇï\é¶
        lblVerName(1).Caption = "--.--.--.-- "
    End If
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psIDUGetVersion
'//  ã@î\ñºèÃ  : IDíÜåpÉÜÉjÉbÉgÉoÅ[ÉWÉáÉìéÊìæèàóù
'//  ã@î\äTóv  : IDíÜåpÉÜÉjÉbÉgÉoÅ[ÉWÉáÉìä«óùÉtÉ@ÉCÉãÇÊÇËÅA
'//              IDíÜåpÉÜÉjÉbÉgÇÃÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Public Function psIDUGetVersion()
    Dim strWork     As String       'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer      'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    
    On Error Resume Next
    
    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
        
   'IDíÜåpÉÜÉjÉbÉgÉoÅ[ÉWÉáÉìä«óùÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÅB
    Open PATH_IDU_APP & PATH_IDU_VERKANRI For Input As #iFileNumber

    'é¿çsÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
    Input #iFileNumber, strWork
    If (Trim(strWork) = "") Then
        'ÉoÅ[ÉWÉáÉìî‘çÜéÊìæàŸèÌÇÃèÍçá
        lblVerName(3).Caption = "--.--.--.--"
    Else
       'ëSëÃÉoÅ[ÉWÉáÉìï∂éöóÒçÏê¨
        lblVerName(3).Caption = Trim(strWork)
    End If
      
   'IDíÜåpÉÜÉjÉbÉgÉoÅ[ÉWÉáÉìä«óùÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÅB
    Close #iFileNumber
    
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psLDUVersion
'//  ã@î\ñºèÃ  : LDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìéÊìæèàóù
'//  ã@î\äTóv  : LDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìä«óùÉtÉ@ÉCÉãÇÊÇËÅA
'//              LDÉÜÅ[ÉeÉBÉäÉeÉBÇÃÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Public Function psLDUVersion()
    Dim strWork     As String       'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer      'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    
    On Error Resume Next
    
    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
    
   'LDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìä«óùÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÅB
    Open PATH_LDU_APP & PATH_LDU_VERKANRI For Input As #iFileNumber

    'é¿çsÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
    Input #iFileNumber, strWork
    If (Trim(strWork) = "") Then
        'ÉoÅ[ÉWÉáÉìî‘çÜéÊìæàŸèÌÇÃèÍçá
        lblVerName(5).Caption = "--.--.--.--"
    Else
       'ëSëÃÉoÅ[ÉWÉáÉìï∂éöóÒçÏê¨
        lblVerName(5).Caption = Trim(strWork)
    End If
      
   'LDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìä«óùÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÅB
    Close #iFileNumber

End Function

'V1.4.0.1 DEL START
''///////////////////////////////////////////////////////////////////
''//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
''//
''//  ä÷êîñºèÃ  : psEGRJVersion
''//  ã@î\ñºèÃ  : EG-Ré©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìéÊìæèàóù
''//  ã@î\äTóv  : GATEVER_FILE.INIÉtÉ@ÉCÉãÇÊÇËÅAë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇµÅA
''//              ë„ï\ÉtÉ@ÉCÉãÇÊÇËÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
''//
''//              å^        ñºèÃ      à”ñ°
''//  à¯êî      : Ç»Çµ
''//
''//              å^        íl        à”ñ°
''//  ñﬂÇËíl    : Ç»Çµ
''//
''//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
''//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
''//  îıçlÅF
''///////////////////////////////////////////////////////////////////
'Public Function psEGRJVersion()
'    Dim strWork     As String                         'çÏã∆ÉGÉäÉA
'    Dim iFileNumber As Integer                        'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
'    Dim lSts As Long                                  'ä÷êîñﬂÇËíl
'    Dim strVerFileName As String * VERSION_GATE_SIZE  'éÊìæÉtÉ@ÉCÉãñº
'    Dim sGetVer     As String                         'çÏã∆ÉGÉäÉA
'    Dim lngErrCode As Long
'
'    On Error Resume Next
'
'    ' GATEVER_FILE.INIÇ©ÇÁîªíËÉfÅ[É^CPU-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_E, _
'                                   GATE_HANTEI_PRO, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = E_EHAN1NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 11
'    Else
'       'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(11).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁÉÅÉCÉìCPU-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_E, _
'                                   GATE_MAIN_PRO, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = E_EPRO1NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 12
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(12).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁÉTÉuCPU-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_E, _
'                                   GATE_SUB_PRO, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = E_ESCPUNOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 13
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(13).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁÉÅÉCÉìOS-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_E, _
'                                   GATE_MAIN_OS, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = E_EOSNOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 14
'    Else
'       'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(14).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁó\îı1ÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_E, _
'                                   GATE_YOBI1, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'     If lSts > 0 Then
'       strWork = E_EYOBI1NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'       psJVerGet strWork, 15
'     Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(15).Caption = "--"
'     End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁó\îı2ÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_E, _
'                                   GATE_YOBI2, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = E_EYOBI2NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 16
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(16).Caption = "--"
'    End If
'End Function
''///////////////////////////////////////////////////////////////////
''//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
''//
''//  ä÷êîñºèÃ  : psNEGJVersion
''//  ã@î\ñºèÃ  : NEGé©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìéÊìæèàóù
''//  ã@î\äTóv  : GATEVER_FILE.INIÉtÉ@ÉCÉãÇÊÇËÅAë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇµÅA
''//              ë„ï\ÉtÉ@ÉCÉãÇÊÇËÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
''//
''//              å^        ñºèÃ      à”ñ°
''//  à¯êî      : Ç»Çµ
''//
''//              å^        íl        à”ñ°
''//  ñﬂÇËíl    : Ç»Çµ
''//
''//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'''//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
''//  îıçlÅF
''///////////////////////////////////////////////////////////////////
'Public Function psNEGJVersion()
'    Dim strWork     As String                         'çÏã∆ÉGÉäÉA
'    Dim iFileNumber As Integer                        'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
'    Dim lSts As Long                                  'ä÷êîñﬂÇËíl
'    Dim strVerFileName As String * VERSION_GATE_SIZE  'éÊìæÉtÉ@ÉCÉãñº
'    Dim sGetVer     As String                         'çÏã∆ÉGÉäÉA
'    Dim lngErrCode As Long
'
'     On Error Resume Next
'
'    ' GATEVER_FILE.INIÇ©ÇÁîªíËÉfÅ[É^CPU-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_N, _
'                                   GATE_HANTEI_PRO, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = N_NHAN1NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 17
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(17).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁÉÅÉCÉìCPU-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_N, _
'                                   GATE_MAIN_PRO, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = N_NPRO1NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 18
'    Else
'       'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(18).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁÉTÉuCPU-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_N, _
'                                   GATE_SUB_PRO, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = N_NSCPUNOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 19
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(19).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁÉÅÉCÉìOS-PROÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_N, _
'                                   GATE_MAIN_OS, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = N_NOSNOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 20
'    Else
'    'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'     lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'     Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'     lblVerName(20).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁó\îı1ÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_N, _
'                                   GATE_YOBI1, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = N_NYOBI1NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 21
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(21).Caption = "--"
'    End If
'
'    ' GATEVER_FILE.INIÇ©ÇÁó\îı2ÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_N, _
'                                   GATE_YOBI2, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = N_NYOBI2NOW & "\\" & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psJVerGet strWork, 22
'    Else
'       'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(22).Caption = "--"
'    End If
'End Function

''///////////////////////////////////////////////////////////////////
''//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
''//
''//  ä÷êîñºèÃ  : psJVerGet
''//  ã@î\ñºèÃ  : ë„ï\ÉtÉ@ÉCÉãÇÃÉoÅ[ÉWÉáÉìÇéÊìæ
''//  ã@î\äTóv  : ë„ï\ÉtÉ@ÉCÉãÇÃÉoÅ[ÉWÉáÉìÇéÊìæÇµÅAâÊñ ï\é¶Ç∑ÇÈÅB
''//
''//              å^        ñºèÃ      à”ñ°
''//  à¯êî      : StringÅ@Å@sPathÅ@Å@[IN]ë„ï\ÉtÉ@ÉCÉãñº
''//  Å@Å@      : IntegerÅ@ iIndexÅ@ [IN]ï\é¶ÉCÉìÉfÉbÉNÉXî‘çÜ
''//
''//              å^        íl        à”ñ°
''//  ñﬂÇËíl    : Ç»Çµ
''//
''//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
''//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
''//  îıçlÅF
''///////////////////////////////////////////////////////////////////
'Private Function psJVerGet(sPath As String, iCnt As Integer)
'
'    Dim i As Integer                    'ÉJÉEÉìÉ^
'    Dim j As Integer                    'ÉJÉEÉìÉ^
'    Dim iFileNumber As Integer          'ÉtÉ@ÉCÉãî‘çÜ
'    Dim lLen As Long                    'ÉtÉ@ÉCÉãÉTÉCÉY
'    Dim uFooter As MN_FOOT              'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
'    Dim lPos As Long                    'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
'    Dim sDateTime As String
'    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
'
'On Error GoTo FileGetError
'
'    If Dir(sPath) <> "" Then            'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?
'
'      lLen = FileLen(sPath)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ
'
'      iFileNumber = FreeFile            'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'
'      'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
'      Open sPath For Binary Access Read As #iFileNumber
'
'      'ÉtÉbÉ^èÓïÒÇÃéÊìæ
'      Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
'
'      'ÉoÅ[ÉWÉáÉìílÇï\é¶
'      lblVerName(iCnt).Caption = CStr(uFooter.sVersion)
'      Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
'    Else
'      'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢ÅB
'      lblVerName(iCnt).Caption = "--"
'    End If
' Exit Function
'
'FileGetError:
'   'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'   lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'   Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'   lblVerName(iCnt).Caption = "--"
'   Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
'End Function
'
''///////////////////////////////////////////////////////////////////
''//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
''//
''//  ä÷êîñºèÃ  : psICMGetVersion
''//  ã@î\ñºèÃ  : IC-MÉoÅ[ÉWÉáÉìéÊìæèàóù
''//  ã@î\äTóv  : GATEVER_FILE.INIÉtÉ@ÉCÉãÇÊÇËÅAë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇµÅA
''//              ë„ï\ÉtÉ@ÉCÉãÇÊÇËÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
''//
''//              å^        ñºèÃ      à”ñ°
''//  à¯êî      : Ç»Çµ
''//
''//              å^        íl        à”ñ°
''//  ñﬂÇËíl    : Ç»Çµ
''//
''//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
''//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
''//  îıçlÅF
''///////////////////////////////////////////////////////////////////
'Public Function psICMGetVersion()
'    Dim strWork     As String                         'çÏã∆ÉGÉäÉA
'    Dim iFileNumber As Integer                        'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
'    Dim lSts As Long                                  'ä÷êîñﬂÇËíl
'    Dim strVerFileName As String * VERSION_GATE_SIZE  'éÊìæÉtÉ@ÉCÉãñº
'    Dim sGetVer     As String                         'çÏã∆ÉGÉäÉA
'    Dim lngErrCode As Long
'
'    On Error Resume Next
'    strWork = ""
'
'    ' GATEVER_FILE.INIÇ©ÇÁîªíËIC-MÉfÅ[É^ÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(GATE_TYPE_ICM, _
'                                   GATE_ICM, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_GATEVER_FILE)
'    If lSts > 0 Then
'    strWork = PATH_IDU_APP & PATH_IDU_IC_M & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psIDUVerGet strWork, 31
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(31).Caption = "--------------------"
'    End If
'
'End Function
'
''///////////////////////////////////////////////////////////////////
''//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
''//
''//  ä÷êîñºèÃ  : psICUnchinGetVersion
''//  ã@î\ñºèÃ  : ICã§í â^í¿ÉoÅ[ÉWÉáÉìéÊìæèàóù
''//  ã@î\äTóv  : kansi.iniÉtÉ@ÉCÉãÇÊÇËÅAë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇµÅA
''//              ë„ï\ÉtÉ@ÉCÉãÇÊÇËÉoÅ[ÉWÉáÉìÇéÊìæÇ∑ÇÈÅB
''//
''//              å^        ñºèÃ      à”ñ°
''//  à¯êî      : Ç»Çµ
''//
''//              å^        íl        à”ñ°
''//  ñﬂÇËíl    : Ç»Çµ
''//
''//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
''//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
''//  îıçlÅF
''///////////////////////////////////////////////////////////////////
'Public Function psICUnchinGetVersion()
'    Dim strWork     As String                        'çÏã∆ÉGÉäÉA
'    Dim iFileNumber As Integer                       'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
'    Dim lSts As Long                                 'ä÷êîñﬂÇËíl
'    Dim strVerFileName As String * VERSION_GATE_SIZE 'éÊìæÉtÉ@ÉCÉãñº
'    Dim sGetVer     As String                        'çÏã∆ÉGÉäÉA
'    Dim lngErrCode As Long
'
'    strWork = ""
'
'    ' äƒéãî’ê›íuç\ê¨INIÉtÉ@ÉCÉã(kansi.ini)ÇÊÇËICã§í â^í¿ÉfÅ[É^ÇÃë„ï\ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'    strVerFileName = ""
'    lSts = GetPrivateProfileString(IDU_KANSI_SECTION_NAME, _
'                                   IDU_KANSI_KEY_NAME, _
'                                   DEFAILT, _
'                                   strVerFileName, _
'                                   Len(strVerFileName), _
'                                   PATH_IDU_APP & IDU_KANSI_INI)
'    If lSts > 0 Then
'    strWork = PATH_IDU_APP & PATH_IDU_ICUNCHIN & Left$(strVerFileName, (InStr(strVerFileName, vbNullChar) - 1))
'    psIDUVerGet strWork, 33
'    Else
'      'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'      lblVerName(33).Caption = "--------------------"
'    End If
'
'End Function
'
''///////////////////////////////////////////////////////////////////
''//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
''//
''//  ä÷êîñºèÃ  : psIDUVerGet
''//  ã@î\ñºèÃ  : ë„ï\ÉtÉ@ÉCÉãÇÃÉoÅ[ÉWÉáÉìÇéÊìæ
''//  ã@î\äTóv  : ë„ï\ÉtÉ@ÉCÉãÇÃÉoÅ[ÉWÉáÉìÇéÊìæÇµÅAâÊñ ï\é¶Ç∑ÇÈÅB
''//
''//              å^        ñºèÃ      à”ñ°
''//  à¯êî      : StringÅ@Å@sPathÅ@Å@[IN]ë„ï\ÉtÉ@ÉCÉãñº
''//  Å@Å@      : IntegerÅ@ iIndexÅ@ [IN]ï\é¶ÉCÉìÉfÉbÉNÉXî‘çÜ
''//
''//              å^        íl        à”ñ°
''//  ñﬂÇËíl    : Ç»Çµ
''//
''//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
''//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
''//  îıçlÅF
''///////////////////////////////////////////////////////////////////
'Private Function psIDUVerGet(sPath As String, iCnt As Integer)
'
'    Dim i As Integer                    'ÉJÉEÉìÉ^
'    Dim j As Integer                    'ÉJÉEÉìÉ^
'    Dim sMyName As String               'ÉtÉ@ÉCÉãñº
'    Dim iFileNumber As Integer          'ÉtÉ@ÉCÉãî‘çÜ
'    Dim lLen As Long                    'ÉtÉ@ÉCÉãÉTÉCÉY
'    Dim uFooter As MN_IDU_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
'    Dim lPos As Long                    'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
'    Dim sDateTime As String
'    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
'
'On Error GoTo FileGetError
'
'    If Dir(sPath) <> "" Then            'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?
'
'      lLen = FileLen(sPath)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ
'
'      iFileNumber = FreeFile            'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'
'        'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
'        Open sPath For Binary Access Read As #iFileNumber
'        'ÉtÉbÉ^èÓïÒÇÃéÊìæ
'        Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
'
'        'ÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉìÇï\é¶
'        lblVerName(iCnt).Caption = CStr(uFooter.sDataName) & CStr(uFooter.sVersion)
'        Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
'    Else
'      'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
'      lblVerName(iCnt).Caption = "--------------------"
'    End If
'
'    Exit Function
'FileGetError:
'   'ÅuÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìéÊìæàŸèÌÅvÉçÉOèoóÕ
'   lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'   Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_GETVER_ERROR, lngErrCode)
'   lblVerName(iCnt).Caption = "--------------------"
'   Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
'End Function
'V1.4.0.1 DEL END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psJikiCheck
'//  ã@î\ñºèÃ  : é•ãCâ^í¿ëŒâûÉÜÅ[ÉUÉ`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : HOSHU.INIÇÊÇËÅAé•ãCâ^í¿ëŒâûÉÜÅ[ÉUÇ≈Ç†ÇÈÇ©Ç«Ç§Ç©É`ÉFÉbÉNÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Public Sub psJikiCheck()
    Dim iFlag As Integer 'éÊìæÉÜÅ[ÉUÉtÉâÉO
 
    On Error Resume Next
 
  ' HOSHU.INIÇÊÇËé•ãCâ^í¿ëŒâûÉÜÅ[ÉUÉtÉâÉOÇéÊìæÇ∑ÇÈÅB
    iFlag = GetPrivateProfileInt(KANS_JIKI, _
                                 KANSI_JIKI_FLAG, _
                                 DEFAILT_Int, _
                                 HOSHU_FILE)
     If iFlag = 0 Then
      'ÉtÉâÉOÇ™0ÇÃèÍçáÅué•ãCâ^í¿ÅvñtÇÕîÒï\é¶
      cmdFixedExe(7).Visible = False
     End If
End Sub

'V1.3.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ÅAÉ^ÉCÉÄÉAÉbÉvèàóù
'//  ã@î\äTóv  : ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()
  'ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
    If pfComMailRecieve = ML_ID_HOSHU_ACTIVE_REQ Then
       'ï€éÁâÊñ ÉAÉNÉeÉBÉuóvãÅÇéÛêMÇµÇΩÇÁÅAé©âÊñ ÇëOñ Ç…ï\é¶Ç≥ÇπÇÈÅB
        AppActivate frmVersion.Caption, False
        pfFormActive (frmVersion.hwnd)
    End If
End Sub
'V1.3.0.1 ADD END

'V1.20.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdVer_Output
'//  ã@î\ñºèÃ  : ÅuVeràÍóóÅ@USBèoóÕÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : VeràÍóóÇÃUSBèoóÕÅBÉoÅ[ÉWÉáÉìî}ëÃèoóÕfrmÇÃî}ëÃèoóÕÇ∆ìØàÍèàóù
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Boolean
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V2.0.1.1) 2011-11-21 REVISED BY [TCC] T.Koyama
'//                 ÇdÇfÇQÇOÉtÉFÅ[ÉYÇQëŒâûÅyécåèáÇ54Åz
'//                  ÅEÉoÅ[ÉWÉáÉìàÍóóèoóÕÉtÉ@ÉCÉãñºïœçX
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-21  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅy03ìùçáTR-No.18èCê≥ëŒâûÅz
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function cmdVer_Output() As Boolean
    
    Dim sWriteDir As String                 'î}ëÃèoóÕêÊ
    Dim bRet      As Boolean         'ñﬂÇËíl
    Dim lRetVal   As Long            'ÉeÉLÉXÉgï\é¶èàóùñﬂÇËíl
    Dim sCommand  As String          'ÉRÉ}ÉìÉhï∂éöóÒ
    Dim iResponse As Integer   'MsgBoxñﬂÇËíl
    Dim lngErrCode As Long     'ÉGÉâÅ[ÉRÅ[Éh
    Dim fso         As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim strWriteDir As String               'èoóÕêÊÉtÉHÉãÉ_
' EG20 V2.0.1.1 ADD START
    Dim strStationName As String    ' âwñº
    Dim strSrcName     As String    ' ÉRÉsÅ[å≥ÉtÉ@ÉCÉãÉpÉX
' EG20 V2.0.1.1 ADD END
    
   On Error GoTo COPY_ERROR

    cmdVer_Output = False

    sWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)
    
    If sWriteDir <> "" Then

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_VERSION_KANRI)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
       
       'ÉfÉBÉåÉNÉgÉäÇ™éwíËÇ≥ÇÍÇÍÇŒÅAÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÇéÊèoÇ∑
        bRet = dllEGRCreateVersionFile(PATH_IDU_APP, PATH_LDU_APP)
        If bRet = False Then

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
           'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
           Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
           
           'ÅuÉtÉ@ÉCÉãçÏê¨àŸèÌÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
'           MsgBox "ÉtÉ@ÉCÉãÇÃçÏê¨Ç…é∏îsÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "ÉtÉ@ÉCÉãçÏê¨àŸèÌ"              ' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzçÌèú
           MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbCritical, "VeràÍóóUSBèoóÕ"                                        ' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzí«â¡
           'ÅuÉtÉ@ÉCÉãçÏê¨àŸèÌÅvÉçÉOèoóÕ
           Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, VERSION_OUTPUT_FILE_CREATE_ERROR, 0)

           'ÅuVeràÍóóUSBèoóÕèàóùàŸèÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, VERASION_KANRI_MENU_VER_USB_OUTPUT_ERROR, 0)
            Exit Function
        Else
          'ÉtÉ@ÉCÉãÉRÉsÅ[
' EG20 V2.0.1.1 DEL START
'          FileCopy EGR_KANSI_VERSION_FILE_PATH, sWriteDir & EGR_KANSI_VERSION_FILE
' EG20 V2.0.1.1 DEL END
' EG20 V2.0.1.1 ADD START
          'âwñºéÊìæ
          strStationName = gsGetStationEkiName
          ' ÉRÉsÅ[å≥ÉtÉ@ÉCÉãÉpÉX
          strSrcName = PATH_HOSHU_DATA & EGR_KANSI_VERSION_FILE
          
          FileCopy strSrcName, sWriteDir & strStationName & "_" & EGR_KANSI_VERSION_FILE
' EG20 V2.0.1.1 ADD START
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
          'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
          Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ

          'Åuî}ëÃèoóÕê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
'          MsgBox "î}ëÃèoóÕÇÕê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃèoóÕåãâ "          ' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzçÌèú
          MsgBox "ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "VeràÍóóUSBèoóÕ"                   ' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzí«â¡

          'ÅuVeràÍóóUSBèoóÕèàóùê≥èÌÅvÉçÉOèoóÕ
          Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, VERASION_KANRI_MENU_VER_USB_OUTPUT_OK, 0)
        End If
     Else
         'ÅuVeràÍóóUSBèoóÕèàóùñ¢é¿çsÅvÉçÉOèoóÕ
          Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, VERASION_KANRI_MENU_VER_USB_OUTPUT_MISHORI, 0)
     End If
  cmdVer_Output = True
  
  Exit Function
COPY_ERROR:
   
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
   
   'èàóùàŸèÌÇÃèÍçáÅAèoóÕåãâ É|ÉbÉvÉAÉbÉv(àŸèÌ)ï\é¶
'    MsgBox "î}ëÃèoóÕÇÕàŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbCritical, "î}ëÃèoóÕåãâ "                              ' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzçÌèú
    MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbCritical, "VeràÍóóUSBèoóÕ"                                       ' EG20 V3.6.0.1Åy03ìùçáTR-No.18èCê≥ëŒâûÅzí«â¡
   
   'ÅuVeràÍóóUSBèoóÕèàóùàŸèÌÅvÉçÉOèoóÕ
   lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
   Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, VERASION_KANRI_MENU_VER_USB_OUTPUT_ERROR, lngErrCode)
   cmdVer_Output = False
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2010 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psListVersion
'//  ã@î\ñºèÃ  : ÉäÉXÉgï\é¶
'//  ã@î\äTóv  : ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÇì«Ç›çûÇﬁ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.20.0.1) 2010-03-16   CODED   BY [TCC] S.Yamazaki
'//     REVISIONS :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(EG20 V5.6.0.1) 2012-04-04  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÇhÇbÇlÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉäÉXÉgëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-05-08  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub psListVersion()
    
    Dim iCnt As Integer
    Dim iMax As Integer
    Dim structDispInfo() As DISP_FILE_INFO
    Dim fsoObj As New FileSystemObject  'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim iFileNumber As Integer
    
    Dim sLine As String             '1çsï™ÇÃcsvì«Ç›éÊÇËÉfÅ[É^
    Dim sLineSplit() As String      '1íPåÍÇ∏Ç¬ÇÃcsvì«Ç›éÊÇËÉfÅ[É^
    
    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim sErrEventName As String        'ÉGÉâÅ[Ç™ãNÇ´ÇΩÉCÉxÉìÉgñº
    
    'ÉGÉâÅ[ÉgÉâÉbÉv
    On Error GoTo Err_FILE
    
    'ÉäÉXÉgÉ{ÉbÉNÉXèâä˙âª
    lstKan.Clear
    
    'ë∂ç›É`ÉFÉbÉN
    If fsoObj.FileExists(DISP_VERFILE_FILE) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        GoTo Err_FILE
    End If
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜéÊìæ
    iFileNumber = FreeFile
    
    'ÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
    sErrEventName = LOG_ERR_FILE_OPEN       'ÉtÉ@ÉCÉãÉIÅ[ÉvÉìàŸèÌ
    Open DISP_VERFILE_FILE For Input As #iFileNumber
    
    iCnt = 0
    
    sErrEventName = LOG_ERR_FILE_READ       'ÉtÉ@ÉCÉãì«çûàŸèÌ
    Do While Not EOF(iFileNumber)
        
        'ÇP çsÇ√Ç¬ïœêîì«Ç›çûÇ›
        Line Input #iFileNumber, sLine
        
        'ÉRÉÅÉìÉgçsÇ∆ãÛçsÇ∂Ç·Ç»ÇØÇÍÇŒ§óÃàÊÇ…äiî[
        If Trim(Left(sLine, 1)) <> CSV_COMMENT_CHAR And sLine <> "" Then
            
            sLineSplit = Split(sLine, ",")
            
'            If UBound(sLineSplit) = 3 Then                           ' EG20 V5.6.0.1çÌèú
            If UBound(sLineSplit) = 4 Then                            ' EG20 V5.6.0.1í«â¡
            
                ReDim Preserve structDispInfo(iCnt)
                
                structDispInfo(iCnt).sTitle = sLineSplit(0)
                structDispInfo(iCnt).sFilePath = sLineSplit(1)
                structDispInfo(iCnt).iType = sLineSplit(2)
                structDispInfo(iCnt).iIdu = sLineSplit(3)
                structDispInfo(iCnt).iMaker = sLineSplit(4)           ' EG20 V5.6.0.1í«â¡
                
                iCnt = iCnt + 1
                
            End If
            
        End If
    Loop
    
    'ÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    sErrEventName = LOG_ERR_FILE_CLOSE      'ÉtÉ@ÉCÉãÉNÉçÅ[ÉYàŸèÌ
    Close #iFileNumber
    
    iMax = iCnt - 1
    
    'ï\é¶ë„ï\ÉtÉ@ÉCÉãÇÃÉGÉâÅ[ÉgÉâÉbÉvÅiÉGÉâÅ[Ç™Ç†Ç¡ÇƒÇ‡èàóùÇÕë±Ç≠Åj
    On Error Resume Next
    
    'IDUèkëﬁÉ`ÉFÉbÉN
    Call psIDUCheck
    
    For iCnt = 0 To iMax
        
        'èkëﬁã@î\ÉtÉâÉOÇ™Ç»ÇµÅAÇ‹ÇΩÇÕèkëﬁíÜÇ≈ÇÕÇ»Ç¢Ç∆Ç´ÇÃÇ›èàóùÇçsÇ§
        If structDispInfo(iCnt).iIdu = 0 Or pbIDUSts = 0 Then
        
            Select Case structDispInfo(iCnt).iType
                Case 1
                    Call psListVersion_Type1(structDispInfo(iCnt))
                Case 2
                    Call psListVersion_Type2(structDispInfo(iCnt))
' EG20 V2.1.0.1[Mainte_03_01]í«â¡äJén
                Case 3
                    Call psListVersion_Type3(structDispInfo(iCnt))
' EG20 V2.1.0.1[Mainte_03_01]í«â¡èIóπ
'EG20 V30.1.0.1 ADD START
                Case 4
                    Call psListVersion_Type4(structDispInfo(iCnt))
'EG20 V30.1.0.1 ADD END
                Case Else
                    'èàóùÇ»Çµ
            End Select
        End If
    Next
    
    Set fsoObj = Nothing

    Exit Sub

Err_FILE:

    'àŸèÌÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, sErrEventName, lngErrCode)
    'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
    Call psFileNameGet(DISP_VERFILE_FILE, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
    
    'ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    
    Set fsoObj = Nothing

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2010 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psListVersion_Type1
'//  ã@î\ñºèÃ  : ÉäÉXÉgï\é¶
'//  ã@î\äTóv  : ï\é¶É^ÉCÉvÇPÇÃï\é¶ÇçsÇ§Åiäƒéãî’ÅARYTÅj
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.20.0.1) 2010-03-16   CODED   BY [TCC] S.Yamazaki
'//     REVISIONS :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(EG20 V6.1.0.1) 2012-06-09  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÉoÅ[ÉWÉáÉìï\é¶ïsê≥ëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub psListVersion_Type1(structDispInfo As DISP_FILE_INFO)
    
    Dim lLen As Long
    Dim sDateTime As String
    Dim j As Integer
    Dim uFooter As MN_FOOT              'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
    Dim sTitle As String                'å„ÇÎãÛîíñÑÇﬂÇµÇΩÉ^ÉCÉgÉã
    Dim sDisp As String                 'ï\é¶óp
    Dim fsoObj As New FileSystemObject  'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim iFileNumber As Integer

    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim sErrEventName As String        'ÉGÉâÅ[Ç™ãNÇ´ÇΩÉCÉxÉìÉgñº

    Dim bRet As Boolean                 ' ñﬂÇËíl
    Dim szFileName As String            ' ÉtÉ@ÉCÉãñº
    Dim uVersion As MN_VERSION_JIKAI    ' ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉA

    'ÉGÉâÅ[ÉgÉâÉbÉv
    On Error GoTo Err_FILE

    'É^ÉCÉgÉãÇÃâ¡çH
    sTitle = structDispInfo.sTitle
    'É^ÉCÉgÉãå„ÇÃÉXÉyÅ[ÉXÅiëSäpÇÃâ¬î\ê´Ç™Ç†ÇÈÇÃÇ≈FormatÇÕégÇ¶Ç»Ç¢Åj
    If LenB(StrConv(sTitle, vbFromUnicode)) < 24 Then
        sTitle = sTitle & Space(24 - LenB(StrConv(sTitle, vbFromUnicode))) & Space(2)
    Else
        sTitle = sTitle & Space(2)
    End If

    'ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
    If fsoObj.FolderExists(structDispInfo.sFilePath) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If

    ' ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇÃçÏê¨
    bRet = fReadFileList(structDispInfo.sFilePath & "\" & MN_FILELIST)
    If bRet <> True Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If

    szFileName = structDispInfo.sFilePath & "\" & FileList(0)   ' ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
    If fsoObj.FileExists(szFileName) = True Then                ' ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?
        lLen = FileLen(szFileName)                              ' ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ

        iFileNumber = FreeFile                                  ' ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

        Open szFileName For Binary Access Read As #iFileNumber  ' ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
        Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter      ' ÉtÉbÉ^èÓïÒÇÃéÊìæ
        uVersion.sFileName = UCase(FileListType(0))             ' ÉtÉ@ÉCÉãñºÇëÂï∂éöÇ…ÇµÇƒÉZÉbÉg
        uVersion.sMachineName = uFooter.sKisyu                  ' ã@éÌñºÉZÉbÉg
        uVersion.sFooterFile = uFooter.sFileName                ' ÉtÉ@ÉCÉãñºÉZÉbÉg

        sDateTime = ""
        For j = 0 To 3
            sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
        Next
        sDateTime = sDateTime & " "
        For j = 4 To 5
            sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
        Next
        uVersion.sFileDate = sDateTime
        uVersion.sVersion = uFooter.sVersion                    ' ÉoÅ[ÉWÉáÉìèÓïÒÉZÉbÉg
        uVersion.sComment = uFooter.sHyoji                      ' ï\é¶ï∂éöóÒÉZÉbÉg

        Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
    End If
    
    'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉAÇÃägí£
    sDisp = sTitle                                                                  ' É^ÉCÉgÉã
'    sDisp = sDisp & Format(Right(FileList(0), 12), "!@@@@@@@@@@@@") & Space(11)     ' ÉtÉ@ÉCÉãñº   ' EG20 V6.1.0.1çÌèú
    sDisp = sDisp & Format(Right(FileList(0), 12), "!@@@@@@@@@@@@") & Space(7)      ' ÉtÉ@ÉCÉãñº    ' EG20 V6.1.0.1í«â¡
    sDisp = sDisp & uFooter.sKisyu & Space(1)                                       ' ã@éÌñº
    sDisp = sDisp & uFooter.sFileName & Space(2)                                    ' ÉtÉ@ÉCÉã
    sDisp = sDisp & sDateTime & Space(1)                                            ' çÏê¨ì˙éû
    sDisp = sDisp & uFooter.sVersion                                                ' ÉoÅ[ÉWÉáÉì
    lstKan.AddItem (sDisp)

    sDisp = StrConv(MidB(StrConv(uFooter.sHyoji, vbFromUnicode), 1, 32), vbUnicode)     ' ÉRÉÅÉìÉg1
    lstKan.AddItem (Space(45) & sDisp)

    sDisp = StrConv(MidB(StrConv(uFooter.sHyoji, vbFromUnicode), 33, 64), vbUnicode)    ' ÉRÉÅÉìÉg2
    lstKan.AddItem (Space(45) & sDisp)

    Set fsoObj = Nothing
    Exit Sub
    
Err_FILE:

    'àŸèÌÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, sErrEventName, lngErrCode)
    'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)

    'ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If

    'àŸèÌópï\é¶
' EG20 V6.1.0.1çÌèúäJén
'    lstKan.AddItem (sTitle & "------------           -------- --------  -------- ---- --")
' EG20 V6.1.0.1çÌèúèIóπ
' EG20 V6.1.0.1í«â¡äJén
    lstKan.AddItem (sTitle & "------------       -------- --------  -------- ---- --")
' EG20 V6.1.0.1í«â¡èIóπ
    lstKan.AddItem (Space(45) & "--------------------------------")
    lstKan.AddItem (Space(45) & "--------------------------------")

    Set fsoObj = Nothing

End Sub

' EG20 V2.1.0.1[Mainte_03_01]çÌèúäJénÅiï\é¶ì‡óeïœçXÅj
'Private Sub psListVersion_Type1(structDispInfo As DISP_FILE_INFO)
'
'    Dim lLen As Long
'    Dim sDateTime As String
'    Dim j As Integer
'    Dim uFooter As MN_FOOT              'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
'    Dim sTitle As String                'å„ÇÎãÛîíñÑÇﬂÇµÇΩÉ^ÉCÉgÉã
'    Dim sDisp As String                 'ï\é¶óp
'    Dim sDispFile As String             'çÏã∆óp
'    Dim sDispExe As String              'ägí£éq
'    Dim fsoObj As New FileSystemObject  'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
'    Dim iFileNumber As Integer
'
'    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
'    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
'    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh
'    Dim sErrEventName As String        'ÉGÉâÅ[Ç™ãNÇ´ÇΩÉCÉxÉìÉgñº
'
'    'ÉGÉâÅ[ÉgÉâÉbÉv
'    On Error GoTo Err_FILE
'
'    'É^ÉCÉgÉãÇÃâ¡çH
'    sTitle = structDispInfo.sTitle
'    'É^ÉCÉgÉãå„ÇÃÉXÉyÅ[ÉXÅiëSäpÇÃâ¬î\ê´Ç™Ç†ÇÈÇÃÇ≈FormatÇÕégÇ¶Ç»Ç¢Åj
'    If LenB(StrConv(sTitle, vbFromUnicode)) < 20 Then
'        sTitle = sTitle & Space(20 - LenB(StrConv(sTitle, vbFromUnicode))) & Space(2)
'    Else
'        sTitle = sTitle & Space(2)
'    End If
'
'    'ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
'    If fsoObj.FileExists(structDispInfo.sFilePath) = False Then
'        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
'        'àŸèÌ
'        GoTo Err_FILE
'    End If
'
'    lLen = FileLen(structDispInfo.sFilePath)              'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ
'    If lLen < Len(uFooter) Then
'        sErrEventName = LOG_ERR_FILE_LENGTH     'ÉtÉ@ÉCÉãÉåÉìÉOÉXàŸèÌ
'        'àŸèÌ
'        GoTo Err_FILE
'    End If
'
'    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜéÊìæ
'    iFileNumber = FreeFile
'
'    'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
'    sErrEventName = LOG_ERR_FILE_OPEN       'ÉtÉ@ÉCÉãÉIÅ[ÉvÉìàŸèÌ
'    Open structDispInfo.sFilePath For Binary Access Read As #iFileNumber
'
'        sErrEventName = LOG_ERR_FILE_READ       'ÉtÉ@ÉCÉãì«çûàŸèÌ
'        'ÉtÉbÉ^èÓïÒÇÃéÊìæ
'        Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
'
'    sErrEventName = LOG_ERR_FILE_CLOSE      'ÉtÉ@ÉCÉãÉNÉçÅ[ÉYàŸèÌ
'    Close #iFileNumber      'ÉtÉ@ÉCÉãÇÃÉNÉçÅ[ÉY
'
'    'çÏê¨ì˙éûÇÃâ¡çH
'    sDateTime = ""
'    For j = 0 To 3
'        sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
'    Next
'    sDateTime = sDateTime & " "
'    For j = 4 To 5
'        sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
'    Next
'
'    'ÉtÉ@ÉCÉãñºÇÃâ¡çH
'    Call psFileNameGet(structDispInfo.sFilePath, sDispFile, sDispExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
'    sDispFile = UCase(sDispFile & "." & sDispExe)                                 'ägí£éqÇåãçáÇµëÂï∂éöÇ…ïœä∑
'
'    'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉAÇÃägí£
'    sDisp = sTitle                                                                  'É^ÉCÉgÉã
'    sDisp = sDisp & Format(Right(sDispFile, 12), "!@@@@@@@@@@@@") & Space(11)       'ÉtÉ@ÉCÉãñº
'    sDisp = sDisp & uFooter.sKisyu & Space(1)                                       'ã@éÌñº
'    sDisp = sDisp & uFooter.sFileName & Space(2)                                    'ÉtÉ@ÉCÉã
'    sDisp = sDisp & sDateTime & Space(1)                                            'çÏê¨ì˙éû
'    sDisp = sDisp & uFooter.sVersion                                                'ÉoÅ[ÉWÉáÉì
'    lstKan.AddItem (sDisp)
'
'    sDisp = StrConv(MidB(StrConv(uFooter.sHyoji, vbFromUnicode), 1, 32), vbUnicode)     'ÉRÉÅÉìÉg1
'    lstKan.AddItem (Space(45) & sDisp)
'
'    sDisp = StrConv(MidB(StrConv(uFooter.sHyoji, vbFromUnicode), 33, 64), vbUnicode)    'ÉRÉÅÉìÉg2
'    lstKan.AddItem (Space(45) & sDisp)
'
'    Set fsoObj = Nothing
'
'    Exit Sub
'Err_FILE:
'
'    'àŸèÌÉçÉOèoóÕ
'    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
'    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, sErrEventName, lngErrCode)
'    'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
'    Call psFileNameGet(structDispInfo.sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
'    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
'
'    'ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
'    If iFileNumber > 0 Then
'        Close #iFileNumber
'    End If
'
'    'àŸèÌópï\é¶
'    lstKan.AddItem (sTitle & "------------           -------- --------  -------- ---- --")
'    lstKan.AddItem (Space(45) & "--------------------------------")
'    lstKan.AddItem (Space(45) & "--------------------------------")
'
'    Set fsoObj = Nothing
'
'End Sub
' EG20 V2.1.0.1[Mainte_03_01]çÌèúèIóπ

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2010 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psListVersion_Type2
'//  ã@î\ñºèÃ  : ÉäÉXÉgï\é¶
'//  ã@î\äTóv  : ï\é¶É^ÉCÉvÇQÇÃï\é¶ÇçsÇ§ÅiIDUÅj
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.20.0.1) 2010-03-16   CODED   BY [TCC] S.Yamazaki
'//     REVISIONS :(EG20 V5.6.0.1) 2012-04-04  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÇhÇbÇlÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉäÉXÉgëŒâûÅz
'//     REVISIONS :(EG20 V6.1.0.1) 2012-06-09  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÉoÅ[ÉWÉáÉìï\é¶ïsê≥ëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub psListVersion_Type2(structDispInfo As DISP_FILE_INFO)

    Dim lLen As Long
    Dim sDateTime As String
    Dim j As Integer
    Dim uFooter As MN_IDU_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
    Dim sTitle As String                'å„ÇÎãÛîíñÑÇﬂÇµÇΩÉ^ÉCÉgÉã
    Dim sDisp As String                 'ï\é¶óp
    Dim sDispFile As String             'çÏã∆ópÅiÉtÉ@ÉCÉãï\é¶ópÅj
    Dim sDispDV As String               'çÏã∆ópÅiÉfÅ[É^Å{ÉoÅ[ÉWÉáÉìÅj
    Dim sDispCom As String              'çÏã∆ópÅiÉRÉÅÉìÉgÅj
    Dim sDispExe As String              'ägí£éq
    Dim fsoObj As New FileSystemObject  'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim iFileNumber As Integer
    
    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim sErrEventName As String        'ÉGÉâÅ[Ç™ãNÇ´ÇΩÉCÉxÉìÉgñº

' EG20 V5.6.0.1 í«â¡äJén
    Dim bRet As Boolean                 ' ñﬂÇËíl
    Dim szFilelist As String            ' ÉtÉ@ÉCÉãÉäÉXÉgñº
    Dim szFileName As String            ' ÉtÉ@ÉCÉãñº
' EG20 V5.6.0.1 í«â¡èIóπ
    
    'ÉGÉâÅ[ÉgÉâÉbÉv
    On Error GoTo Err_FILE
    
    'ÉpÉXÇçÏÇËíºÇµ
    structDispInfo.sFilePath = PATH_IDU_APP & "\" & structDispInfo.sFilePath

    'É^ÉCÉgÉãÇÃâ¡çH
    sTitle = structDispInfo.sTitle
    'É^ÉCÉgÉãå„ÇÃÉXÉyÅ[ÉXÅiëSäpÇÃâ¬î\ê´Ç™Ç†ÇÈÇÃÇ≈FormatÇÕégÇ¶Ç»Ç¢Åj
    If LenB(StrConv(sTitle, vbFromUnicode)) < 24 Then
        sTitle = sTitle & Space(24 - LenB(StrConv(sTitle, vbFromUnicode))) & Space(2)
    Else
        sTitle = sTitle & Space(2)
    End If

' EG20 V5.6.0.1 í«â¡äJén

    ' ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇÃçÏê¨
    szFilelist = structDispInfo.sFilePath & "\FILELIST_" & Format(structDispInfo.iMaker, "00") & ".TXT"

    ' ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
    If fsoObj.FileExists(szFilelist) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If

    bRet = fReadFileListIDU(szFilelist)
    If bRet <> True Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If
    structDispInfo.sFilePath = structDispInfo.sFilePath & "\" & FileList(0)   ' ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ

' EG20 V5.6.0.1 í«â¡èIóπ
    
    '--------------------------------------------
    'ÉtÉ@ÉCÉãèÓïÒéÊìæ
    '--------------------------------------------
    'ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
    If fsoObj.FileExists(structDispInfo.sFilePath) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If
    
    lLen = FileLen(structDispInfo.sFilePath)              'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ
    If lLen < Len(uFooter) Then
        sErrEventName = LOG_ERR_FILE_LENGTH     'ÉtÉ@ÉCÉãÉåÉìÉOÉXàŸèÌ
        'àŸèÌ
        GoTo Err_FILE
    End If
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜéÊìæ
    iFileNumber = FreeFile
    
    'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
    sErrEventName = LOG_ERR_FILE_OPEN       'ÉtÉ@ÉCÉãÉIÅ[ÉvÉìàŸèÌ
    Open structDispInfo.sFilePath For Binary Access Read As #iFileNumber
    
        sErrEventName = LOG_ERR_FILE_READ       'ÉtÉ@ÉCÉãì«çûàŸèÌ
        'ÉtÉbÉ^èÓïÒÇÃéÊìæ
        Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
        
    sErrEventName = LOG_ERR_FILE_CLOSE      'ÉtÉ@ÉCÉãÉNÉçÅ[ÉYàŸèÌ
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇÃÉNÉçÅ[ÉY
    
    '--------------------------------------------
    'ÉoÅ[ÉWÉáÉìèÓïÒï\é¶ïîÇÃï\é¶ÉeÉLÉXÉgçÏê¨
    '--------------------------------------------
    'É^ÉCÉgÉã
    sDisp = sTitle
    
    'ÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sDispFile, sDispExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    sDispFile = sDispFile & "." & sDispExe                                        'ägí£éqÇåãçáÇµëÂï∂éöÇ…ïœä∑
'    sDisp = sDisp & Format(Right(sDispFile, 12), "!@@@@@@@@@@@@") & Space(11)      ' EG20 V6.1.0.1çÌèú
    sDisp = sDisp & Format(Right(sDispFile, 12), "!@@@@@@@@@@@@") & Space(7)        ' EG20 V6.1.0.1í«â¡

    'éÌï 
    sDisp = sDisp & LCase(Right$("0" & Hex(uFooter.bSyubetu), 2))
    
    'ÉÅÅ[ÉJñº
    sDisp = sDisp & uFooter.sMakerName & Space(2)
    
    'ÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉì
    sDispDV = LTrim(uFooter.sDataName) & uFooter.sVersion
    If Len(Trim(uFooter.sDataName)) = 0 And Len(Trim(uFooter.sVersion)) <> 0 Then
        sDisp = sDisp & Left(Trim(uFooter.sVersion) & Space(20), 20) & Space(2)
    ElseIf Len(Trim(uFooter.sDataName & uFooter.sVersion)) <> 0 Then
        sDisp = sDisp & Left(sDispDV & Space(20), 20) & Space(2)
    Else
        sDisp = sDisp & String(20, "-") & Space(2)
    End If
    
    'çÏê¨ì˙éû
    sDateTime = ""
    For j = 0 To 5
        sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
    Next
    sDateTime = Format(sDateTime, "@@@@/@@/@@ @@:@@")
    sDisp = sDisp & sDateTime
    
    'ÉäÉXÉgÇ…í«â¡
    lstKan.AddItem (sDisp)
    
    'ÉRÉÅÉìÉg
    '60ï∂éöÇ≈ï€ë∂Ç≥ÇÍÇƒÇ¢ÇÈÇÃÇ≈ÅA60ÉoÉCÉgÇÃóÃàÊÇ…íºÇ∑ÅBëOå„ÇÃãÛîíÇéÊÇÈÅB
    sDispCom = Trim(StrConv(MidB(StrConv(uFooter.sHyoji, vbFromUnicode), 1, 60), vbUnicode))
    
    sDisp = StrConv(MidB(StrConv(sDispCom, vbFromUnicode), 1, 32), vbUnicode)     'ÉRÉÅÉìÉg1
    If Len(Trim(sDisp)) <> 0 Then
        lstKan.AddItem (Space(45) & sDisp)
    Else
        lstKan.AddItem (Space(45) & String(32, "-"))
    End If
    
    sDisp = StrConv(MidB(StrConv(sDispCom, vbFromUnicode), 33, 60), vbUnicode)    'ÉRÉÅÉìÉg2
    If Len(Trim(sDisp)) <> 0 Then
        lstKan.AddItem (Space(45) & sDisp)
    End If
    
    Set fsoObj = Nothing
    
    Exit Sub
Err_FILE:
    
    'àŸèÌÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, sErrEventName, lngErrCode)
    'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
    
    'ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    
    'àŸèÌópï\é¶
' EG20 V6.1.0.1çÌèúäJén
'    lstKan.AddItem (sTitle & "------------           ---  --------------------  ----/--/-- --:--")
' EG20 V6.1.0.1çÌèúèIóπ
' EG20 V6.1.0.1í«â¡äJén
    lstKan.AddItem (sTitle & "------------       ---  --------------------  ----/--/-- --:--")
' EG20 V6.1.0.1í«â¡èIóπ
    lstKan.AddItem (Space(45) & "--------------------------------")
    lstKan.AddItem (Space(45) & "--------------------------------")

    Set fsoObj = Nothing

End Sub
'V1.20.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psListVersion_Type3
'//  ã@î\ñºèÃ  : ÉäÉXÉgï\é¶
'//  ã@î\äTóv  : ï\é¶É^ÉCÉvÇRÇÃï\é¶ÇçsÇ§ÅiëÄçÏëÏÅj
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//     REVISIONS :(EG20 V5.0.2.1) 2012-03-10  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyåãçáTR-No.56èCê≥ëŒâûÅz
'//     REVISIONS :(EG20 V6.1.0.1) 2012-06-09  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÉoÅ[ÉWÉáÉìï\é¶ïsê≥ëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub psListVersion_Type3(structDispInfo As DISP_FILE_INFO)

'    Dim lLen As Long                                                 ' EG20 V5.0.2.1çÌèú
'    Dim sDateTime As String                                          ' EG20 V5.0.2.1çÌèú
'    Dim j As Integer                                                 ' EG20 V5.0.2.1çÌèú
'    Dim uFooter As MN_IDU_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA        ' EG20 V5.0.2.1çÌèú
    Dim sTitle As String                'å„ÇÎãÛîíñÑÇﬂÇµÇΩÉ^ÉCÉgÉã
    Dim sDisp As String                 'ï\é¶óp
    Dim sDispFile As String             'çÏã∆ópÅiÉtÉ@ÉCÉãï\é¶ópÅj
'    Dim sDispCom As String              'çÏã∆ópÅiÉRÉÅÉìÉgÅj          ' EG20 V5.0.2.1çÌèú
    Dim sDispExe As String              'ägí£éq
    Dim fsoObj As New FileSystemObject  'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
'    Dim iFileNumber As Integer                                       ' EG20 V5.0.2.1çÌèú
    
    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim sErrEventName As String        'ÉGÉâÅ[Ç™ãNÇ´ÇΩÉCÉxÉìÉgñº
    
'    Dim FsoRead As TextStream                                        ' EG20 V5.0.2.1çÌèú
'    Dim bFileOpen As Boolean            ' ÉIÅ[ÉvÉìÉtÉâÉO             ' EG20 V5.0.2.1çÌèú
'    Dim strBuffer As String             ' ÉäÅ[ÉhÉoÉbÉtÉ@             ' EG20 V5.0.2.1çÌèú
    Dim strVersion As String            ' ÉoÅ[ÉWÉáÉìï∂éöóÒ

' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzí«â¡äJén
    Dim lSts As Long                                       'ä÷êîñﬂÇËíl
    Dim strKansiVersion2 As String * VERSION_GATE_SIZE     'äƒéãëïíuëSëÃÉoÅ[ÉWÉáÉì
' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzí«â¡èIóπ

    
    'ÉGÉâÅ[ÉgÉâÉbÉv
    On Error GoTo Err_FILE
    
    ' èâä˙âª
'    bFileOpen = False                                                ' EG20 V5.0.2.1çÌèú
    
    
    'É^ÉCÉgÉãÇÃâ¡çH
    sTitle = structDispInfo.sTitle
    'É^ÉCÉgÉãå„ÇÃÉXÉyÅ[ÉXÅiëSäpÇÃâ¬î\ê´Ç™Ç†ÇÈÇÃÇ≈FormatÇÕégÇ¶Ç»Ç¢Åj
    If LenB(StrConv(sTitle, vbFromUnicode)) < 24 Then
        sTitle = sTitle & Space(24 - LenB(StrConv(sTitle, vbFromUnicode))) & Space(2)
    Else
        sTitle = sTitle & Space(2)
    End If
    
    '--------------------------------------------
    'ÉtÉ@ÉCÉãèÓïÒéÊìæ
    '--------------------------------------------
    'ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
    If fsoObj.FileExists(structDispInfo.sFilePath) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If
    
' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzçÌèúäJén
'    Set FsoRead = fsoObj.OpenTextFile(structDispInfo.sFilePath, ForReading)
'    bFileOpen = True
'    ' ÉtÉ@ÉCÉãÇ©ÇÁÇPçsÉäÅ[Éh
'    strBuffer = FsoRead.ReadLine
'    strVersion = Trim(strBuffer)
'
'    FsoRead.Close
'    Set FsoRead = Nothing
'    Set fsoObj = Nothing
' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzçÌèúèIóπ

' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzí«â¡äJén
    Set fsoObj = Nothing
    strKansiVersion2 = ""
    strVersion = ""
    ' KansiVersion.iniÇ©ÇÁëÄçÏëÏÇÃëSëÃÉoÅ[ÉWÉáÉìÇéÊìæÇµï\é¶Ç∑ÇÈ
    lSts = GetPrivateProfileString(KANSIVERSION_SECTION_NAME, _
                                   KANSIVERSION_KEY_NAME, _
                                   DEFAILT, _
                                   strKansiVersion2, _
                                   Len(strKansiVersion2), _
                                   structDispInfo.sFilePath)
     If lSts > 0 Then
        'éÊìæÇµÇΩÉoÅ[ÉWÉáÉìî‘çÜÇï\é¶
        strVersion = Left$(strKansiVersion2, lSts)
    End If

' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzí«â¡èIóπ

    '--------------------------------------------
    'ÉoÅ[ÉWÉáÉìèÓïÒï\é¶ïîÇÃï\é¶ÉeÉLÉXÉgçÏê¨
    '--------------------------------------------
    'É^ÉCÉgÉã
    sDisp = sTitle
    
    'ÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sDispFile, sDispExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    
    sDispFile = sDispFile & "." & sDispExe                                        'ägí£éqÇåãçáÇµëÂï∂éöÇ…ïœä∑
    
' EG20 V5.0.2.1ÅyÉtÉ@ÉCÉãñºÇÕï\é¶ÇµÇ»Ç¢ÅzçÌèúäJén
'    sDisp = sDisp & Format(Right(sDispFile, 12), "!@@@@@@@@@@@@") & Space(11)
' EG20 V5.0.2.1ÅyÉtÉ@ÉCÉãñºÇÕï\é¶ÇµÇ»Ç¢ÅzçÌèúèIóπ
' EG20 V5.0.2.1ÅyÉtÉ@ÉCÉãñºÇÕï\é¶ÇµÇ»Ç¢Åzí«â¡äJén
'    sDisp = sDisp & Space(12) & Space(11)                                       ' EG20 V6.1.0.1çÌèú
    sDisp = sDisp & Space(12) & Space(7)                                         ' EG20 V6.1.0.1í«â¡
' EG20 V5.0.2.1ÅyÉtÉ@ÉCÉãñºÇÕï\é¶ÇµÇ»Ç¢Åzí«â¡èIóπ

    'ÉoÅ[ÉWÉáÉì
    If Len(strVersion) <> 0 Then
        sDisp = sDisp & Format(Left(strVersion, 11), "!@@@@@@@@@@@")
    Else
        sDisp = sDisp & "--.--.--.--"
    End If
    
    'ÉäÉXÉgÇ…í«â¡
    lstKan.AddItem (sDisp)
    
    Exit Sub
Err_FILE:
    
    'àŸèÌÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, sErrEventName, lngErrCode)
    'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
    
    'àŸèÌópï\é¶
'    lstKan.AddItem (sTitle & "                       --.--.--.--")             ' EG20 V6.1.0.1çÌèú
    lstKan.AddItem (sTitle & "                   --.--.--.--")                  ' EG20 V6.1.0.1í«â¡
' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzçÌèúäJén
'    If bFileOpen = True Then
'        FsoRead.Close
'    End If
'    Set FsoRead = Nothing
' EG20 V5.0.2.1ÅyåãçáTR-No.56èCê≥ëŒâûÅzçÌèúèIóπ
    Set fsoObj = Nothing

End Sub
'EG20 V30.1.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2014 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psListVersion_Type4
'//  ã@î\ñºèÃ  : ÉäÉXÉgï\é¶
'//  ã@î\äTóv  : ï\é¶É^ÉCÉvÇSÇÃï\é¶ÇçsÇ§Åiä≤ê¸é©â¸Åj
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V30.1.0.1) 2014-05-08   CODED   BY [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub psListVersion_Type4(structDispInfo As DISP_FILE_INFO)

    Dim lLen As Long
    Dim sDateTime As String
    Dim j As Integer
    Dim uFooter As MN_IDU_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA(êVä≤ê¸â¸éDã@ÇÕIDUÇÃÉtÉbÉ^ÉtÉHÅ[É}ÉbÉgÇ∆ìØÇ∂Ç»ÇÃÇ≈Åj
    Dim sTitle As String                'å„ÇÎãÛîíñÑÇﬂÇµÇΩÉ^ÉCÉgÉã
    Dim sDisp As String                 'ï\é¶óp
    Dim sDispFile As String             'çÏã∆ópÅiÉtÉ@ÉCÉãï\é¶ópÅj
    Dim sDispDV As String               'çÏã∆ópÅiÉfÅ[É^Å{ÉoÅ[ÉWÉáÉìÅj
    Dim sDispCom As String              'çÏã∆ópÅiÉRÉÅÉìÉgÅj
    Dim sDispExe As String              'ägí£éq
    Dim fsoObj As New FileSystemObject  'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim iFileNumber As Integer
    
    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim sErrEventName As String        'ÉGÉâÅ[Ç™ãNÇ´ÇΩÉCÉxÉìÉgñº

    Dim bRet As Boolean                 ' ñﬂÇËíl
    
    'ÉGÉâÅ[ÉgÉâÉbÉv
    On Error GoTo Err_FILE
    
    'É^ÉCÉgÉãÇÃâ¡çH
    sTitle = structDispInfo.sTitle
    'É^ÉCÉgÉãå„ÇÃÉXÉyÅ[ÉXÅiëSäpÇÃâ¬î\ê´Ç™Ç†ÇÈÇÃÇ≈FormatÇÕégÇ¶Ç»Ç¢Åj
    If LenB(StrConv(sTitle, vbFromUnicode)) < 24 Then
        sTitle = sTitle & Space(24 - LenB(StrConv(sTitle, vbFromUnicode))) & Space(2)
    Else
        sTitle = sTitle & Space(2)
    End If

    ' ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
    If fsoObj.FolderExists(structDispInfo.sFilePath) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If

    bRet = fReadFileList(structDispInfo.sFilePath & "\" & MN_FILELIST)
    If bRet <> True Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If
    structDispInfo.sFilePath = structDispInfo.sFilePath & "\" & FileList(0)   ' ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ

    '--------------------------------------------
    'ÉtÉ@ÉCÉãèÓïÒéÊìæ
    '--------------------------------------------
    'ÉtÉ@ÉCÉãÇÃë∂ç›É`ÉFÉbÉNÅBàŸèÌéûÇÕ----ÇÃï\é¶
    If fsoObj.FileExists(structDispInfo.sFilePath) = False Then
        sErrEventName = LOG_ERR_FILE_NOTING     'ÉtÉ@ÉCÉãñ≥Çµ
        'àŸèÌ
        GoTo Err_FILE
    End If
    
    lLen = FileLen(structDispInfo.sFilePath)              'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ
    If lLen < Len(uFooter) Then
        sErrEventName = LOG_ERR_FILE_LENGTH     'ÉtÉ@ÉCÉãÉåÉìÉOÉXàŸèÌ
        'àŸèÌ
        GoTo Err_FILE
    End If
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜéÊìæ
    iFileNumber = FreeFile
    
    'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
    sErrEventName = LOG_ERR_FILE_OPEN       'ÉtÉ@ÉCÉãÉIÅ[ÉvÉìàŸèÌ
    Open structDispInfo.sFilePath For Binary Access Read As #iFileNumber
    
        sErrEventName = LOG_ERR_FILE_READ       'ÉtÉ@ÉCÉãì«çûàŸèÌ
        'ÉtÉbÉ^èÓïÒÇÃéÊìæ
        Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
        
    sErrEventName = LOG_ERR_FILE_CLOSE      'ÉtÉ@ÉCÉãÉNÉçÅ[ÉYàŸèÌ
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇÃÉNÉçÅ[ÉY
    
    '--------------------------------------------
    'ÉoÅ[ÉWÉáÉìèÓïÒï\é¶ïîÇÃï\é¶ÉeÉLÉXÉgçÏê¨
    '--------------------------------------------
    'É^ÉCÉgÉã
    sDisp = sTitle
    
    'ÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sDispFile, sDispExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    sDispFile = sDispFile & "." & sDispExe                                        'ägí£éqÇåãçáÇµëÂï∂éöÇ…ïœä∑
    sDisp = sDisp & Format(Right(sDispFile, 12), "!@@@@@@@@@@@@") & Space(7)

    'éÌï 
    sDisp = sDisp & LCase(Right$("0" & Hex(uFooter.bSyubetu), 2))
    
    'ÉÅÅ[ÉJñº
    sDisp = sDisp & uFooter.sMakerName & Space(2)
    
    'ÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉì
    uFooter.sDataName = Replace(uFooter.sDataName, vbNullChar, Space(1))
    sDispDV = LTrim(uFooter.sDataName) & uFooter.sVersion
    If Len(Trim(uFooter.sDataName)) = 0 And Len(Trim(uFooter.sVersion)) <> 0 Then
        sDisp = sDisp & Left(Trim(uFooter.sVersion) & Space(20), 20) & Space(2)
    ElseIf Len(Trim(uFooter.sDataName & uFooter.sVersion)) <> 0 Then
        sDisp = sDisp & Left(sDispDV & Space(20), 20) & Space(2)
    Else
        sDisp = sDisp & String(20, "-") & Space(2)
    End If
    
    'çÏê¨ì˙éû
    sDateTime = ""
    For j = 0 To 5
        sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
    Next
    sDateTime = Format(sDateTime, "@@@@/@@/@@ @@:@@")
    sDisp = sDisp & sDateTime
    
    'ÉäÉXÉgÇ…í«â¡
    lstKan.AddItem (sDisp)
    
    'ÉRÉÅÉìÉg
    '60ï∂éöÇ≈ï€ë∂Ç≥ÇÍÇƒÇ¢ÇÈÇÃÇ≈ÅA60ÉoÉCÉgÇÃóÃàÊÇ…íºÇ∑ÅBëOå„ÇÃãÛîíÇéÊÇÈÅB
    sDispCom = Trim(StrConv(MidB(StrConv(uFooter.sHyoji, vbFromUnicode), 1, 60), vbUnicode))
    
    sDisp = StrConv(MidB(StrConv(sDispCom, vbFromUnicode), 1, 32), vbUnicode)     'ÉRÉÅÉìÉg1
    If Len(Trim(sDisp)) <> 0 Then
        lstKan.AddItem (Space(45) & sDisp)
    Else
        lstKan.AddItem (Space(45) & String(32, "-"))
    End If
    
    sDisp = StrConv(MidB(StrConv(sDispCom, vbFromUnicode), 33, 60), vbUnicode)    'ÉRÉÅÉìÉg2
    If Len(Trim(sDisp)) <> 0 Then
        lstKan.AddItem (Space(45) & sDisp)
    End If
    
    Set fsoObj = Nothing
    
    Exit Sub
Err_FILE:
    
    'àŸèÌÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, sErrEventName, lngErrCode)
    'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
    Call psFileNameGet(structDispInfo.sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
    
    'ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    
    'àŸèÌópï\é¶
    lstKan.AddItem (sTitle & "------------       ---  --------------------  ----/--/-- --:--")
    lstKan.AddItem (Space(45) & "--------------------------------")
    lstKan.AddItem (Space(45) & "--------------------------------")

    Set fsoObj = Nothing

End Sub
'V30.1.0.1 ADD END


' EG20 V2.1.0.1[Mainte_03_01] í«â¡äJén
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fReadFileList
'//  ã@î\ñºèÃ  : ÉtÉ@ÉCÉãÉäÉXÉgÇÃéÊìæ
'//  ã@î\äTóv  : ÉtÉ@ÉCÉãÉäÉXÉgÇÊÇËÅAÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fReadFileList(sFileList As String) As Boolean
    Dim iFileNumber As Integer      'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String         'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer         'ÉtÉ@ÉCÉãäiî[êî

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË

    iListCnt = 0
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)

    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open sFileList For Input Access Read As #iFileNumber    'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
    Do While Not EOF(iFileNumber)                           'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
        Line Input #iFileNumber, sFileName                  'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
        If sFileName <> "" And Left$(sFileName, 1) <> "/" Then                'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
            iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
            ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
            FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 16)
                                                            'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
        End If
    Loop
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB

    fReadFileList = True    'ñﬂÇËílÇê≥èÌÇ∆Ç∑ÇÈ

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'V1.21.0.1 ADD  START
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    'V1.21.0.1 ADD  END
    fReadFileList = False   'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
End Function
' EG20 V2.1.0.1[Mainte_03_01] í«â¡èIóπ
' EG20 V5.6.0.1ÅyÇhÇbÇlÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉäÉXÉgëŒâûÅzí«â¡äJén
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2012 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fReadFileListIDU
'//  ã@î\ñºèÃ  : IDUÉtÉ@ÉCÉãÉäÉXÉgÇÃéÊìæ
'//  ã@î\äTóv  : ÉtÉ@ÉCÉãÉäÉXÉgÇÊÇËÅAÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V5.6.0.1) 2012-04-04  CODED BY  [TCC] H.Sugimoto
'//                 ÅyÇhÇbÇlÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉäÉXÉgëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fReadFileListIDU(sFileList As String) As Boolean
    Dim iFileNumber As Integer      'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String         'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer         'ÉtÉ@ÉCÉãäiî[êî
    Dim nIndex As Integer           ' ï∂éöêî

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË

    iListCnt = 0
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)

    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open sFileList For Input Access Read As #iFileNumber    'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
    Do While Not EOF(iFileNumber)                           'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
        Line Input #iFileNumber, sFileName                  'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
        If sFileName <> "" And Left$(sFileName, 1) <> "/" Then                'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
            iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
            ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ

            nIndex = InStr(sFileName, " ")
            If nIndex = 0 Then
                ' ÉXÉyÅ[ÉXÇ™ä‹Ç‹ÇÍÇƒÇ¢Ç»Ç¢èÍçá
                FileListType(iListCnt - 1) = UCase(Trim$(sFileName))
            Else
                ' ÉXÉyÅ[ÉXÇ™ä‹Ç‹ÇÍÇƒÇ¢ÇÈèÍçá
                FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, nIndex)))
            End If
            FileList(iListCnt - 1) = FileListType(iListCnt - 1)
                                                            'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
        End If
    Loop
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB

    fReadFileListIDU = True    'ñﬂÇËílÇê≥èÌÇ∆Ç∑ÇÈ

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    fReadFileListIDU = False   'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
End Function
' EG20 V5.6.0.1ÅyÇhÇbÇlÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉäÉXÉgëŒâûÅzí«â¡èIóπ

'EG20 V30.1.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2014 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fIsExistCornerType
'//  ã@î\ñºèÃ  : ÉRÅ[ÉiÅ[É^ÉCÉvë∂ç›É`ÉFÉbÉN
'//  ã@î\äTóv  : ä≤ê¸ÉRÅ[ÉiÅ[Ç™ë∂ç›Ç∑ÇÈÇ©ÅAç›óàê¸ÉRÅ[ÉiÅ[Ç™ë∂ç›Ç∑ÇÈÇ©É`ÉFÉbÉNÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : byte  byCornerTypeÅ@[IN]   0:ç›óàê¸ÉRÅ[ÉiÅ[
'//                                         1:ä≤ê¸ÉRÅ[ÉiÅ[
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : boolean  true/false    true:ç›óàê¸ÉRÅ[ÉiÅ[óLÇË false:ä≤ê¸ÉRÅ[ÉiÅ[óLÇË
'//
'//     ORIGINAL  :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fIsExistCornerType(intCornerType As Integer)

    Dim intCount        As Integer
    Dim byFindFlg       As Byte
    
    byFindFlg = False

    'äeÉRÅ[ÉiÅ[ÇÃÉRÅ[ÉiÅ[É^ÉCÉvÇéÊìæÇ∑ÇÈ
    Call gsGetSettiCorner
    Call gsGetCornerType
    
    If intCornerType = CORNER_TYPE_KANSEN Then   'ä≤ê¸ÉRÅ[ÉiÅ[Ç™ë∂ç›Ç∑ÇÈÇ©ímÇËÇΩÇ¢èÍçá
        For intCount = 0 To UBound(gblnCornerSet)
            If gintCornerType(intCount) = CORNER_TYPE_KANSEN And gblnCornerSet(intCount) = True Then
                byFindFlg = True        'ä≤ê¸ÉRÅ[ÉiÅ[Ç™àÍÇ¬Ç≈Ç‡Ç†ÇÍÇŒOK
                Exit For
            End If
        Next intCount
    Else                                        'ç›óàê¸ÉRÅ[ÉiÅ[Ç™ë∂ç›Ç∑ÇÈÇ©ímÇËÇΩÇ¢èÍçá
        For intCount = 0 To UBound(gblnCornerSet)
            If gintCornerType(intCount) = CORNER_TYPE_ZAIRAI And gblnCornerSet(intCount) = True Then
                byFindFlg = True        'ç›óàê¸ÉRÅ[ÉiÅ[Ç™àÍÇ¬Ç≈Ç‡Ç†ÇÍÇŒOK
                Exit For
            End If
        Next intCount
    End If
    
    fIsExistCornerType = byFindFlg
          

End Function
