VERSION 5.00
Begin VB.Form frmLanSettei 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "LANÉJÅ[Éhè„à â∫à ê›íË"
   ClientHeight    =   9000
   ClientLeft      =   2175
   ClientTop       =   2445
   ClientWidth     =   12000
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   NegotiateMenus  =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   9000
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtDummy 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   479
      Left            =   120
      Locked          =   -1  'True
      MultiLine       =   -1  'True
      TabIndex        =   0
      Top             =   10089
      Width           =   3135
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   9
      Left            =   10200
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   23
      Top             =   6680
      Width           =   1575
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   8
      Left            =   8520
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   22
      Top             =   6680
      Width           =   1575
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   7
      Left            =   10200
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   21
      Top             =   5360
      Width           =   1575
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   6
      Left            =   8520
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   20
      Top             =   5360
      Width           =   1575
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   5
      Left            =   10200
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   19
      Top             =   4040
      Width           =   1575
   End
   Begin VB.Timer tmrMail 
      Left            =   3600
      Top             =   7800
   End
   Begin VB.CommandButton cmdReturn 
      Caption         =   "  ã@äÌèÓïÒê›íË    âÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   9480
      TabIndex        =   18
      Top             =   7800
      Width           =   2415
   End
   Begin VB.CommandButton SetteiUpdata 
      Caption         =   "ê›íËçXêV"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   6840
      TabIndex        =   16
      Top             =   7800
      Width           =   2415
   End
   Begin VB.Frame Frame1 
      Caption         =   "LANÉJÅ[Éhê›íË(5)"
      Height          =   975
      Index           =   4
      Left            =   240
      TabIndex        =   14
      Top             =   6120
      Width           =   8055
      Begin VB.Label Label2 
         Caption         =   "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Index           =   4
         Left            =   120
         TabIndex        =   15
         Top             =   360
         Width           =   7695
      End
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   4
      Left            =   8520
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   13
      Top             =   4040
      Width           =   1575
   End
   Begin VB.Frame Frame1 
      Caption         =   "LANÉJÅ[Éhê›íË(4)"
      Height          =   975
      Index           =   3
      Left            =   240
      TabIndex        =   11
      Top             =   4800
      Width           =   8055
      Begin VB.Label Label2 
         Caption         =   "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Index           =   3
         Left            =   120
         TabIndex        =   12
         Top             =   360
         Width           =   7695
      End
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   3
      Left            =   10200
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   10
      Top             =   2720
      Width           =   1575
   End
   Begin VB.Frame Frame1 
      Caption         =   "LANÉJÅ[Éhê›íË(3)"
      Height          =   975
      Index           =   2
      Left            =   240
      TabIndex        =   8
      Top             =   3480
      Width           =   8055
      Begin VB.Label Label2 
         Caption         =   "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Index           =   2
         Left            =   120
         TabIndex        =   9
         Top             =   360
         Width           =   7695
      End
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   2
      Left            =   8520
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   7
      Top             =   2720
      Width           =   1575
   End
   Begin VB.Frame Frame1 
      Caption         =   "LANÉJÅ[Éhê›íË(2)"
      Height          =   975
      Index           =   1
      Left            =   240
      TabIndex        =   5
      Top             =   2160
      Width           =   8055
      Begin VB.Label Label2 
         Caption         =   "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Index           =   1
         Left            =   120
         TabIndex        =   6
         Top             =   360
         Width           =   7695
      End
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   1
      Left            =   10200
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   4
      Top             =   1400
      Width           =   1575
   End
   Begin VB.ComboBox cmbLanSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   0
      Left            =   8520
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   3
      Top             =   1400
      Width           =   1575
   End
   Begin VB.Frame Frame1 
      Caption         =   "LANÉJÅ[Éhê›íË(1)"
      Height          =   975
      Index           =   0
      Left            =   240
      TabIndex        =   1
      Top             =   840
      Width           =   8055
      Begin VB.Label Label2 
         Caption         =   "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Index           =   0
         Left            =   120
         TabIndex        =   2
         Top             =   360
         Width           =   7695
      End
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   10200
      TabIndex        =   35
      Top             =   6280
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   8
      Left            =   8520
      TabIndex        =   34
      Top             =   6280
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   7
      Left            =   10200
      TabIndex        =   33
      Top             =   4950
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   6
      Left            =   8520
      TabIndex        =   32
      Top             =   4950
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   5
      Left            =   10200
      TabIndex        =   31
      Top             =   3650
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   4
      Left            =   8520
      TabIndex        =   30
      Top             =   3650
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   3
      Left            =   10200
      TabIndex        =   29
      Top             =   2325
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   2
      Left            =   8520
      TabIndex        =   28
      Top             =   2325
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   1
      Left            =   10200
      TabIndex        =   27
      Top             =   1005
      Width           =   1575
   End
   Begin VB.Label lblIpDisp 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "XXX.XXX.XXX.XXX"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   300
      Index           =   0
      Left            =   8520
      TabIndex        =   26
      Top             =   1005
      Width           =   1575
   End
   Begin VB.Label Label4 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "ê⁄ë±ã@äÌÇQ"
      Height          =   375
      Left            =   10320
      TabIndex        =   25
      Top             =   600
      Width           =   1335
   End
   Begin VB.Label Label3 
      Alignment       =   2  'íÜâõëµÇ¶
      Caption         =   "ê⁄ë±ã@äÌÇP"
      Height          =   375
      Left            =   8520
      TabIndex        =   24
      Top             =   600
      Width           =   1575
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "LANÉJÅ[Éhê›íË"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Left            =   0
      TabIndex        =   17
      Top             =   0
      Width           =   12015
   End
End
Attribute VB_Name = "frmLanSettei"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFfrmLanSettei.frm
'//  ÉpÉbÉPÅ[ÉWñºÅFLANÉJÅ[Éhè„à â∫à ê›íËâÊñ 
'//
'//  äTóvÅFLANÉJÅ[Éhè„à â∫à ê›íËâÊñ 
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(1.12.0.1) 2009-11-10  REVISED BY [TCC] C.Terui
'//                 ñtÇÃâüâ∫â¬Å^ïsâ¬èàóùí«â¡
'//     REVISIONS :(1.18.0.1) 2010-01-09  REVISED BY [TCC] S.Terao
'//                 ïsãÔçáëŒâû
'//     REVISIONS :(1.21.0.1) 2010-04-08  REVISED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(2.7.0.1) 2010-12-24   CODED   BY [TCC] M.Kuroki
'//                 ÇiÇqìåäCÅ@ÇmÇdÇfÅ®ÇdÇfÇqÉRÉìÉoÅ[ÉgëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Const ASRT_IDSERV = &H80000000

'------------------------------------------------------------------------------
'ÉAÉ_ÉvÉ^èÓïÒéÊìæAPI
'------------------------------------------------------------------------------
Private Const NO_ERROR = 0
Private Const ERROR_BUFFER_OVERFLOW = 111
Private Const ERROR_INVALID_PARAMETER = 87
Private Const ERROR_NO_DATA = 232
Private Const ERROR_NOT_SUPPORTED = 50
Private Const MAX_ADAPTER_DESCRIPTION_LENGTH = 128  '// arb.
Private Const MAX_ADAPTER_NAME_LENGTH = 256         '// arb.
Private Const MAX_ADAPTER_ADDRESS_LENGTH = 8        '// arb.
Private Type IP_ADDRESS_STRING
    addr(15)        As Byte
End Type
Private Type IP_ADDR_STRING
    pNext           As Long
    IpAddress       As IP_ADDRESS_STRING
    IpMask          As IP_ADDRESS_STRING
    Context         As Long
End Type
Private Type IP_ADAPTER_INFO
    pNext                   As Long
    ComboIndex              As Long
    AdapterName(MAX_ADAPTER_NAME_LENGTH + 3)          As Byte
    Description(MAX_ADAPTER_DESCRIPTION_LENGTH + 3)   As Byte
    AddressLength           As Long
    Address(MAX_ADAPTER_ADDRESS_LENGTH - 1)           As Byte
    dwIndex                 As Long
    uType                   As Long
    bDhcpEnabled            As Long
    pCurrentIpAddress       As Long
    IpAddressList           As IP_ADDR_STRING
    GatewayList             As IP_ADDR_STRING
    DhcpServer              As IP_ADDR_STRING
    bHaveWins               As Long
    PrimaryWinsServer       As IP_ADDR_STRING
    SecondaryWinsServer     As IP_ADDR_STRING
    LeaseObtained           As Long 'time_t
    LeaseExpires            As Long 'time_t
End Type
Private Declare Function GetAdaptersInfo Lib "IPHLPAPI.DLL" ( _
    pAdapterInfo As Byte, _
    pOutBufLen As Long) As Long
Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" ( _
    Destination As Any, _
    Source As Any, _
    ByVal Length As Long)

Private Type userIP_ADAPTER
    Description As String       'ÉAÉ_ÉvÉ^ñº
    MACAddr As String           'ÉAÉ_ÉvÉ^ÉAÉhÉåÉX
    IPAddr As String            'IPÉAÉhÉåÉX
    Subnet As String            'ÉTÉuÉlÉbÉgÉ}ÉXÉN
    Gateway As String           'ÉQÅ[ÉgÉEÉFÉC
    DHCP As String              'DHCP
    WINS1 As String             'ÉvÉâÉCÉ}ÉäWINS
    WINS2 As String             'ÉZÉJÉìÉ_ÉäWINS
    LeaseObtain As String       'DHCPÉäÅ[ÉXéÊìæì˙
    LeaseExpire As String       'DHCPÉäÅ[ÉXä˙å¿
End Type

'V1.11.0.1 DEL START
'Private Type SetteiFile
'    sLanCardName(0 To 4) As String         'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÅFLANÉJÅ[Éhñº
'    sAdapterName(0 To 4) As String         'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÅFLANÉAÉ_ÉvÉ^ñº    'V1.11.0.1 ADD
''    sCombBox(0 To 4) As Integer           'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÅFLANÉJÅ[Éhíl      'V1.11.0.1 DEL
'    sCombBox1(0 To 4) As Integer           'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÅFLANÉJÅ[Éhíl      'V1.11.0.1 ADD
'    sCombBox2(0 To 4) As Integer           'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÅFLANÉJÅ[Éhíl2     'V1.11.0.1 ADD
'End Type
'Private SetteiFile As SetteiFile
'V1.11.0.1 DEL END
Private sGetLanInfo(0 To 4) As String * MAX_PATH_SIZE 'LANÉJÅ[ÉhèÓïÒiniÉtÉ@ÉCÉãóp

Private Const SETTEI_ARI = 0
Private Const SETTEI_NASI = 1
Private Const MN_MAIL_INTERVAL = 1000      'ÉÅÅ[ÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl
Private Const KANMA = ","
'Private Const DEFULT_KIKI_NAME = "è„à "    'ÉfÉtÉHÉãÉgíl   'V1.11.0.1 DEL
Private iDispFlag(0 To 4) As Integer       'ÉtÉâÉO
Private Const LAN_MAX_SETTEI = 5           'LANê›íËç≈ëÂíl
Private Const KIKI_MAX_SETTEI = 10         'ê⁄ë±ã@äÌç≈ëÂíl   'V1.11.0.1 ADD
Private iLan_Defult As Integer             'LANê›íËç≈ëÂíl
'V1.11.0.1 ADD START
Private Const DEFULT_NASI = 0          'ÉfÉtÉHÉãÉgíl
Private Const DEFULT_JIKAI = 1         'ÉfÉtÉHÉãÉgíl
Private Const DEFULT_JOUI = 2          'ÉfÉtÉHÉãÉgíl
Private Const DEFULT_SHUNYU_JOUI = 2   'ÉfÉtÉHÉãÉgíl
Private Const DEFULT_IC_JOUI = 3       'ÉfÉtÉHÉãÉgíl
Private iLanInfo As Integer            'è„à LANê›íËèÓïÒ
'V1.11.0.1 ADD END
Private Const DEFULT_ZEN_KIKI = 1      'ÉfÉtÉHÉãÉgíl    'V2.7.0.1 ADD

Option Explicit

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : LANÉJÅ[Éhè„à â∫à ê›íËâÊñ (ÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÅAÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()
On Error Resume Next
    'É^ÉCÉ}ÇãNìÆÇ∑ÇÈ
    tmrMail.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : LANÉJÅ[Éhè„à â∫à ê›íËâÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÅAÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
On Error Resume Next
    'É^ÉCÉ}Çí‚é~Ç∑ÇÈ
    tmrMail.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : LANÉJÅ[Éhè„à â∫à ê›íËâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(1.21.0.1) 2010-04-08  REVISED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()

    Dim i               As Integer          'ÉãÅ[ÉvópÉJÉEÉìÉ^
    Dim j               As Integer          'ÉãÅ[ÉvópÉJÉEÉìÉ^
    Dim fso As New FileSystemObject
    Dim CreateFile As TextStream
    Dim bRet            As Boolean
    
    On Error Resume Next
   
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000
    bRet = True
    
    'ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãÇ'ÇPïbÇ…ÉZÉbÉg
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False
    
    SetteiUpdata.Enabled = False
    
    'èâä˙ÇÕîÒï\é¶Ç∆Ç∑ÇÈÅB
    For i = 0 To LAN_MAX_SETTEI - 1
        Frame1(i).Visible = False
'        cmbLanSelect(i).Visible = False    'V1.11.0.1 DEL
        'V1.11.0.1 ADD START
        cmbLanSelect(i * 2).Visible = False
        cmbLanSelect((i * 2) + 1).Visible = False
        'V1.11.0.1 ADD DEL
        SetteiFile.sLanCardName(i) = ""
'        SetteiFile.sCombBox(i) = 0         'V1.11.0.1 DEL
        'V1.11.0.1 ADD START
        SetteiFile.sCombBox1(i) = 0
        SetteiFile.sCombBox2(i) = 0
        'V1.11.0.1 ADD END
        'V1.21.0.1 ADD START
        lblIpDisp(i * 2).Caption = ""
        lblIpDisp((i * 2) + 1).Caption = ""
        lblIpDisp(i * 2).Visible = False
        lblIpDisp((i * 2) + 1).Visible = False
        'V1.21.0.1 ADD END
    Next
        
    'V1.11.0.1 ADD START
    'HOSHU.INIÇ©ÇÁè„à ÇkÇ`Çmê›íËèÓïÒÇéÊìæÇ∑ÇÈ
    iLanInfo = GetPrivateProfileInt(HOSHU_LANINFO_SEC, HOSHU_LANINFO_KEY, LANINFO_DEFAULT, HOSHU_FILE)
    'V1.11.0.1 ADD END
    
    'LANèÓïÒINIÉtÉ@ÉCÉãéÊìæèàóù
    bRet = pfGetLanInfo
    If bRet = True Then
        If Dir(LAN_CARD_SETTEI_CSVFILE, vbNormal) = "" Then
           'ÉtÉ@ÉCÉãñ≥ÇµéûÅ®ÉtÉ@ÉCÉãçÏê¨
           Set CreateFile = fso.CreateTextFile(LAN_CARD_SETTEI_CSVFILE, True)
           CreateFile.Close
        Else
          'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãèÓïÒéÊìæèàóù
          bRet = pfGetLANSetteiFileInfo
        End If
        
        If bRet = True Then
           'ï\é¶ÇÃÇΩÇﬂÇÃLANÉJÅ[ÉhñºéÊìæèàóùÇçsÇ§ÅB
           bRet = psGetLANSettei
           If bRet = True Then
              SetteiUpdata.Enabled = True
           End If
        End If
    End If
    
    'ÅuLANÉJÅ[Éhè„à â∫à ê›íËâÊñ ÅFï\é¶£
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LAN_CARD_SETTEI_GAMEN_START, 0)
   
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdReturn_Click
'//  ã@î\ñºèÃ  : ÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫èàóù
'//  ã@î\äTóv  : é©âÊñ Çè¡ãéÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdReturn_Click()
    On Error Resume Next
    'ÅuLANÉJÅ[Éhè„à â∫à ê›íËÅFè¡ãéÅv
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LAN_CARD_SETTEI_GAMEN_END, 0)
    Unload Me
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psGetLANSettei
'//  ã@î\ñºèÃ  : OSÇÊÇËLANÉJÅ[ÉhèÓïÒéÊìæèàóù
'//  ã@î\äTóv  : OSÇÊÇËLANÉJÅ[ÉhèÓïÒÇÃéÊìæÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(1.18.0.1) 2010-01-09  REVISED BY [TCC] S.Terao
'//                 ïsãÔçáëŒâû
'//     REVISIONS :(1.21.0.1) 2010-04-08  REVISED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function psGetLANSettei() As Boolean
    
    Dim udtIPAdaptInfo() As IP_ADAPTER_INFO
    Dim bytAdaptInfo()  As Byte
    Dim lngBufLen       As Long
    Dim lngRet          As Long
    Dim lngPtr          As Long
    Dim i               As Integer
    Dim Fnc_GetIPAdapt As String
    Dim Name As String
    Dim Name2 As String     'V1.11.0.1 ADD
    Dim lngErrCode As Long
    'V1.18.0.1Å@ADD START
    Dim sSection As String            'ÉåÉWÉXÉgÉäê⁄ë±ÉZÉNÉVÉáÉìñº
    Dim iErrCnt   As Integer
    'V1.18.0.1Å@ADD END
    'V1.21.0.1 ADD START
    Dim sIPaddress1 As String         'ê⁄ë±ã@äÌÇPÅFIPÉAÉhÉåÉX(ÉtÉçÉìÉg)
    Dim sIPaddress2 As String         'ê⁄ë±ã@äÌÇQÅFIPÉAÉhÉåÉX(ÉTÉu)
    Dim sGetIPaddress As String       'IPÉAÉhÉåÉXèÓïÒ
    Dim sSeachStr As String           'éüï∂éöóLñ≥
    Dim iStrCnt As Integer            'ÉXÉyÅ[ÉXà íu
    Dim iByteSts  As Integer          'ÉoÉCÉgêî
    'V1.21.0.1 ADD END
    
    On Error Resume Next
    
    psGetLANSettei = True
    Fnc_GetIPAdapt = vbNullString
    ' ÉfÅ[É^ÇÃéÊìæÉoÉbÉtÉ@ÇÃèâä˙âª
    ReDim udtIPAdaptInfo(0)
    ReDim bytAdaptInfo(0)
    
    ' ÉAÉ_ÉvÉ^èÓïÒÇéÊìæÇ∑ÇÈÇΩÇﬂÇ…ïKóvÇ»ÉoÉbÉtÉ@ÉTÉCÉYÇéÊìæÇ∑ÇÈ
    lngRet = GetAdaptersInfo(bytAdaptInfo(0), lngBufLen)
    
    Select Case lngRet
    
    Case ERROR_BUFFER_OVERFLOW  ' ÉoÉbÉtÉ@ÉTÉCÉYÇ™è¨Ç≥Ç¢
        
        ' éÊìæÇµÇΩÉoÉbÉtÉ@ÉTÉCÉYÇÊÇËïKóvÇ»ÉoÉbÉtÉ@Çämï€
        ReDim bytAdaptInfo(lngBufLen)
        
        ' ÉAÉ_ÉvÉ^èÓïÒÇéÊìæÇ∑ÇÈ
        lngRet = GetAdaptersInfo(bytAdaptInfo(0), lngBufLen)
        
        If lngRet = NO_ERROR Then
            ReDim pIpAdapter(0)
            ' éÊìæÇµÇΩÉAÉ_ÉvÉ^èÓïÒÇÉÜÅ[ÉUÅ[íËã`å^ïœêîÇ÷ÉRÉsÅ[
            CopyMemory udtIPAdaptInfo(0), bytAdaptInfo(0), LenB(udtIPAdaptInfo(0))
            lngPtr = udtIPAdaptInfo(0).pNext
            i = 0
            Do While Not lngPtr = 0 ' îzóÒÇÃéüÇÃÉAÉhÉåÉXÇ÷ÇÃÉ|ÉCÉìÉ^ÇÉ`ÉFÉbÉNÇ∑ÇÈ
                i = i + 1
                ReDim Preserve udtIPAdaptInfo(i)
                ReDim Preserve pIpAdapter(i)
                CopyMemory udtIPAdaptInfo(i), ByVal lngPtr, LenB(udtIPAdaptInfo(0))
                lngPtr = udtIPAdaptInfo(i).pNext
            Loop
            
            'ï\é¶LANÉJÅ[ÉhñºèÃÇéÊìæÇ∑ÇÈÅB
            For i = 0 To UBound(udtIPAdaptInfo)
              'ÉAÉ_ÉvÉ^ñº
              Name = ByteToStr(udtIPAdaptInfo(i).Description)
              'V1.11.0.1 ADD START
              'LANÉTÅ[ÉrÉXñº
              Name2 = ByteToStr(udtIPAdaptInfo(i).AdapterName)
              
              'V1.21.0.1 ADD START
              sIPaddress1 = ""
              sIPaddress2 = ""
              ' IPÉAÉhÉåÉX
              sSection = ""
              sSection = "SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\"
              sSection = sSection + Name2 + "\\"
              sGetIPaddress = pfIpAddressGetReg(HKEY_LOCAL_MACHINE, sSection, "IpAddress")
                            
              iStrCnt = InStr(sGetIPaddress, Chr(0)) 'ÉXÉyÅ[ÉXà íuÇÃîcà¨
              iByteSts = LenB(sGetIPaddress)         'ëSëÃÇÃí∑Ç≥îcà¨
              sIPaddress1 = Left(sGetIPaddress, InStr(sGetIPaddress, Chr(0)) - 1)
              sSeachStr = Mid(sGetIPaddress, iStrCnt + 1, 1) 'ë±Ç´Ç™Ç†ÇÈÇ©Ç«Ç§Ç©îªíË
              If 0 = InStr(sSeachStr, Chr(0)) And sSeachStr <> "" Then
                 sGetIPaddress = Mid(sGetIPaddress, iStrCnt + 1, iByteSts - iStrCnt)
                 sIPaddress2 = Left(sGetIPaddress, InStr(sGetIPaddress, Chr(0)) - 1)
              End If
              'V1.21.0.1 ADD END
              
              'V1.18.0.1 ADD START
              'ê⁄ë±ñºéÊìæ
               sSection = ""
               sSection = "SYSTEM\\CurrentControlSet\\Control\\Network\\"
               sSection = sSection + "{4D36E972-E325-11CE-BFC1-08002BE10318}\\"
               sSection = sSection + Name2
               sSection = sSection + "\\Connection"
               SetteiFile.sLanName(i) = pfGetReg(HKEY_LOCAL_MACHINE, sSection, "Name")
               If SetteiFile.sLanName(i) = "" Then
                  Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
                  psGetLANSettei = False
        
                  'àŸèÌéûÇÕâÊñ ÅAÉuÉâÉìÉNï\é¶Ç∆Ç∑ÇÈÅÀLANÉJÅ[ÉhñºÇ™ïsñæÇ≈ÇÕÅuê›íËçXêVÅvñtèàóùÇ‡
                  'àŸèÌÇ∆Ç»ÇÈÇ±Ç∆Ç™ÇÌÇ©Ç¡ÇƒÇ¢ÇÈÇΩÇﬂ
                  For iErrCnt = 0 To LAN_MAX_SETTEI - 1
                      Frame1(iErrCnt).Visible = False
                      cmbLanSelect(iErrCnt * 2).Visible = False
                      cmbLanSelect((iErrCnt * 2) + 1).Visible = False
                      SetteiFile.sLanCardName(iErrCnt) = ""
                      SetteiFile.sCombBox1(iErrCnt) = 0
                      SetteiFile.sCombBox2(iErrCnt) = 0
                  Next
                  Exit Function
               End If
              'V1.18.0.1 ADD END
              'V1.11.0.1 ADD END
              If Name <> "" Then
'                 pfCreateFileDisp Name, i  'V1.11.0.1 DEL
                 'pfCreateFileDisp Name, Name2, i   'V1.11.0.1 ADD 'V1.21.0.1 DEL
                  pfCreateFileDisp Name, Name2, i, sIPaddress1, sIPaddress2 'V1.21.0.1 ADD
              End If
            Next
          Call sLogTraceReq(LTYP_NORMAL, L3AN_API, LAN_CARD_GET_INFO_OK, lngErrCode)
          psGetLANSettei = True
        Else
          Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
          psGetLANSettei = False
        End If
    ' ÉGÉâÅ[ï\é¶
    Case ERROR_INVALID_PARAMETER
       Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
       psGetLANSettei = False
    Case ERROR_NO_DATA
       Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
       psGetLANSettei = False
    Case ERROR_NOT_SUPPORTED
       Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
       psGetLANSettei = False
    End Select
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : ByteToStr
'//  ã@î\ñºèÃ  : ÉoÉCÉgîzóÒÇÊÇËNULLèIí[ÉfÅ[É^Çï∂éöóÒÇ…ïœä∑èàóù
'//  ã@î\äTóv  : ï∂éöóÒÇ…ï∂éöïœä∑èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : VariantÅ@bytDestÅ@ [IN]ïœä∑ëŒè€îzóÒ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function ByteToStr(bytDest As Variant) As String
    Dim strBuf  As String
  
    On Error Resume Next
    ' ÉoÉCÉgîzóÒÇÊÇËNULLèIí[Ç‹Ç≈ÇÃÉfÅ[É^Ç≈ï∂éöóÒå^Çê∂ê¨
    strBuf = StrConv(bytDest, vbUnicode)
    ByteToStr = Left$(strBuf, InStr(1, strBuf, vbNullChar) - 1)
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfGetLanInfo
'//  ã@î\ñºèÃ  : LANÉJÅ[ÉhèÓïÒINIÉtÉ@ÉCÉãÇÊÇËäOïîã@äÌëIëïîñºèÃàÍóóéÊìæèàóù
'//  ã@î\äTóv  : INIÉtÉ@ÉCÉãÇÊÇËèÓïÒÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfGetLanInfo() As Boolean

  Dim iRet As Integer
  Dim sKey As String
  Dim i As Integer
  Dim iCnt As Integer
  Dim iCount As Integer
  Dim sLANInfo As String * MAX_PATH_SIZE
  Dim iSetteiCnt As Integer
  Dim iCntUp As Integer
  Dim sKikiName As String
    
  On Error Resume Next
  
  sKey = LAN_KEY
  
  pfGetLanInfo = False
  
' V1.11.0.1 DEL START
'  For iCnt = 0 To LAN_MAX_SETTEI - 1
'    i = 1
'    iCntUp = 0
'    iSetteiCnt = 0
'    Do While Not EOF(1)
'       iRet = GetPrivateProfileString(LAN_SEC, _
'                                       sKey & i, _
'                                       "", sLANInfo, Len(sLANInfo), _
'                                       PATH_LAN_CARD_FILE)
'        If 0 <> iRet Then
'           '1ÉRÉìÉ{É{ÉbÉNÉXï\é¶äOïîã@äÌñºèÃï\é¶
'           sKikiName = Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 3)
'           If sKikiName <> "" And Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 2, 1) = "," Then
'              cmbLanSelect(iCnt).AddItem Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 3)
'              sGetLanInfo(i - 1) = Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))
'              If i = 1 Then
'                 'ÉfÉtÉHÉãÉgílåàíË
'                 iLan_Defult = Mid(sGetLanInfo(i - 1), 1, 1)
'              End If
'           End If
'           iCntUp = iCntUp + 1
'        ElseIf i <> 1 And sGetLanInfo(i - 1) <> " " Then
'           'ÉãÅ[ÉvèIóπ
'           iCntUp = iCntUp + 1
'           pfGetLanInfo = True
'           Exit Do
'        Else
'           'ê›íËÇ»Çµ
'           iSetteiCnt = iSetteiCnt + 1
'        End If
'        i = i + 1
'    Loop
'  Next
'
'  If iSetteiCnt = iCntUp Then
'     pfGetLanInfo = False
'  Else
'     pfGetLanInfo = True
'  End If
' V1.11.0.1 DEL END
  ' V1.11.0.1 ADD START
  For iCnt = 0 To LAN_MAX_SETTEI - 1
    i = 1
    iCntUp = 0
    iSetteiCnt = 0
    Do While Not EOF(1)
       iRet = GetPrivateProfileString(LAN_SEC, _
                                       sKey & i, _
                                       "", sLANInfo, Len(sLANInfo), _
                                       PATH_LAN_CARD_FILE)
        If 0 <> iRet Then
           '1ÉRÉìÉ{É{ÉbÉNÉXï\é¶äOïîã@äÌñºèÃï\é¶
           sKikiName = Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 3)
           If sKikiName <> "" And Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 2, 1) = "," Then
              cmbLanSelect(iCnt * 2).AddItem Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 3)
              cmbLanSelect((iCnt * 2) + 1).AddItem Mid((Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))), 3)
              sGetLanInfo(i - 1) = Left$(sLANInfo, (InStr(sLANInfo, vbNullChar) - 1))
           End If
        ElseIf i <> 1 And sGetLanInfo(i - 1) <> " " Then
           'ÉãÅ[ÉvèIóπ
           pfGetLanInfo = True
           Exit Do
        End If
        i = i + 1
    Loop
  Next
  ' V1.11.0.1 ADD END
  
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfGetLANSetteiFileInfo
'//  ã@î\ñºèÃ  : LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãì‡èÓïÒÇì«Ç›çûÇﬁ
'//  ã@î\äTóv  : LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÇÊÇËê›íËÉtÉ@ÉCÉãèÓïÒÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ          à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(EG20 V3.3.0.1) 2012-01-20  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyëÄçÏëÏ åãçáNo.36ä÷òAÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfGetLANSetteiFileInfo() As Boolean

    Dim bRet            As Boolean  'ñﬂÇËíl
    Dim intFileNo       As Integer  'ÉtÉ@ÉCÉãî‘çÜ
    Dim strWork         As String   'çÏã∆ÉGÉäÉA
    Dim intCnt          As Integer  'ÉJÉEÉìÉ^Å[
    Dim lngErrCode      As Long     'ÉGÉâÅ[ÉRÅ[Éh
    Dim sFData()        As String
    Dim iFCnt           As Integer
    Dim iFLoop          As Integer
    Dim iFLoop2         As Integer
    Dim iRet            As Integer
    Dim lLen            As Long     'ÉtÉ@ÉCÉãÉTÉCÉY
    
    pfGetLANSetteiFileInfo = True
    
On Error GoTo DispFileGetInfo_Error
   
   lLen = FileLen(LAN_CARD_SETTEI_CSVFILE)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ
   If lLen = 0 Then
      Exit Function
   End If
   
   'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈÅB
   intFileNo = FreeFile

   'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÉIÅ[ÉvÉì
   Open LAN_CARD_SETTEI_CSVFILE For Input As #intFileNo
    
   intCnt = 0
   
   'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãì‡èÓïÒÇéÊìæÇ∑ÇÈÅB
'   Do While Not EOF(1)                                     ' EG20 V3.3.0.1çÌèú
    Do While Not EOF(intFileNo)                             ' EG20 V3.3.0.1í«â¡
     Line Input #intFileNo, strWork
           
     If Len(strWork) <> 0 Then
        intCnt = intCnt + 1
        'ÉfÅ[É^ÇÃéÊìæ
'        ReDim sFData(2)    'V1.11.0.1 DEL
        ReDim sFData(4)     'V1.11.0.1 ADD
        iFCnt = 1
            
        For iFLoop = 1 To Len(strWork)
            If Mid(strWork, iFLoop, 1) <> "," Then
               iFLoop2 = iFLoop
               Do
                iFLoop2 = iFLoop2 + 1
                If iFLoop2 > Len(strWork) Then
                   sFData(iFCnt) = Mid(strWork, iFLoop, iFLoop2 - iFLoop)
                   iFCnt = iFCnt + 1
                   If iFCnt >= 16 Then
                      Exit For
                   End If
                  
                   iFLoop = iFLoop2
                   Exit Do
                End If
                       
                If Mid(strWork, iFLoop2, 1) = "," Then
                   sFData(iFCnt) = Mid(strWork, iFLoop, iFLoop2 - iFLoop)
                   iFCnt = iFCnt + 1
                   If iFCnt >= 16 Then
                      Exit For
                   End If
                    
                   iFLoop = iFLoop2
                   Exit Do
                End If
               Loop
            End If
        Next
        
        If intCnt <= LAN_MAX_SETTEI Then
           If Len(Trim(sFData(1))) > 0 Then
              'ÉtÉ@ÉCÉãÇ…ãLç⁄Ç≥ÇÍÇƒÇ¢ÇÈLANÉJÅ[ÉhñºÇÅALANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÉGÉäÉAÇ…ï€éù
              SetteiFile.sLanCardName(intCnt - 1) = Trim(sFData(1))
           End If
        
           If Len(Trim(sFData(2))) > 0 Then
              'ÉtÉ@ÉCÉãÇ…ãLç⁄Ç≥ÇÍÇƒÇ¢ÇÈLANÉJÅ[ÉhílÇÅALANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÉGÉäÉAÇ…ï€éù
'              SetteiFile.sCombBox(intCnt - 1) = Trim(sFData(2))    'V1.11.0.1 DEL
              SetteiFile.sCombBox1(intCnt - 1) = Trim(sFData(2))     'V1.11.0.1 ADD
           End If
           'V1.11.0.1 ADD START
           If Len(Trim(sFData(3))) > 0 Then
              'ÉtÉ@ÉCÉãÇ…ãLç⁄Ç≥ÇÍÇƒÇ¢ÇÈLANÉJÅ[ÉhílÇÅALANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÉGÉäÉAÇ…ï€éù
              SetteiFile.sCombBox2(intCnt - 1) = Trim(sFData(3))
           End If
           If Len(Trim(sFData(4))) > 0 Then
              'ÉtÉ@ÉCÉãÇ…ãLç⁄Ç≥ÇÍÇƒÇ¢ÇÈLANÉAÉ_ÉvÉ^ñºÇÅALANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÉGÉäÉAÇ…ï€éù
              SetteiFile.sAdapterName(intCnt - 1) = Trim(sFData(4))
           End If
           'V1.11.0.1 ADD END
        End If
     End If
   Loop
   
   'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    Close #intFileNo
 Exit Function
    
DispFileGetInfo_Error:
  'ÉIÅ[ÉvÉìàŸèÌéûÇÕèàóùèIóπ
  Close #intFileNo 'V1.11.0.1 ADD
  lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
  Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, FILE_ACCESS_ERROR, lngErrCode)
  pfGetLANSetteiFileInfo = False
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfCreateFileDisp
'//  ã@î\ñºèÃ  : ê›íËî‰ärÇçsÇ¢âÊñ ï\é¶èàóù
'//  ã@î\äTóv  : ê›íËî‰ärÇçsÇ¢ÅAâÊñ Ç…ï\é¶Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ          à”ñ°
'//  à¯êî      : String   sLanCardName  [IN]LANÉJÅ[ÉhñºèÃ
'//              Integer  iCnt          [IN]ê›íËî‘çÜ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(1.21.0.1) 2010-04-08  REVISED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(2.7.0.1) 2010-12-24   CODED   BY [TCC] M.Kuroki
'//                 ÇiÇqìåäCÅ@ÇmÇdÇfÅ®ÇdÇfÇqÉRÉìÉoÅ[ÉgëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Function pfCreateFileDisp(sLanCardName As String, iCnt As Integer)     'V1.11.0.1 DEL
'Private Function pfCreateFileDisp(sLanCardName As String, sAdapterName As String, iCnt As Integer)      'V1.11.0.1 ADD
Private Function pfCreateFileDisp(sLanCardName As String, sAdapterName As String, iCnt As Integer, sIPaddress1 As String, sIPaddress2 As String)     'V1.21.0.1 ADD
      
      Dim bRet            As Boolean  'ñﬂÇËíl
    Dim strWork         As String   'çÏã∆ÉGÉäÉA
    Dim intCnt          As Integer  'ÉJÉEÉìÉ^Å[
    Dim lngErrCode      As Long     'ÉGÉâÅ[ÉRÅ[Éh
    Dim i As Integer                'ÉJÉEÉìÉ^Å[
    Dim iIniCnt As Integer          'ÉJÉEÉìÉ^Å[ÇP
    Dim bChkFlag1 As Boolean         'É`ÉFÉbÉNÉtÉâÉO1
    Dim bChkFlag2 As Boolean         'É`ÉFÉbÉNÉtÉâÉO2
    
   If iCnt < LAN_MAX_SETTEI Then
    'ï\é¶ïîÇÉtÉåÅ[ÉÄÅAÉâÉxÉãÅAäOïîã@äÌñºèÃÇï\é¶
     Frame1(iCnt).Visible = True
'     cmbLanSelect(iCnt).Visible = True             'V1.11.0.1 DEL
     cmbLanSelect(iCnt * 2).Visible = True          'V1.11.0.1 ADD
     cmbLanSelect((iCnt * 2) + 1).Visible = True    'V1.11.0.1 ADD
     'V1.21.0.1 ADD START
     'ê⁄ë±ã@äÌÇPÅFílÉ`ÉFÉbÉNÅBÉAÉhÉåÉXÇ™Åu0.0.0.0ÅvéûÇÕÉuÉâÉìÉN
     If sIPaddress1 <> "" And sIPaddress1 <> "0.0.0.0" Then
        lblIpDisp(iCnt * 2).Caption = sIPaddress1
        lblIpDisp(iCnt * 2).Visible = True
     End If
     'ê⁄ë±ã@äÌÇQÅFílÉ`ÉFÉbÉNÅBÉAÉhÉåÉXÇ™Åu0.0.0.0ÅvéûÇÕÉuÉâÉìÉN
     If sIPaddress2 <> "" And sIPaddress2 <> "0.0.0.0" Then
        lblIpDisp((iCnt * 2) + 1).Caption = sIPaddress2
        lblIpDisp((iCnt * 2) + 1).Visible = True
     End If
     'V1.21.0.1 ADD END
     
     'OSéÊìæLANÉJÅ[ÉhñºÇï\é¶Ç∑ÇÈÅB
     Label2(iCnt).Caption = sLanCardName
                
     For i = 0 To LAN_MAX_SETTEI - 1
        'OSéÊìæLANÉJÅ[ÉhñºÇ∆ÅAÉtÉ@ÉCÉãì‡ãLç⁄LANÉJÅ[ÉhñºÇî‰ärÇ∑ÇÈÅB
        If SetteiFile.sLanCardName(i) = sLanCardName Then
           'àÍívÅFê›íËÉtÉ@ÉCÉãÇ…ê›íËóLÇË
           iDispFlag(iCnt) = SETTEI_ARI
           Exit For
        End If
        If i = LAN_MAX_SETTEI - 1 Then
            'ïsàÍívÅFê›íËÉtÉ@ÉCÉãÇ…ê›íËñ≥Çµ
             iDispFlag(iCnt) = SETTEI_NASI
        End If
     Next
     
     If iDispFlag(iCnt) = SETTEI_NASI Then
        'âÊñ ï\é¶LANÉJÅ[Éhñºï€éùÉGÉäÉAÇ…ï€éù
        SetteiFile.sLanCardName(iCnt) = sLanCardName
        'ÉtÉ@ÉCÉãÇ…ê›íËÇ™Ç»ÇØÇÍÇŒÉfÉtÉHÉãÉgílÇÇ¢ÇÍÇÈ
'        SetteiFile.sCombBox(iCnt) = iLan_Defult    'V1.11.0.1 DEL
        'V1.11.0.1 ADD START
        'LANÉJÅ[ÉhÉAÉ_ÉvÉ^ñºï€éùÉGÉäÉAÇ…ï€éù
        SetteiFile.sAdapterName(iCnt) = sAdapterName
'        If iLanInfo = 1 Then                    'V2.7.0.1 DEL
        If iLanInfo = LAN_CARD_SET_TYPE1 Then    'V2.7.0.1 ADD
            'LANè„à ê›íËÅÅï˚éÆÇP
            'ê⁄ë±ã@äÌÇê›íËÅ^ï€éù
            If iCnt = 0 Then
                SetteiFile.sCombBox1(iCnt) = DEFULT_JIKAI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            ElseIf iCnt = 1 Then
                SetteiFile.sCombBox1(iCnt) = DEFULT_JOUI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            Else
                SetteiFile.sCombBox1(iCnt) = DEFULT_NASI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            End If
'        ElseIf iLanInfo = 2 Then                  'V2.7.0.1 DEL
        ElseIf iLanInfo = LAN_CARD_SET_TYPE2 Then  'V2.7.0.1 ADD
            'LANè„à ê›íËÅÅï˚éÆÇQ
            'ê⁄ë±ã@äÌÇê›íËÅ^ï€éù
            If iCnt = 0 Then
                SetteiFile.sCombBox1(iCnt) = DEFULT_JIKAI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            ElseIf iCnt = 1 Then
                SetteiFile.sCombBox1(iCnt) = DEFULT_SHUNYU_JOUI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_IC_JOUI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            Else
                SetteiFile.sCombBox1(iCnt) = DEFULT_NASI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            End If
        'V2.7.0.1 ADD START
        ElseIf iLanInfo = LAN_CARD_SET_TYPE3 Then
            'LANè„à ê›íËÅÅï˚éÆÇR
            'ê⁄ë±ã@äÌÇê›íËÅ^ï€éù
            If iCnt = 0 Then
                SetteiFile.sCombBox1(iCnt) = DEFULT_ZEN_KIKI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            Else
                SetteiFile.sCombBox1(iCnt) = DEFULT_NASI
                cmbLanSelect(iCnt * 2).ListIndex = SetteiFile.sCombBox1(iCnt)
                SetteiFile.sCombBox2(iCnt) = DEFULT_NASI
                cmbLanSelect((iCnt * 2) + 1).ListIndex = SetteiFile.sCombBox2(iCnt)
            End If
        'V2.7.0.1 ADD END
        End If
        'V1.11.0.1 ADD END
     End If
     
     'V1.11.0.1 ADD START
     'ê›íËÇ†ÇËÇÃèÍçáÅAê›íËÉtÉ@ÉCÉãÇ©ÇÁèÓïÒÇéÊìæ
     If iDispFlag(iCnt) = SETTEI_ARI Then
        bChkFlag1 = False
        bChkFlag2 = False
        For iIniCnt = 0 To LAN_MAX_SETTEI - 1 'LANÉJÅ[ÉhèÓïÒINIÉtÉ@ÉCÉãï™ÉãÅ[Év
        'äOïîã@äÌñºèÃílÇå≥Ç…ÅALANÉJÅ[ÉhèÓïÒINIÉtÉ@ÉCÉãÇ∆ÅAê›íËÇ™ÉtÉ@ÉCÉãÇ…Ç†Ç¡ÇΩÇ©Ç«Ç§Ç©ÇîªífÇ∑ÇÈÅB
            If SetteiFile.sCombBox1(iCnt) = Mid(sGetLanInfo(iIniCnt), 1, 1) Then
                'äOïîã@äÌñºèÃílÇ…ëŒâûÇµÇΩï∂åæÇï\é¶Ç∑ÇÈÅB
                cmbLanSelect(iCnt * 2).ListIndex = iIniCnt
                bChkFlag1 = True
            End If
            If SetteiFile.sCombBox2(iCnt) = Mid(sGetLanInfo(iIniCnt), 1, 1) Then
                'äOïîã@äÌñºèÃílÇ…ëŒâûÇµÇΩï∂åæÇï\é¶Ç∑ÇÈÅB
                cmbLanSelect((iCnt * 2) + 1).ListIndex = iIniCnt
                bChkFlag2 = True
            End If
        Next
        If bChkFlag1 = False Then
            'ÅuÅ|ÅvÇï\é¶
            cmbLanSelect(iCnt * 2).ListIndex = DEFULT_NASI
        End If
        If bChkFlag2 = False Then
            'ÅuÅ|ÅvÇï\é¶
            cmbLanSelect((iCnt * 2) + 1).ListIndex = DEFULT_NASI
        End If
     End If
     'V1.11.0.1 ADD END

'V1.11.0.1 DEL START
'     For intCnt = 0 To LAN_MAX_SETTEI - 1    'ê›íËÉtÉ@ÉCÉãì‡ãLç⁄äOïîã@äÌñºèÃílï™ÉãÅ[Év
'       For iIniCnt = 0 To LAN_MAX_SETTEI - 1 'LANÉJÅ[ÉhèÓïÒINIÉtÉ@ÉCÉãï™ÉãÅ[Év
'         'äOïîã@äÌñºèÃílÇå≥Ç…ÅALANÉJÅ[ÉhèÓïÒINIÉtÉ@ÉCÉãÇ∆ÅAê›íËÇ™ÉtÉ@ÉCÉãÇ…Ç†Ç¡ÇΩÇ©Ç«Ç§Ç©ÇîªífÇ∑ÇÈÅB
'         If SetteiFile.sCombBox(iCnt) = Mid(sGetLanInfo(iIniCnt), 1, 1) And iDispFlag(iCnt) = SETTEI_ARI Then
'            'äOïîã@äÌñºèÃílÇ…ëŒâûÇµÇΩï∂åæÇï\é¶Ç∑ÇÈÅB
'            cmbLanSelect(iCnt).ListIndex = iIniCnt
'            Exit Function
'         Else
'            'è„ãLà»äOÇÃèÍçá
'            cmbLanSelect(iCnt).ListIndex = 0
'         End If
'       Next
'     Next
'V1.11.0.1 DEL END
  End If
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : SetteiUpdata_Click
'//  ã@î\ñºèÃ  : Åuê›íËçXêVÅvñtâüâ∫èàóù
'//  ã@î\äTóv  : LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãÇ…âÊñ ílÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-26  REVISED BY [TCC] D.Yamashita
'//                 EG-RÉtÉFÅ[ÉY3écåèçÄñ⁄ëŒâûÅ@è„à LANê›íËå©íºÇµ
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ñtÇÃâüâ∫â¬Å^ïsâ¬èàóùí«â¡
'//     REVISIONS :(1.21.0.1) 2010-04-08  REVISED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub SetteiUpdata_Click()
   Dim iResponse   As Integer   'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXÇÃñﬂÇËíl
   Dim i           As Integer   'ÉJÉEÉìÉ^Å|ÇP
   Dim iCnt2       As Integer   'ÉJÉEÉìÉ^Å[ÇQ
   Dim iCnt1       As Integer   'ÉJÉEÉìÉ^Å[ÇR
   Dim iKikiCnt    As Integer   'ê⁄ë±ã@äÌÉJÉEÉìÉ^Å[     'V1.11.0.1 ADD
   Dim intFileNo   As Integer   'ÉtÉ@ÉCÉãî‘çÜ
   Dim sLanName    As String    'èëçûÇ›LANÉJÅ[Éhñº
   Dim sAdapterName As String   'èëçûÇ›LANÉAÉ_ÉvÉ^ñº    'V1.11.0.1 ADD
'   Dim sListCnt    As String    'èëçûÇ›äOïîã@äÌñºèÃíl  'V1.11.0.1 DEL
   Dim sListCnt1    As String    'èëçûÇ›äOïîã@äÌñºèÃíl  'V1.11.0.1 ADD
   Dim sListCnt2    As String    'èëçûÇ›äOïîã@äÌñºèÃíl  'V1.11.0.1 ADD
   Dim iLenCnt     As Integer   'ï∂éöóÒêî
   Dim lngErrCode  As Long      'ÉGÉâÅ[ÉRÅ[Éh
'   Dim iListIndex  As Integer   'ÉCÉìÉfÉbÉNÉXíl    'V1.11.0.1 DEL
   Dim iListIndex1  As Integer   'ÉCÉìÉfÉbÉNÉXíl     'V1.11.0.1 ADD
   Dim iListIndex2  As Integer   'ÉCÉìÉfÉbÉNÉXíl     'V1.11.0.1 ADD
   Dim bKikiChk     As Boolean   'ã@äÌÉ`ÉFÉbÉNÉtÉâÉO 'V1.11.0.1 ADD
   Dim bRet         As Boolean   'ñﬂÇËíl             'V1.11.0.1 ADD
   
On Error GoTo SetteiUpdata_Click

   'ÅuLANÉJÅ[Éhè„à â∫à ê›íËâÊñ ÅFê›íËçXêVñtâüâ∫Åv
   Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LAN_CARD_SETTEICHANGE_BUTTOM, 0)

'V1.12.0.1 ADD START
   'äeÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈ
    sButtonEnabled (False)
'V1.12.0.1 ADD END
 
   'ê›íËçXêVämîFÉ|ÉbÉvÉAÉbÉvï\é¶
   iResponse = MsgBox("ê›íËílÇîΩâfÇµÇ‹Ç∑Ç™ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                       vbOKCancel + vbQuestion, "ê›íËçXêVämîF")
   If iResponse = vbOK Then
      'V1.11.0.1 ADD START
      'ñtâüâ∫ïsâ¬Ç…çXêV
      sButtonEnabled (False)
      'ã@äÌëIëèdï°É`ÉFÉbÉNÇçsÇ§
      bKikiChk = False
      For i = 0 To LAN_MAX_SETTEI - 1
        If cmbLanSelect(i).Visible = True And Frame1(i).Visible = True Then
            If cmbLanSelect(i * 2).ListIndex = DEFULT_NASI And cmbLanSelect((i * 2) + 1).ListIndex = DEFULT_NASI Then
                ' LANÉJÅ[ÉhÇ…ã@äÌÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç»Ç¢
                iResponse = MsgBox("LANÉJÅ[Éhê›íË(" & i + 1 & ")Ç…ê⁄ë±ã@äÌÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                                    vbOKOnly + vbCritical, "ê›íËçXêVåãâ ")
                'ñtâüâ∫â¬Ç…çXêV
                sButtonEnabled (True)
                Exit Sub
            End If
            For iKikiCnt = 0 To KIKI_MAX_SETTEI - 1
                'ìØÇ∂ÉRÉ}ÉìÉhÇÕçƒÉãÅ[Év
                If i <> iKikiCnt Then
                    'ê⁄ë±ã@äÌÇ»ÇµÇÃèÍçáÇÕÉ`ÉFÉbÉNëŒè€äO
                    If cmbLanSelect(i).ListIndex <> DEFULT_NASI Then
                        'ê⁄ë±ã@äÌÇÃèdï°Çî‰är
                        If cmbLanSelect(i).ListIndex = cmbLanSelect(iKikiCnt).ListIndex Then
                            'èdï°Ç†ÇË
                            bKikiChk = True
                            Exit For
                        End If
                    End If
                End If
            Next
        End If
        'ã@äÌÉ`ÉFÉbÉNÉtÉâÉOÇÉ`ÉFÉbÉN
        If bKikiChk = True Then
            'ê›íËèdï°É|ÉbÉvÉAÉbÉvï\é¶
            iResponse = MsgBox("ê⁄ë±ã@äÌÇ…ìØàÍÇÃã@äÌÇ™ê›íËÇ≥ÇÍÇƒÇ¢Ç‹Ç∑ÅB", _
                                vbOKOnly + vbCritical, "ê›íËçXêVåãâ ")
            'ñtâüâ∫â¬Ç…çXêV
            sButtonEnabled (True)
            Exit Sub
        End If
      Next
      
      'LANÉJÅ[ÉhÇ…IPÉAÉhÉåÉXÅ^ÉRÉìÉsÉÖÅ[É^ñºÇê›íË
      bRet = True
      bRet = LANSelectNetworkSet(Me)
      If bRet <> True Then
        'IPÉAÉhÉåÉXê›íËàŸèÌÇ…ÇÊÇËèàóùèIóπÅ@É|ÉbÉvÉAÉbÉvÇÕä÷êîì‡Ç≈ï\é¶
        'ñtâüâ∫â¬Ç…çXêV
        sButtonEnabled (True)
        Exit Sub
      End If
      'V1.11.0.1 ADD END
      
      'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
      intFileNo = FreeFile
    
      'LANÉJÅ[ÉhèÓïÒê›íËÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
      Open LAN_CARD_SETTEI_CSVFILE For Output Access Write As #intFileNo
     
      For i = 0 To LAN_MAX_SETTEI - 1
        If cmbLanSelect(i).Visible = True And Frame1(i).Visible = True Then
            'V1.11.0.1 ADD START
            For iCnt1 = 0 To cmbLanSelect(i).ListCount
                iListIndex1 = cmbLanSelect(i * 2).ListIndex
                iListIndex2 = cmbLanSelect((i * 2) + 1).ListIndex
                'ï\é¶LANÉJÅ[ÉhñºÇéÊìæ
                sLanName = SetteiFile.sLanCardName(i)
                'LANÉAÉ_ÉvÉ^ñºÇéÊìæ
                sAdapterName = SetteiFile.sAdapterName(i)
                'ëIëäOïîã@äÌñºèÃî‘çÜéÊìæ
                sListCnt1 = Mid(sGetLanInfo(iListIndex1), 1, 1)
                sListCnt2 = Mid(sGetLanInfo(iListIndex2), 1, 1)
                Print #intFileNo, sLanName; KANMA; sListCnt1; KANMA; sListCnt2; KANMA; sAdapterName
                Exit For
            Next
            'V1.11.0.1 ADD END
'V1.11.0.1 DEL START
'          'ï\é¶Ç≥ÇÍÇƒÇ¢ÇÈÇ‡ÇÃÇê›íËÉtÉ@ÉCÉãÇ…èëÇ´çûÇﬁÅB
'          For iCnt1 = 0 To cmbLanSelect(i).ListCount
'              iListIndex = cmbLanSelect(i).ListIndex
'              'ï\é¶LANÉJÅ[ÉhñºÇéÊìæ
'               sLanName = SetteiFile.sLanCardName(i)
'               'ëIëäOïîã@äÌñºèÃî‘çÜéÊìæ
'               sListCnt = Mid(sGetLanInfo(iListIndex), 1, 1)
'               Print #intFileNo, sLanName; KANMA; sListCnt
'               Exit For
'            Next
'V1.11.0.1 DEL END
         End If
      Next
      'LANÉJÅ[ÉhèÓïÒê›íËÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
      Close #intFileNo
      Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, LAN_CARD_SETTEICHANGE_OK, 0)
      'V1.11.0.1 ADD START
       'ê≥èÌèIóπ
        'iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "ê›íËçXêVåãâ ")  'V1.21.0.1 DEL
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB" & Chr(vbKeyReturn) & "äƒéãî’ÇçƒãNìÆÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", vbOKOnly + vbInformation, "ê›íËçXêVåãâ ")  'V1.21.0.1 ADD
        'ñtâüâ∫â¬Ç…çXêV
        sButtonEnabled (True)
      'V1.11.0.1 ADD END
'V1.12.0.1 ADD START
   Else
        sButtonEnabled (True)
'V1.12.0.1 ADD END
   End If
'V1.21.0.1 ADD START
 'LANÉJÅ[Éhê›íËÉtÉ@ÉCÉãèÓïÒéÊìæèàóù
  sLanInfoUpData
'V1.21.0.1 ADD END
Exit Sub

SetteiUpdata_Click:
    'V1.21.0.1 ADD  START
    If intFileNo > 0 Then
        Close #intFileNo
    End If
    'V1.21.0.1 ADD  END
    
   'ÅuLANÉJÅ[Éhè„à â∫à ê›íËâÊñ ÅFê›íËçXêVñtâüâ∫èàóùàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, LAN_CARD_SETTEICHANGE_ERROR, lngErrCode)
   'ê›íËçXêVåãâ (àŸèÌ)É|ÉbÉvÉAÉbÉvï\é¶
   iResponse = MsgBox("ê›íËçXêVÇÕàŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                       vbOKOnly + vbCritical, "ê›íËçXêVåãâ ")
    'ñtâüâ∫â¬Ç…çXêV
    sButtonEnabled (True)
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ÅAÉ^ÉCÉÄÉAÉbÉvèàóù
'//  ã@î\äTóv  : ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-03   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()
  'ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
    If pfComMailRecieve = ML_ID_HOSHU_ACTIVE_REQ Then
       'ï€éÁâÊñ ÉAÉNÉeÉBÉuóvãÅÇéÛêMÇµÇΩÇÁÅAé©âÊñ ÇëOñ Ç…ï\é¶Ç≥ÇπÇÈÅB
        AppActivate frmLanSettei.Caption, False
        pfFormActive (frmLanSettei.hwnd)
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sButtonEnabled
'//  ã@î\ñºèÃ  : ï\é¶âÊñ ÇÃñtÉRÉìÉgÉçÅ[ÉãÇçsÇ§ÅB
'//  ã@î\äTóv  : Åuê›íËçXêVÅvñtâüâ∫éûèàóùÅFñtÇâüâ∫â¬/âüâ∫ïsâ¬Ç…Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : BooleanÅ@bSetÅ@Å@Å@[IN]ñtÇÃÉRÉìÉgÉçÅ[Éã(TRUEÅFâüâ∫â¬,FALSEÅFâüâ∫ïsâ¬)
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.11.0.1) 2009-10-26   CODED   BY [TCC] D.Yamashita
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sButtonEnabled(bSet As Boolean)

    Dim i           As Integer   'ÉJÉEÉìÉ^Å|
    
    On Error Resume Next

    SetteiUpdata.Enabled = bSet         'ê›íËçXêVÉ{É^Éì
    cmdReturn.Enabled = bSet            'ÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÉ{É^Éì
    For i = 0 To LAN_MAX_SETTEI - 1
        If cmbLanSelect(i).Visible = True Then
            cmbLanSelect(i * 2).Enabled = bSet
            cmbLanSelect((i * 2) + 1).Enabled = bSet
        End If
    Next

End Sub

'V1.21.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sLanInfoUpData
'//  ã@î\ñºèÃ  : LANÉJÅ[Éhê›íËâÊñ ÇÃçXêVèàóùÇçsÇ§ÅB
'//  ã@î\äTóv  : âÊñ çXêVèàóù
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      :
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.21.0.1) 2010-04-08   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sLanInfoUpData()
    Dim bRet As Boolean
    Dim i As Integer
    
    SetteiUpdata.Enabled = False
    
    'èâä˙ÇÕîÒï\é¶Ç∆Ç∑ÇÈÅB
    For i = 0 To LAN_MAX_SETTEI - 1
        Frame1(i).Visible = False
        cmbLanSelect(i * 2).Visible = False
        cmbLanSelect((i * 2) + 1).Visible = False
        SetteiFile.sLanCardName(i) = ""
        lblIpDisp(i * 2).Caption = ""
        lblIpDisp((i * 2) + 1).Caption = ""
        lblIpDisp(i * 2).Visible = False
        lblIpDisp((i * 2) + 1).Visible = False
    Next
    
    bRet = psGetLANDispUpData
    
    SetteiUpdata.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psGetLANDispUpData
'//  ã@î\ñºèÃ  : OSÇÊÇËLANÉJÅ[ÉhèÓïÒéÊìæèàóù
'//  ã@î\äTóv  : OSÇÊÇËLANÉJÅ[ÉhèÓïÒÇÃéÊìæÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL :(1.21.0.1) 2010-04-08  CODED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function psGetLANDispUpData() As Boolean
    
    Dim udtIPAdaptInfo() As IP_ADAPTER_INFO
    Dim bytAdaptInfo()  As Byte
    Dim lngBufLen       As Long
    Dim lngRet          As Long
    Dim lngPtr          As Long
    Dim i               As Integer
    Dim Fnc_GetIPAdapt As String
    Dim Name As String
    Dim Name2 As String
    Dim lngErrCode As Long
    Dim sSection As String            'ÉåÉWÉXÉgÉäê⁄ë±ÉZÉNÉVÉáÉìñº
    Dim iErrCnt   As Integer
    Dim sIPaddress1 As String         'ê⁄ë±ã@äÌÇPÅFIPÉAÉhÉåÉX(ÉtÉçÉìÉg)
    Dim sIPaddress2 As String         'ê⁄ë±ã@äÌÇQÅFIPÉAÉhÉåÉX(ÉTÉu)
    Dim sGetIPaddress As String       'IPÉAÉhÉåÉXèÓïÒ
    Dim sSeachStr As String           'éüï∂éöóLñ≥
    Dim iStrCnt As Integer            'ÉXÉyÅ[ÉXà íu
    Dim iByteSts  As Integer          'ÉoÉCÉgêî
    
    On Error Resume Next
    
    psGetLANDispUpData = True
    Fnc_GetIPAdapt = vbNullString
    ' ÉfÅ[É^ÇÃéÊìæÉoÉbÉtÉ@ÇÃèâä˙âª
    ReDim udtIPAdaptInfo(0)
    ReDim bytAdaptInfo(0)
    
    ' ÉAÉ_ÉvÉ^èÓïÒÇéÊìæÇ∑ÇÈÇΩÇﬂÇ…ïKóvÇ»ÉoÉbÉtÉ@ÉTÉCÉYÇéÊìæÇ∑ÇÈ
    lngRet = GetAdaptersInfo(bytAdaptInfo(0), lngBufLen)
    
    Select Case lngRet
    
     Case ERROR_BUFFER_OVERFLOW  ' ÉoÉbÉtÉ@ÉTÉCÉYÇ™è¨Ç≥Ç¢
        
        ' éÊìæÇµÇΩÉoÉbÉtÉ@ÉTÉCÉYÇÊÇËïKóvÇ»ÉoÉbÉtÉ@Çämï€
        ReDim bytAdaptInfo(lngBufLen)
        
        ' ÉAÉ_ÉvÉ^èÓïÒÇéÊìæÇ∑ÇÈ
        lngRet = GetAdaptersInfo(bytAdaptInfo(0), lngBufLen)
        
        If lngRet = NO_ERROR Then
            ReDim pIpAdapter(0)
            ' éÊìæÇµÇΩÉAÉ_ÉvÉ^èÓïÒÇÉÜÅ[ÉUÅ[íËã`å^ïœêîÇ÷ÉRÉsÅ[
            CopyMemory udtIPAdaptInfo(0), bytAdaptInfo(0), LenB(udtIPAdaptInfo(0))
            lngPtr = udtIPAdaptInfo(0).pNext
            i = 0
            Do While Not lngPtr = 0 ' îzóÒÇÃéüÇÃÉAÉhÉåÉXÇ÷ÇÃÉ|ÉCÉìÉ^ÇÉ`ÉFÉbÉNÇ∑ÇÈ
                i = i + 1
                ReDim Preserve udtIPAdaptInfo(i)
                ReDim Preserve pIpAdapter(i)
                CopyMemory udtIPAdaptInfo(i), ByVal lngPtr, LenB(udtIPAdaptInfo(0))
                lngPtr = udtIPAdaptInfo(i).pNext
            Loop
            
            'ï\é¶LANÉJÅ[ÉhñºèÃÇéÊìæÇ∑ÇÈÅB
            For i = 0 To UBound(udtIPAdaptInfo)
              'ÉAÉ_ÉvÉ^ñº
              Name = ByteToStr(udtIPAdaptInfo(i).Description)
              'LANÉTÅ[ÉrÉXñº
              Name2 = ByteToStr(udtIPAdaptInfo(i).AdapterName)
              
              sIPaddress1 = ""
              sIPaddress2 = ""
              ' IPÉAÉhÉåÉX
              sSection = ""
              sSection = "SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces\\"
              sSection = sSection + Name2 + "\\"
              sGetIPaddress = pfIpAddressGetReg(HKEY_LOCAL_MACHINE, sSection, "IpAddress")
                            
              iStrCnt = InStr(sGetIPaddress, Chr(0)) 'ÉXÉyÅ[ÉXà íuÇÃîcà¨
              iByteSts = LenB(sGetIPaddress)         'ëSëÃÇÃí∑Ç≥îcà¨
              sIPaddress1 = Left(sGetIPaddress, InStr(sGetIPaddress, Chr(0)) - 1)
              sSeachStr = Mid(sGetIPaddress, iStrCnt + 1, 1) 'ë±Ç´Ç™Ç†ÇÈÇ©Ç«Ç§Ç©îªíË
              If 0 = InStr(sSeachStr, Chr(0)) And sSeachStr <> "" Then
                 sGetIPaddress = Mid(sGetIPaddress, iStrCnt + 1, iByteSts - iStrCnt)
                 sIPaddress2 = Left(sGetIPaddress, InStr(sGetIPaddress, Chr(0)) - 1)
              End If
              If Name <> "" Then
                  pfCreateFileDispUpData Name, i, sIPaddress1, sIPaddress2
              End If
            Next
          Call sLogTraceReq(LTYP_NORMAL, L3AN_API, LAN_CARD_GET_INFO_OK, lngErrCode)
          psGetLANDispUpData = True
        Else
          Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
          psGetLANDispUpData = False
        End If
    ' ÉGÉâÅ[ï\é¶
    Case ERROR_INVALID_PARAMETER
       Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
       psGetLANDispUpData = False
    Case ERROR_NO_DATA
       Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
       psGetLANDispUpData = False
    Case ERROR_NOT_SUPPORTED
       Call sLogTraceReq(LTYP_ERROR, L3AN_API, LAN_CARD_GET_INFO_ERROR, lngErrCode)
       psGetLANDispUpData = False
    End Select
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfCreateFileDispUpData
'//  ã@î\ñºèÃ  : âÊñ çƒï`âÊèàóù
'//  ã@î\äTóv  : âÊñ çƒï`âÊÇçsÇ§ÅB
'//
'//              å^        ñºèÃ          à”ñ°
'//  à¯êî      : String   sLanCardName  [IN]LANÉJÅ[ÉhñºèÃ
'//              Integer  iCnt          [IN]ê›íËî‘çÜ
'//              String   sIPaddress1   [IN]ê⁄ë±ã@äÌÇPÅFIPÉAÉhÉåÉX
'//              String   sIPaddress2Å@ [IN]ê⁄ë±ã@äÌÇQÅFIPÉAÉhÉåÉX
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL :(1.21.0.1) 2010-04-08  CODED BY [TCC] S.Terao
'//                 EG-Räƒéãî’Å@ÇQåéëŒâûÅ@LANÉJÅ[Éhê›íËédólïœçX
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfCreateFileDispUpData(sLanCardName As String, iCnt As Integer, sIPaddress1 As String, sIPaddress2 As String)
      
   On Error Resume Next
    
   If iCnt < LAN_MAX_SETTEI Then
    'ï\é¶ïîÇÉtÉåÅ[ÉÄÅAÉâÉxÉãÅAäOïîã@äÌñºèÃÇï\é¶
     Frame1(iCnt).Visible = True
     cmbLanSelect(iCnt * 2).Visible = True
     cmbLanSelect((iCnt * 2) + 1).Visible = True
     'ê⁄ë±ã@äÌÇPÅFílÉ`ÉFÉbÉNÅBÉAÉhÉåÉXÇ™Åu0.0.0.0ÅvéûÇÕÉuÉâÉìÉN
     If sIPaddress1 <> "" And sIPaddress1 <> "0.0.0.0" Then
        lblIpDisp(iCnt * 2).Caption = sIPaddress1
        lblIpDisp(iCnt * 2).Visible = True
     End If
     'ê⁄ë±ã@äÌÇQÅFílÉ`ÉFÉbÉNÅBÉAÉhÉåÉXÇ™Åu0.0.0.0ÅvéûÇÕÉuÉâÉìÉN
     If sIPaddress2 <> "" And sIPaddress2 <> "0.0.0.0" Then
        lblIpDisp((iCnt * 2) + 1).Caption = sIPaddress2
        lblIpDisp((iCnt * 2) + 1).Visible = True
     End If
     
     'OSéÊìæLANÉJÅ[ÉhñºÇï\é¶Ç∑ÇÈÅB
     Label2(iCnt).Caption = sLanCardName
   End If
End Function
'V1.21.0.1 ADD END
