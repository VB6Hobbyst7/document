VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "COMDLG32.OCX"
Object = "{5E9E78A0-531B-11CF-91F6-C2863C385E30}#1.0#0"; "MSFLXGRD.OCX"
Begin VB.Form frmKikiDataSubGate 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "ã@äÌç\ê¨ê›íË"
   ClientHeight    =   9000
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   12000
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   11.25
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   ScaleHeight     =   9000
   ScaleMode       =   0  '’∞ªﬁ∞
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   Begin VB.ComboBox CmbCornerName 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Left            =   8280
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   15
      Top             =   700
      Visible         =   0   'False
      Width           =   3495
   End
   Begin VB.ComboBox cmbGoki 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   405
      Left            =   9480
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   14
      Top             =   1200
      Visible         =   0   'False
      Width           =   2295
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "â¸éDã@âÊñ Ç÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   7
      Left            =   7250
      TabIndex        =   13
      Top             =   7800
      Width           =   2175
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   8280
      Top             =   2160
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "âwèÓïÒâÊñ Ç÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   6
      Left            =   7250
      TabIndex        =   12
      Top             =   8400
      Width           =   2175
   End
   Begin VB.Timer tmrMail 
      Enabled         =   0   'False
      Left            =   9120
      Top             =   2160
   End
   Begin VB.ComboBox CmbDummy 
      Height          =   345
      Left            =   4080
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   11
      Top             =   9720
      Width           =   2655
   End
   Begin VB.ListBox ListDummy 
      Height          =   510
      Left            =   120
      TabIndex        =   10
      Top             =   9720
      Width           =   1935
   End
   Begin VB.CommandButton cmdCancel 
      Caption         =   " ã@äÌèÓïÒê›íË   âÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   9720
      TabIndex        =   0
      Top             =   7800
      Width           =   2055
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "î}ëÃéÊäO"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   5
      Left            =   4850
      TabIndex        =   7
      Top             =   8400
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "àÍéûï€ë∂"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   2
      Left            =   120
      TabIndex        =   6
      Top             =   8400
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "àÍéûï€ë∂ÉfÅ[É^ éÊçû"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   3
      Left            =   2450
      TabIndex        =   5
      Top             =   8400
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "ê›íËîΩâf"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   0
      Left            =   120
      TabIndex        =   4
      Top             =   7800
      Width           =   2175
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "î}ëÃèoóÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   1
      Left            =   2450
      TabIndex        =   3
      Top             =   7800
      Width           =   2175
   End
   Begin VB.TextBox txtDummy 
      Height          =   495
      IMEMode         =   3  'µÃå≈íË
      Left            =   120
      TabIndex        =   1
      Text            =   "Text1"
      Top             =   10425
      Width           =   3135
   End
   Begin VB.CommandButton CmdKikiSetMenu 
      Caption         =   "î}ëÃì¸óÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   4
      Left            =   4850
      TabIndex        =   2
      Top             =   7800
      Width           =   2175
   End
   Begin MSFlexGridLib.MSFlexGrid GridIni 
      Height          =   5730
      Left            =   120
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   1800
      Width           =   11640
      _ExtentX        =   20532
      _ExtentY        =   10107
      _Version        =   393216
      Rows            =   18
      Cols            =   8
      FixedCols       =   2
      RowHeightMin    =   350
      WordWrap        =   -1  'True
      Redraw          =   -1  'True
      AllowBigSelection=   0   'False
      FocusRect       =   2
      HighLight       =   0
      GridLines       =   2
      GridLinesFixed  =   1
      ScrollBars      =   2
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.Label LblEkiName 
      Caption         =   "âwñºÅFÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõÅõ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   360
      TabIndex        =   16
      Top             =   720
      Width           =   7815
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "ã@äÌç\ê¨ê›íËÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`Åj"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Left            =   0
      TabIndex        =   8
      Top             =   0
      Width           =   12015
   End
End
Attribute VB_Name = "frmKikiDataSubGate"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFã@äÌç\ê¨ê›íËÅiÉGÉìÉRÅ[ÉhÅjâÊñ .frm
'//  ÉpÉbÉPÅ[ÉWñºÅFã@äÌç\ê¨ê›íËÅiÉGÉìÉRÅ[ÉhÅjâÊñ ÇÃÉtÉHÅ[ÉÄÉÇÉWÉÖÅ[Éã
'//
'//  äTóvÅFã@äÌç\ê¨ê›íËÅiÉGÉìÉRÅ[ÉhÅjâÊñ 
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V30.1.0.1) 2014-04-28  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-09-19  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû
'//                 ÅyHKRK_Kansi07_003_01ÅzSub_gate_kan.iniÉtÉHÅ[É}ÉbÉgå©íºÇµëŒâû
'//     REVISIONS :(EG20 V30.4.0.1) 2015-01-15 CODED BY  [TCC] S.Kuroda
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇRëŒâûÅyHKRK_kansi02_001_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit

Private Const MN_MAIL_INTERVAL = 1000                   'ÉÅÉCÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl
Private Const TITOL_EKI_NAME = "âwñºÅF"                 'âwñºÉ^ÉCÉgÉã       ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
Private bScroll As Boolean

'ê›íËîΩâfÉtÉâÉO
Private SetteiHaneiFlg As Boolean

'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉO
Private KikiDataUpDateFlg As Boolean

'ã@äÌç\ê¨ÉfÅ[É^ÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãì«éÊópÇÃç\ë¢ëÃ
Private Type SUBGATE_IMAGE_FILE
    sType       As String                'éÌï 
    sGoki       As String                'çÜã@
    sNo         As String                'éÌï ñàí î‘
    sCorner     As String                'ÉRÅ[Éi        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    sTuuban     As String                'í î‘
    sKoumoku    As String                'çÄñ⁄
    sKubun      As String                'ãÊï™
    sSettei     As String                'ê›íËíl
    sSyosai     As String                'ê›íËílè⁄ç◊
End Type

'Private Const START_DATA_COL_INDEX = 1       '1çsÇÃÉfÅ[É^ê›íËÇäJénÇ∑ÇÈÉJÉâÉÄÉCÉìÉfÉbÉNÉX  'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
Private Const START_DATA_COL_INDEX = 2       '1çsÇÃÉfÅ[É^ê›íËÇäJénÇ∑ÇÈÉJÉâÉÄÉCÉìÉfÉbÉNÉX   'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
'Private Const MAX_DATA_COL_INDEX = 6         '1çsÇÃç≈ëÂê›íËÉJÉâÉÄêî        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
'Private Const MAX_DATA_COL_INDEX = 3         '1çsÇÃç≈ëÂê›íËÉJÉâÉÄêî         ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡   'EG20 V30.1.0.1 DEL
'Private Const MAX_DATA_COL_INDEX = 6         '1çsÇÃç≈ëÂê›íËÉJÉâÉÄêî         ' EG20 V30.1.0.1 ADD   'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
Private Const MAX_DATA_COL_INDEX = 7         '1çsÇÃç≈ëÂê›íËÉJÉâÉÄêî         ' EG20 V30.1.0.1 ADD    'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD START
Private Const FM_CORNER_COL = 2                 'FMåîÉRÅ[Éiî‘çÜÇÃóÒÅiCOLÉvÉçÉpÉeÉBÅj
Private Const FM_GOKI_COL = 3                   'FMåîçÜã@î‘çÜÇÃóÒÅiCOLÉvÉçÉpÉeÉBÅj
Private Const SINKANSENIC_CORNER_COL = 4        'êVä≤ê¸ICÉRÅ[Éiî‘çÜÅiCOLÉvÉçÉpÉeÉBÅj
Private Const SINKANSENIC_GOKI_COL = 5          'êVä≤ê¸ICçÜã@î‘çÜÅiCOLÉvÉçÉpÉeÉBÅj
Private Const NRZ_CORNER_COL = 6                'NRZåîÉRÅ[Éiî‘çÜ(COLÉvÉçÉpÉeÉB)
Private Const NRZ_GOKI_COL = 7                  'NRZåîçÜã@î‘çÜ(COLÉvÉçÉpÉeÉB)
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01ÅzADD END


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : ã@äÌèÓïÒê›íËÅiÉGÉìÉRÅ[ÉhÅjâÊñ (ÉAÉNÉeÉBÉuéûÅFÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ)
'//  ã@î\äTóv  : ç≈ëOëOï\é¶èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'é©âÊñ ç≈ëOñ ï\é¶èàóùÇçsÇ§ÅB
    pfFormActive (hwnd)
    
    'ÉtÉHÅ[ÉJÉXà íuÇê›íË
    cmdCancel.SetFocus
    
    'É^ÉCÉ}ÇãNìÆÇ∑ÇÈ
    tmrMail.Enabled = True
    
End Sub

'EG20 V2.1.0.1 ADD START ÅyÉtÉFÅ[ÉYÇQëŒâûÅz
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : ã@äÌèÓïÒê›íËÅiÉGÉìÉRÅ[ÉhÅjâÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÅAÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-11-26   CODED   BY [TCC] M.Matsumoto
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
On Error Resume Next
    'É^ÉCÉ}Çí‚é~Ç∑ÇÈ
    tmrMail.Enabled = False
End Sub
'EG20 V2.1.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : ã@äÌèÓïÒê›íËÅiÉGÉìÉRÅ[ÉhÅjâÊñ (ÉçÅ[ÉhéûÅFÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ)
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V30.1.0.1) 2014-05-20  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()

    Dim bRet                 As Boolean         'ä÷êîñﬂÇËíl
    Dim lErrCode             As Long            'ÉGÉâÅ[ÉRÅ[Éh
    Dim iLoopCnt             As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_START, 0)
    
    '----------------------------------------------------
    'âÊñ èâä˙ílê›íË
    '----------------------------------------------------
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000
    
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅiçXêVê›íËÅj
    KikiDataUpDateFlg = True
    
    'ã@äÌèÓïÒê›íËÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÏê¨
    bRet = dllGetKikiIniData(2, 0, KIKI_DATA_SET_SUBGATE_FILE, EKI_SETTI_FILE, KIKI_DATA_FILE, lErrCode)
    If bRet = False Then
        'ã@äÌèÓïÒê›íËÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÌèú
        Kill KIKI_DATA_SET_SUBGATE_FILE
        'àŸèÌÉçÉOèoóÕ
        Call pfOutPutErrLog(lErrCode)
    End If

    'çÜã@ÉRÉìÉ{É{ÉbÉNÉXèâä˙íl
    cmbGoki.Clear

    'For iLoopCnt = 0 To 15 'EG20 V30.1.0.1 DEL
    For iLoopCnt = 0 To 31  'EG20 V30.1.0.1 ADD
            cmbGoki.AddItem iLoopCnt + 1 & "çÜã@"
    Next
    cmbGoki.ListIndex = 0

' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    'ÉRÅ[Éiê›íËÉRÉìÉ{É{ÉbÉNÉXÇÃèâä˙âªèàóù
    Call InitCornerComboBox
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ

    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅií èÌê›íËÅj
    KikiDataUpDateFlg = False
    
    'ÉÅÉCÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈ
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False
    
    'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
    SetteiHaneiFlg = False

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMópÉ^ÉCÉ}èàóùÅiÉ^ÉCÉÄÉAÉbÉvéûÅFÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉÅj
'//  ã@î\äTóv  : îƒópÉÅÉCÉãéÛêMèàóùÇçsÇ§
'//
'//              å^        ñºèÃ     Å@Å@Å@à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        Å@Å@ à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(V30.1.0.1) 2014-06-04 REVISED BY [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸â¸çsëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()

    Dim udtReadMail As ML_KYOTU_INF  'ÉÅÅ[ÉãéÛêMÉGÉäÉA
    Dim lngLength As Long            'éÛêMÉÅÅ[ÉãÉoÉCÉgÉTÉCÉY
    Dim intStatus As Integer         'éÛêMÉÅÅ[ÉãÉ`ÉFÉbÉNåãâ 
    Dim iResponse As Integer
    
    On Error Resume Next
    
    'ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
    lngLength = DssMailRead(plMSlot_MN, udtReadMail)
    If lngLength > 0 Then
    'éÛêMÉÅÅ[ÉãÇ™Ç†ÇÍÇŒÅAÉÅÅ[ÉãÇhÇcñàÇÃèàóùÇÇ∑ÇÈÅB
        Select Case udtReadMail.udtlHeader.dwId        'ÉÅÅ[ÉãÇhÇc
            Case ML_ID_PROEND_ORD
                'ÅuÉvÉçÉZÉXèIóπéwé¶ÅvÇéÛêMÇµÇΩèÍçáÅA
                'ÅuÉvÉçÉZÉXèIóπéwé¶éÛêMê≥èÌÅvÉçÉOèoóÕ
                Call sLogTraceReq(LTYP_NORMAL, L3AN_RECV, PROCESS_END_ORD_RECV, 0)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
                'ÉvÉçÉZÉXÇÃèIóπèàóùÇçsÇ§
                pfAbortProc
            Case ML_ID_HOSHU_ACTIVE_REQ
                'Åuï€éÁâÊñ ÉAÉNÉeÉBÉuï\é¶ÅvÇéÛêMÇµÇΩèÍçá
                'Åuï€éÁâÊñ ÉAÉNÉeÉBÉuï\é¶óvãÅéÛêMê≥èÌÅvÉçÉOèoóÕ
                Call sLogTraceReq(LTYP_NORMAL, L3AN_RECV, HOSHU_ACTIVE_REQ_RECV, 0)
                'ï\é¶å≥âÊñ Åiï€éÁÉfÅ[É^é˚èWâÊñ ÅjÇÉAÉNÉeÉBÉuï\é¶Ç∑ÇÈÅB
                'AppActivate frmInputMstData.Caption, False     'EG20 V30.1.0.1 DEL
                'EG20 V30.1.0.1 ADD START
                AppActivate frmKikiDataSubGate.Caption, False
                pfFormActive (frmKikiDataSubGate.hwnd)
                'EG20 V30.1.0.1 ADD END
            Case ML_ID_HOSHU_OPERATE_PROG_SNDREQ_RES
                'Åuï€éÁëÄçÏëÏÉvÉçÉOÉâÉÄëóêMóvãÅÅvÇéÛêMÇµÇΩèÍçá
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
                If pubfuncRespCheckTakuProgramData(udtReadMail) = False Then
                    iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ")
                Else
                    iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "îΩâfèàóùê›íËîΩâfåãâ ")
                End If
                Call SetEnableTrue
            Case Else
                 'ÇªÇÃëºÇÃÉÅÅ[ÉãÇéÛêMÇµÇΩèÍçá
                 'ÅuÉÅÅ[ÉãIDïsê≥ÅvÉçÉOèoóÕ
                 Call sLogTraceReq(LTYP_ERROR, L3AN_RECV, MAIL_FUSEI_RECV, 0)
        End Select
    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdCancel_Click
'//  ã@î\ñºèÃ  : ÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : é©âÊñ Çè¡ãéÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdCancel_Click()
    Dim iResponse           As Integer          'MsgBoxñﬂÇËíl
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    If SetteiHaneiFlg = True Then
        iResponse = MsgBox("âÊñ ï\é¶íÜÇ…ê›íËÇ≥ÇÍÇΩÉfÅ[É^Ç™é∏ÇÌÇÍÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                            "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                            vbYesNo + vbQuestion, _
                            "ê›íËîΩâfñtñ¢âüâ∫")
        
        If iResponse = vbNo Then Exit Sub
    End If
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_END, 0)
    
    Unload Me

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDisp
'//  ã@î\ñºèÃ  : âÊñ çƒï`âÊèàóù
'//  ã@î\äTóv  : âÊñ Ççƒï`âÊÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-09-19  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâûÅyHKRK_Kansi07_003_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sDisp()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim nCornerIndex         As Integer         ' ÉRÅ[ÉiëIëèÛë‘
    
    ' EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD START
    Dim iLoopCnt            As Integer          'ÉãÅ[ÉvÉJÉEÉìÉ^ÅiÉZÉãècï˚å¸Åj
    Dim iLoopCnt2           As Integer          'ÉãÅ[ÉvÉJÉEÉìÉ^ÅiÉZÉãâ°ï˚å¸Åj
    ' EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD END

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    If CmbCornerName.ListIndex < 0 Then
        Exit Sub
    End If
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ

    'èâä˙ílê›íË
    strFileName = ""                            'ÉtÉ@ÉCÉãñº
    cmbGoki.Enabled = False                     'çÜã@ëIëÉRÉìÉ{É{ÉbÉNÉXëIëïsâ¬ê›íË
    CmbCornerName.Enabled = False               ' ÉRÅ[ÉiëIëïîëIëïsâ¬      ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    LblEkiName.Caption = TITOL_EKI_NAME         'âwñºÉâÉxÉãèâä˙âª           ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
    '----------------------------------------------------
    'ÉOÉäÉbÉhÉ^ÉCÉgÉãê›íË
    '----------------------------------------------------
    Call sDispGridTitol
    
    'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOÉ`ÉFÉbÉN
    If KikiDataUpDateFlg = True Then
        Erase KikiDataTbl
        ReDim KikiDataTbl(0)
        Call pfKikiDataSet
    End If
    
    '----------------------------------------------------
    'åªç›âwê›íËÉtÉ@ÉCÉãåüçı
    '----------------------------------------------------
    strFileName = Dir(EKI_SETTI_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then
    
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_EKI_SETTI, 0)
        
        'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
        Call sDispDataClear
        GridIni.Enabled = False
        
        'èàóùñtâüâ∫ïsâ¬î\ê›íË
        CmdKikiSetMenu(0).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
        CmdKikiSetMenu(1).Enabled = False           'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
        CmdKikiSetMenu(2).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

        Exit Sub
        
    End If
    
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    '----------------------------------------------------
    'âwñºÉâÉxÉãçXêV
    '----------------------------------------------------
    LblEkiName.Caption = TITOL_EKI_NAME & pfGetEkiNameInfo(NotEkiVer)
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
    
    'ã@äÌç\ê¨èÓïÒÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãåüçı
    strFileName = Dir(KIKI_DATA_SET_SUBGATE_FILE)
    
    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇΩèÍçá
    If strFileName <> "" Then
    
        'ÉOÉäÉbÉhÉfÅ[É^ïîê›íË
'        Call sDispDataSet(cmbGoki.ListIndex + 1)                               ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL START
'' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
'        nCornerIndex = CmbCornerName.ListIndex
'        Call sDispDataSet(cmbGoki.ListIndex + 1, nCornerIndex + 1)
'' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL END
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD START
        'ëÂï™óﬁ:5ÇÃâwìsìxÉfÅ[É^ÇÕÉRÅ[ÉiéwíËÇ≈ÇÕÇ»Ç≠Ç»Ç¡ÇΩÇΩÇﬂÅAÉRÅ[ÉiÇÕ0å≈íËÇ∆Ç∑ÇÈÅBÅiâwìsìxÇÃÉRÅ[ÉiÇÕ0Ç≈åüçıÇ∑ÇÈÅj
        '1Å`32çÜã@
        For iLoopCnt = 0 To 31
            'çÄñ⁄á@Å`áE
            For iLoopCnt2 = 0 To 5
                Call sDispDataSet(iLoopCnt + 1, 0, iLoopCnt2 + 1)
            Next
        Next
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD END
    Else
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_SUBGATE_IMAGE, 0)
        
        'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
        Call sDispDataClear
        GridIni.Enabled = False
        
        'èàóùñtâüâ∫ïsâ¬î\ê›íË
        CmdKikiSetMenu(0).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
        CmdKikiSetMenu(1).Enabled = False           'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
        CmdKikiSetMenu(2).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

    End If
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDispGridTitol
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÉ^ÉCÉgÉãïîê›íËèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÇÃèâä˙ílÅAÉ^ÉCÉgÉãÇê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V30.1.0.1) 2014-04-28  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-09-19  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâûÅyHKRK_Kansi07_003_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sDispGridTitol()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    Dim ColCount                As Integer         ' ÉJÉâÉÄÉJÉEÉìÉ^
    Dim RowCount                As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^

    GridIni.Visible = False             'ê›íËíÜÇÕîÒï\é¶Ç…ê›íË
    
    'ÉOÉäÉbÉhÉ^ÉCÉgÉãê›íË
    With GridIni
    
        '----------------------------------
        'ÉOÉäÉbÉhÇÃèâä˙âª
        '----------------------------------
        .Clear
        
        '----------------------------------
        'ÉOÉäÉbÉhÉZÉãêîê›íË
        '----------------------------------
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúäJén
'        .Rows = 18
'        .Cols = 7
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúèIóπ
' EG20 V30.1.0.1 DEL START
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
'        .Rows = 5
'        .Cols = 4
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
' EG20 V30.1.0.1 DEL END
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01ÅzDEL START
'' EG20 V30.1.0.1 ADD START
'        .Rows = 2
'        .Cols = 7
'' EG20 V30.1.0.1 ADD END
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01ÅzDEL END
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01ÅzADD START
        .Rows = 33
        .Cols = 8
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01ÅzADD END
        For ColCount = 2 To (.Cols - 1)
            .ColWidth(ColCount) = 1748
        Next

        '----------------------------------
        'ÉOÉäÉbÉhïùê›íË
        '----------------------------------
        .ColWidth(0) = 1000
        .ColWidth(1) = 1000         'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
        
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL START
'        For ColCount = 1 To (.Cols - 1)
'            .ColWidth(ColCount) = 1748
'        Next
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL END
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD START
        For ColCount = 2 To (.Cols - 1)
            .ColWidth(ColCount) = 1548
        Next
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD END

        '----------------------------------
        'É^ÉCÉgÉãê›íË
        '----------------------------------
        For RowCount = 1 To (.Rows - 1)
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD START
            'çÜã@ï\é¶
            .Col = 0
            .Row = RowCount: .Text = RowCount & "çÜã@"
            .CellAlignment = flexAlignLeftCenter
            
            'é©é–ÅEëºé–ï\é¶Åiñkó§êVä≤ê¸Ç≈ÇÕâwìsìxÇÕé©é–ÇÃÇ›Åj
            .Col = 1
            .Row = RowCount: .Text = "é©é–"
            .CellAlignment = flexAlignLeftCenter
            
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL START
'            If RowCount = 1 Then
'                'é©é–ê›íË
'                .Col = 0
'                .Row = RowCount: .Text = "é©é–"
'                .CellAlignment = flexAlignLeftCenter
'
'            Else
'                'ëºé–ê›íË
'                .Col = 0
'                .Row = RowCount: .Text = "ëºé–" & RowCount - 1
'                .CellAlignment = flexAlignLeftCenter
'            End If
        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL END
        
        Next

        .RowHeight(0) = 500

    End With

    GridIni.Visible = True

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDispDataClear
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^ïîÇÉNÉäÉAÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sDispDataClear()
    
    Dim iRowCnt             As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim ColCount             As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    GridIni.Visible = False             'ê›íËíÜÇÕîÒï\é¶Ç…ê›íË
    
    'ÉOÉäÉbÉhèâä˙âª
    With GridIni

        For iRowCnt = 1 To (.Rows - 1)
        
            .Row = iRowCnt

            'çÄñ⁄ê›íË
            For ColCount = 2 To (.Rows - 1)
                .Col = ColCount
                .Text = ""
                .CellAlignment = flexAlignLeftCenter
            Next

        Next

    End With

    GridIni.Visible = True

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sDispDataSet
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÉfÅ[É^ïîê›íËèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^ïîÇê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-09-19  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâûÅyHKRK_Kansi07_003_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Sub sDispDataSet(iGoki As Integer)                       ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
'Private Sub sDispDataSet(iGoki As Integer, iCorner As Integer)    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡ 'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
Private Sub sDispDataSet(iGoki As Integer, iCorner As Integer, iKomoku As Integer)    ' EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
    
    Dim intFileNumber       As Integer                      ' ÉtÉ@ÉCÉãÉ|ÉCÉìÉ^
    Dim iKikiDataCnt        As Integer                      ' ã@äÌèÓïÒÉfÅ[É^ÉJÉEÉìÉ^
    Dim ColCount            As Integer                      ' ÉJÉâÉÄÉJÉEÉìÉ^
    Dim RowCount            As Integer                      ' çsÉJÉEÉìÉ^
    
    Dim strBunrui_Dai       As String                       ' ëÂï™óﬁ
    Dim strBunrui_Tyu       As String                       ' íÜï™óﬁ
    Dim strBunrui_Sho       As String                       ' è¨ï™óﬁ
    Dim strKomoku           As String                       ' çÄñ⁄
    Dim strKubun            As String                       ' ãÊï™
    Dim strData             As String                       ' ê›íËíl
    Dim strSetShosai        As String                       ' ê›íËílè⁄ç◊
    
    Dim strDispData         As String                       ' ï\é¶ÉfÅ[É^
    Dim strCorner           As String                       ' ÉRÅ[Éi    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    Dim iCmpCorner          As Integer                      ' ÉRÅ[Éi    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'èâä˙ílê›íË
    iKikiDataCnt = 0
    
    'ì‡ïîÉtÉ@ÉCÉãÉGÉâÅ[ÇÃÉgÉâÉbÉv
    On Error GoTo Err_LOG
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜéÊìæ
    intFileNumber = FreeFile
    
    'âwìsìxÉfÅ[É^ämîFÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
    Open KIKI_DATA_SET_SUBGATE_FILE For Input As #intFileNumber
    
    GridIni.Visible = False             'ê›íËíÜÇÕîÒï\é¶Ç…ê›íË

    ColCount = START_DATA_COL_INDEX     'ÉfÅ[É^ê›íËÇÃÉXÉ^Å[ÉgÉJÉâÉÄÉCÉìÉfÉbÉNÉX
    RowCount = 1                        'ÉfÅ[É^ê›íËÇÃÉXÉ^Å[ÉgçsÉCÉìÉfÉbÉNÉX
    Do While Not EOF(intFileNumber)
        'ÇP çsì«Ç›çûÇ›
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúäJén
'        Input #intFileNumber, strBunrui_Dai, strBunrui_Tyu, strBunrui_Sho, _
'                              strKomoku, strKubun, strData, strSetShosai
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúèIóπ
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
        Input #intFileNumber, strBunrui_Dai, strBunrui_Tyu, strBunrui_Sho, strCorner, _
                              strKomoku, strKubun, strData, strSetShosai
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ

        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOÉ`ÉFÉbÉN
        If KikiDataUpDateFlg = False Then
            For iKikiDataCnt = 0 To UBound(KikiDataTbl)
        
                'äYìñÉfÅ[É^åüçı
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúäJén
'                If (BUNRUI_DAI.DAI_SubGate = KikiDataTbl(iKikiDataCnt).iBunrui_Dai) And _
'                   (CInt(strBunrui_Tyu) = KikiDataTbl(iKikiDataCnt).iBunrui_Tyu) And _
'                   (CInt(strBunrui_Sho) = KikiDataTbl(iKikiDataCnt).iBunrui_Sho) Then
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèúèIóπ
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
                If (BUNRUI_DAI.DAI_SubGate = KikiDataTbl(iKikiDataCnt).iBunrui_Dai) And _
                   (CInt(strBunrui_Tyu) = KikiDataTbl(iKikiDataCnt).iBunrui_Tyu) And _
                   (CInt(strBunrui_Sho) = KikiDataTbl(iKikiDataCnt).iBunrui_Sho) And _
                   (CInt(strCorner) = KikiDataTbl(iKikiDataCnt).iBunrui_Corner) Then
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
                  
                    strData = KikiDataTbl(iKikiDataCnt).strData
                    strData = StrConv(strData, vbUnicode)
                    
                End If
            Next
        End If
                
        'çÜã@î‘çÜÉ`ÉFÉbÉN
        If CStr(iGoki) = strBunrui_Tyu Then
            If iKomoku = CInt(strBunrui_Sho) Then       'EG20 V30.3.0.1 ÅyHKRK_Kansi07_008_01Åz ADD
        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
                ' ÉRÅ[ÉiîªíËí«â¡
                ' ëIëÇµÇΩÉRÅ[ÉiÅAÇ‡ÇµÇ≠ÇÕÉRÅ[Éiñ≥ä÷åWÇÃÉåÉRÅ[ÉhÇÕçÃópÇ∑ÇÈ
                iCmpCorner = CInt(strCorner)
                'If (iCorner = iCmpCorner) Then 'EG20 V30.1.0.1 DEL
                If ((iCorner = iCmpCorner) Or (iCmpCorner = 0)) Then 'EG20 V30.1.0.1 ADD
        
        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
                
                    'ÉOÉäÉbÉhê›íË
                    With GridIni
                
                        'ÉJÉâÉÄÉCÉìÉfÉbÉNÉXê›íË
                        '.Col = ColCount                    'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
                        .Col = ColCount + (iKomoku - 1)     'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
                        
                       'É^ÉCÉgÉãê›íË
                        If (strKomoku <> "") Then
                            .Row = 0
                            .Text = strKomoku
                            .CellAlignment = flexAlignLeftCenter
                        End If
        
                        'çÄñ⁄ê›íË
                        '.Row = RowCount        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
                        .Row = iGoki            'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
                        .Text = Format(pfDispIniData(.Text, strData, strKubun), "000")
                        .CellAlignment = flexAlignLeftCenter
                        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_008_01Åz ADD START
                        'âwìsìxÉfÅ[É^1ÉåÉRÅ[Éhï™ÇÃê›íËílÇÉZÉãÇ…ÉZÉbÉgÇµÇΩÇÃÇ≈ÅAàÍíUèIÇÌÇÁÇ∑ÅB
                        Exit Do
                        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_008_01Åz ADD END
                        'EG20 V30.3.0.1 ÅyHKRK_Kansi07_008_01Åz DEL START è„ãLExit DoÇ…ÉçÉWÉbÉNïœçXÇµÇΩÇΩÇﬂïsóvÇ…Ç»Ç¡ÇΩÅB
        '                ColCount = ColCount + 1
        '                If ColCount > MAX_DATA_COL_INDEX Then
        '                 ColCount = START_DATA_COL_INDEX
        '                 RowCount = RowCount + 1
        '                End If
                       'EG20 V30.3.0.1 ÅyHKRK_Kansi07_008_01Åz DEL END
        
                    End With
                
                End If          ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
            End If          'EG20 V30.3.0.1 ÅyHKRK_Kansi07_008_01ÅzADD
        End If
    
    Loop

    GridIni.Visible = True
    
    'ÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    Close #intFileNumber
    
    'çÜã@ëIëÉRÉìÉ{É{ÉbÉNÉXëIëâ¬ê›íË
    cmbGoki.Enabled = True
    CmbCornerName.Enabled = True                ' ÉRÅ[ÉiëIëïîëIëâ¬      ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡

    'èàóùñtâüâ∫â¬î\ê›íË
    CmdKikiSetMenu(0).Enabled = True            'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
    CmdKikiSetMenu(1).Enabled = True            'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
    CmdKikiSetMenu(2).Enabled = True            'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

    Exit Sub

'ÉGÉâÅ[èàóù
Err_LOG:

    If intFileNumber > 0 Then
        Close #intFileNumber
    End If
    
    'àŸèÌÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, FILE_ACCESS_ERROR, 0)
    
    'ÉOÉäÉbÉhÉ^ÉCÉgÉãê›íË
    Call sDispGridTitol
    
    'ÉOÉäÉbÉhÉfÅ[É^ïîÉNÉäÉAèàóù
    Call sDispDataClear
    GridIni.Enabled = False

    GridIni.Visible = True

    'èàóùñtâüâ∫ïsâ¬î\ê›íË
    CmdKikiSetMenu(0).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
    CmdKikiSetMenu(1).Enabled = False           'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
    CmdKikiSetMenu(2).Enabled = False           'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GridIni_Click
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÇëIëÇ≥ÇÍÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V30.3.0.1) 2014-09-19  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâûÅyHKRK_Kansi07_003_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub GridIni_Click()
    
    Dim iLoopCnt As Integer
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ÉNÉäÉbÉNÇ≥ÇÍÇΩà íuÇ…É_É~Å[ÉeÉLÉXÉgÇà⁄ìÆÇµÅAÉtÉHÅ[ÉJÉXÇçáÇÌÇπÇÈ
    With GridIni
        
        CmbDummy.Left = .Left + .CellLeft
        CmbDummy.Top = .Top + .CellTop
        CmbDummy.Width = .CellWidth
        CmbDummy.Height = .CellHeight
        CmbDummy.Text = .Text
        CmbDummy.Visible = True
        CmbDummy.SetFocus

        'É_É~Å[ÉRÉìÉ{É{ÉbÉNÉXèâä˙íl
        CmbDummy.Clear
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD START
        'ÉNÉäÉbÉNÇ≥ÇÍÇΩóÒÇ…ÇÊÇ¡ÇƒÉRÉìÉ{É{ÉbÉNÉXÇ©ÇÁëIÇ◊ÇÈílÇêÿÇËë÷Ç¶ÇÈ
        Select Case .Col
            'FMåîÉRÅ[Éiî‘çÜÅAêVä≤ê¸ICÉRÅ[Éiî‘çÜÅANRZåîÉRÅ[Éiî‘çÜ
            Case FM_CORNER_COL, SINKANSENIC_CORNER_COL, NRZ_CORNER_COL
                'ì¸óÕílÇÕ00Å`99
                'âwìsìxédólÇ≈ÇÕ00Å`99ÇæÇ™ÅAó·äOìIÇ»ílÇ‡çló∂ÇµÇƒ255Ç‹Ç≈ì¸ÇÍÇÁÇÍÇÈÇÊÇ§ÅAÇ∆ÇËÇ†Ç¶Ç∏ÇµÇƒÇ®Ç¢Çƒó~ÇµÇ¢Ç∆ìåé≈ólÇ©ÇÁÇÃéwé¶Ç…ÇÊÇË
                '000Å`255Ç…ïœçX
                For iLoopCnt = 0 To 255
                    CmbDummy.AddItem Format(CStr(iLoopCnt), "000")
                    
                    'ÉRÉìÉ{É{ÉbÉNÉXÇÃÉCÉìÉfÉbÉNÉXÇê›íË
                    If .Text <> "" Then
                        If iLoopCnt = CInt(.Text) Then
                            
                            'ílÇ™àÍívÇµÇΩÇÁÉCÉìÉfÉbÉNÉXê›íË
                            CmbDummy.ListIndex = iLoopCnt
                            
                        End If
                    End If
                Next
            'FMåîçÜã@î‘çÜÅAêVä≤ê¸ICçÜã@î‘çÜÅANRZåîçÜã@î‘çÜ
            Case FM_GOKI_COL, SINKANSENIC_GOKI_COL, NRZ_GOKI_COL
                'ì¸óÕílÇÕ01Å`16
                'âwìsìxédólÇ≈ÇÕ01Å`16ÇæÇ™ÅAó·äOìIÇ»ílÇ‡çló∂ÇµÇƒ255Ç‹Ç≈ì¸ÇÍÇÁÇÍÇÈÇÊÇ§ÅAÇ∆ÇËÇ†Ç¶Ç∏ÇµÇƒÇ®Ç¢Çƒó~ÇµÇ¢Ç∆ìåé≈ólÇ©ÇÁÇÃéwé¶Ç…ÇÊÇË
                '000Å`255Ç…ïœçX
                For iLoopCnt = 0 To 255
                    'CmbDummy.AddItem Format(CStr(iLoopCnt + 1), "000")
                    CmbDummy.AddItem Format(CStr(iLoopCnt), "000")
                    
                    'ÉRÉìÉ{É{ÉbÉNÉXÇÃÉCÉìÉfÉbÉNÉXÇê›íË
                    If .Text <> "" Then
                        'If (iLoopCnt + 1) = CInt(.Text) Then
                        If (iLoopCnt) = CInt(.Text) Then
                            
                            'ílÇ™àÍívÇµÇΩÇÁÉCÉìÉfÉbÉNÉXê›íË
                            CmbDummy.ListIndex = iLoopCnt
                            
                        End If
                    End If
                Next
            Case Else
                For iLoopCnt = 0 To 255
                    CmbDummy.AddItem Format(CStr(iLoopCnt), "000")
                    
                    'ÉRÉìÉ{É{ÉbÉNÉXÇÃÉCÉìÉfÉbÉNÉXÇê›íË
                    If iLoopCnt = CInt(.Text) Then
                        
                        'ílÇ™àÍívÇµÇΩÇÁÉCÉìÉfÉbÉNÉXê›íË
                        CmbDummy.ListIndex = iLoopCnt
                        
                    End If
                Next
            End Select
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD END
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL START
'        For iLoopCnt = 0 To 255
'            CmbDummy.AddItem Format(CStr(iLoopCnt), "000")
'
'            'ÉRÉìÉ{É{ÉbÉNÉXÇÃÉCÉìÉfÉbÉNÉXÇê›íË
'            If iLoopCnt = CInt(.Text) Then
'
'                'ílÇ™àÍívÇµÇΩÇÁÉCÉìÉfÉbÉNÉXê›íË
'                CmbDummy.ListIndex = iLoopCnt
'
'            End If
'        Next
'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL END
    
    End With

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GridIni_Scroll
'//  ã@î\ñºèÃ  : ÉOÉäÉbÉhÇÉXÉNÉçÅ[ÉãÇµÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃîÒï\é¶
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub GridIni_Scroll()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ÉOÉäÉbÉhÇ™ÉXÉNÉçÅ[ÉãÇ≥ÇÍÇΩéûÅAÉ_É~Å[ÉeÉLÉXÉgÇîÒï\é¶Ç…Ç∑ÇÈ
    If bScroll = False Then
        CmbDummy.Visible = False
        CmbDummy.Clear
    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmbDummy_Click
'//  ã@î\ñºèÃ  : É_É~Å[ÉeÉLÉXÉgÇ™ëIëÇ≥ÇÍÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : ÉOÉäÉbÉhÇ÷ÇÃîΩâf
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     ORIGINAL  :(EG20 V3.0.0.2) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxèCê≥ëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-09-19  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâûÅyHKRK_Kansi07_003_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmbDummy_Click()

    Dim iLoopCnt            As Integer                      ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim iLoopCnt2           As Integer                      ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim byBuff()            As Byte                         'ÉoÉCÉgÉoÉbÉtÉ@
    Dim iGoki               As Integer                      ' çÜã@î‘çÜ
    Dim iBunrui_Sho         As Integer                      ' è¨ï™óﬁ
    Dim iBunrui_Corner      As Integer                      ' ÉRÅ[Éiï™óﬁ            ' EG20 V3.0.0.2 ÅiâwìsìxèCê≥ëŒâûÅjí«â¡

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    If GridIni.Text <> CmbDummy.Text Then
        'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ†ÇËÅj
        SetteiHaneiFlg = True
    End If

    GridIni.Text = CmbDummy.Text
    GridIni.CellAlignment = flexAlignLeftCenter
    
    'iGoki = cmbGoki.ListIndex + 1                                              'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
    iGoki = GridIni.Row                                                         'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
    'iBunrui_Sho = ((GridIni.Row - 1) * MAX_DATA_COL_INDEX) + GridIni.Col       'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz DEL
    iBunrui_Sho = GridIni.Col - 1                                               'EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01Åz ADD
    'iBunrui_Corner = CmbCornerName.ListIndex + 1                                    ' EG20 V3.0.0.2 ÅiâwìsìxèCê≥ëŒâûÅjí«â¡ EG20 V30.3.0.1 ÅyHKRK_Kansi07_003_01ÅzDEL
    iBunrui_Corner = 0                                                           'EG20 V30.3.0.1ÅyHKRK_Kansi07_003_01Åz ÉRÅ[Éiï Ç≈ÇÕÇ»Ç¢ÇÃÇ≈0å≈íË ADD

    For iLoopCnt = 0 To UBound(KikiDataTbl)

        'äYìñÉfÅ[É^åüçı
        If (BUNRUI_DAI.DAI_SubGate = KikiDataTbl(iLoopCnt).iBunrui_Dai) And _
           (iGoki = KikiDataTbl(iLoopCnt).iBunrui_Tyu) And _
           (iBunrui_Sho = KikiDataTbl(iLoopCnt).iBunrui_Sho) And _
           (iBunrui_Corner = KikiDataTbl(iLoopCnt).iBunrui_Corner) Then             ' EG20 V3.0.0.2 ÅiâwìsìxèCê≥ëŒâûÅjí«â¡

            'ã@äÌç\ê¨èÓïÒÉfÅ[É^ï€ë∂
            byBuff = StrConv(GridIni.Text, vbFromUnicode)

            Erase KikiDataTbl(iLoopCnt).strData

            'ìÆìIîzóÒÇÃì‡óeÇÉçÉOÉpÉâÉÅÅ[É^ç\ë¢ëÃÇÃê√ìIîzóÒÇ…äiî[Ç∑ÇÈÅB
            For iLoopCnt2 = 0 To UBound(KikiDataTbl(iLoopCnt).strData)
                'NullílÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈÅB
                If byBuff(iLoopCnt2) = vbVEmpty Then Exit For

                KikiDataTbl(iLoopCnt).strData(iLoopCnt2) = byBuff(iLoopCnt2)

                'ìÆìIîzóÒÇÃç≈ëÂóvëfÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈ
                If iLoopCnt2 = UBound(byBuff) Then Exit For
            Next

            Exit For

        End If

    Next

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmbDummy_KeyDown
'//  ã@î\ñºèÃ  : ÉLÅ[É{Å[Éhâüâ∫éûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmbDummy_KeyDown(KeyCode As Integer, Shift As Integer)
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ì¡éÍÉLÅ[Çâüâ∫Ç≥ÇÍÇΩéûÅAâ∫ãLÇÃèàóùÇçsÇ§
    bScroll = True
    
    With GridIni
    
        'É_É~Å[ÉeÉLÉXÉgÇÃÉZÉbÉg
        CmbDummy.Left = .Left + .CellLeft
        CmbDummy.Top = .Top + .CellTop
        CmbDummy.Width = .CellWidth
        CmbDummy.Height = .CellHeight
        CmbDummy.Text = .Text
        CmbDummy.Visible = True
        CmbDummy.SetFocus

    End With
    bScroll = False

End Sub


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmbDummy_LostFocus
'//  ã@î\ñºèÃ  : É_É~Å[ÉeÉLÉXÉgÇ©ÇÁÉtÉHÅ[ÉJÉXÇ™à⁄ìÆÇµÇΩéûÇÃÉCÉxÉìÉgÉvÉçÉVÅ[ÉWÉÉ
'//  ã@î\äTóv  : É_É~Å[ÉeÉLÉXÉgÇîÒï\é¶Ç…Ç∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmbDummy_LostFocus()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'É_É~Å[ÉeÉLÉXÉgÇîÒï\é¶Ç…Ç∑ÇÈ
    CmbDummy.Visible = False
    CmbDummy.Clear

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmdKikiSetMenu_Click
'//  ã@î\ñºèÃ  : äeñtâüâ∫éûèàóù
'//  ã@î\äTóv  : äeñtâüâ∫èàóùÇ…è]Ç§
'//
'//              å^        ñºèÃ     Å@Å@Å@à”ñ°
'//  à¯êî      : IntegerÅ@ Index          ëIëñtÇÃÉCÉìÉfÉbÉNÉX
'//
'//              å^        íl        Å@Å@ à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22   CODED   BY [TCC] H.Sugimoto
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmdKikiSetMenu_Click(Index As Integer)
    
    Dim iResponse           As Integer          'MsgBoxñﬂÇËíl
    Dim bUnlock             As Boolean          ' ÉçÉbÉNâèúÉtÉâÉO      ' EG20 V3.0.0.2 í«â¡

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    Call SetEnableFalse
    
' EG20 V3.0.0.2 í«â¡äJén
' âüâ∫ÇµÇΩñtÇ…âûÇ∂ÇƒÉçÉbÉNâèúÇêßå¿Ç∑ÇÈ
' Å¶ÉÅÅ[ÉãéÛêMÇë“Ç¬ÇΩÇﬂ
    bUnlock = True
' EG20 V3.0.0.2 í«â¡èIóπ
    Select Case Index
        
        Case 0                                 ' ã@äÌç\ê¨çÄñ⁄ê›íËîΩâf
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_KIKIDATA_INSTOL, 0)
            
            'ã@äÌç\ê¨çÄñ⁄ê›íËîΩâfèàóù
            Call sInstolKikiData
            bUnlock = False                     ' EG20 V3.0.0.2 í«â¡
        Case 1                                 ' ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕ
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_KIKIDATA_OUTPUT, 0)
            
            'ã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕèàóù
            Call sKikiDataOutPut
    
        Case 2                                 ' ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_KIKIDATA_SAVE, 0)
            
            'ã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂èàóù
            Call sKikiDataSave
        
        Case 3                                 ' ã@äÌç\ê¨ê›íËÉfÅ[É^ëIë
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_KIKIDATA_SELECT, 0)
            
            'ã@äÌç\ê¨ê›íËÉfÅ[É^ëIëèàóù
            Call sKikiDataSelect
    
        Case 4                                 ' î}ëÃì¸óÕ
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_MEDIUM_INPUT, 0)
            
            'î}ëÃì¸óÕèàóù
            Call sInputMedium
    
        Case 5                                 ' î}ëÃéÊäO
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, USB_OUT, 0)
    
            'î}ëÃéÊäOèàóù
            Call pfRemove(Me)

        Case 6                                 ' âwèÓïÒâÊñ Ç÷
            If SetteiHaneiFlg = True Then
                iResponse = MsgBox("âÊñ ï\é¶íÜÇ…ê›íËÇ≥ÇÍÇΩÉfÅ[É^Ç™é∏ÇÌÇÍÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                                    "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                                    vbYesNo + vbQuestion, _
                                    "ê›íËîΩâfñtñ¢âüâ∫")
                If iResponse = vbNo Then
                    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
                    Call SetEnableTrue
                    Exit Sub
                End If
            End If
            'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
            SetteiHaneiFlg = False
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, EKIINFO_GAMEN_GO_BUTTOM, 0)
            Unload Me
            Load frmKikiData
            frmKikiData.Show 1
            Exit Sub

        Case 7                                 ' é©â¸âÊñ Ç÷
            If SetteiHaneiFlg = True Then
                iResponse = MsgBox("âÊñ ï\é¶íÜÇ…ê›íËÇ≥ÇÍÇΩÉfÅ[É^Ç™é∏ÇÌÇÍÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                                    "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                                    vbYesNo + vbQuestion, _
                                    "ê›íËîΩâfñtñ¢âüâ∫")
                If iResponse = vbNo Then
                    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
                    Call SetEnableTrue
                    Exit Sub
                End If
            End If
            'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
            SetteiHaneiFlg = False
            'âÊñ ëÄçÏÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, GATE_GAMEN_GO_BUTTOM, 0)

            'ï\é¶íÜâÊñ ÉAÉìÉçÅ[Éh
            Unload Me

            'é©â¸âÊñ ï\é¶
            Load frmKikiDataGate
            frmKikiDataGate.Show 1
            Exit Sub

        Case Else
            'èàóùÇ»Çµ
            
    End Select

    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
' EG20 V3.0.0.2 í«â¡äJén
    If bUnlock = True Then
        Call SetEnableTrue
    End If
' EG20 V3.0.0.2 çÌèúèIóπ
'    Call SetEnableTrue                 ' EG20 V3.0.0.2 çÌèú

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sInstolKikiData
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨çÄñ⁄ê›íËîΩâfÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : âÊñ ï\é¶ÉfÅ[É^ÇINIÉtÉ@ÉCÉãÇ÷îΩâfÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22   CODED   BY [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.0.2.1) 2012-03-12  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyåãçáTR-No.76èCê≥ëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sInstolKikiData()

    Dim iResponse           As Integer          'MsgBoxñﬂÇËíl
    Dim bRet                As Boolean          'ä÷êîñﬂÇËíl
    Dim lErrCode            As Long             'ÉGÉâÅ[ÉRÅ[Éh
    Dim strFileName         As String           'î}ëÃÉtÉ@ÉCÉãñº
    
    Dim bData()             As Byte             'ÉoÉCÉiÉäÉfÅ[É^
    Dim lLoopCnt            As Long             'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim lLoopCnt2           As Long             'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim bSysChange          As Boolean          'ÉRÉìÉsÉÖÅ[É^ñºÅAÉlÉbÉgÉèÅ[ÉNïœçXèàóùîªíË
    Dim byBuff()            As Byte             'ÉoÉCÉgÉoÉbÉtÉ@
    Dim strSetteiData       As String           ' ê›íËíl

    Dim lResult             As Long             ' èàóùåãâ      ' EG20 V3.0.0.2[Mainte_03_01 âwìsìxëŒâû]í«â¡

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    iResponse = MsgBox("ã@äÌç\ê¨ÉfÅ[É^ÇÉCÉìÉXÉgÅ[ÉãÇµÇ‹Ç∑ÅB" & Chr(vbKeyReturn) & _
                        "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                        vbOKCancel + vbExclamation, _
                        "ê›íËîΩâfämîF")
    If iResponse = vbCancel Then
        Call SetEnableTrue                      ' EG20 V5.0.2.1ÅyåãçáTR-No.76èCê≥ëŒâûÅzí«â¡
        Exit Sub
    End If
    
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
    
    'ã@äÌç\ê¨ÉfÅ[É^ÉeÅ[ÉuÉãÅiëÂï™óﬁÅFÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@ÅjÇÃê›íËílÇÅu999ÅvÇÃèëéÆÇ…ïœä∑
    For lLoopCnt = 0 To UBound(KikiDataTbl)
        'äYìñÉfÅ[É^åüçı
        If (BUNRUI_DAI.DAI_SubGate = KikiDataTbl(lLoopCnt).iBunrui_Dai) Then
            
            strSetteiData = KikiDataTbl(lLoopCnt).strData
            strSetteiData = StrConv(strSetteiData, vbUnicode)
            strSetteiData = Format(strSetteiData, "000")
    
            'ã@äÌç\ê¨èÓïÒÉfÅ[É^ï€ë∂
            byBuff = StrConv(strSetteiData, vbFromUnicode)

            Erase KikiDataTbl(lLoopCnt).strData

            'ìÆìIîzóÒÇÃì‡óeÇÉçÉOÉpÉâÉÅÅ[É^ç\ë¢ëÃÇÃê√ìIîzóÒÇ…äiî[Ç∑ÇÈÅB
            For lLoopCnt2 = 0 To UBound(KikiDataTbl(lLoopCnt).strData)
                'NullílÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈÅB
                If byBuff(lLoopCnt2) = vbVEmpty Then Exit For

                KikiDataTbl(lLoopCnt).strData(lLoopCnt2) = byBuff(lLoopCnt2)

                'ìÆìIîzóÒÇÃç≈ëÂóvëfÇ…Ç»Ç¡ÇΩÇÁèàóùÇî≤ÇØÇÈ
                If lLoopCnt2 = UBound(byBuff) Then Exit For
            Next
        End If
    Next

    'ç\ë¢ëÃîzóÒÇÉoÉCÉiÉäîzóÒÇ…ïœä∑
    ReDim bData((UBound(KikiDataTbl) + 1) * Len(KikiDataTbl(0))) As Byte
    For lLoopCnt = 0 To UBound(KikiDataTbl)
          MoveMemory bData(lLoopCnt * Len(KikiDataTbl(0))), KikiDataTbl(lLoopCnt), Len(KikiDataTbl(lLoopCnt))
    Next
    
    'ã@äÌç\ê¨ÉfÅ[É^ÉCÉìÉXÉgÅ[Éãèàóù
    bRet = dllInstolKikiData(KIKI_DATA_FILE, EKI_SETTI_FILE, bData(0), UBound(KikiDataTbl) + 1, lErrCode)
    
    If bRet = False Then
        
        'àŸèÌÉçÉOèoóÕ
        Call pfOutPutErrLog(lErrCode)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        'àŸèÌèIóπ
        iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ")
        Call SetEnableTrue              ' EG20 V3.0.0.2ÅiÉÅÅ[ÉãëóêMÇµÇ»Ç¢èÍçáÇÃÇ›ÉçÉbÉNâèúëŒâûÅjí«â¡
    Else
        'ÉRÉìÉsÉÖÅ[É^ñºÅAÉlÉbÉgÉèÅ[ÉNïœçXèàóù
        
        bSysChange = pfNetWorkChng(Me)
        If bSysChange = False Then

            'àŸèÌÉçÉOèoóÕ
            Call pfOutPutErrLog(lErrCode)

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
            'àŸèÌèIóπ
             iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ")
            Call SetEnableTrue              ' EG20 V3.0.0.2ÅiÉÅÅ[ÉãëóêMÇµÇ»Ç¢èÍçáÇÃÇ›ÉçÉbÉNâèúëŒâûÅjí«â¡
        Else
' EG20 V3.0.0.2[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
            ' //////////////////////////////////////////////
            ' // ëÄçÏëÏÉvÉçÉOÉâÉÄèàóù
            ' //////////////////////////////////////////////
             lResult = pubfuncTakuProgramData(2, EKI_SETTI_FILE)
             If lResult = 0 Then
                'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
                Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
                ' àŸèÌèIóπ
                iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "îΩâfèàóùê›íËîΩâfåãâ ")
                Call SetEnableTrue
                Exit Sub
             ElseIf lResult = 1 Then
                ' ÉÅÅ[ÉãëóêMíÜ
                ' ÉçÉOèoóÕ
                Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
                ' ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
                SetteiHaneiFlg = False
                 
                Exit Sub
             End If
' EG20 V3.0.0.2[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
        
            'ÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
            
            'ê≥èÌèIóπ
            iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "îΩâfèàóùê›íËîΩâfåãâ ")
            
            'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ»ÇµÅj
            SetteiHaneiFlg = False
            Call SetEnableTrue              ' EG20 V3.0.0.2ÅiÉÅÅ[ÉãëóêMÇµÇ»Ç¢èÍçáÇÃÇ›ÉçÉbÉNâèúëŒâûÅjí«â¡
        End If
    End If


End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sKikiDataOutPut
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨çÄñ⁄î}ëÃèoóÕÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇäOïîî}ëÃÇ…èoóÕÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sKikiDataOutPut()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim sWriteDir            As String          'ÉtÉHÉãÉ_ñº
    Dim iResponse            As Integer         'MsgBoxñﬂÇËíl

    Dim iRet                 As Integer         'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXñﬂÇËíl
    Dim lSekuta              As Long            'ÉZÉNÉ^ÅiÉNÉâÉXÉ^ìñÇËÅj
    Dim lByte                As Long            'ÉoÉCÉgêîÅiÉZÉNÉ^ìñÇËÅj
    Dim lKurasuta            As Long            'ÉtÉäÅ[ÉNÉâÉXÉ^êî
    Dim lDrive               As Long            'ÉhÉâÉCÉuÇÃÉNÉâÉXÉ^êîÅiçáåvÅj
    Dim strDrive             As String          'ÉhÉâÉCÉu
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'èâä˙ílê›íË
    strFileName = ""

    '----------------------------------------------------
    'ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãåüçı
    '----------------------------------------------------
    strFileName = Dir(KIKI_DATA_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then
    
        'àŸèÌÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, NOT_FILE_KIKI_DATA, 0)
        
        'àŸèÌèIóπ
        MsgBox "î}ëÃèoóÕÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB", _
                vbOKOnly + vbExclamation, _
                 "ÉfÅ[É^ñ≥åxçê"
        Exit Sub
        
    End If
    
    '----------------------------------------------------
    'î}ëÃèoóÕèàóù
    '----------------------------------------------------
    sWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)
    If sWriteDir <> "" Then
    
        On Error GoTo COPY_ERROR
        'ÉtÉ@ÉCÉãÉRÉsÅ[
'        FileCopy KIKI_DATA_FILE, sWriteDir & Dir(KIKI_DATA_FILE)                                       ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]çÌèú
        FileCopy KIKI_DATA_FILE, sWriteDir & Trim(pfGetEkiNameInfo(NotEkiVer)) & "_" & Dir(KIKI_DATA_FILE)    ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
        'ê≥èÌèIóπ
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃèoóÕåãâ ")
    
    End If
  
  Exit Sub
 
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' î}ëÃèoóÕãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case 71 ' î}ëÃÇ»Çµ
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_NOT_DISK, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

    'àŸèÌèIóπ
    iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃèoóÕåãâ ")

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sKikiDataSave
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨çÄñ⁄ì‡ïîï€ë∂Åvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇéwíËÉtÉHÉãÉ_Ç…èoóÕÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sKikiDataSave()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim sWriteDir            As String          'ÉtÉHÉãÉ_ñº
    Dim sMyPath(1 To 3)      As String          'ÉtÉ@ÉCÉãÉpÉX
    Dim iResponse            As Integer         'MsgBoxñﬂÇËíl
    Dim iLoopCount           As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim intFileNo            As Integer         'ÉtÉ@ÉCÉãî‘çÜ

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    'èâä˙ílê›íË
    strFileName = ""

    '----------------------------------------------------
    'ì‡ïîï€ë∂èàóù
    '----------------------------------------------------
    iResponse = MsgBox("ã@äÌç\ê¨ê›íËÇàÍéûï€ë∂ÇµÇ‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
    vbOKCancel + vbQuestion, "àÍéûï€ë∂ämîF")
    
    If iResponse = vbCancel Then Exit Sub
     
     'ÉtÉ@ÉCÉãåüçı
    strFileName = Dir(KIKI_DATA_S_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then

        intFileNo = FreeFile                                        'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
        Open KIKI_DATA_S_FILE For Output Access Write As #intFileNo
        Close #intFileNo
    End If
    
    'àÍéûï€ë∂ÉtÉ@ÉCÉãÇçÏê¨Ç∑ÇÈ
    Name KIKI_DATA_S_FILE As KIKI_DATA_S_TEMP_FILE
    
    'ÉtÉ@ÉCÉãñºéÊìæ
    sWriteDir = KIKI_DATA_S_FILE
    If sWriteDir <> "" Then
    
        On Error GoTo COPY_ERROR
        'ÉtÉ@ÉCÉãÉRÉsÅ[
        FileCopy KIKI_DATA_FILE, sWriteDir
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
        'àÍéûï€ë∂ÉtÉ@ÉCÉãçÌèú
        Kill KIKI_DATA_S_TEMP_FILE
        
        'ê≥èÌèIóπ
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "àÍéûï€ë∂åãâ ")
    
    End If
  
  Exit Sub
 
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' ãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

        'ÉtÉ@ÉCÉãåüçı
        strFileName = Dir(KIKI_DATA_S_FILE)
        If strFileName <> "" Then
            'ÉtÉ@ÉCÉãçÌèú
            Kill KIKI_DATA_S_FILE
        End If
        'ÉtÉ@ÉCÉãñºèÃÇå≥Ç…ñﬂÇ∑
        Name KIKI_DATA_S_TEMP_FILE As KIKI_DATA_S_FILE
    
    'àŸèÌèIóπ
     iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "àÍéûï€ë∂åãâ ")
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sKikiDataSelect
'//  ã@î\ñºèÃ  : Åuã@äÌç\ê¨ê›íËÉfÅ[É^ëIëÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌç\ê¨ÉfÅ[É^ì‡ïîï€ë∂ÉtÉ@ÉCÉãÇã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇ…ÉRÉsÅ[Ç∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sKikiDataSelect()

    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    Dim sWriteDir            As String          'ÉtÉHÉãÉ_ñº
    Dim sMyPath(1 To 3)      As String          'ÉtÉ@ÉCÉãÉpÉX
    Dim iResponse            As Integer         'MsgBoxñﬂÇËíl
    Dim iLoopCount           As Integer         'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim intFileNo            As Integer         'ÉtÉ@ÉCÉãî‘çÜ
    Dim bRet                 As Boolean         'ä÷êîñﬂÇËíl
    Dim lErrCode             As Long            'ÉGÉâÅ[ÉRÅ[Éh

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    '----------------------------------------------------
    'ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãçXêVèàóù
    '----------------------------------------------------
    iResponse = MsgBox("ã@äÌç\ê¨ê›íËÇÃàÍéûï€ë∂ÉfÅ[É^ÇéÊçûÇ›Ç‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
    vbOKCancel + vbQuestion, "àÍéûï€ë∂ÉfÅ[É^éÊçûämîF")
    
    If iResponse = vbCancel Then Exit Sub
    
   'ÉtÉ@ÉCÉãåüçı
    strFileName = Dir(KIKI_DATA_FILE)

    'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçá
    If strFileName = "" Then

        intFileNo = FreeFile                                        'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
        Open KIKI_DATA_FILE For Output Access Write As #intFileNo
        Close #intFileNo
    End If
    
    'àÍéûï€ë∂ÉtÉ@ÉCÉãÇçÏê¨Ç∑ÇÈ
    Name KIKI_DATA_FILE As KIKI_DATA_BACKUP_FILE
    
    'ÉtÉ@ÉCÉãñºéÊìæ
    strFileName = Dir(KIKI_DATA_S_FILE)
    sWriteDir = strFileName
    If sWriteDir <> "" Then
    
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        On Error GoTo COPY_ERROR
        'ÉtÉ@ÉCÉãÉRÉsÅ[
         FileCopy KIKI_DATA_S_FILE, KIKI_DATA_FILE
        
        'ã@äÌç\ê¨ÉfÅ[É^ÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉã
        bRet = dllGetKikiIniData(2, 1, KIKI_DATA_SET_SUBGATE_FILE, EKI_SETTI_FILE, KIKI_DATA_FILE, lErrCode)
        If bRet = False Then
            'àŸèÌÉçÉOèoóÕ
            Call pfOutPutErrLog(lErrCode)
            'ÉtÉ@ÉCÉãçÌèú
            Kill KIKI_DATA_FILE
            'ÉtÉ@ÉCÉãñºèÃÇå≥Ç…ñﬂÇ∑
            Name KIKI_DATA_BACKUP_FILE As KIKI_DATA_FILE
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
            'àŸèÌèIóπ
            iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "àÍéûï€ë∂ÉfÅ[É^éÊçûåãâ ")
            Exit Sub
        End If
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
        'àÍéûï€ë∂ÉtÉ@ÉCÉãçÌèú
        Kill KIKI_DATA_BACKUP_FILE
        
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        'ê≥èÌèIóπ
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "àÍéûï€ë∂ÉfÅ[É^éÊçûåãâ ")
    
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅiçXêVê›íËÅj
        KikiDataUpDateFlg = True
        'âÊñ ï\é¶èàóù
        Call sDisp
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅií èÌê›íËÅj
        KikiDataUpDateFlg = False
        
        'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ†ÇËÅj
        SetteiHaneiFlg = True
    End If
  
  Exit Sub
 
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' ãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

   'ÉtÉ@ÉCÉãåüçı
   strFileName = Dir(KIKI_DATA_FILE)
   If strFileName <> "" Then
    'ÉtÉ@ÉCÉãçÌèú
    Kill KIKI_DATA_FILE
   End If
   'ÉtÉ@ÉCÉãñºèÃÇå≥Ç…ñﬂÇ∑
   Name KIKI_DATA_BACKUP_FILE As KIKI_DATA_FILE
   
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
   'àŸèÌèIóπ
   iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "àÍéûï€ë∂ÉfÅ[É^éÊçûåãâ ")

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sInputMedium
'//  ã@î\ñºèÃ  : Åuî}ëÃì¸óÕÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : äOïîî}ëÃÇã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÇ…ÉRÉsÅ[Ç∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V5.0.2.1) 2012-03-12  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyåãçáTR-No.77èCê≥ëŒâûÅz
'//     REVISIONS :(EG20 V30.4.0.1) 2015-01-15 CODED BY  [TCC] S.Kuroda
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇRëŒâûÅyHKRK_kansi02_001_01Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sInputMedium()

    Dim iResponse               As Integer      'MsgBoxñﬂÇËíl
    Dim bRet                    As Boolean      'ä÷êîñﬂÇËíl
    Dim lErrCode                As Long         'ÉGÉâÅ[ÉRÅ[Éh
    Dim strFileName             As String       'î}ëÃÉtÉ@ÉCÉãñº
    
    Dim iRet                    As Integer      'ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXñﬂÇËíl
    Dim lSekuta                 As Long         'ÉZÉNÉ^ÅiÉNÉâÉXÉ^ìñÇËÅj
    Dim lByte                   As Long         'ÉoÉCÉgêîÅiÉZÉNÉ^ìñÇËÅj
    Dim lKurasuta               As Long         'ÉtÉäÅ[ÉNÉâÉXÉ^êî
    Dim lDrive                  As Long         'ÉhÉâÉCÉuÇÃÉNÉâÉXÉ^êîÅiçáåvÅj
    Dim strDrive                As String       'ÉhÉâÉCÉu
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next
    
    iResponse = MsgBox("ã@äÌç\ê¨ê›íËÇÃî}ëÃì¸óÕÇçsÇ¢Ç‹Ç∑ÅB" & vbCrLf & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
    vbOKCancel + vbQuestion, "î}ëÃì¸óÕämîF")
    
    If iResponse = vbCancel Then
        Set objFso = Nothing
        Exit Sub
    End If
    'éÊìæÉtÉ@ÉCÉãñºÇèâä˙âª
    CommonDialog1.FileName = ""
    'èâä˙ÉfÉBÉåÉNÉgÉäÇê›íË
    If objFso.FolderExists(SHOWFILE_DEFAULTFOLDER1) = True Then    'ÉtÉHÉãÉ_ëIëâÊñ ÉfÉtÉHÉãÉgÉpÉXÇPÇ™ë∂ç›Ç∑ÇÈÇ©
        'ë∂ç›Ç∑ÇÈÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇPÅiH:ÅjÇê›íË
        CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER1
    Else
        'ë∂ç›ÇµÇ»Ç¢ÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇQÅiC:ÅjÇê›íË
        CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER2
    End If
    Set objFso = Nothing
    'ägí£éqÇê›íË
'    CommonDialog1.Filter = "ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÅiKIKI_DATA.CSVÅj|KIKI_DATA.CSV|"    ' EG20 V5.0.2.1çÌèú
    CommonDialog1.Filter = "ã@äÌç\ê¨ÉfÅ[É^ÉtÉ@ÉCÉãÅiKIKI_DATA.CSVÅj|*KIKI_DATA.CSV|"    ' EG20 V5.0.2.1í«â¡
    'ÉtÉ@ÉCÉãëIëâÊñ ÇäJÇ≠
    CommonDialog1.ShowOpen
    'ëIëÇµÇΩÉtÉ@ÉCÉãñºÇéÊìæ
    strFileName = CommonDialog1.FileName
    
    Call ChDrive("D")

    'ÉtÉ@ÉCÉãë∂ç›É`ÉFÉbÉN
    If strFileName <> "" Then

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_EKITSUDO)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ

        On Error GoTo COPY_ERROR
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz DEL Start
        'ÉtÉ@ÉCÉãÉRÉsÅ[
'        FileCopy strFileName, KIKI_DATA_FILE
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz DEL End
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD Start
        'àÍéûï€ë∂ÉtÉHÉãÉ_Ç…ÉfÅ[É^ÇÉRÉsÅ[Çµì«éÊêÍópÇâèúÇ∑ÇÈ
       If pfChangeAttrNormal(strFileName, PATH_HOSHUTMP_KIKI_DATA, KIKI_DATA_FILE) = False Then
          GoTo COPY_ERROR
       End If
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD End
        
        'ã@äÌèÓïÒê›íËÅiÉGÉìÉRÅ[ÉhÉRÅ[ÉiçÜã@èÓïÒíËã`ÅjÉCÉÅÅ[ÉWÉtÉ@ÉCÉãçÏê¨
        bRet = dllGetKikiIniData(2, 1, KIKI_DATA_SET_SUBGATE_FILE, EKI_SETTI_FILE, KIKI_DATA_FILE, lErrCode)
        If bRet = False Then
            'àŸèÌÉçÉOèoóÕ
            Call pfOutPutErrLog(lErrCode)

' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
            
            'àŸèÌèIóπ
            iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃì¸óÕåãâ ")
            
            Exit Sub
       End If
        
        'ÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, LOG_SHORI_OK, 0)
        
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ
        
        'ê≥èÌèIóπ
        iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbInformation, "î}ëÃì¸óÕåãâ ")
    
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅiçXêVê›íËÅj
        KikiDataUpDateFlg = True
        'âÊñ ï\é¶èàóù
        Call sDisp
        'ã@äÌèÓïÒÉfÅ[É^çXêVÉtÉâÉOê›íËÅií èÌê›íËÅj
        KikiDataUpDateFlg = False
        
        'ê›íËîΩâfÉtÉâÉOÅiïœçXÇ†ÇËÅj
        SetteiHaneiFlg = True
    End If

  Exit Sub
  
COPY_ERROR:

    'àŸèÌÉçÉOèoóÕ
    Select Case Err.Number
        Case 61 ' ãÛÇ´óeó ïsë´
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_SHORT_VOLUME, 0)
        Case Else
            Call sLogTraceReq(LTYP_ERROR, L3AN_ETC, ERROR_MEDIUM_OTHER_ERR, 0)
    End Select

' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD Start
    'àÍéûï€ë∂ÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈ
    psDeleteFolder PATH_HOSHUTMP
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD End
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V3.0.0.2[Mainte_03_01 ÉvÉçÉOÉåÉXÉoÅ[ëŒâû]í«â¡èIóπ

    'àŸèÌèIóπ
    iResponse = MsgBox("àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly + vbCritical, "î}ëÃì¸óÕåãâ ")

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : SetEnableFalse
'//  ã@î\ñºèÃ  : âÊñ ÉçÉbÉNèàóù
'//  ã@î\äTóv  : âÊñ ÇÉçÉbÉNÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçl ÅF
'///////////////////////////////////////////////////////////////////
Public Sub SetEnableFalse()
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    CmdKikiSetMenu(3).Enabled = False
    CmdKikiSetMenu(4).Enabled = False
    CmdKikiSetMenu(5).Enabled = False
    CmdKikiSetMenu(6).Enabled = False
    CmdKikiSetMenu(7).Enabled = False
    cmdCancel.Enabled = False
    
    'CmdKikiSetMenu(0)Å`(2)ÇÕèåèÇ…ÇÊÇ¡ÇƒÇÕå≥ÅXâüâ∫ïsâ¬ÇÃÇΩÇﬂîªíËÇçsÇ§
    If cmbGoki.Enabled = True Then
        cmbGoki.Enabled = False     'çÜã@ëIëÉRÉìÉ{É{ÉbÉNÉXëIëïsâ¬ê›íË
        DoEvents
    End If
    
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡äJén
    If CmbCornerName.Enabled = True Then
        CmbCornerName.Enabled = False
        DoEvents
    End If
' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡èIóπ
    
    If CmdKikiSetMenu(0).Enabled = True Then
        CmdKikiSetMenu(0).Enabled = False
    End If
    
    If CmdKikiSetMenu(1).Enabled = True Then
        CmdKikiSetMenu(1).Enabled = False
    End If
    
    If CmdKikiSetMenu(2).Enabled = True Then
        CmdKikiSetMenu(2).Enabled = False
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : SetEnableTrue
'//  ã@î\ñºèÃ  : âÊñ ÉçÉbÉNâèúèàóù
'//  ã@î\äTóv  : âÊñ ÇÃÉçÉbÉNÇâèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçl ÅF
'///////////////////////////////////////////////////////////////////
Public Sub SetEnableTrue()
    
    Dim strFileName          As String          'ÉtÉ@ÉCÉãñº
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
    CmdKikiSetMenu(3).Enabled = True
    CmdKikiSetMenu(4).Enabled = True
    CmdKikiSetMenu(5).Enabled = True
    CmdKikiSetMenu(6).Enabled = True
    CmdKikiSetMenu(7).Enabled = True
    cmdCancel.Enabled = True
    
    'ÉRÉìÉ{É{ÉbÉNÉXÇ∆CmdKikiSetMenu(0)Å`(2)ÇÕèåèÇ…ÇÊÇ¡ÇƒÇÕå≥ÅXâüâ∫ïsâ¬ÇÃÇΩÇﬂÅAâÊñ ï\é¶ÇÃóLñ≥Ç≈îªíËÇçsÇ§
    strFileName = Dir(KIKI_DATA_SET_SUBGATE_FILE)
    'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈèÍçá
    If strFileName <> "" Then
        cmbGoki.Enabled = True              'çÜã@ëIëÉRÉìÉ{É{ÉbÉNÉXëIëâ¬ê›íË
        CmbCornerName.Enabled = True        ' EG20 V2.1.0.1[Mainte_03_01 âwìsìxëŒâû]í«â¡
        CmdKikiSetMenu(0).Enabled = True
        CmdKikiSetMenu(1).Enabled = True
        CmdKikiSetMenu(2).Enabled = True
    End If
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmbGoki_Click
'//  ã@î\ñºèÃ  : çÜã@ëIëèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^Ççƒê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2011-05-11   CODED   BY [TCC] M.Kuroki
'//                 EG-Rç„ã}Å@êVãKäJî≠
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmbGoki_Click()
    
    Dim iIndex          As Integer                  'ÉCÉìÉfÉbÉNÉX
    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    Call SetEnableFalse
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KIKISET_SUBGATE_GAMEN_GOKI_SELECT, 0)
    
    'âÊñ ï\é¶èàóù
    Call sDisp

    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
    Call SetEnableTrue

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : CmbCornerName_Click
'//  ã@î\ñºèÃ  : ÉRÅ[ÉiëIëïîëIëèàóù
'//  ã@î\äTóv  : ÉOÉäÉbÉhÉfÅ[É^Ççƒê›íËÇ∑ÇÈ
'//
'//              å^        ñºèÃ         à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl           à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//                 cmbEkiInfo_Click()ó¨óp
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub CmbCornerName_Click()

    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'ëSÉ{É^ÉìÇâüâ∫ïsâ¬Ç∆Ç∑ÇÈÅB
    Call SetEnableFalse
    
    'âÊñ ëÄçÏÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, EKITUDOKAKUNIN_GAMEN_CORNER_SELECT, 0)
    
    'âÊñ ï\é¶èàóù
    Call sDisp

    'ëSÉ{É^ÉìÇâüâ∫â¬Ç∆Ç∑ÇÈÅB
    Call SetEnableTrue

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : InitCornerComboBox
'//  ã@î\ñºèÃ  : ÉRÅ[Éiê›íËÉRÉìÉ{É{ÉbÉNÉXÇÃèâä˙âªèàóù
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V2.1.0.1) 2011-10-28  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01ÅzâwìsìxëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub InitCornerComboBox()

    Dim intLoop   As Integer            ' ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim strCorner As String             ' ï∂éöóÒäiî[ÉGÉäÉA
    
    On Error Resume Next
    
    ' /////////////////////////////////////////////////////
    ' // èâä˙âªèàóù
    ' /////////////////////////////////////////////////////
    ' ÉRÅ[ÉiñºèÃê›íËèàóù
    Call gsGetCornerName
    
    CmbCornerName.Clear
    For intLoop = 0 To 5
    
        'ê›íËÇ†ÇËÇÃÉRÅ[ÉiÇäàê´Ç…Ç∑ÇÈ
        If gudtSettiCorner(intLoop).intGokiNum > 0 Then
            strCorner = gstrCornerName(intLoop)
            CmbCornerName.AddItem strCorner
        End If
    Next intLoop
    CmbCornerName.ListIndex = 0

End Sub

