VERSION 5.00
Object = "{BDC217C8-ED16-11CD-956C-0000C04E4C0A}#1.1#0"; "TABCTL32.OCX"
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "COMDLG32.OCX"
Begin VB.Form frmKansenGateVerKanri 
   BackColor       =   &H00800000&
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "Form1"
   ClientHeight    =   9000
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   12000
   ControlBox      =   0   'False
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   9000
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton Command2 
      Caption         =   " î}ëÃ Å® ÉèÅ[ÉNÅ@ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      TabIndex        =   70
      Top             =   3240
      Width           =   2415
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   8640
      Top             =   2040
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.Timer tmrMail 
      Left            =   8640
      Top             =   1560
   End
   Begin VB.CommandButton cmdGateVerUpdate 
      Caption         =   "àÍäáçXêV"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   62
      Top             =   1440
      Width           =   2415
   End
   Begin VB.CommandButton cmdInstall 
      Caption         =   "ÉoÅ[ÉWÉáÉìèÓïÒ  î}ëÃèoóÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   0
      Left            =   9360
      TabIndex        =   20
      Top             =   6120
      Width           =   2415
   End
   Begin VB.CommandButton cmdInstall 
      Caption         =   "î}ëÃéÊäO"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Index           =   1
      Left            =   9360
      TabIndex        =   19
      Top             =   6720
      Width           =   2415
   End
   Begin VB.CommandButton cmdModoru_Menu 
      Caption         =   "  ÉoÅ[ÉWÉáÉìä«óù  âÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   975
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   1
      Top             =   7440
      Width           =   2415
   End
   Begin VB.Frame fraDataSelect 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1335
      Left            =   120
      TabIndex        =   12
      Top             =   7080
      Width           =   6255
      Begin VB.OptionButton optData 
         Caption         =   "ó\îıÇR"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   8
         Left            =   3960
         TabIndex        =   61
         Top             =   960
         Visible         =   0   'False
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ó\îıÇQ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   7
         Left            =   3960
         TabIndex        =   60
         Top             =   600
         Visible         =   0   'False
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ó\îıÇP"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   6
         Left            =   3960
         TabIndex        =   59
         Top             =   240
         Visible         =   0   'False
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ó\îıÇP"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   4
         Left            =   2040
         TabIndex        =   17
         Top             =   600
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ó\îıÇQ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   5
         Left            =   2040
         TabIndex        =   18
         Top             =   960
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ÇnÇr"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   3
         Left            =   2040
         TabIndex        =   16
         Top             =   240
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ÉTÉuÇbÇoÇt"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   2
         Left            =   120
         TabIndex        =   15
         Top             =   960
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "ÉÅÉCÉìÇbÇoÇt"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   1
         Left            =   120
         TabIndex        =   14
         Top             =   600
         Width           =   1935
      End
      Begin VB.OptionButton optData 
         Caption         =   "îªíËÇbÇoÇt"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   0
         Left            =   120
         TabIndex        =   13
         Top             =   240
         Value           =   -1  'True
         Width           =   1935
      End
   End
   Begin VB.Frame fraFolderSelect 
      Height          =   1335
      Left            =   6720
      TabIndex        =   8
      Top             =   7080
      Width           =   1935
      Begin VB.CheckBox chkFolder 
         Caption         =   "Çn ãå"
         DataField       =   "e"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Index           =   2
         Left            =   240
         TabIndex        =   11
         Top             =   960
         Width           =   1575
      End
      Begin VB.CheckBox chkFolder 
         Caption         =   "Çm é¿çs"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   240
         TabIndex        =   10
         Top             =   615
         Width           =   1575
      End
      Begin VB.CheckBox chkFolder 
         Caption         =   "Çv ÉèÅ[ÉN"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   240
         TabIndex        =   9
         Top             =   240
         Width           =   1575
      End
   End
   Begin VB.CommandButton cmdClear 
      Caption         =   "ÉèÅ[ÉNÉNÉäÉA"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   6
      Top             =   2040
      Width           =   2415
   End
   Begin VB.CommandButton cmdCopyBaitai_Work 
      Caption         =   " à≥èkÉtÉ@ÉCÉã Å® ÉèÅ[ÉNÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   5
      Top             =   2640
      Width           =   2415
   End
   Begin VB.CommandButton cmdCopyWork_Jikko 
      Caption         =   " ÉèÅ[ÉN Å® é¿çs ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   4
      Top             =   3840
      Width           =   2415
   End
   Begin VB.CommandButton cmdCopyOld_Jikko 
      Caption         =   "   ãå Å® é¿çs   ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   3
      Top             =   4440
      Width           =   2415
   End
   Begin VB.CommandButton cmdDLLJikkoGamen 
      Caption         =   " é©â¸êÿÇËó£Çµ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   2
      Top             =   5520
      Width           =   2415
   End
   Begin VB.CommandButton cmdKoshin 
      Caption         =   "ï\é¶çXêV"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   550
      Left            =   9360
      Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
      TabIndex        =   7
      Top             =   600
      Width           =   2415
   End
   Begin TabDlg.SSTab SSTab1 
      Height          =   8655
      Left            =   0
      TabIndex        =   21
      Top             =   360
      Width           =   12000
      _ExtentX        =   21167
      _ExtentY        =   15266
      _Version        =   393216
      TabOrientation  =   1
      Tabs            =   6
      TabsPerRow      =   6
      TabHeight       =   706
      TabMaxWidth     =   3475
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      TabCaption(0)   =   "   ÅõÅõÅõÅõÅõÅõÅ@ ÅõÅõÅõÅõÅõÅõ"
      TabPicture(0)   =   "ÉoÅ[ÉWÉáÉìä«óù(ä≤ê¸é©â¸).frx":0000
      Tab(0).ControlEnabled=   -1  'True
      Tab(0).Control(0)=   "lblKan(6)"
      Tab(0).Control(0).Enabled=   0   'False
      Tab(0).Control(1)=   "lblKan(4)"
      Tab(0).Control(1).Enabled=   0   'False
      Tab(0).Control(2)=   "lblKan(3)"
      Tab(0).Control(2).Enabled=   0   'False
      Tab(0).Control(3)=   "lblKan(2)"
      Tab(0).Control(3).Enabled=   0   'False
      Tab(0).Control(4)=   "lblKan(1)"
      Tab(0).Control(4).Enabled=   0   'False
      Tab(0).Control(5)=   "lblKan(0)"
      Tab(0).Control(5).Enabled=   0   'False
      Tab(0).Control(6)=   "lblZenVer(0)"
      Tab(0).Control(6).Enabled=   0   'False
      Tab(0).Control(7)=   "lstKan(0)"
      Tab(0).Control(7).Enabled=   0   'False
      Tab(0).ControlCount=   8
      TabCaption(1)   =   "   ÅõÅõÅõÅõÅõÅõÅ@ ÅõÅõÅõÅõÅõÅõ"
      TabPicture(1)   =   "ÉoÅ[ÉWÉáÉìä«óù(ä≤ê¸é©â¸).frx":001C
      Tab(1).ControlEnabled=   0   'False
      Tab(1).Control(0)=   "lstKan(1)"
      Tab(1).Control(1)=   "Command1(1)"
      Tab(1).Control(2)=   "lblKan(22)"
      Tab(1).Control(3)=   "lblKan(16)"
      Tab(1).Control(4)=   "lblKan(14)"
      Tab(1).Control(5)=   "lblKan(8)"
      Tab(1).Control(6)=   "lblKan(7)"
      Tab(1).Control(7)=   "lblKan(5)"
      Tab(1).Control(8)=   "lblZenVer(1)"
      Tab(1).ControlCount=   9
      TabCaption(2)   =   "   ÅõÅõÅõÅõÅõÅõÅ@ ÅõÅõÅõÅõÅõÅõ"
      TabPicture(2)   =   "ÉoÅ[ÉWÉáÉìä«óù(ä≤ê¸é©â¸).frx":0038
      Tab(2).ControlEnabled=   0   'False
      Tab(2).Control(0)=   "lstKan(2)"
      Tab(2).Control(1)=   "lblZenVer(2)"
      Tab(2).Control(2)=   "lblKan(23)"
      Tab(2).Control(3)=   "lblKan(21)"
      Tab(2).Control(4)=   "lblKan(20)"
      Tab(2).Control(5)=   "lblKan(19)"
      Tab(2).Control(6)=   "lblKan(18)"
      Tab(2).Control(7)=   "lblKan(17)"
      Tab(2).ControlCount=   8
      TabCaption(3)   =   "   ÅõÅõÅõÅõÅõÅõÅ@ ÅõÅõÅõÅõÅõÅõ"
      TabPicture(3)   =   "ÉoÅ[ÉWÉáÉìä«óù(ä≤ê¸é©â¸).frx":0054
      Tab(3).ControlEnabled=   0   'False
      Tab(3).Control(0)=   "lstKan(3)"
      Tab(3).Control(1)=   "lblZenVer(3)"
      Tab(3).Control(2)=   "lblKan(31)"
      Tab(3).Control(3)=   "lblKan(29)"
      Tab(3).Control(4)=   "lblKan(28)"
      Tab(3).Control(5)=   "lblKan(27)"
      Tab(3).Control(6)=   "lblKan(26)"
      Tab(3).Control(7)=   "lblKan(25)"
      Tab(3).ControlCount=   8
      TabCaption(4)   =   "   ÅõÅõÅõÅõÅõÅõÅ@ ÅõÅõÅõÅõÅõÅõ"
      TabPicture(4)   =   "ÉoÅ[ÉWÉáÉìä«óù(ä≤ê¸é©â¸).frx":0070
      Tab(4).ControlEnabled=   0   'False
      Tab(4).Control(0)=   "lstKan(4)"
      Tab(4).Control(1)=   "lblZenVer(4)"
      Tab(4).Control(2)=   "lblKan(39)"
      Tab(4).Control(3)=   "lblKan(37)"
      Tab(4).Control(4)=   "lblKan(36)"
      Tab(4).Control(5)=   "lblKan(35)"
      Tab(4).Control(6)=   "lblKan(34)"
      Tab(4).Control(7)=   "lblKan(33)"
      Tab(4).ControlCount=   8
      TabCaption(5)   =   "   ÅõÅõÅõÅõÅõÅõÅ@ ÅõÅõÅõÅõÅõÅõ"
      TabPicture(5)   =   "ÉoÅ[ÉWÉáÉìä«óù(ä≤ê¸é©â¸).frx":008C
      Tab(5).ControlEnabled=   0   'False
      Tab(5).Control(0)=   "lstKan(5)"
      Tab(5).Control(1)=   "lblZenVer(5)"
      Tab(5).Control(2)=   "lblKan(47)"
      Tab(5).Control(3)=   "lblKan(45)"
      Tab(5).Control(4)=   "lblKan(44)"
      Tab(5).Control(5)=   "lblKan(43)"
      Tab(5).Control(6)=   "lblKan(42)"
      Tab(5).Control(7)=   "lblKan(41)"
      Tab(5).ControlCount=   8
      Begin VB.ListBox lstKan 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4380
         Index           =   1
         Left            =   -74640
         TabIndex        =   75
         Top             =   2280
         Width           =   8055
      End
      Begin VB.ListBox lstKan 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4380
         Index           =   2
         Left            =   -74640
         TabIndex        =   74
         Top             =   2280
         Width           =   8055
      End
      Begin VB.ListBox lstKan 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4380
         Index           =   3
         Left            =   -74640
         TabIndex        =   73
         Top             =   2280
         Width           =   8055
      End
      Begin VB.ListBox lstKan 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4380
         Index           =   4
         Left            =   -74640
         TabIndex        =   72
         Top             =   2280
         Width           =   8055
      End
      Begin VB.ListBox lstKan 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4380
         Index           =   5
         Left            =   -74640
         TabIndex        =   71
         Top             =   2280
         Width           =   8055
      End
      Begin VB.CommandButton Command1 
         Caption         =   " î}ëÃ Å® ÉèÅ[ÉNÅ@ÉRÉsÅ["
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   550
         Index           =   1
         Left            =   -65640
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   69
         Top             =   2280
         Width           =   2415
      End
      Begin VB.ListBox lstKan 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4380
         Index           =   0
         Left            =   360
         TabIndex        =   22
         Top             =   2280
         Width           =   8055
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   22
         Left            =   -71880
         TabIndex        =   81
         Top             =   2040
         Width           =   5295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   16
         Left            =   -68880
         TabIndex        =   80
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   14
         Left            =   -71400
         TabIndex        =   79
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   -71880
         TabIndex        =   78
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   7
         Left            =   -72720
         TabIndex        =   77
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   5
         Left            =   -74640
         TabIndex        =   76
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblZenVer 
         Alignment       =   1  'âEëµÇ¶
         Caption         =   "ëSëÃÉoÅ[ÉWÉáÉì"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   5
         Left            =   -73920
         TabIndex        =   68
         Top             =   360
         Width           =   7335
      End
      Begin VB.Label lblZenVer 
         Alignment       =   1  'âEëµÇ¶
         Caption         =   "ëSëÃÉoÅ[ÉWÉáÉì"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   4
         Left            =   -73920
         TabIndex        =   67
         Top             =   360
         Width           =   7335
      End
      Begin VB.Label lblZenVer 
         Alignment       =   1  'âEëµÇ¶
         Caption         =   "ëSëÃÉoÅ[ÉWÉáÉì"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   3
         Left            =   -73920
         TabIndex        =   66
         Top             =   360
         Width           =   7335
      End
      Begin VB.Label lblZenVer 
         Alignment       =   1  'âEëµÇ¶
         Caption         =   "ëSëÃÉoÅ[ÉWÉáÉì"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   2
         Left            =   -73920
         TabIndex        =   65
         Top             =   360
         Width           =   7335
      End
      Begin VB.Label lblZenVer 
         Alignment       =   1  'âEëµÇ¶
         Caption         =   "ëSëÃÉoÅ[ÉWÉáÉì"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   1
         Left            =   -73920
         TabIndex        =   64
         Top             =   360
         Width           =   7335
      End
      Begin VB.Label lblZenVer 
         Alignment       =   1  'âEëµÇ¶
         Caption         =   "ÅõÅõÅõÅõÅõÅõÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF99"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   18
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   0
         Left            =   1080
         TabIndex        =   63
         Top             =   360
         Width           =   7335
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   47
         Left            =   -71880
         TabIndex        =   58
         Top             =   2040
         Width           =   5295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   45
         Left            =   -68880
         TabIndex        =   57
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   44
         Left            =   -71400
         TabIndex        =   56
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   43
         Left            =   -71880
         TabIndex        =   55
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   42
         Left            =   -72720
         TabIndex        =   54
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   41
         Left            =   -74640
         TabIndex        =   53
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   39
         Left            =   -71880
         TabIndex        =   52
         Top             =   2040
         Width           =   5295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   37
         Left            =   -68880
         TabIndex        =   51
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   36
         Left            =   -71400
         TabIndex        =   50
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   35
         Left            =   -71880
         TabIndex        =   49
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   34
         Left            =   -72720
         TabIndex        =   48
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   33
         Left            =   -74640
         TabIndex        =   47
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   31
         Left            =   -71880
         TabIndex        =   46
         Top             =   2040
         Width           =   5295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   29
         Left            =   -68880
         TabIndex        =   45
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   28
         Left            =   -71400
         TabIndex        =   44
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   27
         Left            =   -71880
         TabIndex        =   43
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   26
         Left            =   -72720
         TabIndex        =   42
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   25
         Left            =   -74640
         TabIndex        =   41
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   23
         Left            =   -71880
         TabIndex        =   40
         Top             =   2040
         Width           =   5295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   21
         Left            =   -68880
         TabIndex        =   39
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   20
         Left            =   -71400
         TabIndex        =   38
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   19
         Left            =   -71880
         TabIndex        =   37
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   18
         Left            =   -72720
         TabIndex        =   36
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   17
         Left            =   -74640
         TabIndex        =   35
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   15
         Left            =   -71880
         TabIndex        =   34
         Top             =   2040
         Width           =   5295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   13
         Left            =   -68880
         TabIndex        =   33
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   12
         Left            =   -71400
         TabIndex        =   32
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   -71880
         TabIndex        =   31
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   10
         Left            =   -72720
         TabIndex        =   30
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   9
         Left            =   -74640
         TabIndex        =   29
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉtÉ@ÉCÉãñº"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   0
         Left            =   360
         TabIndex        =   28
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "Ã´Ÿ¿ﬁ"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Index           =   1
         Left            =   2280
         TabIndex        =   27
         Top             =   1680
         Width           =   855
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "éÌï "
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   3120
         TabIndex        =   26
         Top             =   1680
         Width           =   495
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "√ﬁ∞¿ñºÅ{ ﬁ∞ºﬁÆ›"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   3600
         TabIndex        =   25
         Top             =   1680
         Width           =   2535
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "çÏê¨ì˙ït"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   6120
         TabIndex        =   24
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label lblKan 
         Alignment       =   2  'íÜâõëµÇ¶
         BorderStyle     =   1  'é¿ê¸
         Caption         =   "ÉRÉÅÉìÉg"
         BeginProperty Font 
            Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
            Size            =   9.75
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   6
         Left            =   3120
         TabIndex        =   23
         Top             =   2040
         Width           =   5295
      End
   End
   Begin VB.Label lbltitle 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "êVä≤ê¸é©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óù"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Index           =   0
      Left            =   -15
      TabIndex        =   0
      Top             =   -15
      Width           =   12120
   End
End
Attribute VB_Name = "frmKansenGateVerKanri"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFfrmJGateVerKanri.frm
'//  ÉpÉbÉPÅ[ÉWñºÅFÉoÅ[ÉWÉáÉìä«óù(EG20é©â¸)âÊñ 
'//
'//  äTóvÅFÉoÅ[ÉWÉáÉìä«óù(EG-Ré©â¸/NEGé©â¸)âÊñ 
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@ÉvÉçîªê≥ìñê´É`ÉFÉbÉNèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-11   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRëŒâû
'//                     ÅEã@éÌê≥ìñê´É`ÉFÉbÉNèàóùí«â¡/ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Åvéû
'//                     ÅEÉtÉFÅ[ÉYÇQïsãÔçáèCê≥
'//                     ÅEÉtÉFÅ[ÉYÇPïsãÔçáèCê≥
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.11.0.1) 2009-10-23  CODED   BY [TCC] D.Yamashita
'//                 ÅEÉtÉFÅ[ÉYÇRécåèçÄñ⁄ëŒâû
'//     REVISIONS :(1.12.0.1) 2009-11-11  REVISED BY [TCC] C.Terui
'//                 ì¸óÕÉtÉ@ÉCÉãäiî[ÉfÉBÉåÉNÉgÉäà íuïœçX
'//                 ÉtÉHÉãÉ_ëIëÉ|ÉbÉvÉAÉbÉvâÊñ ÇÃèâä˙ÉtÉHÉãÉ_ïœçX
'//     REVISIONS :(1.16.0.1) 2009-12-21   REVISED BY [TCC] S.Terao
'//                 ïsãÔçáëŒâû
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                á@ ÉtÉHÉãÉ_ëIëâÊñ ÇOSédólÇ…ïœçX
'//                áAÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫Ç…ÇƒÅA
'//                 Å@ÉoÅ[ÉWÉáÉìä«óùâÊñ ÇÃÉoÅ[ÉWÉáÉìï\é¶çXêVÇçsÇ§
'//                áBï\é¶ÉäÉ\Å[ÉXÉâÉWÉIñtëIëÇ≈ÉäÉXÉgÇÃï\é¶çXêV
'//                áCÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃã@éÌê≥ìñê´É`ÉFÉbÉNïœçX
'//                áDÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃê≥ìñê´É`ÉFÉbÉNiniÉtÉ@ÉCÉãâª
'//                áEDirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//                áFÉtÉ@ÉCÉãëIëâÊñ ÇOSédólÇ…ïœçX
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(V2.5.0.1) 2010-10-29  REVISED BY [TCC] S.Terao
'//                 EG-R(KK)Å@î™íöìÎëŒâûÅ@KUKê≥ìñê´É`ÉFÉbÉNïœçX
'//                 î}ëÃéÊäOïsãÔçáèCê≥
'//     REVISIONS :(2.6.0.1) 2010-11-16  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãñºÉ`ÉFÉbÉNïsãÔçáèCê≥
'//     REVISIONS :(EG20 V2.0.1.1) 2011-11-16  REVISED BY [TCC] T.Koyama
'//                 ÇdÇfÇQÇOÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V3.4.0.1) 2012-02-07  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-18  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.11.0.1) 2012-05-10  CODED BY  [TCC] H.Sugimoto
'//                Åyâ^â¸ï\é¶â¸ëPëŒâûÅz
'//     REVISIONS :(EG20 V6.9.0.1) 2012-12-03  CODED BY  [TCC] H.Sugimoto
'//                 ó éYëŒâûÅyéÌï É`ÉFÉbÉNã@î\í«â¡ÅzÅyTOMASópóÃàÊÉRÉsÅ[ëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(EG20 V30.4.0.1) 2015-01-15 CODED BY  [TCC] S.Kuroda
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇRëŒâûÅyHKRK_kansi02_001_01Åz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit

Dim FolderSyubetu As Integer                 'ëIëÉäÉ\Å[ÉXéÌï 

Dim FolderName(0 To 2, 0 To 9) As String     'ÉtÉHÉãÉ_ñº
Dim TitleBox(0 To 10) As String               'É^ÉCÉgÉãñº
Dim LogBox(0 To 10) As String                 'ÉçÉOèoóÕópÉ^ÉCÉgÉãñº
Dim FileList() As String                     'ÉtÉ@ÉCÉãñºÉäÉXÉgàÍóóäiî[ÉGÉäÉA
Dim FileListType() As String                 'ÉtÉ@ÉCÉãÉäÉXÉgàÍóóäiî[ÉGÉäÉAÅiéüê¢ë„é©â¸É^ÉCÉvÇä‹ÇﬁÅj
'Dim uVersion() As MN_VERSION_JIKAI           'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉA      'EG20 V30.1.0.1 DEL
Dim uVersion() As MN_VERSION_KAN_JIKAI       'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉA      'EG20 V30.1.0.1 ADD
Dim gintUnkaiKind(0 To 8) As Integer         ' â^â¸éÌï     ' EG20 V5.11.0.1í«â¡
Dim gintProgramJudgeKind(0 To 8) As Integer  ' ÉvÉçÉOÉâÉÄîªíËéÌï     ' EG20 V6.9.0.1Åyó éYëŒâûÅFéÌï É`ÉFÉbÉNã@î\í«â¡ÅzADD

'ëIëíÜÉäÉ\Å[ÉXéÌï  =0=MN_RSOC_PROÅFÉvÉçÉOÉâÉÄÅA=1=MN_RSOC_HAN:îªíËÉfÅ[É^
Dim iSelResource As Integer


Private Const MN_MAIL_INTERVAL = 1000       'ÉÅÅ[ÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl

Private Const MN_FOLD_WRK = 0               'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_
Private Const MN_FOLD_NOW = 1               'Åué¿çsÅvÉtÉHÉãÉ_
Private Const MN_FOLD_OLD = 2               'ÅuãåÅvÉtÉHÉãÉ_

'ÉoÅ[ÉWÉáÉìÉfÅ[É^ÉtÉ@ÉCÉãópÇÃç\ë¢ëÃ
Private Type MN_VERSION_FILE
    sFileName As String * 12                'ÉtÉ@ÉCÉãñº
    uFooter As MN_FOOT_BYTE                 'ÉtÉbÉ^èÓïÒ
End Type

Private Type MN_VERSION_DAT
    strFolder(0 To 5) As String * 8         'ÉtÉHÉãÉ_ñº
    intFileNum(0 To 5) As Integer           'ÉtÉ@ÉCÉãêî
End Type
'ÉoÅ[ÉWÉáÉìÉfÅ[É^ÉtÉ@ÉCÉãèÓïÒ(ÉoÅ[ÉWÉáÉì2)
Private Type MN_FILE_INFO_V2
    udtInfo As MN_VERSION_DAT               'ÉtÉHÉãÉ_ñºÇ∆ÉtÉ@ÉCÉãêî
    uFileInfo() As MN_VERSION_FILE          'ÉtÉ@ÉCÉãñºÇ∆ÉtÉbÉ^èÓïÒ
End Type

Dim uVerdataFile As MN_FILE_INFO_V2

Private Const HANKUKA_KUK = "HAN_KUKA.KUK"
Private Const INI_MAX = 5
Dim HAN_KUKA_DATA As HANTEI_DATA
Private Type HANTEI_DATA
    sHederKisyu(0 To 4) As String
    sHederFile(0 To 4) As String
    sFotterKisyu(0 To 4) As String
    sFotterFile(0 To 4) As String
End Type

'V1.4.0.1Å@ADDÅ@START
Private Const FILE_NAME_MAX_SIZE = 12
Private Const FILE_NAME_SIZE = 19
'Åyâ^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌÉXÉeÅ[É^ÉXíËã`Åz
Private sNGSts As String        'NGà íu
Private sNGKoumoku As String    'NGçÄñ⁄
'ÅyNGà íuÅz
Private Const ERROR_HEDER = "ÉwÉbÉ_"  'ÉwÉbÉ_
Private Const ERROR_FOTTER = "ÉtÉbÉ^" 'ÉtÉbÉ^
'ÅyNGçÄñ⁄Åz
Private Const KISHU_NAME_ERROR = "ã@éÌñº"       'ã@éÌñº
Private Const FILE_NAME_ERRORE = "ÉtÉ@ÉCÉãñº"   'ÉtÉ@ÉCÉãñº
Private Const CREATE_DATA_ERROR = "çÏê¨ì˙ït"    'çÏê¨ì˙ït
Private Const VERSION_ERROR = "ÉoÅ[ÉWÉáÉì"      'ÉoÅ[ÉWÉáÉì
Private sJverName As String                     'ï\é¶ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXÉ^ÉCÉgÉã
'Private Const EG20_JIKAI = "EG20"               'EG20       'EG20 V30.1.0.1 DEL
Private Const EG30_JIKAI = "EG30"               'EG30        'EG20 V30.1.0.1 ADD
'V1.4.0.1Å@ADDÅ@END
'V1.6.0.1 ADD START
Private Const EGR_JIKAI_KISHU = "EG5000"        'EG-Ré©â¸ã@éÌñº
Private Const NEG_JIKAI_KISHU = "EG2000"        'NEGé©â¸ã@éÌñº
Private Const EG20_JIKAI_KISHU = "EG6000"       'EG20 é©â¸ã@éÌñº
Private Const EG30_JIKAI_KISHU = "EG7000"       'EG30 é©â¸ã@éÌñº
'V1.20.0.1 DEL START
'EG-Ré©â¸
'Private Const EHANTEI_CPU_CHK_FILE = "ko_gateh.vef"
'Private Const EMAIN_CPU_CHK_FILE = "ko_gatep.vef"
'Private Const ESUB_CPU_CHK_FILE = "ko_gatef.vef"
'Private Const EMAIN_OS_CHK_FILE = "ko_gateo.vef"
''NEGé©â¸
'Private Const NHANTEI_CPU_CHK_FILE = "KO_GATEH.VEF"
'Private Const NMAIN_CPU_CHK_FILE = "KO_GATEP.VEF"
'Private Const NSUB_CPU_CHK_FILE = "KO_GATEF.VEF"
'Private Const NMAIN_OS_CHK_FILE = "KO_GATEO.VEF"
'V1.20.0.1 DEL END
'EG20 V30.1.0.1 DEL START
'V1.20.0.1 ADD START
'EG-Ré©â¸
'Private EHANTEI_CPU_CHK_FILE As String
'Private EMAIN_CPU_CHK_FILE As String
'Private ESUB_CPU_CHK_FILE As String
'Private EMAIN_OS_CHK_FILE As String
''NEGé©â¸
'Private NHANTEI_CPU_CHK_FILE As String
'Private NMAIN_CPU_CHK_FILE As String
'Private NSUB_CPU_CHK_FILE As String
'Private NMAIN_OS_CHK_FILE As String
'V1.20.0.1 ADD END
'EG20 V30.1.0.1 DEL END
'EG20 V30.1.0.1 ADD START
'êVä≤ê¸é©â¸
Private EG30_HANTEI_CPU_CHK_FILE As String
Private EG30_MAIN_CPU_CHK_FILE As String
Private EG30_SUB_CPU_CHK_FILE As String
Private EG30_MAIN_OS_CHK_FILE As String
'EG20 V30.1.0.1 ADD END
'V1.6.0.1 ADD END
'ÉfÅ[É^éÌï ëIë
' EG20 V2.0.1.1 ADD START
Public mlngOptDataType          As Long

'ÉtÉHÉãÉ_éÌï ïî
Public mlngChkFolderType        As Long

Dim mbVerKanriExecuteFlg                      As Boolean  'èoóÕé¿çsèàóùíÜÇ©î€Ç©

Private iTab_index As Integer       'Å@ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜ
' EG20 V2.0.1.1 ADD END

' EG20 V3.0.0.2í«â¡äJén
Private Const TITLEDISP_VERNOTHING = "--"       ' âÊñ è„ïîÉoÅ[ÉWÉáÉìÇ»Çµï\é¶
Private Const TITLEDISP_FIXEDVERNOW = "                      Åié¿çsÅj  ÅF"
Private Const TITLEDISP_FIXEDVEROLD = "                      ÅiãåÅj    ÅF"

Dim DispTitleBox(0 To 10) As String             ' âÊñ è„ïîÉ^ÉCÉgÉãñºÅiÇPçsñ⁄Åj
Dim DispTitleVersion(0 To 2) As String          ' âÊñ è„ïîÉoÅ[ÉWÉáÉì

' EG20 V3.0.0.2í«â¡èIóπ

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdGateVerUpdate_Click
'//  ã@î\ñºèÃ  : àÍäáçXêVñtâüâ∫èàóù
'//  ã@î\äTóv  : â¸éDã@àÍäáçXêVâÊñ Çï\é¶Ç∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//  ORIGINAL  :(EG20 V2.1.0.1) 2011-09-25  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//                 EG20ìùçáäƒéãî’USDMëŒâûî‘çÜÅyMainte_03_01Åz
'//  REVISIONS :(EG20 V30.1.0.1) 2014-02-20  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//  REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdGateVerUpdate_Click()

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFé©â¸êÿÇËó£Çµñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_IKKATSU_BUTTOM, 0)

    'í êMê⁄ë±ÅEêÿífâÊñ Çï\é¶Ç∑ÇÈÅB
    'Load frmGateVerUpdate          'EG20 V30.1.0.1 DEL
    Load frmKansenGateVerUpdate     'EG20 V30.1.0.1 ADD
    'frmGateVerUpdate.Show 1        'EG20 V30.1.0.1 DEL
    frmKansenGateVerUpdate.Show 1   'EG20 V30.1.0.1 ADD

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óù(EG20é©â¸)âÊñ (ÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()
   On Error Resume Next
    
    'ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ÇãNìÆÇ∑ÇÈÅB
    tmrMail.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óù(EG20é©â¸)âÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
   On Error Resume Next
    
    If blnCabfrmOpenFlg = True Then
        Call fnTsbCabCallDiverge
        Exit Sub
    End If

    'ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}Çé~ÇﬂÇÈÅB
    tmrMail.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdInstall_Click
'//  ã@î\ñºèÃ  : Åuî}ëÃéÊäOÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : î}ëÃÇÃéÊäOÇµÇçsÇ§
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdInstall_Click(Index As Integer)
   On Error Resume Next
   
   If Index = 1 Then                                ' î}ëÃéÊäO èàóù
       'Åuî}ëÃéÊäOñtâüâ∫ÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, USB_OUT, 0)
 
        'î}ëÃéÊäOèàóù
        Call pfRemove(Me)
    Else                                            'ÉoÅ[ÉWÉáÉìèÓïÒ  î}ëÃèoóÕèàóù
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃèoóÕñtâüâ∫ÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_OUTPUT_BUTTOM, 0)
 
        'î}ëÃèoóÕèàóù
        fMakeOutPutFile
    End If
    
ErrorHandle:
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Command1_Click
'//  ã@î\ñºèÃ  : Åuî}ëÃÅ®ÉèÅ[ÉNÉRÉsÅ[Åvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : î}ëÃÇÉèÅ[ÉNÇ…ÉRÉsÅ[
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] T.koyama
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Command2_Click()

   Dim iResponse As Integer         'MsgBoxÉ{É^ÉìÉRÅ[Éh
   Dim lngErrCode As Long           'ÉGÉâÅ[ÉRÅ[Éh

   On Error Resume Next

   'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃÅ®ÉèÅ[ÉNÉRÉsÅ[ñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_LZH_COPY_WRK_BUTTOM, 0)
    'ÉCÉìÉXÉgÅ[Éãî}ëÃÇÉèÅ[ÉNÉtÉHÉãÉ_ì‡Ç…ÉRÉsÅ[Ç∑ÇÈ
    sFDInstall "STD"
        
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2005 All Rights Reserved
'/
'/  ä÷êîñºèÃ     : Form_Load
'/  ã@î\ñºèÃ     : Form_Loadéûèàóù
'/  ã@î\äTóv     : Form_LoadéûèàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/ ORIGINAL  :(3.1.0.1) 2005-11-29   CODED   BY [TCC] A.Mizuno
'/ REVISIONS :(5.1.0.1) 2006-05-10   CODED   BY [TCC] K.Hayashi
'/ REVISIONS :(5.3.0.1) 2006-06-08   CODED   BY [TCC] K.Hayashi
'/ REVISIONS :(EG20 V2.0.1.1) 2011-11-18   CODED   BY [TCC] T.Koyama
'/ REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'/             EG20ÉtÉFÅ[ÉYÇQëŒâû
'/ REVISIONS :(EG20 V3.4.0.1) 2012-02-07  CODED BY  [TCC] H.Sugimoto
'/             EG20ÉtÉFÅ[ÉYÇQëŒâûÅi1ÉRÅ[Éiê›íËÇ≈ê≥ÇµÇ≠ï\é¶Ç™çsÇ¶Ç»Ç¢ëŒâûÅj
'/ REVISIONS :(EG20 V30.1.0.1) 2014-02-17 CODED BY  [TCC] T.Nakajima
'/             ñkó§êVä≤ê¸äJã∆ëŒâû
'/ REVISIONS :(EG20 V30.3.0.1) 2014-10-16 CODED BY  [TCC] T.Nakajima
'/             ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû ÅyHKRK_Kansi06_004_02Åz
'/ REVISIONS :(x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub Form_Load()

   Dim intCount As Integer
   Dim strCorner1 As String
   Dim strCorner2 As String
   Dim bySelectedFlg    As Byte     'EG20 V30.1.0.1 ADD
   
   On Error Resume Next
 
    'sJverName = EG20_JIKAI     'EG20 V30.1.0.1 DEL
    sJverName = EG30_JIKAI      'EG20 V30.1.0.1 ADD
    
    'EG20 V30.1.0.1 DEL START
    'ÅuEG-Ré©ìÆâ¸éDã@ ﬁ∞ºﬁÆ›âÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
    'Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, EJIKAI_VERASION_KANRI_GAMEN_START, 0)
    'EG20 V30.1.0.1 DEL END
    'EG20 V30.1.0.1 ADD START
    'ÅuEG-Ré©ìÆâ¸éDã@ ﬁ∞ºﬁÆ›âÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KJIKAI_VERASION_KANRI_GAMEN_START, 0)
    'EG20 V30.1.0.1 ADD END
  
 ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
    ' ÉtÉHÉãÉ_ëIëÉ`ÉFÉbÉNÉ{ÉbÉNÉXèâä˙ílê›íË
    For intCount = 0 To chkFolder.UBound
      chkFolder(intCount) = 1
    Next intCount
      
      'çÜã@èÓïÒéÊìæ
    Call gsGetGateInfo
    Call gsGetCornerName
    Call gsGetCornerType        ''EG20 V30.1.0.1 ADD
    
   'É^ÉuêîÇê›íuÉRÅ[ÉiêîÇ∆Ç∑ÇÈ
    SSTab1.Tab = 0
'    SSTab1.Tabs = gintCornerNum            ' EG20 V3.4.0.1 çÌèú
    bySelectedFlg = False       'EG20 V30.1.0.1 ADD
    For intCount = 0 To UBound(gblnCornerSet)
    
        'ê›íËÇ†ÇËÇÃÉRÅ[ÉiÇäàê´Ç…Ç∑ÇÈ
        If gblnCornerSet(intCount) = True Then
            'ÉRÅ[ÉiÅ[ñºèÃï\é¶
            strCorner1 = MidB(gstrCornerName(intCount), 1, 12)
            strCorner2 = MidB(gstrCornerName(intCount), 13, 24)
            SSTab1.TabCaption(intCount) = strCorner1 & vbCrLf & strCorner2
            'EG20 V30.0.3.1 ÅyHKRK_Kansi06_004_02Åz DEL START
            'EG20 V30.1.0.1 ADD START
'            If gintCornerType(intCount) = CORNER_TYPE_ZAIRAI Then
'                'ç›óàÉRÅ[ÉiÇ»ÇÁÇŒâüâ∫ïsâ¬Ç…Ç∑ÇÈ
'                SSTab1.TabEnabled(intCount) = False
'            Else
'                'àÍî‘énÇﬂÇÃêVä≤ê¸ÉRÅ[ÉiÅ[ÇÃÉ^ÉuÇëIëèÛë‘Ç…Ç∑ÇÈÅB
'                If bySelectedFlg = False Then
'                    SSTab1.Tab = intCount
'                    bySelectedFlg = True
'                    'êVä≤ê¸ÇÃêÊì™ÉRÅ[ÉiÅ[Ç»ÇÁÇŒGATE00Ç…ÉRÉsÅ[ÇÇ∑ÇÈïKóvÇ™Ç†ÇÈÇΩÇﬂÅAêÊì™ÉCÉìÉfÉbÉNÉXÇï€ë∂ÇµÇƒÇ®Ç≠
'                    gintKansenFirstCornerIdx = intCount
'                End If
'            End If
            'EG20 V30.1.0.1 ADD END
            'EG20 V30.3.0.1 ÅyHKRK_Kansi06_004_02Åz DEL END
            
            'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
            lstKan(intCount).Clear
        
            'âÊñ É^ÉCÉgÉãê›íË
            'lbltitle(intCount).Caption = "é©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óù"    ' EG20 V30.1.0.1 DEL
            lbltitle(intCount).Caption = "êVä≤ê¸é©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óù"    ' EG20 V30.1.0.1 ADD
   
' EG20 V3.0.0.2çÌèúäJén
'            'ë„ï\ÉoÅ[ÉWÉáÉìê›íË
'            lblZenVer(intCount).Caption = "îªíËÉfÅ[É^Å@ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF  " & vbCrLf & _
'                                          "                      Åié¿çsÅj  ÅF  " & vbCrLf & _
'                                          "                      ÅiãåÅj    ÅF  "
' EG20 V3.0.0.2çÌèúèIóπ
        End If
    Next

    'ê›íËÇ»ÇµÇÃÉRÅ[ÉiÉ^ÉuÇîÒï\é¶Ç…ê›íËÇ∑ÇÈ
    For intCount = 0 To UBound(gblnCornerSet)

        If gblnCornerSet(intCount) = False Then
            SSTab1.TabVisible(intCount) = False
        End If
    Next
 ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz

    'ÉfÅ[É^ìWäJ
    sSetFolderName

    'ïœêîÇÃèâä˙âª
    FolderSyubetu = 0

    'ÉoÅ[ÉWÉáÉìèÓïÒÇÃÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox

    'ÉÅÅ[ÉãéÛêMópÇÃÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈ
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False
    
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000

End Sub

  
'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : chkFolder_Click
'/  ã@î\ñºèÃ     : ÅuÉtÉHÉãÉ_ëIëïîÅvÉ`ÉFÉbÉNèàóù
'/  ã@î\äTóv     : ÅuÉtÉHÉãÉ_ëIëïîÅvÉ`ÉFÉbÉNèàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub chkFolder_Click(Index As Integer)
  
'    Dim ValueCnt                As Integer
'
'    'ÉçÉOèoóÕ
'    If Index = 0 Then
'        'ÉèÅ[ÉN
'        Call psPutLog(LOG_frmGateVerKanri_CHKFOLDER0)
'    ElseIf Index = 1 Then
'        'é¿çs
'        Call psPutLog(LOG_frmGateVerKanri_CHKFOLDER1)
'    ElseIf Index = 2 Then
'        'ãå
'        Call psPutLog(LOG_frmGateVerKanri_CHKFOLDER2)
'    End If
'
'    'éÌóﬁÇ…ÇÊÇ¡Çƒëùå∏ílÇïœçXÇ∑ÇÈ
'    ValueCnt = 0
'    'ÉèÅ[ÉN
'    If Index = 0 Then
'        ValueCnt = 1
'    'é¿çs
'    ElseIf Index = 1 Then
'        ValueCnt = 2
'    'ãå
'    ElseIf Index = 2 Then
'        ValueCnt = 4
'    End If
'
'    'É`ÉFÉbÉNÇ™ÇÕÇ∏Ç≥ÇÍÇΩéû
'    If chkFolder(Index).Value = 0 Then
'        mlngChkFolderType = mlngChkFolderType - ValueCnt
'    'É`ÉFÉbÉNÇ≥ÇÍÇΩéû
'    ElseIf chkFolder(Index).Value = 1 Then
'        mlngChkFolderType = mlngChkFolderType + ValueCnt
'    End If

End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdClear_Click
'/  ã@î\ñºèÃ     : ÅuÉèÅ[ÉNÉNÉäÉAÅvÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : ÅuÉèÅ[ÉNÉNÉäÉAÅvÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub CmdClear_Click()

   Dim iResponse As Integer         'MsgBoxÉ{É^ÉìÉRÅ[Éh
   Dim lngErrCode As Long           'ÉGÉâÅ[ÉRÅ[Éh

   On Error Resume Next

    'Åué©â¸ ﬁ∞ºﬁÆ›ä«óùÅFÉèÅ[ÉNÉNÉäÉAñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_WRK_CREA_BUTTOM, 0)

    'ämîFÉ|ÉbÉvÉAÉbÉvÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈÅB
    iResponse = MsgBox("ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "ÇÅA" _
           & Chr(vbKeyReturn) & "ëSÇƒçÌèúÇµÇ‹Ç∑ÅB    ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
           vbYesNo + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ÉèÅ[ÉN ÉNÉäÉA")
    If iResponse = vbYes Then
        '[ÇÕÇ¢] É{É^ÉìÇëIëÇµÇΩèÍçá
        'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
       If sWrkFolderRemove <> True Then
          'Åué©â¸ ﬁ∞ºﬁÆ›ä«óùÅFÉèÅ[ÉNÉNÉäÉAèàóùàŸèÌÅvÉçÉOèoóÕ
          lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
          Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_CREA_ERROR, lngErrCode)
          Exit Sub
       End If
       'Åué©â¸ ﬁ∞ºﬁÆ›ä«óùÅFÉèÅ[ÉNÉNÉäÉAèàóùê≥èÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_CREA_OK, 0)
       
       'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
       lstKan(0).Clear
       lstKan(1).Clear
       lstKan(2).Clear
       lstKan(3).Clear
       lstKan(4).Clear
       lstKan(5).Clear
       
       'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
       fMakeListbox
    End If
    
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdCopyBaitai_Work_Click
'/  ã@î\ñºèÃ     : Åuî}ëÃ(à≥èk)Å®ÉèÅ[ÉN ÉRÉsÅ[ÅvÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : Åuî}ëÃ(à≥èk)Å®ÉèÅ[ÉN ÉRÉsÅ[ÅvÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub cmdCopyBaitai_Work_Click()

   On Error Resume Next

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFà≥èkÃß≤ŸÅ®‹∞∏∫Àﬂ∞ñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_CAB_COPY_WRK_BUTTOM, 0)

    'à≥èkÉtÉ@ÉCÉãÇ©ÇÁÉCÉìÉXÉgÅ[ÉãÇ∑ÇÈÅB
    sFDInstall "LZH"
    
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdCopyOld_Jikko_Click
'/  ã@î\ñºèÃ     : ÅuãåÅ®é¿çs ÉRÉsÅ[ÅvÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : ÅuãåÅ®é¿çs ÉRÉsÅ[ÅvÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'/  REVISIONS    : (EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'/                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub cmdCopyOld_Jikko_Click()
    
   Dim iResponse As Integer         'MsgBoxÉ{É^ÉìÉRÅ[Éh
   Dim lngErrCode As Long           'ÉGÉâÅ[ÉRÅ[Éh

   On Error Resume Next

   'Åué©â¸ ﬁ∞ºﬁÆ›ÅFãåÅ®é¿çsÉRÉsÅ[ñtâüâ∫ÅvÉçÉOèoóÕ
   Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_OLD_COPY_NOW_BUTTOM, 0)
   'ämîFÉ|ÉbÉvÉAÉbÉvÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈÅB
   iResponse = MsgBox("ÅuãåÅvÉtÉHÉãÉ_ÇÃì‡óeÇÅAÅué¿çsÅvÉtÉHÉãÉ_Ç…ñﬂÇ∑Ç±Ç∆Ç…ÇÊÇËÅA" _
             & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & "ÇÃàÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇÅA" _
             & Chr(vbKeyReturn) & "é¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹Ç∑ÅB  ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
            vbYesNo + vbExclamation, _
            TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ[")
   If iResponse = vbYes Then
   '[ÇÕÇ¢] É{É^ÉìÇëIëÇµÇΩèÍçá
         
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_VERSION_KANRI)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
         
         'àÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇé¿çsÉoÅ[ÉWÉáÉìÇ…ñﬂÇ∑
       If fOldVersion <> True Then
          'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[èàóùàŸèÌÅvÉçÉOèoóÕ
          lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
          Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_OLD_COPY_NOW_ERROR, lngErrCode)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
           'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
           Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
          Exit Sub
       End If
       'Åué©â¸ ﬁ∞ºﬁÆ›ÅFãåÅ®é¿çsÉRÉsÅ[èàóùê≥èÌÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_OLD_COPY_NOW_OK, 0)
       
       'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
       lstKan(0).Clear
       lstKan(1).Clear
       lstKan(2).Clear
       lstKan(3).Clear
       lstKan(4).Clear
       lstKan(5).Clear
      
       'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
       fMakeListbox
   
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
   End If
       
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdCopyWork_Jikko_Click
'/  ã@î\ñºèÃ     : ÅuÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ[ÅvÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : ÅuÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ[ÅvÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-27   CODED   BY [TCC] Y.Masuda
'/  REVISIONS    : (3.10.0.1) 2006-02-02  CODED   BY [TCC] K.Inoue
'/  REVISIONS    : (EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'/                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub cmdCopyWork_Jikko_Click()
   
   Dim iResponse As Integer         'MsgBoxÉ{É^ÉìÉRÅ[Éh
   Dim lngErrCode As Long           'ÉGÉâÅ[ÉRÅ[Éh

   On Error Resume Next

   'ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[ÅvÉ{É^ÉìÇÃèÍçáÅB
   'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[ñtâüâ∫ÅvÉçÉOèoóÕ
   Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_WRK_COPY_NOW_BUTTOM, 0)
    
   'ämîFÉ|ÉbÉvÉAÉbÉvÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈÅB
   iResponse = MsgBox("ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ÇÃì‡óeÇÅAÅué¿çsÅvÉtÉHÉãÉ_Ç…ìoò^Ç∑ÇÈÇ±Ç∆Ç…ÇÊÇËÅA" _
            & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & " ÇÃç≈êVÇÃÉoÅ[ÉWÉáÉìÇÅAé¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹Ç∑ÅB" _
            & Chr(vbKeyReturn) & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
           vbYesNo + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ[")
   If iResponse = vbYes Then
   '[ÇÕÇ¢] É{É^ÉìÇëIëÇµÇΩèÍçá
            
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_VERSION_KANRI)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
            'ç≈êVÉoÅ[ÉWÉáÉìÇé¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇƒìoò^Ç∑ÇÈ
        If fNewVersion <> True Then
           'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[èàóùàŸèÌÅvÉçÉOèoóÕ
           lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_COPY_NOW_ERROR, lngErrCode)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
           'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
           Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
           Exit Sub
        End If
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[èàóùê≥èÌÅvÉçÉOèoóÕ
         Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_COPY_NOW_OK, 0)
        
        'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
        lstKan(0).Clear
        lstKan(1).Clear
        lstKan(2).Clear
        lstKan(3).Clear
        lstKan(4).Clear
        lstKan(5).Clear
        
        'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
        fMakeListbox
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
   End If
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdDLLJikkoGamen_Click
'/  ã@î\ñºèÃ     : ÅuDLLé¿çsâÊñ Ç÷ÅvÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : ÅuDLLé¿çsâÊñ Ç÷ÅvÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub cmdDLLJikkoGamen_Click()

    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim bFlag As Boolean            'ÉtÉâÉO
    Dim lRetVal As Long             'ñﬂÇËíl
    Dim sCommand As String          'ÉRÉ}ÉìÉhï∂éöóÒ
    Dim sWriteDir As String
    
    On Error GoTo ErrorHandle

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFé©â¸êÿÇËó£Çµñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_KIRIHANASI_BUTTOM, 0)

    'í êMê⁄ë±ÅEêÿífâÊñ Çï\é¶Ç∑ÇÈÅB
    Load frmConectSts
    frmConectSts.Show 1

ErrorHandle:
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdKoshin_Click
'/  ã@î\ñºèÃ     : Åuï\é¶çXêVÅvÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : Åuï\é¶çXêVÅvÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub cmdKoshin_Click()
    
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim bFlag As Boolean            'ÉtÉâÉO
    Dim lRetVal As Long             'ñﬂÇËíl
    Dim sCommand As String          'ÉRÉ}ÉìÉhï∂éöóÒ
    Dim sWriteDir As String
    
    On Error GoTo ErrorHandle

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFï\é¶çXêVñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, UPDATE_BUTTOM, 0)

    'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
    bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
        If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
            bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
            Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
        End If
    Next
              
    If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
        'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
        'EG20 V30.1.0.1 DEL START
'        MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
'                          vbOKOnly + vbExclamation, _
'                          "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 DEL END
        'EG20 V30.1.0.1 ADD START
        MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                          vbOKOnly + vbExclamation, _
                          "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 ADD END
        'èàóùÇî≤ÇØÇÈ
        Exit Sub
    End If
    
    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
    lstKan(0).Clear
    lstKan(1).Clear
    lstKan(2).Clear
    lstKan(3).Clear
    lstKan(4).Clear
    lstKan(5).Clear
    
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox
              
ErrorHandle:
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : cmdModoru_Menu_Click
'/  ã@î\ñºèÃ     : ÉÅÉjÉÖÅ[âÊñ Ç…ñﬂÇÈÉ{É^Éìâüâ∫èàóù
'/  ã@î\äTóv     : ÉÅÉjÉÖÅ[âÊñ Ç…ñﬂÇÈÉ{É^Éìâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-07   CODED   BY [TCC] T.Shimizu
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub cmdModoru_Menu_Click()
    
'    'ÉçÉOèoóÕ
'    Call psPutLog(LOG_frmGateVerKanri_CMDMODORU_MENU)
'
'    'ÉÅÉjÉÖÅ[âÊñ ï\é¶
'    frmProgramHanteiData.Show

    'âÊñ ÇÃUnload
    Unload Me

End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : sOptDataDisp
'/  ã@î\ñºèÃ     : ÉfÅ[É^éÌï ëIëïîï\é¶èàóù
'/  ã@î\äTóv     : ÉfÅ[É^éÌï ëIëïîÇëIëÇ≥ÇÍÇΩÉ^Éuï Ç…ï\é¶èàóùÇçsÇ§
'/
'/                 å^          ñºèÃ                   à”ñ°
'/  à¯êî         : Long        îªíËIC-MÉÅÅ[ÉJÅ[ëIëïî ÉNÉäÉbÉNÇµÇΩÉ^ÉuÉCÉìÉfÉbÉNÉX(1Å`6)
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-26   CODED   BY [TCC] Y.Masuda
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub sOptDataDisp(Index As Long)
'
'    'ÉfÅ[É^éÌï ëIëïîï\é¶
'    Dim intCnt                  As Long
'
'    'ÉfÅ[É^éÌï ëIëïîÇçƒï\é¶Ç∑ÇÈ
'    For intCnt = 5 To 0 Step -1
'        If gudtMaker(Index).strType(intCnt) = "" Then
'            Me.optData(intCnt).Caption = ""
'            Me.optData(intCnt).Visible = False
'        Else
'            Me.optData(intCnt).Caption = gudtMaker(Index).strType(intCnt)
'            Me.optData(intCnt).Visible = True
'
'            'Ver1.0.0.6 ADD Start
'            mlngOptDataType = intCnt + 1
'            'Ver1.0.0.6 ADD End
'        End If
'    Next
'
'    'Ver1.0.0.6 UPD Start
'    'ëIëèÛë‘Ç…Ç∑ÇÈ
'    Me.optData(mlngOptDataType - 1).Value = True
'    'Ver1.0.0.6 UPD End


End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : sCmdBtnEnabled
'/  ã@î\ñºèÃ     : ÉRÉ}ÉìÉhÉ{É^Éìâüâ∫â¬ÅEïsâ¬èàóù
'/  ã@î\äTóv     : ÉRÉ}ÉìÉhÉ{É^ÉìÇà¯êîÇ…äÓÇ¢Çƒâüâ∫â¬ÅEïsâ¬èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-26   CODED   BY [TCC] Y.Masuda
'/  REVISIONS    : (1.0.0.5) 2005-04-06   CODED   BY [TCC] Y.Masuda
'/  REVISIONS    : (3.1.0.1) 2005-12-09   CODED   BY [TCC] A.Mizuno
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub sCmdBtnEnabled(blnFlg As Boolean)
'
'    'Ç∑Ç◊ÇƒÇÃñtâüâ∫â¬î\
'    Me.cmdClear.Enabled = blnFlg
'    Me.cmdCopyBaitai_Work.Enabled = blnFlg
'    If blnFlg = vbTrue Then
'      Call CopyBtm_Enabled
'    Else
'      Me.cmdCopyOld_Jikko.Enabled = blnFlg
'      Me.cmdCopyWork_Jikko.Enabled = blnFlg
'    End If
'    Me.cmdDLLJikkoGamen.Enabled = blnFlg
'    Me.cmdKoshin.Enabled = blnFlg
'    Me.cmdModoru_Menu.Enabled = blnFlg
''V3.1.0.1 Add Start
'    'DLLãñâ¬âÊñ ÇÃÉ{É^Éìêßå‰í«â¡
'    Me.cmdDLLKyokaGamen.Enabled = blnFlg
''V3.1.0.1 Add End
    
End Sub

Private Sub Form_Paint()
'    glnghwndTabCnt = gudtVerTbsInfo.lnghwndTabCnt
'    glnghwndOwnDrwTab1 = gudtVerTbsInfo.lnghwndOwnDrwTab
'    glngPrevWndProc = gudtVerTbsInfo.lngPrevWndProc
'    tbsICMVersion.Refresh
End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
'    ' ÉTÉuÉNÉâÉXâªäJén
'    UnSubClass Me, gudtVerTbsInfo.lngPrevWndProc
End Sub

'/////////////////////////////////////////////////////////////////////////////
'/    (C) Copyright TOSHIBA Corporation 2004 All Right Reserved
'/
'/  ä÷êîñºèÃ     : optData_Click
'/  ã@î\ñºèÃ     : ÅuÉfÅ[É^éÌï ëIëïîÅvâüâ∫èàóù
'/  ã@î\äTóv     : ÅuÉfÅ[É^éÌï ëIëïîÅvâüâ∫èàóùÇçsÇ§
'/
'/                   å^          ñºèÃ            à”ñ°
'/  à¯êî         :
'/  ñﬂÇËíl       :
'/
'/  ORIGINAL     : (1.0.0.0) 2004-12-26   CODED   BY [TCC] Y.Masuda
'/  REVISIONS    : (EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'/                  EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'/  REVISIONS    : (x.x.x.x) xxxx-xx-xx   CODED   BY [xxx]
'/  îıçl         :
'/////////////////////////////////////////////////////////////////////////////
Private Sub optData_Click(Index As Integer)
  
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim bFlag As Boolean            'ÉtÉâÉO

    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    'ÉäÉ\Å[ÉXéÌï ÇïœçXÇ∑ÇÈÅB'
    FolderSyubetu = Index
    
' EG20 V3.0.0.2çÌèúäJén
'    ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
'    Select Case FolderSyubetu           'ÉäÉ\Å[ÉXéÌï 
'        Case 0                              'îªíËÉfÅ[É^
'           lblZenVer(iTab_index).Caption = "îªíËÉfÅ[É^  ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 1                              'ÉvÉçÉOÉâÉÄ
'           lblZenVer(iTab_index).Caption = "ÉvÉçÉOÉâÉÄ  ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 2                              'ªÃﬁCPU-Pro1
'           lblZenVer(iTab_index).Caption = "ªÃﬁCPU-Pro1 ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 3                              'ªÃﬁCPU-Pro2
'           lblZenVer(iTab_index).Caption = "ªÃﬁCPU-Pro2 ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 4                              'ªÃﬁCPU-Pro3
'           lblZenVer(iTab_index).Caption = "ªÃﬁCPU-Pro3 ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 5                              'é©â¸ÅiÇnÇrÅj
'           lblZenVer(iTab_index).Caption = "é©â¸ÅiÇnÇrÅjÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 6                              'ó\îıÇP
'           lblZenVer(iTab_index).Caption = "ó\îıÇP      ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 7                              'ó\îıÇQ
'           lblZenVer(iTab_index).Caption = "ó\îıÇQ      ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'        Case 8                              'ó\îıÇP
'           lblZenVer(iTab_index).Caption = "ó\îıÇR      ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & vbCrLf & _
'                                           "                      Åié¿çsÅj  ÅF" & vbCrLf & _
'                                           "                      ÅiãåÅj    ÅF"
'    End Select
'    ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
' EG20 V3.0.0.2çÌèúèIóπ

    
    
    
    'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
    bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
        If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
            bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
            Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
        End If
    Next
    
    If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
        'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
        'EG20 V30.1.0.1 DEL START
'        MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
'                    vbOKOnly + vbExclamation, _
'                    "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 DEL END
        'EG20 V30.1.0.1 ADD START
        MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                    vbOKOnly + vbExclamation, _
                    "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 ADD END
        'èàóùÇî≤ÇØÇÈ
        Exit Sub
    End If
    
    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
    lstKan(0).Clear
    lstKan(1).Clear
    lstKan(2).Clear
    lstKan(3).Clear
    lstKan(4).Clear
    lstKan(5).Clear
    
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox
    'V1.20.0.1 ADD END

End Sub


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sVersionDisp
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXí«â¡
'//  ã@î\äTóv  : ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºíPà Ç≈ÉäÉXÉgÉ{ÉbÉNÉXÇ…í«â¡Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V6.4.0.1) 2012-06-17 REVISED BY [TCC] H.Sugimoto
'//                Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-18 REVISED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Sub sVersionDisp(uVerData() As MN_VERSION_JIKAI)       'EG20 V30.1.0.1 DEL
Private Sub sVersionDisp(uVerData() As MN_VERSION_KAN_JIKAI)    'EG20 V30.1.0.1 ADD
    Dim sFileName As String         'ÉtÉ@ÉCÉãñºï∂éöóÒÅiéüê¢ë„é©â¸É^ÉCÉvÇä‹ÇﬁÅj
    Dim sFileSize As String         'ÉtÉ@ÉCÉãÉTÉCÉYï∂éöóÒ
    Dim sFileInfo(2) As String      'ÉoÅ[ÉWÉáÉìèÓïÒï∂éöóÒ
    Dim sComment1(2) As String      'ÉRÉÅÉìÉgï∂éöóÒ
    Dim sComment2(2) As String      'ÉRÉÅÉìÉgï∂éöóÒ

   On Error Resume Next
    
    If uVerData(0).sFileName <> "" Then     'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉtÉ@ÉCÉãñºäiî[
        sFileName = StrConv(MidB(StrConv(uVerData(0).sFileName & Space(12), vbFromUnicode), 1, 16), vbUnicode)
    ElseIf uVerData(1).sFileName <> "" Then 'Åué¿çsÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉtÉ@ÉCÉãñºäiî[
        sFileName = StrConv(MidB(StrConv(uVerData(1).sFileName & Space(12), vbFromUnicode), 1, 16), vbUnicode)
    Else                                    'ÅuãåÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉtÉ@ÉCÉãñºäiî[
        sFileName = StrConv(MidB(StrConv(uVerData(2).sFileName & Space(12), vbFromUnicode), 1, 16), vbUnicode)
    End If
    sFileName = sFileName & " "

    If uVerData(0).sFileName <> "" Then     'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉoÅ[ÉWÉáÉìèÓïÒäiî[
        'EG20 V30.1.0.1 DEL START
'        sFileInfo(0) = " " & StrConv(MidB(StrConv(uVerData(0).sMachineName & Space(10), vbFromUnicode), 1, 9), vbUnicode)
'        sFileInfo(0) = sFileInfo(0) & StrConv(MidB(StrConv(uVerData(0).sFooterFile & Space(8), vbFromUnicode), 1, 10), vbUnicode)
'        sFileInfo(0) = sFileInfo(0) & StrConv(MidB(StrConv(uVerData(0).sFileDate & Space(15), vbFromUnicode), 1, 14), vbUnicode)
'        sFileInfo(0) = sFileInfo(0) & uVerData(0).sVersion
        'EG20 V30.1.0.1 DEL END
        'EG20 V30.1.0.1 ADD START
        If Len(Trim(uVerData(0).sSyubetsu)) <> 0 Then
            sFileInfo(0) = " " & StrConv(MidB(StrConv(uVerData(0).sSyubetsu & Space(6), vbFromUnicode), 1, 4), vbUnicode)
        Else
            sFileInfo(0) = " " & Left(String(3, "-") & Space(6), 4)
        End If
        If Len(Trim(uVerData(0).sDataVersion)) <> 0 Then
            sFileInfo(0) = sFileInfo(0) & StrConv(MidB(StrConv(uVerData(0).sDataVersion & Space(20), vbFromUnicode), 1, 21), vbUnicode)
        Else
            sFileInfo(0) = sFileInfo(0) & Left(String(20, "-") & Space(20), 21)
        End If
        If Len(Trim(uVerData(0).sFileDate)) <> 0 Then
            sFileInfo(0) = sFileInfo(0) & StrConv(MidB(StrConv(uVerData(0).sFileDate, vbFromUnicode), 1, 16), vbUnicode)
        Else
            sFileInfo(0) = sFileInfo(0) & Left(String(16, "-") & Space(20), 16)
        End If
            
        'EG20 V30.1.0.1 ADD END
        sComment1(0) = " " & StrConv(MidB(StrConv(uVerData(0).sComment, vbFromUnicode), 1, 32), vbUnicode)
        sComment2(0) = " " & StrConv(MidB(StrConv(uVerData(0).sComment, vbFromUnicode), 33, 32), vbUnicode)
        If Len(Trim(sComment1(0))) <> 0 Then
            'ÇªÇÃÇ‹Ç‹
        Else
            sComment1(0) = " " & String(32, "-")
        End If
            
    End If
    If uVerData(1).sFileName <> "" Then     'Åué¿çsÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉoÅ[ÉWÉáÉìèÓïÒäiî[
        'EG20 V30.1.0.1 DEL START
'        sFileInfo(1) = " " & StrConv(MidB(StrConv(uVerData(1).sMachineName & Space(10), vbFromUnicode), 1, 9), vbUnicode)
'        sFileInfo(1) = sFileInfo(1) & StrConv(MidB(StrConv(uVerData(1).sFooterFile & Space(8), vbFromUnicode), 1, 10), vbUnicode)
'        sFileInfo(1) = sFileInfo(1) & StrConv(MidB(StrConv(uVerData(1).sFileDate & Space(15), vbFromUnicode), 1, 14), vbUnicode)
'        sFileInfo(1) = sFileInfo(1) & uVerData(1).sVersion
        'EG20 V30.1.0.1 DEL END
        'EG20 V30.1.0.1 ADD START
        If Len(Trim(uVerData(1).sSyubetsu)) <> 0 Then
            sFileInfo(1) = " " & StrConv(MidB(StrConv(uVerData(1).sSyubetsu & Space(6), vbFromUnicode), 1, 4), vbUnicode)
        Else
            sFileInfo(1) = " " & Left(String(3, "-") & Space(6), 4)
        End If
        If Len(Trim(uVerData(1).sDataVersion)) <> 0 Then
            sFileInfo(1) = sFileInfo(1) & StrConv(MidB(StrConv(uVerData(1).sDataVersion & Space(20), vbFromUnicode), 1, 21), vbUnicode)
        Else
            sFileInfo(1) = sFileInfo(1) & Left(String(20, "-") & Space(20), 21)
        End If
        If Len(Trim(uVerData(1).sFileDate)) <> 0 Then
            sFileInfo(1) = sFileInfo(1) & StrConv(MidB(StrConv(uVerData(1).sFileDate, vbFromUnicode), 1, 16), vbUnicode)
        Else
            sFileInfo(1) = sFileInfo(1) & Left(String(16, "-") & Space(20), 16)
        End If
        'EG20 V30.1.0.1 ADD END
        sComment1(1) = " " & StrConv(MidB(StrConv(uVerData(1).sComment, vbFromUnicode), 1, 32), vbUnicode)
        sComment2(1) = " " & StrConv(MidB(StrConv(uVerData(1).sComment, vbFromUnicode), 33, 32), vbUnicode)
        If Len(Trim(sComment1(1))) <> 0 Then
            'ÇªÇÃÇ‹Ç‹
        Else
            sComment1(1) = " " & String(32, "-")
        End If
        
    End If
    If uVerData(2).sFileName <> "" Then     'ÅuãåÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉoÅ[ÉWÉáÉìèÓïÒäiî[
        'EG20 V30.1.0.1 DEL START
'        sFileInfo(2) = " " & StrConv(MidB(StrConv(uVerData(2).sMachineName & Space(10), vbFromUnicode), 1, 9), vbUnicode)
'        sFileInfo(2) = sFileInfo(2) & StrConv(MidB(StrConv(uVerData(2).sFooterFile & Space(8), vbFromUnicode), 1, 10), vbUnicode)
'        sFileInfo(2) = sFileInfo(2) & StrConv(MidB(StrConv(uVerData(2).sFileDate & Space(15), vbFromUnicode), 1, 14), vbUnicode)
'        sFileInfo(2) = sFileInfo(2) & uVerData(2).sVersion
        'EG20 V30.1.0.1 DEL END
        'EG20 V30.1.0.1 ADD START
        If Len(Trim(uVerData(2).sSyubetsu)) <> 0 Then
            sFileInfo(2) = " " & StrConv(MidB(StrConv(uVerData(2).sSyubetsu & Space(6), vbFromUnicode), 1, 4), vbUnicode)
        Else
            sFileInfo(2) = " " & Left(String(3, "-") & Space(6), 4)
        End If
        If Len(Trim(uVerData(2).sDataVersion)) <> 0 Then
            sFileInfo(2) = sFileInfo(2) & StrConv(MidB(StrConv(uVerData(2).sDataVersion & Space(20), vbFromUnicode), 1, 21), vbUnicode)
        Else
            sFileInfo(2) = sFileInfo(2) & Left(String(20, "-") & Space(20), 21)
        End If
        If Len(Trim(uVerData(2).sFileDate)) <> 0 Then
            sFileInfo(2) = sFileInfo(2) & StrConv(MidB(StrConv(uVerData(2).sFileDate, vbFromUnicode), 1, 16), vbUnicode)
        Else
            sFileInfo(2) = sFileInfo(2) & Left(String(16, "-") & Space(20), 16)
        End If
        'EG20 V30.1.0.1 ADD END
        sComment1(2) = " " & StrConv(MidB(StrConv(uVerData(2).sComment, vbFromUnicode), 1, 32), vbUnicode)
        sComment2(2) = " " & StrConv(MidB(StrConv(uVerData(2).sComment, vbFromUnicode), 33, 32), vbUnicode)
        If Len(Trim(sComment1(2))) <> 0 Then
            'ÇªÇÃÇ‹Ç‹
        Else
            sComment1(2) = " " & String(32, "-")
        End If
    End If


    If chkFolder(0).Value = CHECKBOX_ON Then               '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_ï\é¶
        If uVerData(0).sFileName <> "" Then         '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
            If chkFolder(1).Value = CHECKBOX_ON Then       '¢é¿çs£ÉtÉHÉãÉ_ï\é¶
                If uVerData(1).sFileName <> "" Then '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç∆¢é¿çs£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                    If sFileInfo(0) = sFileInfo(1) Then
                        If chkFolder(2).Value = CHECKBOX_ON Then   '¢ãå£ÉtÉHÉãÉ_ï\é¶
                            If uVerData(2).sFileName <> "" Then
                                '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                                If sFileInfo(1) = sFileInfo(2) Then
'                                    lstKan(0).AddItem sFileName & "W N O" & sFileInfo(0)
                                    lstKan(iTab_index).AddItem sFileName & "W N O" & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment1(0)
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                    End If
                                    'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(0) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment2(0)
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                    End If
                                Else
'                                    lstKan(0).AddItem sFileName & "W N  " & sFileInfo(0)
                                    lstKan(iTab_index).AddItem sFileName & "W N  " & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment1(0)
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                    End If
                                    'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(0) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment2(0)
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                    End If
'                                    lstKan(0).AddItem Space(17) & "    O" & sFileInfo(2)
                                    lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                                    If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment1(2)
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                                    End If
                                    'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(2) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment2(2)
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                                    End If
                                End If
                            Else                            '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                                lstKan(0).AddItem sFileName & "W N  " & sFileInfo(1)
                                lstKan(iTab_index).AddItem sFileName & "W N  " & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                End If
                                'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(1) <> "" Then
'                                     lstKan(0).AddItem Space(22) & sComment2(1)
                                     lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                End If
'                                lstKan(0).AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                                'lstKan(iTab_index).AddItem Space(17) & "    O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                                'EG20 V30.1.0.1 ADD START
'                                lstKan(iTab_index).AddItem sFileName & "    O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                                'EG20 V30.1.0.1 ADD END
                            End If
                        Else                                '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                            lstKan(0).AddItem sFileName & "W N  " & sFileInfo(0)
                            lstKan(iTab_index).AddItem sFileName & "W N  " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                            End If
                            'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                            End If
                        End If
                    Else                            '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç∆¢é¿çs£ÉtÉHÉãÉ_ÇÃÉoÅ[ÉWÉáÉìÇ™à·Ç§
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥ÅzçÌèúäJén
''                        lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
'                        lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
'                        If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
''                            lstKan(0).AddItem Space(22) & sComment1(0)
'                            lstKan(iTab_index).AddItem Space(22) & sComment1(0)
'                        End If
'                        If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
''                            lstKan(0).AddItem Space(22) & sComment2(0)
'                            lstKan(iTab_index).AddItem Space(22) & sComment2(0)
'                        End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥ÅzçÌèúèIóπ
                        If chkFolder(2).Value = CHECKBOX_ON Then   '¢ãå£ÉtÉHÉãÉ_ï\é¶
                            If uVerData(2).sFileName <> "" Then
                                '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                                If sFileInfo(1) = sFileInfo(2) Then
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡äJén
                                    lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                    End If
                                    'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(0) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                    End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡èIóπ
'                                    lstKan(0).AddItem Space(17) & "  N O" & sFileInfo(1)
                                    lstKan(iTab_index).AddItem sFileName & "  N O" & sFileInfo(1)
                                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment1(1)
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                    End If
                                    'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(1) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment2(1)
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                    End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡äJén
                                ElseIf sFileInfo(0) = sFileInfo(2) Then
                                    ' ÅuÉèÅ[ÉNÅvÅÅÅuãåÅvÇÃèÍçá
                                    lstKan(iTab_index).AddItem sFileName & "W   O" & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                    End If
                                    'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(0) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                    End If
                                    lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                    End If
                                    'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(1) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                    End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡èIóπ
                                Else
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡äJén
                                    ' ÅuÉèÅ[ÉNÅvÅÇ Åué¿çsÅv ÅÇÅuãåÅvÇÃèÍçá
                                    lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                    End If
                                    'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(0) <> "" Then
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                    End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡èIóπ
'                                    lstKan(0).AddItem Space(17) & "  N  " & sFileInfo(1)
                                    lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment1(1)
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                    End If
                                    'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(1) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment2(1)
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                    End If
'                                    lstKan(0).AddItem Space(17) & "    O" & sFileInfo(2)
                                    lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                                    If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment1(2)
                                        lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                                    End If
                                    'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                    If sComment2(2) <> "" Then
'                                        lstKan(0).AddItem Space(22) & sComment2(2)
                                        lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                                    End If
                                End If
                            Else                            '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡äJén
                                ' ÅuÉèÅ[ÉNÅvÅÇ Åué¿çsÅv ÅÇÅuãåÅvÇÃèÍçá
                                lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                                If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                End If
                                'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(0) <> "" Then
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡èIóπ
'                                lstKan(0).AddItem Space(17) & "  N  " & sFileInfo(1)
                                lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                End If
                                'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                End If
'                                lstKan(0).AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                                'lstKan(iTab_index).AddItem Space(17) & "    O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                                'EG20 V30.1.0.1 ADD START
'                                lstKan(iTab_index).AddItem sFileName & "    O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                                'EG20 V30.1.0.1 ADD END
                            End If
                        Else
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡äJén
                            ' ÅuÉèÅ[ÉNÅvÅÇ Åué¿çsÅv ÅÇÅuãåÅvÇÃèÍçá
                            lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                            End If
                            'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(0) <> "" Then
                                lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                            End If
' EG20 V6.4.0.1Åyëçì_åüèCê≥ëŒâûÅFÉèÅ[ÉNÅÇé¿çsÅAÉèÅ[ÉNÅÅãåÇÃèÍçáÇÃï\é¶ïsê≥Åzí«â¡èIóπ
'                            lstKan(0).AddItem Space(17) & "  N  " & sFileInfo(1)
                            lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                            End If
                            'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                            End If
                        End If
                    End If
                Else                                    '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                    If chkFolder(2).Value = CHECKBOX_ON Then   '¢ãå£ÉtÉHÉãÉ_ï\é¶
                        If uVerData(2).sFileName <> "" Then
                            If sFileInfo(0) = sFileInfo(2) Then
'                                lstKan(0).AddItem sFileName & "W   O" & sFileInfo(0)
                                lstKan(iTab_index).AddItem sFileName & "W   O" & sFileInfo(0)
                                If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(0)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                End If
                                'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(0) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(0)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                End If
'                                lstKan(0).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                                'lstKan(iTab_index).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                                'EG20 V30.1.0.1 ADD START
'                                lstKan(iTab_index).AddItem sFileName & "  N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                                'EG20 V30.1.0.1 ADD END
                            Else
'                                lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
                                lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                                If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(0)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                                End If
                                'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(0) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(0)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                                End If
'                                lstKan(0).AddItem Space(17) & "    O" & sFileInfo(2)
                                lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                                If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(2)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                                End If
                                'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(2) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(2)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                                End If
'                                lstKan(0).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                                'lstKan(iTab_index).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                                'EG20 V30.1.0.1 ADD START
'                                lstKan(iTab_index).AddItem sFileName & "  N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                                'EG20 V30.1.0.1 ADD END
                            End If
                        Else                            '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                            lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
                            lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                            End If
                            'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                            End If
'                            lstKan(0).AddItem Space(17) & "  N O" & " -------- --------  -------- ----"
                            'lstKan(iTab_index).AddItem Space(17) & "  N O" & " -------- --------  -------- ----"    'EG20 DEL
                            'EG20 V30.1.0.1 ADD START
'                            lstKan(iTab_index).AddItem sFileName & "  N O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                            lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                            'EG20 V30.1.0.1 ADD END
                        End If
                    Else                                '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                        lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
                        lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                        If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment1(0)
                            lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                        End If
                        'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                        'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                        If sComment2(0) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment2(0)
                            lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                        End If
'                        lstKan(0).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"    'EG20 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "  N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    End If
                End If
            Else                                        '¢é¿çs£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then
                        If sFileInfo(0) = sFileInfo(2) Then
'                            lstKan(0).AddItem sFileName & "W   O" & sFileInfo(0)
                            lstKan(iTab_index).AddItem sFileName & "W   O" & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                            End If
                            'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                            End If
                        Else
'                            lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
                            lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                            End If
                            'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(0) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(0)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                            End If
'                            lstKan(0).AddItem Space(17) & "    O" & sFileInfo(2)
                            lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                            If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(2)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                            End If
                            'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(2) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(2)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                            End If
                        End If
                    Else                                    '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                        lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
                        lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                        If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment1(0)
                            lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                        End If
                        'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                        'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                        If sComment2(0) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment2(0)
                            lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                        End If
'                        lstKan(0).AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem Space(17) & "    O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                       'EG20 V30.1.0.1 ADD START
'                       lstKan(iTab_index).AddItem sFileName & "    O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                       lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                       'EG20 V30.1.0.1 ADD END
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                    lstKan(0).AddItem sFileName & "W    " & sFileInfo(0)
                    lstKan(iTab_index).AddItem sFileName & "W    " & sFileInfo(0)
                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
'                        lstKan(0).AddItem Space(22) & sComment1(0)
                        lstKan(iTab_index).AddItem Space(22) & sComment1(0)
                    End If
                    'If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                    If sComment2(0) <> "" Then
'                        lstKan(0).AddItem Space(22) & sComment2(0)
                        lstKan(iTab_index).AddItem Space(22) & sComment2(0)
                    End If
                End If
            End If
        Else                                '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
            If chkFolder(1).Value = CHECKBOX_ON Then               '¢é¿çs£ÉtÉHÉãÉ_ï\é¶
                If uVerData(1).sFileName <> "" Then         '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                    If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                        If uVerData(2).sFileName <> "" Then '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                            '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                            If sFileInfo(1) = sFileInfo(2) Then
'                                lstKan(0).AddItem sFileName & "  N O" & sFileInfo(1)
                                lstKan(iTab_index).AddItem sFileName & "  N O" & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                End If
                                'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                End If
'                                lstKan(0).AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                                'lstKan(iTab_index).AddItem Space(17) & "W    " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                                'EG20 V30.1.0.1 ADD START
'                                lstKan(iTab_index).AddItem sFileName & "W    " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                                'EG20 V30.1.0.1 ADD END
                            Else                            '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_ÇÃÉoÅ[ÉWÉáÉìÇ™à·Ç§
'                                lstKan(0).AddItem sFileName & "  N  " & sFileInfo(1)
                                lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                                End If
                                'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(1) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(1)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                                End If
'                                lstKan(0).AddItem Space(17) & "    O" & sFileInfo(2)
                                lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                                If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment1(2)
                                    lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                                End If
                                'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                                If sComment2(2) <> "" Then
'                                    lstKan(0).AddItem Space(22) & sComment2(2)
                                    lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                                End If
'                                lstKan(0).AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                                'lstKan(iTab_index).AddItem Space(17) & "W    " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                                'EG20 V30.1.0.1 ADD START
'                                lstKan(iTab_index).AddItem sFileName & "W    " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                                'EG20 V30.1.0.1 ADD END
                            End If
                        Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ»Ç¢
'                            lstKan(0).AddItem sFileName & "  N  " & sFileInfo(1)
                            lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                            End If
                            'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                            End If
'                            lstKan(0).AddItem Space(17) & "W   O" & " -------- --------  -------- ----"
                            'lstKan(iTab_index).AddItem Space(17) & "W   O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                            'EG20 V30.1.0.1 ADD START
'                            lstKan(iTab_index).AddItem sFileName & "W   O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                            lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                            'EG20 V30.1.0.1 ADD END
                        End If
                    Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                        lstKan(0).AddItem sFileName & "  N  " & sFileInfo(1)
                        lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                        If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment1(1)
                            lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                        End If
                        'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                        'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                        If sComment2(1) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment2(1)
                            lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                        End If
'                        lstKan(0).AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem Space(17) & "W    " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "W    " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    End If
                Else                                        '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                    If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                        If uVerData(2).sFileName <> "" Then
'                            lstKan(0).AddItem sFileName & "    O" & sFileInfo(2)
                            lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                            If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(2)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                            End If
                            'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(2) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(2)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                            End If
'                            lstKan(0).AddItem Space(17) & "W N  " & " -------- --------  -------- ----"
                            'lstKan(iTab_index).AddItem Space(17) & "W N  " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                            'EG20 V30.1.0.1 ADD START
'                            lstKan(iTab_index).AddItem sFileName & "W N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                            lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                            'EG20 V30.1.0.1 ADD END
                        Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                            lstKan(0).AddItem sFileName & "W N O" & " -------- --------  -------- ----"
                            'lstKan(iTab_index).AddItem sFileName & "W N O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                            'EG20 V30.1.0.1 ADD START
'                            lstKan(iTab_index).AddItem sFileName & "W N O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                            lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                            'EG20 V30.1.0.1 ADD END
                        End If
                    Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                        lstKan(0).AddItem sFileName & "W N  " & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem sFileName & "W N  " & " -------- --------  -------- ----"    'EG20 V30.1.0.1DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "W N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    End If
                End If
            Else                                        '¢é¿çs£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then
'                        lstKan(0).AddItem sFileName & "    O" & sFileInfo(2)
                        lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                        If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment1(2)
                            lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                        End If
                        'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                        'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                        If sComment2(2) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment2(2)
                            lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                        End If
'                        lstKan(0).AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem Space(17) & "W    " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "W    " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                        lstKan(0).AddItem sFileName & "W   O" & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem sFileName & "W   O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "W   O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                    lstKan(0).AddItem sFileName & "W    " & " -------- --------  -------- ----"
                    'lstKan(iTab_index).AddItem sFileName & "W    " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                    'EG20 V30.1.0.1 ADD START
'                    lstKan(iTab_index).AddItem sFileName & "W    " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                    lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                    'EG20 V30.1.0.1 ADD END
                End If
            End If
        End If
    Else                                                '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
        If chkFolder(1).Value = CHECKBOX_ON Then               '¢é¿çs£ÉtÉHÉãÉ_ï\é¶
            If uVerData(1).sFileName <> "" Then         '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                        '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                        If sFileInfo(1) = sFileInfo(2) Then
'                            lstKan(0).AddItem sFileName & "  N O" & sFileInfo(1)
                            lstKan(iTab_index).AddItem sFileName & "  N O" & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                            End If
                            'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                            End If
                        Else
'                            lstKan(0).AddItem sFileName & "  N  " & sFileInfo(1)
                            lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                            End If
                            'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(1) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(1)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                            End If
'                            lstKan(0).AddItem Space(17) & "    O" & sFileInfo(2)
                            lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                            If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment1(2)
                                lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                            End If
                            'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                            'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                            If sComment2(2) <> "" Then
'                                lstKan(0).AddItem Space(22) & sComment2(2)
                                lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                            End If
                        End If
                    Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ»Ç¢
'                        lstKan(0).AddItem sFileName & "  N  " & sFileInfo(1)
                        lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                        If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment1(1)
                            lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                        End If
                        'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                        'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                        If sComment2(1) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment2(1)
                            lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                        End If
'                        lstKan(0).AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem Space(17) & "    O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "    O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                    lstKan(0).AddItem sFileName & "  N  " & sFileInfo(1)
                    lstKan(iTab_index).AddItem sFileName & "  N  " & sFileInfo(1)
                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
'                        lstKan(0).AddItem Space(22) & sComment1(1)
                        lstKan(iTab_index).AddItem Space(22) & sComment1(1)
                    End If
                    'If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                    'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                    If sComment2(1) <> "" Then
'                        lstKan(0).AddItem Space(22) & sComment2(1)
                        lstKan(iTab_index).AddItem Space(22) & sComment2(1)
                    End If
                End If
            Else                                        '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then
'                        lstKan(0).AddItem sFileName & "    O" & sFileInfo(2)
                        lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                        If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment1(2)
                            lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                        End If
                        'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                        'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                        If sComment2(2) <> "" Then
'                            lstKan(0).AddItem Space(22) & sComment2(2)
                            lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                        End If
'                        lstKan(0).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem Space(17) & "  N  " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "  N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                        lstKan(0).AddItem sFileName & "  N O" & " -------- --------  -------- ----"
                        'lstKan(iTab_index).AddItem sFileName & "  N O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                        'EG20 V30.1.0.1 ADD START
'                        lstKan(iTab_index).AddItem sFileName & "  N O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                        lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                        'EG20 V30.1.0.1 ADD END
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
'                    lstKan(0).AddItem sFileName & "  N  " & " -------- --------  -------- ----"
                    'lstKan(iTab_index).AddItem sFileName & "  N  " & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                    'EG20 V30.1.0.1 ADD START
'                    lstKan(iTab_index).AddItem sFileName & "  N  " & " ---  ----" & Space(16) & "----/--/-- --:--"
'                    lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                    'EG20 V30.1.0.1 ADD END
                End If
            End If
        Else                                    '¢é¿çs£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
            If uVerData(2).sFileName <> "" Then '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
'                lstKan(0).AddItem sFileName & "    O" & sFileInfo(2)
                lstKan(iTab_index).AddItem sFileName & "    O" & sFileInfo(2)
                If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
'                    lstKan(0).AddItem Space(22) & sComment1(2)
                    lstKan(iTab_index).AddItem Space(22) & sComment1(2)
                End If
                'If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                'IsNullÇÕNullÇîªífÇ∑ÇÈÇ™NullÇ∆Ç¢Ç§ílÇ™ì¸ÇÈÇ±Ç∆ÇÕÇ»Ç¢ÅBNot IsNullÇorÇ∑ÇÈÇ∆<>""Ç∆îªíËÇ™Ç≈Ç´Ç»Ç≠Ç»ÇÈÅB
                If sComment2(2) <> "" Then
'                    lstKan(0).AddItem Space(22) & sComment2(2)
                    lstKan(iTab_index).AddItem Space(22) & sComment2(2)
                End If
            Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
'                lstKan(0).AddItem sFileName & "    O" & " -------- --------  -------- ----"
                'lstKan(iTab_index).AddItem sFileName & "    O" & " -------- --------  -------- ----"    'EG20 V30.1.0.1 DEL
                'EG20 V30.1.0.1 ADD START
'                lstKan(iTab_index).AddItem sFileName & "    O" & " ---  ----" & Space(16) & "----/--/-- --:--"
'                lstKan(iTab_index).AddItem Space(17) & Space(5) & " ----"
                'EG20 V30.1.0.1 ADD END
            End If
        End If
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMópÉ^ÉCÉ}ÅAÉ^ÉCÉÄÉAÉbÉvéûèàóù
'//  ã@î\äTóv  : ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()
   On Error Resume Next
    
    'îƒópÉÅÅ[ÉãéÛêMèàóùÇçsÇ§
    If pfComMailRecieve = ML_ID_HOSHU_ACTIVE_REQ Then
        AppActivate frmKansenGateVerKanri.Caption, False
        pfFormActive (frmKansenGateVerKanri.hwnd)
    End If
End Sub

'EG20 V30.1.0.1 DEL START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sSetFolderName
'//  ã@î\ñºèÃ  : ÉfÅ[É^ìWäJ
'//  ã@î\äTóv  : ÉtÉHÉãÉ_ñºÇ»Ç«ÇÃÉfÅ[É^ÇÉOÉçÅ[ÉoÉãÉGÉäÉAÇ…ìWäJÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//                ÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃê≥ìñê´É`ÉFÉbÉNINIì«çûÇ›
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V6.9.0.1) 2012-12-03  CODED BY  [TCC] H.Sugimoto
'//                 ó éYëŒâûÅyéÌï É`ÉFÉbÉNã@î\í«â¡Åz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Sub sSetFolderName()
'
'        TitleBox(0) = "îªíËÉfÅ[É^"
'        TitleBox(1) = "ÉvÉçÉOÉâÉÄ"
'        TitleBox(2) = "ªÃﬁCPU-Pro1"
'        TitleBox(3) = "ªÃﬁCPU-Pro2"
'        TitleBox(4) = "ªÃﬁCPU-Pro3"
'        TitleBox(5) = "é©â¸ÅiÇnÇrÅj"
'        TitleBox(6) = "ó\îıÇP"
'        TitleBox(7) = "ó\îıÇQ"
'        TitleBox(8) = "ó\îıÇR"
'
'        LogBox(0) = "îªíË"
'        LogBox(1) = "ÉvÉçÉOÉÅÉCÉì"
'        LogBox(2) = "ÉTÉu1"
'        LogBox(3) = "ÉTÉu2"
'        LogBox(4) = "ÉTÉu3"
'        LogBox(5) = "OS"
'        LogBox(5) = "ó\îı1"
'        LogBox(5) = "ó\îı2"
'        LogBox(5) = "ó\îı3"
'
'        'ÉtÉHÉãÉ_ñºÇ…ê›íËÇçsÇ§
'        FolderName(0, 0) = EG20_NHAN1WRK
'        FolderName(1, 0) = EG20_NHAN1NOW
'        FolderName(2, 0) = EG20_NHAN1OLD
'        FolderName(0, 1) = EG20_NPRO1WRK
'        FolderName(1, 1) = EG20_NPRO1NOW
'        FolderName(2, 1) = EG20_NPRO1OLD
'        FolderName(0, 2) = EG20_NSCP1WRK
'        FolderName(1, 2) = EG20_NSCP1NOW
'        FolderName(2, 2) = EG20_NSCP1OLD
'        FolderName(0, 3) = EG20_NSCP2WRK
'        FolderName(1, 3) = EG20_NSCP2NOW
'        FolderName(2, 3) = EG20_NSCP2OLD
'        FolderName(0, 4) = EG20_NSCP3WRK
'        FolderName(1, 4) = EG20_NSCP3NOW
'        FolderName(2, 4) = EG20_NSCP3OLD
'        FolderName(0, 5) = EG20_NOSWRK
'        FolderName(1, 5) = EG20_NOSNOW
'        FolderName(2, 5) = EG20_NOSOLD
'        FolderName(0, 6) = EG20_NYOBI1WRK
'        FolderName(1, 6) = EG20_NYOBI1NOW
'        FolderName(2, 6) = EG20_NYOBI1OLD
'        FolderName(0, 7) = EG20_NYOBI2WRK
'        FolderName(1, 7) = EG20_NYOBI2NOW
'        FolderName(2, 7) = EG20_NYOBI2OLD
'' EG20 V5.11.0.1í«â¡äJén
'        FolderName(0, 8) = EG20_NYOBI3WRK
'        FolderName(1, 8) = EG20_NYOBI3NOW
'        FolderName(2, 8) = EG20_NYOBI3OLD
'' EG20 V5.11.0.1í«â¡èIóπ
'' EG20 V5.11.0.1çÌèúäJén
''        FolderName(0, 8) = EG20_NYOBI2WRK
''        FolderName(1, 8) = EG20_NYOBI2NOW
''        FolderName(2, 8) = EG20_NYOBI2OLD
'' EG20 V5.11.0.1çÌèúèIóπ
'
'' EG20 V3.0.0.2í«â¡äJén
'        DispTitleBox(0) = "îªíËÉfÅ[É^  ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(1) = "ÉvÉçÉOÉâÉÄ  ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(2) = "ªÃﬁCPU-Pro1 ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(3) = "ªÃﬁCPU-Pro2 ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(4) = "ªÃﬁCPU-Pro3 ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(5) = "é©â¸ÅiÇnÇrÅjÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(6) = "ó\îıÇP      ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(7) = "ó\îıÇQ      ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'        DispTitleBox(8) = "ó\îıÇR      ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
'' EG20 V3.0.0.2í«â¡èIóπ
'
'
''V1.20.0.1 ADD START
''-------EG-Ré©â¸-------
'    ' ÉLÅ[ñº:îªíËCPU-PROë„ï\
'    EHANTEI_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_HANTEI_PRO, PATH_GATEVER_FILE)
'
'    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-PROë„ï\
'    EMAIN_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_MAIN_PRO, PATH_GATEVER_FILE)
'
'    ' ÉLÅ[ñºÅFÉTÉuCPU-PROë„ï\
'    ESUB_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_SUB_PRO, PATH_GATEVER_FILE)
'
'    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-OSë„ï\
'    EMAIN_OS_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_MAIN_OS, PATH_GATEVER_FILE)
'
'''-------NEGé©â¸-------
''    ' ÉLÅ[ñº:îªíËCPU-PROë„ï\
''    NHANTEI_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_HANTEI_PRO, PATH_GATEVER_FILE)
''
''    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-PROë„ï\
''    NMAIN_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_MAIN_PRO, PATH_GATEVER_FILE)
''
''    ' ÉLÅ[ñºÅFÉTÉuCPU-PROë„ï\
''    NSUB_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_SUB_PRO, PATH_GATEVER_FILE)
''
''    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-OSë„ï\
''    NMAIN_OS_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_MAIN_OS, PATH_GATEVER_FILE)
'''V1.20.0.1 ADD END
'
'' EG20 V5.11.0.1Åyâ^â¸ï\é¶â¸ëPëŒâûÅzí«â¡äJén
'    gintUnkaiKind(0) = BootInfoGateType.TYPE_NHAN
'    gintUnkaiKind(1) = BootInfoGateType.TYPE_NPRO
'    gintUnkaiKind(2) = BootInfoGateType.TYPE_NSCP1
'    gintUnkaiKind(3) = BootInfoGateType.TYPE_NSCP2
'    gintUnkaiKind(4) = BootInfoGateType.TYPE_NSCP3
'    gintUnkaiKind(5) = BootInfoGateType.TYPE_NOS
'    gintUnkaiKind(6) = BootInfoGateType.TYPE_NYOBI1
'    gintUnkaiKind(7) = BootInfoGateType.TYPE_NYOBI2
'    gintUnkaiKind(8) = BootInfoGateType.TYPE_NYOBI3
'' EG20 V5.11.0.1Åyâ^â¸ï\é¶â¸ëPëŒâûÅzí«â¡èIóπ
'
'' EG20 V6.9.0.1Åyó éYëŒâûÅFéÌï É`ÉFÉbÉNã@î\í«â¡ÅzADD START
'    gintProgramJudgeKind(0) = ProgramJudgeKind.JUDGE_NHAN       ' îªíËÉfÅ[É^
'    gintProgramJudgeKind(1) = ProgramJudgeKind.JUDGE_NPRO       ' ÉvÉçÉOÉâÉÄ
'    gintProgramJudgeKind(2) = ProgramJudgeKind.JUDGE_NSCP1      ' ÉTÉuCPU-Pro1
'    gintProgramJudgeKind(3) = ProgramJudgeKind.JUDGE_NSCP2      ' ÉTÉuCPU-Pro2
'    gintProgramJudgeKind(4) = ProgramJudgeKind.JUDGE_NSCP3      ' ÉTÉuCPU-Pro3
'    gintProgramJudgeKind(5) = ProgramJudgeKind.JUDGE_NOS        ' é©â¸ÅiOSÅj
'    gintProgramJudgeKind(6) = ProgramJudgeKind.JUDGE_NOCHECK    ' ó\îı1
'    gintProgramJudgeKind(7) = ProgramJudgeKind.JUDGE_NOCHECK    ' ó\îı2
'    gintProgramJudgeKind(8) = ProgramJudgeKind.JUDGE_NOCHECK    ' ó\îı3
'' EG20 V6.9.0.1Åyó éYëŒâûÅFéÌï É`ÉFÉbÉNã@î\í«â¡ÅzADD END

'End Sub
'EG20 V30.1.0.1 DEL END
'EG20 V30.1.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2014 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sSetFolderName
'//  ã@î\ñºèÃ  : ÉfÅ[É^ìWäJ
'//  ã@î\äTóv  : ÉtÉHÉãÉ_ñºÇ»Ç«ÇÃÉfÅ[É^ÇÉOÉçÅ[ÉoÉãÉGÉäÉAÇ…ìWäJÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V30.1.0.1) 2014-02-18  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sSetFolderName()

        TitleBox(0) = "îªíËÇbÇoÇt"
        TitleBox(1) = "ÉÅÉCÉìÇbÇoÇt"
        TitleBox(2) = "ÉTÉuÇbÇoÇt"
        TitleBox(3) = "ÇnÇr"
        TitleBox(4) = "ó\îıÇP"
        TitleBox(5) = "ó\îıÇQ"
    
        LogBox(0) = "îªíË"
        LogBox(1) = "ÉvÉçÉOÉÅÉCÉì"
        LogBox(2) = "ÉTÉu"
        LogBox(3) = "ÇnÇr"
        LogBox(4) = "ó\îıÇP"
        LogBox(5) = "ó\îıÇQ"
        
        'ÉtÉHÉãÉ_ñºÇ…ê›íËÇçsÇ§
        FolderName(0, 0) = EG30_JHANWRK
        FolderName(1, 0) = EG30_JHANNOW
        FolderName(2, 0) = EG30_JHANOLD
        FolderName(0, 1) = EG30_JPROWRK
        FolderName(1, 1) = EG30_JPRONOW
        FolderName(2, 1) = EG30_JPROOLD
        FolderName(0, 2) = EG30_JSCPUWRK
        FolderName(1, 2) = EG30_JSCPUNOW
        FolderName(2, 2) = EG30_JSCPUOLD
        FolderName(0, 3) = EG30_JOSWRK
        FolderName(1, 3) = EG30_JOSNOW
        FolderName(2, 3) = EG30_JOSOLD
        FolderName(0, 4) = EG30_JYOBIWK1
        FolderName(1, 4) = EG30_JYOBINW1
        FolderName(2, 4) = EG30_JYOBIOD1
        FolderName(0, 5) = EG30_JYOBIWRK
        FolderName(1, 5) = EG30_JYOBINOW
        FolderName(2, 5) = EG30_JYOBIOLD

        DispTitleBox(0) = "îªíËÇbÇoÇt  ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
        DispTitleBox(1) = "ÉÅÉCÉìÇbÇoÇt  ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
        DispTitleBox(2) = "ÉTÉuÇbÇoÇt ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
        DispTitleBox(3) = "ÇnÇr ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
        DispTitleBox(4) = "ó\îıÇP ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"
        DispTitleBox(5) = "ó\îıÇQ ÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF"

'-------êVä≤ê¸é©â¸-------
    ' ÉLÅ[ñº:îªíËCPU-PROë„ï\
    EG30_HANTEI_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_EG30, GATE_HANTEI_PRO, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-PROë„ï\
    EG30_MAIN_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_EG30, GATE_MAIN_PRO, PATH_GATEVER_FILE)
        
    ' ÉLÅ[ñºÅFÉTÉuCPU-PROë„ï\
    EG30_SUB_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_EG30, GATE_SUB_PRO1, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-OSë„ï\
    EG30_MAIN_OS_CHK_FILE = sSetChkFile(GATE_TYPE_EG30, GATE_MAIN_OS, PATH_GATEVER_FILE)

    gintUnkaiKind(0) = BootInfoGateType.TYPE_JHAN
    gintUnkaiKind(1) = BootInfoGateType.TYPE_JPRO
    gintUnkaiKind(2) = BootInfoGateType.TYPE_JSCPU
    gintUnkaiKind(3) = BootInfoGateType.TYPE_JOS

    gintProgramJudgeKind(0) = ProgramJudgeKind.JUDGE_JHAN       'a:îªíËCPUópÉvÉçÉOÉâÉÄÅiä≤ê¸Åj
    gintProgramJudgeKind(1) = ProgramJudgeKind.JUDGE_JPRO       'b:ÉÅÉCÉìCPUópÉvÉçÉOÉâÉÄÅiä≤ê¸Åj
    gintProgramJudgeKind(2) = ProgramJudgeKind.JUDGE_JSCPU     'c:ÉTÉuCPUÉvÉçÉOÉâÉÄÅiä≤ê¸Åj
    gintProgramJudgeKind(3) = ProgramJudgeKind.JUDGE_JOS        ' d:OSÉvÉçÉOÉâÉÄÅiä≤ê¸Åj
    gintProgramJudgeKind(4) = ProgramJudgeKind.JUDGE_YOBI1      'e:ó\îıÇPÅiä≤ê¸Åj É`ÉFÉbÉNñ≥Çµ
    gintProgramJudgeKind(5) = ProgramJudgeKind.JUDGE_YOBI       'f:ó\îıÅiä≤ê¸Åj É`ÉFÉbÉNñ≥Çµ
    gintProgramJudgeKind(6) = ProgramJudgeKind.JUDGE_NOCHECK
    gintProgramJudgeKind(7) = ProgramJudgeKind.JUDGE_NOCHECK
    gintProgramJudgeKind(8) = ProgramJudgeKind.JUDGE_NOCHECK

End Sub
'EG20 V30.1.0.1 ADD END
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fMakeListbox
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXçÏê¨
'//  ã@î\äTóv  : äeÉtÉHÉãÉ_Ç©ÇÁÉoÅ[ÉWÉáÉìéÊìæÇçsÇ¢ÅAÉäÉXÉgÉ{ÉbÉNÉXçÏê¨
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fMakeListbox() As Boolean
    
    Dim bRet As Boolean                        'ñﬂÇËíl
    
    Dim sCorner As String                      'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                    'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String                    'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    Dim i As Integer                           'ÉãÅ[ÉvÉJÉEÉìÉ^
    Dim sWorkVer As String                      ' ÉèÅ[ÉNÉoÅ[ÉWÉáÉì
    Dim sNowVer As String                       ' åªçsÉoÅ[ÉWÉáÉì
    Dim sOldVer As String                       ' ãåÉoÅ[ÉWÉáÉì

    On Error Resume Next

    sWorkVer = TITLEDISP_VERNOTHING
    sNowVer = TITLEDISP_VERNOTHING
    sOldVer = TITLEDISP_VERNOTHING
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab

    sCorner = Format(iTab_index + 1, "00")

    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    '***********************************************
    '* éüê¢ë„é©â¸ÉtÉHÉãÉ_Ç©ÇÁëSÇƒÇÃÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ *
    '***********************************************

    ReDim uVersion(0)

    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    sFilePath = sGatePath & FolderName(0, FolderSyubetu)
    bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
    If bRet = True Then
        'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
        sWorkVer = sVersionInfo(sFilePath, MN_FLDWRK)
    End If

    '¢é¿çs£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    sFilePath = sGatePath & FolderName(1, FolderSyubetu)
    bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
    If bRet = True Then
        'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
        sNowVer = sVersionInfo(sFilePath, MN_FLDNOW)
    End If

    '¢ãå£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    sFilePath = sGatePath & FolderName(2, FolderSyubetu)
    bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
    If bRet = True Then
        'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
        sOldVer = sVersionInfo(sFilePath, MN_FLDOLD)
    End If

    'ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºèáÇ…É\Å[ÉgÇ∑ÇÈ
    sListboxSort

    'ÉoÅ[ÉWÉáÉìèÓïÒÇÉäÉXÉgÉ{ÉbÉNÉXÇ…ÉZÉbÉgÇ∑ÇÈ
    Call sVerListDisp(sWorkVer, sNowVer, sOldVer)

End Function

' EG20 V3.0.0.2 çÌèúäJén
'Private Function fMakeListbox() As Boolean
'
'    Dim bRet As Boolean                        'ñﬂÇËíl
'
'    Dim sCorner As String                      'ÉRÅ[ÉiÅ[î‘çÜ
'    Dim sGatePath As String                    'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
'    Dim sFilePath As String                    'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
'    Dim i As Integer                           'ÉãÅ[ÉvÉJÉEÉìÉ^
'
'    On Error Resume Next
'
''    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
''    iTab_index = SSTab1.Tab
''
''    sCorner = Format(iTab_index + 1, "00")
''
''    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
''    sGatePath = PATH_N_GATE & sCorner
'
'    '***********************************************
'    '* éüê¢ë„é©â¸ÉtÉHÉãÉ_Ç©ÇÁëSÇƒÇÃÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ *
'    '***********************************************
'    For i = 0 To 5
'
'        iTab_index = i
'
'        sCorner = Format(iTab_index + 1, "00")
'
'        ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
'        sGatePath = PATH_N_GATE & sCorner
'
'        ReDim uVersion(0)
'
'        '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
'        sFilePath = sGatePath & FolderName(0, FolderSyubetu)
'
''       bRet = fReadFileList(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)
'        bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
'        If bRet = True Then
'            'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
''            sVersionInfo FolderName(0, FolderSyubetu), MN_FLDWRK
'            sVersionInfo sFilePath, MN_FLDWRK
'        End If
'
'        '¢é¿çs£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
'        sFilePath = sGatePath & FolderName(1, FolderSyubetu)
'
''       bRet = fReadFileList(FolderName(1, FolderSyubetu) & "\" & MN_FILELIST)
'        bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
'        If bRet = True Then
'            'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
''           sVersionInfo FolderName(1, FolderSyubetu), MN_FLDNOW
'            sVersionInfo sFilePath, MN_FLDNOW
'        End If
'
'        '¢ãå£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
'        sFilePath = sGatePath & FolderName(2, FolderSyubetu)
'
''       bRet = fReadFileList(FolderName(2, FolderSyubetu) & "\" & MN_FILELIST)
'        bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
'        If bRet = True Then
'            'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
''           sVersionInfo FolderName(2, FolderSyubetu), MN_FLDOLD
'            sVersionInfo sFilePath, MN_FLDOLD
'        End If
'
'        'ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºèáÇ…É\Å[ÉgÇ∑ÇÈ
'        sListboxSort
'
'        'ÉoÅ[ÉWÉáÉìèÓïÒÇÉäÉXÉgÉ{ÉbÉNÉXÇ…ÉZÉbÉgÇ∑ÇÈ
'        sVerListDisp
'
'    Next i
'End Function
' EG20 V3.0.0.2 çÌèúèIóπ
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sVerListDisp
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXê›íË
'//  ã@î\äTóv  : éÊìæÇµÇΩÉoÅ[ÉWÉáÉìèÓïÒÇÅAÉäÉXÉgÉ{ÉbÉNÉXÇ…ê›íË
'//
'//              å^        ñºèÃ             à”ñ°
'//  à¯êî      : String    szWorkVersion    ÉèÅ[ÉNÉoÅ[ÉWÉáÉì
'//  à¯êî      : String    szNowVersion     é¿çsÉoÅ[ÉWÉáÉì
'//  à¯êî      : String    szOldVersion     ãåÉoÅ[ÉWÉáÉì
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'/  REVISIONS    : (EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'/                  EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-18 REVISED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Sub sVerListDisp()                 ' EG20 V3.0.0.2çÌèú
' EG20 V3.0.0.2í«â¡äJén
Private Sub sVerListDisp(szWorkVersion As String, _
                            szNowVersion As String, _
                            szOldVersion As String)
' EG20 V3.0.0.2í«â¡èIóπ

    Dim i As Integer                        'ÉJÉEÉìÉ^
    'Dim uVerData(2) As MN_VERSION_JIKAI     'ÉoÅ[ÉWÉáÉìèÓïÒÅiäeÉtÉHÉãÉ_Åj   'EG20 V30.1.0.1 DEL
    Dim uVerData(2) As MN_VERSION_KAN_JIKAI  'ÉoÅ[ÉWÉáÉìèÓïÒÅiäeÉtÉHÉãÉ_Åj   'EG20 V30.1.0.1 ADD
    Dim lDataNum As Long                    'ÉoÅ[ÉWÉáÉìèÓïÒêî
    Dim szWorkBuffer As String              ' ÉèÅ[ÉNÉoÉbÉtÉ@        ' EG20 V3.0.0.2í«â¡
    Dim szTitleBuffer As String             ' ÉèÅ[ÉNÉoÉbÉtÉ@        ' EG20 V3.0.0.2í«â¡

    On Error Resume Next

'    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
'    lstKan(0).Clear
'    lstKan(1).Clear
'    lstKan(2).Clear
'    lstKan(3).Clear
'    lstKan(4).Clear
'    lstKan(5).Clear

    lDataNum = UBound(uVersion)             'ÉoÅ[ÉWÉáÉìèÓïÒêîéÊìæ
    For i = 1 To lDataNum

        uVerData(0).sFileName = ""          'ÉtÉ@ÉCÉãñºÇÉNÉäÉAÇ∑ÇÈ
        uVerData(1).sFileName = ""          'ÉtÉ@ÉCÉãñºÇÉNÉäÉAÇ∑ÇÈ
        uVerData(2).sFileName = ""          'ÉtÉ@ÉCÉãñºÇÉNÉäÉAÇ∑ÇÈ

        Select Case uVersion(i).iFolder     'ÉtÉHÉãÉ_ñºÇëŒè€Ç∆Ç∑ÇÈ
        Case MN_FLDWRK                      'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ÇÃèÍçá
            uVerData(0) = uVersion(i)       'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
            If i + 1 <= lDataNum Then       'éüÇÃÉfÅ[É^Ç™Ç†ÇÈ?
                If uVersion(i).sFileName = uVersion(i + 1).sFileName Then
                                                        'ÉtÉ@ÉCÉãñºÇ™ìØÇ∂?
                    Select Case uVersion(i + 1).iFolder 'ÉtÉHÉãÉ_ñºÇëŒè€Ç∆Ç∑ÇÈ
                    Case MN_FLDNOW                      'Åué¿çsÅvÉtÉHÉãÉ_ÇÃèÍçá
                        uVerData(1) = uVersion(i + 1)   'Åué¿çsÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                        If i + 2 <= lDataNum Then       'éüÇÃÉfÅ[É^Ç™Ç†ÇÈ?
                            If uVersion(i + 1).sFileName = uVersion(i + 2).sFileName Then
                                                        'ÉtÉ@ÉCÉãñºÇ™ìØÇ∂?
                                uVerData(2) = uVersion(i + 2)
                                                        'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                                i = i + 2               'ÉJÉEÉìÉ^ÇéüÅXÇ…Ç∑ÇÈ
                            Else
                                i = i + 1               'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                            End If
                        Else
                            i = i + 1                   'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                        End If
                    Case MN_FLDOLD                      'ÅuãåÅvÉtÉHÉãÉ_ÇÃèÍçá
                        uVerData(2) = uVersion(i + 1)   'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                        i = i + 1                       'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                    End Select
                End If
            End If
        Case MN_FLDNOW                      'Åué¿çsÅvÉtÉHÉãÉ_ÇÃèÍçá
            uVerData(1) = uVersion(i)       'Åué¿çsÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
            If i + 1 <= lDataNum Then       'éüÇÃÉfÅ[É^Ç™Ç†ÇÈ
                If uVersion(i).sFileName = uVersion(i + 1).sFileName Then
                                                    'ÉtÉ@ÉCÉãñºÇ™ìØÇ∂?
                    uVerData(2) = uVersion(i + 1)   'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                    i = i + 1                       'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                End If
            End If
        Case MN_FLDOLD                      'ÅuãåÅvÉtÉHÉãÉ_ÇÃèÍçá
            uVerData(2) = uVersion(i)       'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
        End Select
        'ÉtÉ@ÉCÉãñºÇÇ‹Ç∆ÇﬂÇƒÉäÉXÉgÉ{ÉbÉNÉXÇ…ê›íË
        sVersionDisp uVerData()
    Next

' EG20 V3.0.0.2í«â¡äJén
    ' ÉèÅ[ÉNçsï“èW
    szWorkBuffer = DispTitleBox(FolderSyubetu) & szWorkVersion & vbCrLf
    szTitleBuffer = szWorkBuffer
    ' é¿çsçsï“èW
    szWorkBuffer = TITLEDISP_FIXEDVERNOW & szNowVersion & vbCrLf
    szTitleBuffer = szTitleBuffer & szWorkBuffer
    ' ãåçsï“èW
    szWorkBuffer = TITLEDISP_FIXEDVEROLD & szOldVersion
    szTitleBuffer = szTitleBuffer & szWorkBuffer

    lblZenVer(iTab_index).Caption = szTitleBuffer

    DispTitleVersion(MN_FOLD_WRK) = szWorkVersion
    DispTitleVersion(MN_FOLD_NOW) = szNowVersion
    DispTitleVersion(MN_FOLD_OLD) = szOldVersion
' EG20 V3.0.0.2í«â¡èIóπ

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sSetChkFile
'//  ã@î\ñºèÃ  : ÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈égópÇ∑ÇÈê≥ìñê´É`ÉFÉbÉNINIì«çûÇ›
'//  ã@î\äTóv  : INIÉtÉ@ÉCÉãÇ…ÇÃì‡óeÇÉGÉäÉAÇ…ìWäJÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : String    ÉZÉNÉVÉáÉìñº
'//              String    ÉLÅ[ñº
'//              String    ÉtÉ@ÉCÉãñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : String    ê≥ìñê´É`ÉFÉbÉNINIÇÃì‡óeÅiàŸèÌéûÇÕÉuÉâÉìÉNÅj
'//
'//     ORIGINAL  :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sSetChkFile(sSec As String, sKey As String, sFilePath As String) As String

    Dim iRet As Integer             'ä÷êîÇÃñﬂÇËíl
    Dim sIni_Data As String * 128   'INIÉtÉ@ÉCÉãÇÊÇË1çsï™éÊìæ
    
    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh

    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'iniÉtÉ@ÉCÉãéÊìæ
    sIni_Data = ""
    iRet = GetPrivateProfileString(sSec, sKey, DEFAILT, sIni_Data, Len(sIni_Data), sFilePath)
    
    'àŸèÌèàóù
    If iRet = 0 Then
        
        'ÉçÉOèoóÕÅuINIÉtÉ@ÉCÉãì«çûàŸèÌÅv
        lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, LOG_ERR_INI_READ, lngErrCode)
        'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
        Call psFileNameGet(sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
        'ÉçÉOèoóÕÅ@ÑØÉLÅ[ñº
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØKey:" & sKey, lngErrCode)
        
    End If
    
    sSetChkFile = Left$(sIni_Data, iRet)
    
End Function
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fReadFileList
'//  ã@î\ñºèÃ  : ÉtÉ@ÉCÉãÉäÉXÉgÇÃéÊìæ
'//  ã@î\äTóv  : ÉtÉ@ÉCÉãÉäÉXÉgÇÊÇËÅAÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fReadFileList(sFileList As String) As Boolean
    Dim iFileNumber As Integer      'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String         'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer         'ÉtÉ@ÉCÉãäiî[êî

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË

    iListCnt = 0
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)

    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open sFileList For Input Access Read As #iFileNumber    'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
    Do While Not EOF(iFileNumber)                           'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
        Line Input #iFileNumber, sFileName                  'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
        If sFileName <> "" And Left$(sFileName, 1) <> "/" Then                'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
            iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
            ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            'EG20 V30.1.0.1 DEL START
'            FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
'            FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 16)
            'EG20 V30.1.0.1 DEL END
            'EG20 V30.1.0.1 ADD START
            'ÉtÉ@ÉCÉãéÌï ÇÕëÂï∂éöÇ…ïœä∑ÇπÇ∏ÅAÉtÉ@ÉCÉãñºÇæÇØÇëÂï∂éöÇ…ïœä∑Ç∑ÇÈÇÊÇ§Ç…Ç∑ÇÈÅBÅiç°Ç‹Ç≈ÇÕéÌï Ç™êîéöÇæÇ¡ÇΩÇ©ÇÁñ‚ëËÇ»Ç©Ç¡ÇΩÅj
            FileListType(iListCnt - 1) = Trim$(Left$(sFileName, 18))
            FileList(iListCnt - 1) = UCase(Mid$(FileListType(iListCnt - 1), 3, 16))
            'EG20 V30.1.0.1 ADDÅ@END
                                                            'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
        End If
    Loop
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB

    fReadFileList = True    'ñﬂÇËílÇê≥èÌÇ∆Ç∑ÇÈ

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'V1.21.0.1 ADD  START
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    'V1.21.0.1 ADD  END
    fReadFileList = False   'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sVersionInfo
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÇÃéÊìæ
'//  ã@î\äTóv  : ÉtÉ@ÉCÉãÉäÉXÉgàÍóóÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sPath
'//  Å@Å@Å@    : IntegerÅ@ iFolder
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-18  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Sub sVersionInfo(sPath As String, iFolder As Integer)                  ' EG20 V3.0.0.2çÌèú
Private Function sVersionInfo(sPath As String, iFolder As Integer) As String    ' EG20 V3.0.0.2í«â¡
    Dim i As Integer                    'ÉJÉEÉìÉ^
    Dim j As Integer                    'ÉJÉEÉìÉ^
    Dim sMyName As String               'ÉtÉ@ÉCÉãñº
    Dim iFileNumber As Integer          'ÉtÉ@ÉCÉãî‘çÜ
    Dim lLen As Long                    'ÉtÉ@ÉCÉãÉTÉCÉY
    'Dim uFooter As MN_FOOT              'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA      'EG20 V30.1.0.1 DEL
    Dim uFooter As MN_KAN_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA       'EG20 V30.1.0.1 ADD
    Dim uFooterDummy    As MN_KAN_FOOT  'èâä˙âªóp
    
    Dim lPos As Long                    'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
    Dim sDateTime As String
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD

    Dim szResultVersion As String        ' èoóÕÉoÅ[ÉWÉáÉì               ' EG20 V3.0.0.2í«â¡

    szResultVersion = TITLEDISP_VERNOTHING                              ' EG20 V3.0.0.2í«â¡
   On Error Resume Next

    For i = 0 To UBound(FileList) - 1   'ÉtÉ@ÉCÉãÉäÉXÉgêî

        sMyName = sPath & "\" & FileList(i)     'ÉtÉ@ÉCÉãÉtÉãÉpÉXñºÇÃçÏê¨

        'If Dir(sMyName) <> "" Then              'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?    'V1.20.0.1 DEL
        If objFso.FileExists(sMyName) = True Then  'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?    'V1.20.0.1 ADD
            lLen = FileLen(sMyName)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ

            iFileNumber = FreeFile              'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

            Open sMyName For Binary Access Read As #iFileNumber
                                                'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
            uFooter = uFooterDummy  'ëOâÒÇÃï\é¶ópÉfÅ[É^Ç™écÇ¡ÇƒÇ¢ÇÈèÍçáÇ™Ç†ÇÈÇÃÇ≈èâä˙âª
            Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
                                                'ÉtÉbÉ^èÓïÒÇÃéÊìæ
            ReDim Preserve uVersion(UBound(uVersion) + 1)
                                                'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉAÇÃägí£
            lPos = UBound(uVersion)             'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íuÇÃéÊìæ
            'uVersion(lPos).sFileName = UCase(FileListType(i))       'ÉtÉ@ÉCÉãñºÇëÂï∂éöÇ…ÇµÇƒÉZÉbÉg    'EG20 V30.1.0.1 DEL
            uVersion(lPos).sFileName = UCase(FileList(i))       'ÉtÉ@ÉCÉãñºÇëÂï∂éöÇ…ÇµÇƒÉZÉbÉg    'EG20 V30.1.0.1 ADD
            uVersion(lPos).iFolder = iFolder                    'ÉtÉHÉãÉ_ñºÉZÉbÉg
            'uVersion(lPos).sMachineName = uFooter.sKisyu        'ã@éÌñºÉZÉbÉg   'EG20 V30.1.0.1 DEL
            uVersion(lPos).sSyubetsu = LCase(Right$("0" & Hex(uFooter.bySyubetsu), 2)) & Chr(uFooter.byMakerName)  'éÌï ÇÉZÉbÉg   'EG20 V30.1.0.1 ADD
            'uVersion(lPos).sFooterFile = uFooter.sFileName      'ÉtÉ@ÉCÉãñºÉZÉbÉg      'EG20 V30.1.0.1 DEL
            'uVersion(lPos).sDataVersion = uFooter.sFileVersion     'ÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉì
            'JTRÉ\Å[ÉXÇéQçlÇ…ÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉìÇï“èW
            'NULLï∂éöÉ`ÉFÉbÉN
            For j = 0 To UBound(uFooter.byFileVersion)
                'Ç‡ÇµÅANULLï∂éöÅi0x00)Ç™ì¸Ç¡ÇƒÇ¢ÇÈèÍçáÇÕÅAÉXÉyÅ[ÉX(0x20)Ç…ïœçX
                If uFooter.byFileVersion(j) = &H0 Then
                    uFooter.byFileVersion(j) = &H20
                End If
            Next j
            'ÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉìÇÉZÉbÉg
            uVersion(lPos).sDataVersion = ""    'èâä˙âª
            For j = 0 To UBound(uFooter.byFileVersion)
                'ASCIIÉRÅ[ÉhÇ©ÇÁï∂éöóÒÇ…ïœä∑ÇµÇƒê›íË
                uVersion(lPos).sDataVersion = uVersion(lPos).sDataVersion & Chr(uFooter.byFileVersion(j))
            Next j
            'EG20 V30.1.0.1 ADD START
            'ÅuÉfÅ[É^ñºÅ{ÉoÅ[ÉWÉáÉìÅvÅi18ÉoÉCÉgÅjÇÃå„Ç…ÉtÉ@ÉCÉãå¬ï ÉoÅ[ÉWÉáÉìÇí«â¡
            For j = 0 To UBound(uFooter.byZentaiVersion)
                'ASCIIÉRÅ[ÉhÇ©ÇÁï∂éöóÒÇ…ïœä∑ÇµÇƒê›íË
                uVersion(lPos).sDataVersion = uVersion(lPos).sDataVersion & Chr(uFooter.byZentaiVersion(j))
            Next j
            'EG20 V30.1.0.1 ADD END
            
            sDateTime = ""
            For j = 0 To 3
                sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
                'EG20 V30.1.0.1 ADD START
                If j = 1 Or j = 2 Then
                    sDateTime = sDateTime & "/"
                End If
                'EG20 V30.1.0.1 ADD END
            Next
            sDateTime = sDateTime & " "
            For j = 4 To 5
                sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
                'EG20 V30.1.0.1 ADD START
                If j = 4 Then
                    sDateTime = sDateTime & ":"
                End If
               'EG20 V30.1.0.1 ADD END
            Next
            uVersion(lPos).sFileDate = sDateTime
            'uVersion(lPos).sVersion = uFooter.sVersion          'ÉoÅ[ÉWÉáÉìèÓïÒÉZÉbÉg   'EG20 V30.1.0.1 DEL
            'EG20 V30.1.0.1 ADD START
            'ÉoÅ[ÉWÉáÉìèÓïÒÇÉZÉbÉg
            uVersion(lPos).sVersion = ""    'èâä˙âª
            For j = 0 To UBound(uFooter.byZentaiVersion)
                'ASCIIÉRÅ[ÉhÇ©ÇÁï∂éöóÒÇ…ïœä∑ÇµÇƒê›íË
                uVersion(lPos).sVersion = uVersion(lPos).sVersion & Chr(uFooter.byZentaiVersion(j))
            Next
            'EG20 V30.1.0.1 ADD END
            uVersion(lPos).sComment = uFooter.sHyoji            'ï\é¶ï∂éöóÒÉZÉbÉg

' EG20 V3.0.0.2í«â¡äJén
            ' ÉtÉ@ÉCÉãÉäÉXÉgÇÃêÊì™Ç≈ÅAÇ©Ç¬ç≈èâÇ…å©Ç¬Ç©Ç¡ÇΩÉtÉ@ÉCÉãÇÃÉoÅ[ÉWÉáÉìÇê›íË
            If szResultVersion = TITLEDISP_VERNOTHING Then
                'szResultVersion = uFooter.sVersion     'EG20 V30.1.0.1 DEL
                'EG20 V30.1.0.1 ADD START
                szResultVersion = ""    'èâä˙âª
                For j = 0 To UBound(uFooter.byFileVersion)
                    'ASCIIÉRÅ[ÉhÇ©ÇÁï∂éöóÒÇ…ïœä∑ÇµÇƒê›íË
                    szResultVersion = szResultVersion & Chr(uFooter.byZentaiVersion(j))
                Next j
                'EG20 V30.1.0.1 ADD END
            End If
' EG20 V3.0.0.2í«â¡èIóπ

            Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
        End If
    Next
    
    Set objFso = Nothing    'V1.20.0.1 ADD

    sVersionInfo = szResultVersion              ' EG20 V3.0.0.2í«â¡

End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sListboxSort
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÇÃÉ\Å[Ég
'//  ã@î\äTóv  : ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºèáÇ…É\Å[ÉgÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-18 REVISED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sListboxSort()
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim j As Integer                'ÉJÉEÉìÉ^
    'Dim uBuff As MN_VERSION_JIKAI   'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉoÉbÉtÉ@    'EG20 V30.1.0.1 DEL
    Dim uBuff As MN_VERSION_KAN_JIKAI   'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉoÉbÉtÉ@     'EG20 V30.1.0.1 ADD

    On Error Resume Next
   
    For i = 1 To UBound(uVersion) - 1
        For j = i + 1 To UBound(uVersion)
            'ÉtÉ@ÉCÉãñºÇÃî‰ärÇçsÇ§
            If uVersion(j).sFileName < uVersion(i).sFileName Then
                'ÉtÉ@ÉCÉãñºÇ™è¨Ç≥ÇØÇÍÇŒà⁄Çµë÷Ç¶ÇÈ
                uBuff = uVersion(i)
                uVersion(i) = uVersion(j)
                uVersion(j) = uBuff
            ElseIf uVersion(j).sFileName = uVersion(i).sFileName Then
                'ÉtÉHÉãÉ_ÇÃî‰ärÇçsÇ§
                If uVersion(j).iFolder = MN_FLDWRK And uVersion(i).iFolder = MN_FLDNOW Then
                    uBuff = uVersion(i)
                    uVersion(i) = uVersion(j)
                    uVersion(j) = uBuff
                ElseIf uVersion(j).iFolder = MN_FLDNOW And uVersion(i).iFolder = MN_FLDOLD Then
                    uBuff = uVersion(i)
                    uVersion(i) = uVersion(j)
                    uVersion(j) = uBuff
                ElseIf uVersion(j).iFolder = MN_FLDWRK And uVersion(i).iFolder = MN_FLDOLD Then
                    uBuff = uVersion(i)
                    uVersion(i) = uVersion(j)
                    uVersion(j) = uBuff
                End If
            End If
        Next
    Next
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psVersionDisp
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒï\é¶èàóù
'//  ã@î\äTóv  : ÉoÅ[ÉWÉáÉìèÓïÒï\é¶ïîÇÃï\é¶èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Public Sub psVersionDisp()
'
'    Dim strFilePath     As String   'ÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉpÉX
'    Dim bRet            As Boolean  'ñﬂÇËíl
'    Dim intFileNo       As Integer  'ÉtÉ@ÉCÉãî‘çÜ
'    Dim strWork         As String   'çÏã∆ÉGÉäÉA
'    Dim strVerData      As String   'ëSëÃÉoÅ[ÉWÉáÉì
'    Dim intCnt          As Integer  'ÉJÉEÉìÉ^Å[
'    Dim lngErrCode      As Long     'ÉGÉâÅ[ÉRÅ[Éh
'
''*******************************
''VBÉGÉâÅ[èàóù
'On Error GoTo Error_psVersionDisp
''*******************************
'
'    'î}ëÃèoóÕñtâüâ∫ïsâ¬
'    cmdOutput.Enabled = False
'
'    'ÉäÉXÉgèâä˙âª
'    LstFile.Clear
'
'    'ëSëÃÉoÅ[ÉWÉáÉìèâä˙âª
'    lblZenVer.Caption = "ëSëÃÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅj:--.--.--.--" & vbCrLf & _
'                        "Å@Å@Å@Å@Å@Å@Å@Åié¿çsÅjÅ@:--.--.--.--" & vbCrLf & _
'                        "Å@Å@Å@Å@Å@Å@Å@ÅiãåÅj    :--.--.--.--"
'
'    'çÏã∆ÉGÉäÉAèâä˙âª
'    strWork = ""
'
'    'ëSëÃÉoÅ[ÉWÉáÉìèâä˙âª
'    strVerData = ""
'
'    'LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉpÉXçÏê¨
'    strFilePath = PATH_LDU_APP & PATH_LDU_WORK & LDU_VER_FILE
'
'    bRet = True
'    '///////////////////////////////////////////////////////////////////////////////////////////
'    '/ ã§í DA:LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãçÏê¨
'    '///////////////////////////////////////////////////////////////////////////////////////////
'    bRet = dllCreateIDU_LDUVerFile(mlngChkFolderType, strFilePath, PATH_LDU_APP)
'
'    'LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãçÏê¨ê¨å˜
'    If bRet Then
'       'ÅuLDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉãçÏê¨ê≥èÌÅvÉçÉOèoóÕ
'       Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, CREATE_FILE_OK, 0)
'    'LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãçÏê¨é∏îs
'    Else
'       'ÅuLDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉãçÏê¨àŸèÌÅvÉçÉOèoóÕ
'       lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
'       Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, CREATE_FILE_ERROR, lngErrCode)
'       Exit Sub
'    End If
'
'    'LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÇÃóLñ≥ämîF
'    If Len(Trim(Dir(strFilePath))) = 0 Then
'        Exit Sub
'    End If
'
'    'LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈÅB
'    intFileNo = FreeFile
'
'    'LDÉÜÅ[ÉeÉBÉäÉeÉBâÊñ ï\é¶ópÉoÅ[ÉWÉáÉìÉtÉ@ÉCÉãÉIÅ[ÉvÉì
'    Open strFilePath For Input As #intFileNo
'
'
'        'ÉèÅ[ÉN
'        Line Input #intFileNo, strWork
'
'        If (Trim(strWork) = "") Then
'            strVerData = "ëSëÃÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF--.--.--.--" & vbCrLf
'        Else
'            'ëSëÃÉoÅ[ÉWÉáÉìï∂éöóÒçÏê¨
'            strVerData = strVerData & strWork & vbCrLf
'        End If
'
'        'é¿çs
'        Line Input #intFileNo, strWork
'        If (Trim(strWork) = "") Then
'            strVerData = strVerData & "Å@Å@Å@Å@Å@Å@Å@Åié¿çsÅjÅ@ÅF--.--.--.--" & vbCrLf
'        Else
'            'ëSëÃÉoÅ[ÉWÉáÉìï∂éöóÒçÏê¨
'            strVerData = strVerData & strWork & vbCrLf
'        End If
'
'        'ãå
'        Line Input #intFileNo, strWork
'        If (Trim(strWork) = "") Then
'            strVerData = strVerData & "Å@Å@Å@Å@Å@Å@Å@ÅiãåÅj    ÅF--.--.--.--" & vbCrLf
'        Else
'            'ëSëÃÉoÅ[ÉWÉáÉìï∂éöóÒçÏê¨
'            strVerData = strVerData & strWork & vbCrLf
'        End If
'
'        'ëSëÃÉoÅ[ÉWÉáÉìèoóÕ
'        lblZenVer.Caption = strVerData
'
'        strWork = ""
'
'        'ÉäÉXÉgï\é¶ï™ì«Ç›çûÇ›ÅiÉtÉ@ÉCÉãèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘Ç∑Åj
'        Do While Not EOF(1)
'
'            Line Input #intFileNo, strWork
'
'            'â¸çsÉRÅ[ÉhÇÃÇ›ÇÕì«Ç›Ç∆ÇŒÇ∑
'            If Trim(strWork) <> "" Then
'
'                'ÉäÉXÉgÇ…èoóÕ
'                LstFile.AddItem (strWork)
'
'            End If
'        Loop
'
'    'ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
'    Close #intFileNo
'
'    'î}ëÃèoóÕñtâüâ∫â¬
'    cmdOutput.Enabled = True
'
'    Exit Sub
'
''*******************************
''VBÉGÉâÅ[èàóù
'Error_psVersionDisp:
'   'ÅuLDÉÜÅ[ÉeÉBÉäÉeÉBÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉãçÏê¨àŸèÌÅvÉçÉOèoóÕ
'   lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
'   Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, CREATE_FILE_ERROR, lngErrCode)
''    ÉtÉ@ÉCÉãÉNÉçÅ[ÉY
'    Close #intFileNo
''*******************************
'End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfInstallSeitouseiChck
'//  ã@î\ñºèÃ  : äOïîì¸óÕÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : äOïîì¸óÕÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL :(1.6.0.1) 2009-06-16   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûïsãÔçáèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(2.6.0.1) 2010-11-16  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãñºÉ`ÉFÉbÉNïsãÔçáèCê≥
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V6.9.0.1) 2012-12-03 REVISED BY  [TCC] H.Sugimoto
'//                 ó éYëŒâûÅyéÌï É`ÉFÉbÉNã@î\í«â¡Åz
'//     REVISIONS :(EG20 V6.11.0.1) 2013-03-27 REVISED BY  [TCC] H.Kondoh
'//                 î}ëÃìäì¸ã@î\ïœçXëŒâû
'//                   éÌï ÇOÇÃèÍçáÇ‡àŸèÌÇ∆Ç∑ÇÈÇÊÇ§Ç…ïœçX
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X)----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfInstallSeitouseiChck(sInputPass As String) As Boolean
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim SysCodeTxt As String                 'ÉoÉCÉgïœä∑å„(ëSäpÅ®îºäp)
    Dim lngSumRet As Long
    Dim i As Integer
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    Dim bRet As Boolean
    Dim lngCnt As Long
    Dim iRet   As Integer                    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNDLLñﬂÇËíl
    Dim iGouki As Integer                    'çÜã@î‘çÜ
    Dim sVersionInfoPath As String           'ÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉã(çÜã@ï )
    Dim sSrcFileName As String               'ÉtÉ@ÉCÉãÉäÉXÉgñº
    Dim lngErrCode   As Long
    Dim intCheckKind As Integer              ' É`ÉFÉbÉNéÌï      ' EG20 V6.9.0.1ADD
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    On Error Resume Next
    
    pfInstallSeitouseiChck = True
    
    '********************************
    '*ÉvÉçîªê≥ìñê´É`ÉFÉbÉN
    '********************************
    'äOïîî}ëÃÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨
    sSrcFileName = sInputPass & MN_FILELIST
    'äOïîî}ëÃÇÃåüçıÇÇ∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'V1.20.0.1 DEL
    'V1.20.0.1 ADD START
    If objFso.FileExists(sSrcFileName) = True Then
        Set objFso = Nothing
    'V1.20.0.1 ADD END
    Else
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
      
      'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
      MsgBox "î}ëÃì‡Ç…ÅAÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
             vbOKOnly + vbExclamation, _
             "Å®ÉèÅ[ÉN ÉRÉsÅ["
     'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉtÉ@ÉCÉãÉäÉXÉgñ≥ÇµÅvÉçÉOèoóÕ
      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOTFOUND_FILELIST, lngErrCode)

      pfInstallSeitouseiChck = False
      Set objFso = Nothing    'V1.20.0.1 ADD
      Exit Function
    End If

   '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    bRet = fReadFileList(sInputPass & MN_FILELIST)

    'ÉTÉÄílÉ`ÉFÉbÉN
    For lngCnt = 0 To UBound(FileList) - 1
        If pfFileSumChk(sInputPass & FileList(lngCnt), lngSumRet) <> True Then

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
           
            'ÉTÉÄílàŸèÌ
            If lngSumRet = SUM_CHK.SumErr Then
                'EG20 V30.1.0.1 DEL START
'               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
'                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                      vbOKOnly + vbExclamation, _
'                      "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
                'EG20 V30.1.0.1 DEL END
                'EG20 V30.1.0.1 ADD START
               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
                      vbOKOnly + vbExclamation, _
                      "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
                'EG20 V30.1.0.1 ADD END
            'ÉTÉÄílàŸèÌà»äOàŸèÌ
            ElseIf lngSumRet = SUM_CHK.SumErr_Else Then
                   'ÅuÉèÅ[ÉNÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
                'EG20 V30.1.0.1 DEL START
'               MsgBox "ÉRÉsÅ[ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB" _
'                     & Chr(vbKeyReturn) & "ÉGÉâÅ[ÉRÅ[ÉhÅÅ" _
'                     & str$(Err.Number), _
'                     vbOKOnly + vbExclamation, _
'                     "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
                'EG20 V30.1.0.1 DEL END
                'EG20 V30.1.0.1 ADD START
               MsgBox "ÉRÉsÅ[ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB" _
                     & Chr(vbKeyReturn) & "ÉGÉâÅ[ÉRÅ[ÉhÅÅ" _
                     & str$(Err.Number), _
                     vbOKOnly + vbExclamation, _
                     "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
                'EG20 V30.1.0.1 ADD END
            End If
            pfInstallSeitouseiChck = False
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_SUMCHK_ERROR, 0)
            Exit Function
        End If
    Next

    'ÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉN
    If UBound(FileList) > FILECNT_MAX Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
       'EG20 V30.1.0.1 DEL START
'       MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
'              & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'              vbOKOnly + vbExclamation, _
'              "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 DEL END
        'EG20 V30.1.0.1 ADD START
        MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
              & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
              vbOKOnly + vbExclamation, _
              "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 ADD END
      pfInstallSeitouseiChck = False

      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_MAXFILECHK_ERROR, 0)

      Exit Function
    End If
'V2.6.0.1 DEL START
'    'ÉtÉ@ÉCÉãñºÉTÉCÉYÉ`ÉFÉbÉN
'    lngFileListCnt = UBound(FileList)
'
'    On Error GoTo FileGetError
'
'    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'
'    bRet = True
'
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉIÅ[ÉvÉìÅB
'    Open sInputPass & MN_FILELIST For Input As #iFileNumber
'    For i = 0 To lngFileListCnt
'       If i = lngFileListCnt Then
'          Exit For
'       End If
'       'ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'       Input #iFileNumber, strWork
'       'ÉtÉ@ÉCÉãñºíËã`Ç»Çµ
'       If strWork = "" Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'          bRet = False
'          Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'          Exit For
'       'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'       ElseIf " " <> Mid(strWork, 2, 1) And Left$(strWork, 1) <> "/" Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'       ElseIf (InStr(strWork, ".") - 1) = -1 And Left$(strWork, 1) <> "/" Then
'           MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       'Åu/*--ÅvìôÇÃÉRÉÅÉìÉgïîÇÕèúÇ≠
'       ElseIf Left$(strWork, 1) = "/" Then
'               'âΩÇ‡ÇµÇ»Ç¢ÅB
'       Else
'          'ÉtÉ@ÉCÉãñºÇÃÇ›Çíäèo
'          sGetFileListName = Mid(strWork, 3, 16)
'          'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
'          myLen = LenB(StrConv(Trim(sGetFileListName), vbFromUnicode))                                              'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
'          If FILE_NAME_MAX_SIZE < myLen Then
'            '13ÉoÉCÉgà»è„ÇÃèÍçá
'            MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                   vbOKOnly + vbExclamation, _
'                   sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'            bRet = False
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'            Exit For
'           End If
'        End If
'     Next
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉNÉçÅ[ÉYÅB
'    Close #iFileNumber
'V2.6.0.1 DEL END
'V2.6.0.1 ADD START
    For i = 0 To UBound(FileList) - 1
       'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
       myLen = LenB(StrConv(Trim(FileList(i)), vbFromUnicode))                                              'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
       If FILE_NAME_MAX_SIZE < myLen Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
          'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
          Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
          
          '13ÉoÉCÉgà»è„ÇÃèÍçá
          'EG20 V30.1.0.1 DEL START
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                 & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
                 & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
                  vbOKOnly + vbExclamation, _
                  "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
         'EG20 V30.1.0.1 ADD END
                
           bRet = False
           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
           Exit For
       End If
    Next
'V2.6.0.1 ADD END

' EG20 V6.9.0.1Åyó éYëŒâûÅFéÌï É`ÉFÉbÉNã@î\í«â¡ÅzADD START
    If bRet = False Then
        pfInstallSeitouseiChck = bRet
        Exit Function
    End If

    For i = 0 To UBound(FileList) - 1
        ' ÉtÉ@ÉCÉãÉäÉXÉgì‡ÇÃéÌï Çíäèo
        'intCheckKind = CInt(Left$(FileListType(i), 1))     'EG20 V30.1.0.1 DEL
        intCheckKind = Asc(Left$(FileListType(i), 1))       'EG20 V30.1.0.1 ADD
'EG20 V6.11.0.1 DEL Start
'        If ((gintProgramJudgeKind(FolderSyubetu) = intCheckKind) Or _
'            (intCheckKind = ProgramJudgeKind.JUDGE_NOCHECK)) Then
'            ' ÉfÅ[É^éÌï ëIëïîÇÃëIëì‡óeÇ∆ÉtÉ@ÉCÉãÉäÉXÉgì‡ÇÃéÌï ÇÃî‰äråãâ Ç™ÅuàÍívÅvÅAÇ‡ÇµÇ≠ÇÕ
'            ' ÉtÉ@ÉCÉãÉäÉXÉgì‡ÇÃéÌï Ç™ÅuÉ`ÉFÉbÉNÇ»ÇµÅv
'            ' Å®É`ÉFÉbÉNåãâ ê≥èÌ
'EG20 V6.11.0.1 DEL End
'EG20 V6.11.0.1 ADD Start
        If (gintProgramJudgeKind(FolderSyubetu) = intCheckKind) Then
            ' ÉfÅ[É^éÌï ëIëïîÇÃëIëì‡óeÇ∆ÉtÉ@ÉCÉãÉäÉXÉgì‡ÇÃéÌï ÇÃî‰äråãâ Ç™ÅuàÍívÅv
            ' Å®É`ÉFÉbÉNåãâ ê≥èÌ
'EG20 V6.11.0.1 ADD End
            bRet = True
        Else
            ' è„ãLà»äO
            ' Å®É`ÉFÉbÉNåãâ àŸèÌ
            bRet = False
            ' ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
            ' ÉÅÉbÉZÅ[ÉWï\é¶
            'EG20 V30.1.0.1 DEL START
'            MsgBox "ëIëÇµÇΩÉfÅ[É^éÌï Ç∆ÉCÉìÉXÉgÅ[ÉãïîçﬁÇ™" & Chr(vbKeyReturn) _
'                     & "àÍívÇµÇ‹ÇπÇÒ", _
'                   vbOKOnly + vbExclamation, _
'                   "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 DEL END
            'EG20 V30.1.0.1 ADD START
            MsgBox "ëIëÇµÇΩÉfÅ[É^éÌï Ç∆ÉCÉìÉXÉgÅ[ÉãïîçﬁÇ™" & Chr(vbKeyReturn) _
                     & "àÍívÇµÇ‹ÇπÇÒ", _
                   vbOKOnly + vbExclamation, _
                   "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 ADD END
            
            ' ÉGÉâÅ[ÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_PRGKIND_ERROR, 0)
            Exit For
        End If
    Next
' EG20 V6.9.0.1Åyó éYëŒâûÅFéÌï É`ÉFÉbÉNã@î\í«â¡ÅzADD END

    pfInstallSeitouseiChck = bRet
Exit Function

FileGetError:
    If iFileNumber > 0 Then
       Close #iFileNumber
    End If
    iFileNumber = 0
    pfInstallSeitouseiChck = False
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fSelectFile
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñº
'//  ã@î\äTóv  : ëŒè€ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-18 REVISED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fSelectFile() As String
 
 'If gStrCurrentForm = sFormName_EJVer Then      'EG20 V30.1.0.1 DEL
    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñºÇê›íËÇ∑ÇÈÅB
    Select Case FolderSyubetu
       Case 0 'îªíËCPU-Pro
            fSelectFile = EG30_HANTEI_CPU_CHK_FILE
       
       Case 1 'ÉÅÉCÉìCPU-Pro
            fSelectFile = EG30_MAIN_CPU_CHK_FILE
       
       Case 2 'ÉTÉuCPU-Pro
            fSelectFile = EG30_SUB_CPU_CHK_FILE
       
       Case 3 'ÉÅÉCÉìCPU-OS
            fSelectFile = EG30_MAIN_OS_CHK_FILE
     
     End Select
'EG20 V30.1.0.1 DEL START
'  Else
'    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñºÇê›íËÇ∑ÇÈÅB
'    Select Case FolderSyubetu
'       Case 0 'îªíËCPU-Pro
'             fSelectFile = NHANTEI_CPU_CHK_FILE
'
'       Case 1 'ÉÅÉCÉìCPU-Pro
'            fSelectFile = NMAIN_CPU_CHK_FILE
'
'       Case 2 'ÉTÉuCPU-Pro
'            fSelectFile = NSUB_CPU_CHK_FILE
'
'       Case 3 'ÉÅÉCÉìCPU-OS
'            fSelectFile = NMAIN_OS_CHK_FILE
'
'    End Select
'   End If
'EG20 V30.1.0.1 DEL END

End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fNewVersion
'//  ã@î\ñºèÃ  : ç≈êVÉoÅ[ÉWÉáÉìèàóù
'//  ã@î\äTóv  : ç≈êV(ÉèÅ[ÉN)ÉoÅ[ÉWÉáÉìÇÅAé¿çs(é¿çs)ÉoÅ[ÉWÉáÉìÇ…ìoò^
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sPath
'//  Å@Å@Å@    : IntegerÅ@ iFolder
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@ÉvÉçîªê≥ìñê´É`ÉFÉbÉNèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-12   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇPëŒâûïsãÔçáèCê≥
'//                 ÉtÉFÅ[ÉYÇRëŒâûÅ@ã@éÌê≥ìñê´É`ÉFÉbÉNèàóùí«â¡
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-18  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.5.0.1) 2012-03-28  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.6.0.1) 2012-03-28  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.8.0.1) 2012-04-17  CODED BY  [TCC] H.Sugimoto
'//                Åyécåè:ï€éÁâ^â¸ÇÃêÿë÷åãâ í ímëŒâûÅz
'//     REVISIONS :(EG20 V5.11.0.1) 2012-05-10  CODED BY  [TCC] H.Sugimoto
'//                Åyâ^â¸ï\é¶â¸ëPëŒâûÅz
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fNewVersion() As Boolean
    Dim bRet As Boolean                      'ñﬂÇËíl
    Dim lngCnt                  As Long      'ÉJÉEÉìÉ^Å[
    Dim sSrcFileName            As String    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãÉäÉXÉg
    Dim sFileName As String
    Dim lngErrCode As Long                   'ÉGÉâÅ[ÉRÅ[Éh
    'V1.4.0.1 ADD START
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim SysCodeTxt As String                 'ÉoÉCÉgïœä∑å„(ëSäpÅ®îºäp)
    Dim lngSumRet As Long
    Dim i As Integer
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    'V1.4.0.1 ADD END
    Dim iKansiAplChk As Integer              'ÉAÉvÉäãNìÆÉ`ÉFÉbÉNñﬂÇËílÅ@'V1.6.0.1 ADD
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    Dim sCorner As String                    'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                  'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String                  'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    
    On Error Resume Next
    
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    sFilePath = sGatePath & FolderName(0, FolderSyubetu)

    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_ÇÃÉtÉ@ÉCÉãÉäÉXÉgÇåüçıÇ∑ÇÈ
    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨
'    sSrcFileName = FolderName(0, FolderSyubetu) & "\" & MN_FILELIST
    sSrcFileName = sFilePath & "\" & MN_FILELIST
    'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'V1.20.0.1 DEL
    'V1.20.0.1 ADD START
    If objFso.FileExists(sSrcFileName) = True Then
      Set objFso = Nothing
    'V1.20.0.1 ADD END
    Else
      
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
      'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
      Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
      'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
      MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
             & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
             vbOKOnly + vbExclamation, _
             TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
     'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉtÉ@ÉCÉãÉäÉXÉgñ≥ÇµÅvÉçÉOèoóÕ
      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOTFOUND_FILELIST, lngErrCode)

      fNewVersion = False
      Set objFso = Nothing    'V1.20.0.1 ADD
      Exit Function
    End If
  
    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    'bRet = fReadFileList(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)Å@'V1.8.0.1 DEL
    
    bRet = pfSeitouseiChck    'V1.4.0.1Å@ADD
    'é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNÇçsÇ§(ëŒè€ÉtÉ@ÉCÉãÅFHAN_KUKA.KUK)
'    bRet = fDataFileCheck(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST) 'V1.4.0.1Å@DEL
'V1.8.0.1 ADD START
    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇÊÇËÅAìoò^ÉtÉ@ÉCÉãêîÇÉJÉEÉìÉgÇ∑ÇÈ
    If bRet = True Then
'       bRet = fReadFileList(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)
       bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
    End If
'V1.8.0.1 ADD END

  If bRet = True Then
    '¢ãå£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇëSÇƒçÌèúÇ∑ÇÈ
     If sOldFolderRemove <> True Then
'        Call pubfuncErrorOccur(MN_FOLD_NOW)         ' EG20 V3.0.0.2í«â¡    EG20 V3.6.0.1çÌèú
        Call pubfuncErrorOccur(MN_FOLD_OLD)          ' EG20 V3.6.0.1í«â¡
         fNewVersion = False
         Exit Function
     End If

    '¢ãå£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇ¢é¿çs£ÉtÉHÉãÉ_ÇÃì‡óeÇ…íuä∑Ç¶ÇÈ
    If sCopyNOWtoOLD <> True Then
'        Call pubfuncErrorOccur(MN_FOLD_NOW)         ' EG20 V3.0.0.2í«â¡    EG20 V3.6.0.1çÌèú
        Call pubfuncErrorOccur(MN_FOLD_OLD)          ' EG20 V3.6.0.1í«â¡
        fNewVersion = False
        Exit Function
    End If

    '¢é¿çs£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇ¢ÉèÅ[ÉN£ÉtÉHÉãÉ_ÇÃì‡óeÇ…íuä∑Ç¶ÇÈ
    If sCopyWRKtoNOW <> True Then
        Call pubfuncErrorOccur(MN_FOLD_NOW)         ' EG20 V3.0.0.2í«â¡
        fNewVersion = False
        Exit Function
    End If
    
' EG20 V3.0.0.2 í«â¡äJén
    ' â¸éDã@ã§í ÉGÉäÉAçXêVèàóù
    Call pubfuncCommonAreaUpdate
' EG20 V3.0.0.2 í«â¡èIóπ
 
    'é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇä«óùÉvÉçÉZÉXÇ÷ëóêMÇ∑ÇÈÅB
    'V1.6.0.1Å@ADDÅ@START
    'äƒéãî’ãNìÆ/ñ¢ãNìÆÉ`ÉFÉbÉNÇçsÇ§ÅBÉ`ÉFÉbÉNèÛë‘Ç…ÇÊÇËèàóùï™äÚÇçsÇ§ÅB
     iKansiAplChk = CheckAppStart(PROC_KANRI)
     If iKansiAplChk <> 0 Then
        'äƒéãî’ãNìÆéûÅFä«óùÉvÉçÉZÉXÇ…é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇëóêMÇ∑ÇÈÅB
    'V1.6.0.1 ADD END
      'If gStrCurrentForm = sFormName_EJVer Then     'EG20 V30.1.0.1 DEL
         'psVersionUpdateReqest (ML_REQUEST_EGATE)      'EG20 V30.1.0.1 DEL
         psVersionUpdateReqest (ML_REQUEST_EG30GATE)       'EG20 V30.1.0.1 ADD
      'EG20 V30.1.0.1 DEL START
'      Else
'         psVersionUpdateReqest (ML_REQUEST_NGATE)
'      End If
      'EG20 V30.1.0.1 DEL END
    'V1.6.0.1 ADD START
    Else
        'äƒéãî’ñ¢ãNìÆéûÅFâ¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùåãâ Ç…ê≥èÌÇê›íËÇ∑ÇÈÅB
        gintGateVerInfUpdRes = MailSts.stsNormal
    End If
    'V1.6.0.1 ADD END

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
    'â¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùåãâ 
    If gintGateVerInfUpdRes = MailSts.stsNormal Then
' EG20 V5.8.0.1çÌèúäJén
'        ' â^â¸èÛë‘çXêV                                              ' EG20 V5.5.0.1í«â¡
'        Call pubFuncUpdateUnkaiStatus(BOOTINFO_UNKAI_NASHI)         ' EG20 V5.5.0.1í«â¡
' EG20 V5.8.0.1çÌèúèIóπ
' EG20 V5.8.0.1í«â¡äJén
        ' â^â¸èÛë‘çXêV
        Call pubFuncUpdateUnkaiStatus(BootInfoHoshuType.TYPE_GATE, BOOTINFO_UNKAI_KIRIKAE)
' EG20 V5.8.0.1í«â¡èIóπ
'        Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_KIRIKAE, iTab_index + 1)   ' EG20 V5.6.0.1í«â¡           ' EG20 V5.11.0.1çÌèú
        Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_KIRIKAE, iTab_index + 1, gintUnkaiKind(FolderSyubetu))    ' EG20 V5.11.0.1í«â¡
        'ê≥èÌ
        MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ÇÃì‡óeÇ,Åué¿çsÅvÉtÉHÉãÉ_Ç…ìoò^ÇµÇƒÅA" _
                & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & " ÇÃç≈êVÇÃÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹ÇµÇΩÅB", _
                vbOKOnly + vbExclamation, _
                TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
        fNewVersion = True
    Else
        'àŸèÌ
        'If gStrCurrentForm = sFormName_EJVer Then      ' EG20 V30.1.0.1 DEL
            'EG20 V30.1.0.1 DEL START
'           MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
'                  vbOKOnly + vbExclamation, _
'                  "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 DEL END
            'EG20 V30.1.0.1 ADD START
           MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
                  vbOKOnly + vbExclamation, _
                  "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 ADD END
        ' EG20 V30.1.0.1 DEL START
'        Else
'         MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
'                 vbOKOnly + vbExclamation, _
'                 "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'        End If
        ' EG20 V30.1.0.1 DEL END
        
        fNewVersion = False
    End If
  
    fNewVersion = True
  Else
    fNewVersion = False
  End If
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfSeitouseiChck
'//  ã@î\ñºèÃ  : ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@ÉvÉçîªê≥ìñê´É`ÉFÉbÉNèàóù
'//     REVISIONS :(1.6.0.1) 2009-06-16  REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûïsãÔçáèCê≥
'//                 ÉtÉFÅ[ÉYÇRëŒâûÅ@ã@éÌê≥ìñê´É`ÉFÉbÉNí«â¡
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-18  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfSeitouseiChck() As Boolean
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim SysCodeTxt As String                 'ÉoÉCÉgïœä∑å„(ëSäpÅ®îºäp)
    Dim lngSumRet As Long
    Dim i As Integer
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    Dim bRet As Boolean
    Dim lngCnt As Long
    Dim iRet   As Integer                    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNDLLñﬂÇËíl
    Dim iGouki As Integer                    'çÜã@î‘çÜ
    Dim sVersionInfoPath As String           'ÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉã(çÜã@ï )
    Dim iCnt             As Integer          'çÜã@ÉJÉEÉìÉ^Å[Å@V1.6.0.1Å@ADD
    
    Dim sCorner As String                    'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                  'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String                  'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    
    On Error Resume Next
    
    pfSeitouseiChck = True
   
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    '********************************
    '*ÉvÉçîªê≥ìñê´É`ÉFÉbÉN
    '********************************
    'é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNÇçsÇ§(ëŒè€ÉtÉ@ÉCÉãÅFHAN_KUKA.KUK)
'    bRet = fDataFileCheck(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)
    
    sFilePath = sGatePath & FolderName(0, FolderSyubetu)
    
    bRet = fDataFileCheck(sFilePath & "\" & MN_FILELIST)
    If bRet = False Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
       'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
       Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
       If sNGSts <> "" And sNGKoumoku <> "" Then
          'EG20 V30.1.0.1 DEL START
'          MsgBox "â^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌ(" & sNGSts & "ÅF" & sNGKoumoku & "Åj", _
'                 vbOKOnly + vbExclamation, _
'                 "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          MsgBox "â^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌ(" & sNGSts & "ÅF" & sNGKoumoku & "Åj", _
                 vbOKOnly + vbExclamation, _
                 "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 ADD END
       Else
          MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                 vbOKOnly + vbExclamation, _
                 TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
       End If
'       Call pubfuncErrorOccur(MN_FOLD_NOW)         ' EG20 V3.0.0.2í«â¡
       Call pubfuncErrorOccur(MN_FOLD_WRK)          ' EG20 V3.6.0.1í«â¡
       pfSeitouseiChck = False
       Exit Function
    End If

' EG20 V3.0.0.2í«â¡äJén
    ' â¸éDã@ã§í îªíËèàóù
    bRet = pubfuncCommonGateCheck(MN_FOLD_WRK)
    If bRet = False Then
       pfSeitouseiChck = False
       Exit Function
    End If

' EG20 V3.0.0.2í«â¡èIóπ

'V1.6.0.1 DEL START
'    'ÉTÉÄílÉ`ÉFÉbÉN
'    For lngCnt = 0 To UBound(FileList) - 1
'        If pfFileSumChk(FolderName(0, FolderSyubetu) & "\" & FileList(lngCnt), lngSumRet) <> True Then
'            'ÉTÉÄílàŸèÌ
'            If lngSumRet = SUM_CHK.SumErr Then
'               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
'                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                      vbOKOnly + vbExclamation, _
'                      sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'            'ÉTÉÄílàŸèÌà»äOàŸèÌ
'            ElseIf lngSumRet = SUM_CHK.SumErr_Else Then
'               MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
'                     vbOKOnly + vbExclamation, _
'                     TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
'            End If
'            pfSeitouseiChck = False
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_SUMCHK_ERROR, 0)
'            Exit Function
'        End If
'    Next
'
'    'ÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉN
'    If UBound(FileList) > FILECNT_MAX Then
'       MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
'              & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'              vbOKOnly + vbExclamation, _
'              sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'      pfSeitouseiChck = False
'
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_MAXFILECHK_ERROR, 0)
'
'      Exit Function
'    End If
'
'    'ÉtÉ@ÉCÉãñºÉTÉCÉYÉ`ÉFÉbÉN
'    lngFileListCnt = UBound(FileList)
'
'    On Error GoTo FileGetError
'
'    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉIÅ[ÉvÉìÅB
'    Open FolderName(0, FolderSyubetu) & "\" & MN_FILELIST For Input As #iFileNumber
'    For i = 0 To lngFileListCnt
'       If i = lngFileListCnt Then
'          Exit For
'       End If
'       'ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'       Input #iFileNumber, strWork
'       'ÉtÉ@ÉCÉãñºíËã`Ç»Çµ
'       If strWork = "" Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'          bRet = False
'          Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'          Exit For
'       'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'       ElseIf " " <> Mid(strWork, 2, 1) Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       ElseIf (InStr(strWork, ".") - 1) = -1 Then
'           MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       Else
'          'ÉtÉ@ÉCÉãñºÇÃÇ›Çíäèo
'          sGetFileListName = Mid(strWork, 3, 16)
'          'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
'          myLen = LenB(StrConv(sGetFileListName, vbFromUnicode))                                              'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
'          If FILE_NAME_MAX_SIZE < myLen Then
'            '13ÉoÉCÉgà»è„ÇÃèÍçá
'            MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                   vbOKOnly + vbExclamation, _
'                   sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'            bRet = False
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'            Exit For
'           End If
'        End If
'     Next
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉNÉçÅ[ÉYÅB
'    Close #iFileNumber
'V1.6.0.1 DEL END
'V1.11.0.1 DEL START
'    If gStrCurrentForm = sFormName_EJVer Then
''V1.6.0.1 ADDÅ@START
'   For iCnt = 1 To MAX_GATE_NO
'      'EG-Ré©â¸ÇÃÇ›ÅFé©â¸ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNDLLèàóù
'      iGouki = pfGetGoukiNo(iCnt)
'      If iGouki <> 0 Then
''V1.6.0.1 ADDÅ@END
'       'iGouki = pfGetGoukiNo 'V1.6.0.1 DEL
'       sVersionInfoPath = Replace(GATE_VERSION_INFO_FILE, "##", Format(iGouki, "0#"))
'
'       'iRet = dllVerChk(E_EPRO1WRK & "\\" & GATE_VERSION_KANRI_FILE, PATH_GATE & sVersionInfoPath, PATH_HOSHU_LOG & GATE_VERSION_NGLIST_FILE)Å@Å@Å@Å@Å@Å@Å@Å@Å@'V1.6.0.1Å@DEL
'       iRet = dllVerChk(FolderName(0, FolderSyubetu) & "\" & GATE_VERSION_KANRI_FILE, PATH_GATE & sVersionInfoPath, PATH_HOSHU_LOG & GATE_VERSION_NGLIST_FILE)  'V1.6.0.1Å@ADD
'       If iRet = 1 Then
'          bRet = True
'       Else
'          bRet = False
'          MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
'                 vbOKOnly + vbExclamation, _
'                 TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
'          'V1.6.0.1 ADD START
'           pfSeitouseiChck = False
'           Exit Function
'          'V1.6.0.1 ADD END
'       End If
'       End If 'V1.6.0.1 ADD
'      Next 'V1.6.0.1 ADD
'    End If
''V1.6.0.1 ADD START
'V1.11.0.1 DEL END
    'ã@éÌê≥ìñê´É`ÉFÉbÉN(ëŒè€ÉtÉ@ÉCÉãÅFXX_GATEY.VEFÅ@XX:ÉÜÅ[ÉUÅ[ñºÅ@YÅFÉfÅ[É^éÌï )
'    bRet = fKishuCheck(FolderName(0, FolderSyubetu) & "\")
    sFilePath = sGatePath & FolderName(0, FolderSyubetu)
    
    bRet = fKishuCheck(sFilePath & "\")
    
    If bRet = False Then
       Call pubfuncErrorOccur(MN_FOLD_NOW)         ' EG20 V3.0.0.2í«â¡
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
       'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
       Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
       MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                  vbOKOnly + vbExclamation, _
                  TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
       pfSeitouseiChck = False
       Exit Function
    End If
'V1.6.0.1 ADD END

    pfSeitouseiChck = bRet
Exit Function

FileGetError:
    If iFileNumber > 0 Then
       Close #iFileNumber
    End If
    iFileNumber = 0
    Call pubfuncErrorOccur(MN_FOLD_NOW)         ' EG20 V3.0.0.2í«â¡
    pfSeitouseiChck = False
End Function


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sOldFolderRemove
'//  ã@î\ñºèÃ  : ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãçÌèúèàóù
'//  ã@î\äTóv  : ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sOldFolderRemove() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    Dim sCorner As String                      'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                    'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String                    'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    
   'ñﬂÇËílèâä˙âª
    sOldFolderRemove = True
    
    On Error GoTo ErrorHandler          'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^
    
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner
 
    'Åué¿çsÅvÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
'    gstrMyPath = FolderName(2, FolderSyubetu) & "\"
    gstrMyPath = sGatePath & FolderName(2, FolderSyubetu) & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
'                Kill gstrMyPath & MyName
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
                Kill gstrMyPath & MyName
            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    'ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFãåÉtÉHÉãÉ_Ãß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_OLDFILE_DELETE_ERROR, lngErrCode)

    sOldFolderRemove = False
    
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sNowFolderRemove
'//  ã@î\ñºèÃ  : é¿çsÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãçÌèúèàóù
'//  ã@î\äTóv  : é¿çsÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sNowFolderRemove() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END

    Dim sCorner As String                 'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String               'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String
    On Error GoTo ErrorHandler          'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    'èâä˙ílê›íË
    sNowFolderRemove = True
    
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    sFilePath = sGatePath & FolderName(1, FolderSyubetu)
    
    'Åué¿çsÅvÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
'    gstrMyPath = FolderName(1, FolderSyubetu) & "\"
    gstrMyPath = sFilePath & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'
'                Kill gstrMyPath & MyName        'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
'
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then

                Kill gstrMyPath & MyName        'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ

            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    'ÅuãåÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFé¿çsÉtÉHÉãÉ_Ãß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOWFILE_DELETE_ERROR, lngErrCode)

    sNowFolderRemove = False
    
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sWrkFolderRemove
'//  ã@î\ñºèÃ  : ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãçÌèúèàóù
'//  ã@î\äTóv  : ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-17  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.5.0.1) 2012-03-28  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.6.0.1) 2012-03-28  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.11.0.1) 2012-05-10  CODED BY  [TCC] H.Sugimoto
'//                Åyâ^â¸ï\é¶â¸ëPëŒâûÅz
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sWrkFolderRemove() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    Dim lngPgmHanteiStsWork As Long     'ÉvÉçÉOÉâÉÄîªíËèÛë‘ÅiÉèÅ[ÉNÅj   ' EG20 V3.6.0.1í«â¡
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    Dim sCorner As String               'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String             'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    
    On Error GoTo ErrorHandler          'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    'èâä˙ílê›íË
    sWrkFolderRemove = True
   
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner
  
    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
'    gstrMyPath = FolderName(0, FolderSyubetu) & "\"
    gstrMyPath = sGatePath & FolderName(0, FolderSyubetu) & "\"
    
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
'                Kill gstrMyPath & MyName
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_VERSION_KANRI)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
                Kill gstrMyPath & MyName
            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END

' EG20 V3.6.0.1í«â¡äJén
    'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËàŸèÌèÛë‘ÅiÉèÅ[ÉNÅjÅvÇÃèÛë‘ÇéÊìæÇ∑ÇÈ
    lngPgmHanteiStsWork = pfGetKansiSet(IdKansiSet.PG_HANTEI_ERR_STS_WORK)

    'ÅuÉvÉçÉOÉâÉÄîªíËàŸèÌèÛë‘ÅiÉèÅ[ÉNÅjÅvÅiê≥èÌÅj
    Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_ERR_STS_WORK, ErrCode.Normal)
    
    'ïœâªÇ™Ç†Ç¡ÇΩèÍçáÅAÅuèÛë‘ïœâªí ímÅvÇëóêMÇ∑ÇÈ
    If lngPgmHanteiStsWork <> ErrCode.Normal Then
        Call sSendMailStsChgInf(MailSts.stsNormal, lngPgmHanteiStsWork)
    End If
' EG20 V3.6.0.1í«â¡èIóπ
    
' EG20 V5.11.0.1çÌèúäJén
'' EG20 V5.8.0.1çÌèúäJén
''    ' â^â¸èÛë‘çXêV                                              ' EG20 V5.5.0.1í«â¡
''    Call pubFuncUpdateUnkaiStatus(BOOTINFO_UNKAI_NASHI)         ' EG20 V5.5.0.1í«â¡
'' EG20 V5.8.0.1çÌèúèIóπ
'' EG20 V5.8.0.1í«â¡äJén
'    ' â^â¸èÛë‘çXêV
'    Call pubFuncUpdateUnkaiStatus(BootInfoHoshuType.TYPE_GATE, BOOTINFO_UNKAI_NASHI)
'' EG20 V5.8.0.1í«â¡èIóπ
'    Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_NASHI, iTab_index + 1)   ' EG20 V5.6.0.1í«â¡
' EG20 V5.11.0.1çÌèúèIóπ
' EG20 V5.11.0.1í«â¡äJén
    ' â^â¸èÛë‘çXêV
    Call pubFuncUpdateUnkaiStatus(BootInfoHoshuType.TYPE_GATE, BOOTINFO_UNKAI_CLEAR)
    Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_NASHI, iTab_index + 1, gintUnkaiKind(FolderSyubetu))    ' EG20 V5.11.0.1í«â¡
' EG20 V5.11.0.1í«â¡èIóπ
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ

    'ÅuÉèÅ[ÉNÉNÉäÉAê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "ÇÅA" _
               & Chr(vbKeyReturn) & "ëSÇƒçÌèúÇµÇ‹ÇµÇΩÅB", _
               vbOKOnly + vbExclamation, _
               TitleBox(FolderSyubetu) & "  ÉèÅ[ÉN ÉNÉäÉA"

    Exit Function 'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    Call pubfuncErrorOccur(MN_FOLD_WRK)             ' EG20 V3.6.0.1í«â¡
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
    'ÅuÉèÅ[ÉNÉNÉäÉAàŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbCritical, _
           "ÉèÅ[ÉN ÉNÉäÉA"
           
   'Åué©â¸ ﬁ∞ºﬁÆ›ÅF‹∞∏Ã´Ÿ¿ﬁÃß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_WRKFILE_DELETE_ERROR, lngErrCode)
           
    sWrkFolderRemove = False
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
End Function


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sCopyNOWtoOLD
'//  ã@î\ñºèÃ  : é¿çsÉoÅ[ÉWÉáÉìï€ë∂èàóù
'//  ã@î\äTóv  : é¿çsÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAãåÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sCopyNOWtoOLD() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim sSrcFileName As String          'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãÇÃÉtÉãÉpÉXñº
    Dim sDstFileName As String          'ÉRÉsÅ[êÊÉtÉ@ÉCÉãÇÃÉtÉãÉpÉXñº
    Dim iResponse As Integer            'MsgBoxÉ{É^ÉìÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    Dim sCorner As String                      'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                    'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    
    On Error GoTo ErrorHandler              'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
  
    'ñﬂÇËílèâä˙âª
    sCopyNOWtoOLD = True
   
       ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    'é¿çsÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
'    gstrMyPath = FolderName(1, FolderSyubetu) & "\"
    gstrMyPath = sGatePath & FolderName(1, FolderSyubetu) & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'
'                'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sSrcFileName = gstrMyPath & MyName
'
'                'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sDstFileName = FolderName(2, FolderSyubetu) & "\" & MyName
'
'                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
'                FileCopy sSrcFileName, sDstFileName
'
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑°
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then

                'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
                sSrcFileName = gstrMyPath & MyName

                'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sDstFileName = FolderName(2, FolderSyubetu) & "\" & MyName
                sDstFileName = sGatePath & FolderName(2, FolderSyubetu) & "\" & MyName

                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
                FileCopy sSrcFileName, sDstFileName

            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
           
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
           ' ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
    
    sCopyNOWtoOLD = False
    
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sCopyWRKtoNOW
'//  ã@î\ñºèÃ  : ç≈êVÉoÅ[ÉWÉáÉìÉRÉsÅ[
'//  ã@î\äTóv  : ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅiPASSINFÉRÉsÅ[ëŒâûÅj
'//     REVISIONS :(EG20 V3.5.0.1) 2012-02-07  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sCopyWRKtoNOW() As Boolean
    
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim sSrcFileName As String      'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãñº
    Dim sDstFileName As String      'ÉRÉsÅ[êÊÉtÉ@ÉCÉãñº
    Dim bError As Boolean           'ÉtÉâÉO
    Dim bRet As Boolean             'ñﬂÇËíl
    
    Dim sCorner As String                'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String              'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^
  
    'ñﬂÇËílèâä˙âª
    sCopyWRKtoNOW = True
    
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    '****************************
    '* ÉtÉ@ÉCÉãÉäÉXÉgÇÉRÉsÅ[Ç∑ÇÈ *
    '****************************
      
'    sSrcFileName = FolderName(0, FolderSyubetu) & "\" & MN_FILELIST
    sSrcFileName = sGatePath & FolderName(0, FolderSyubetu) & "\" & MN_FILELIST
                                    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'    sDstFileName = FolderName(1, FolderSyubetu) & "\" & MN_FILELIST
    sDstFileName = sGatePath & FolderName(1, FolderSyubetu) & "\" & MN_FILELIST
                                    'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 DEL
    If objFso.FileExists(sSrcFileName) = True Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
        'ÉtÉ@ÉCÉãÉäÉXÉgÇÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        FileCopy sSrcFileName, sDstFileName
    Else                                'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
     'ÅuÉèÅ[ÉNÉtÉHÉãÉ_ÉtÉ@ÉCÉãÉäÉXÉgÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
             & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
             vbOKOnly + vbExclamation, _
             TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
     sCopyWRKtoNOW = False
     Set objFso = Nothing    'V1.20.0.1 ADD
     Exit Function                   'èàóùÇèIóπÇ∑ÇÈ
    End If

    bError = False                  'ÉGÉâÅ[ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To UBound(FileList) - 1
                                    'ÉtÉ@ÉCÉãÉäÉXÉgàÍóóêîï™åJÇËï‘Ç∑
'        sSrcFileName = FolderName(0, FolderSyubetu) & "\" & FileList(i)
        sSrcFileName = sGatePath & FolderName(0, FolderSyubetu) & "\" & FileList(i)
                                    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'        sDstFileName = FolderName(1, FolderSyubetu) & "\" & FileList(i)
        sDstFileName = sGatePath & FolderName(1, FolderSyubetu) & "\" & FileList(i)
                                    'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ

        'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 DEL
        If objFso.FileExists(sSrcFileName) = True Then   'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
            'ÉtÉ@ÉCÉãÇÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
            FileCopy sSrcFileName, sDstFileName
        End If
    Next
    
    Set objFso = Nothing    'V1.20.0.1 ADD
    
' EG20 V3.0.0.2í«â¡äJén
    If pfuncCopyPASSINF(iTab_index, MN_FOLD_WRK) = False Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
' EG20 V3.5.0.1í«â¡äJén
        MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                vbOKOnly + vbExclamation, _
                TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
' EG20 V3.5.0.1í«â¡èIóπ
        sCopyWRKtoNOW = False
    End If
' EG20 V3.0.0.2í«â¡èIóπ
    
    Exit Function                           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    'ÉGÉâÅ[Ç™î≠ê∂Ç∑ÇÍÇŒÅAÉ_ÉCÉAÉçÉOÇèoÇ∑ÇÊÇ§Ç…Ç∑ÇÈÅBÅiÉGÉâÅ[ÉRÅ[ÉhÇ…Ç©Ç©ÇÌÇÁÇ∏Åj
    'Select Case Err.Number
    '    Case 53 'ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
            
            sCopyWRKtoNOW = False
            Set objFso = Nothing    'V1.20.0.1 ADD
            Exit Function
    '    Case Else
                ' ëºÇÃÉGÉâÅ[èàóùÇÇ±Ç±Ç…ãLèqÇµÇ‹Ç∑ÅB
    'End Select
    sCopyWRKtoNOW = False
    Set objFso = Nothing    'V1.20.0.1 ADD
End Function
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fDataFileCheck
'//  ã@î\ñºèÃ  : é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ëŒè€Ç∆Ç»ÇÈHAN_KUKA.KUKóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-23  CODED   BY [TCC] D.Yamashita
'//                 ÅEÉtÉFÅ[ÉYÇRécåèçÄñ⁄ëŒâûÅ@àŸèÌéûÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fDataFileCheck(sFileList As String) As Boolean
    Dim iFileNumber As Integer      'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String         'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer         'ÉtÉ@ÉCÉãäiî[êî
    Dim sFolderPath As String       'HAN_KUKA.KUKÉtÉHÉãÉ_ÉpÉXóp
    Dim sHANKUKAPath As String      'HAN_KUKA.KUKÉtÉãÉpÉXóp
     
    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË

    iListCnt = 0
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)

    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open sFileList For Input Access Read As #iFileNumber    'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
    Do While Not EOF(iFileNumber)                           'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
        Line Input #iFileNumber, sFileName                  'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
        If sFileName <> "" And Left$(sFileName, 1) <> "/" Then                'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
            iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
            ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
            FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 16)
                                                            'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
            If HANKUKA_KUK = FileList(iListCnt - 1) Then
               'HAN_KUKA.KUKÉtÉ@ÉCÉãÇ™óLÇ¡ÇΩèÍçáÅAÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNÇçsÇ§ÅB
               psFolderPathGet sFileList, sFolderPath
               sHANKUKAPath = sFolderPath & HANKUKA_KUK
               If fHankukaChck(sHANKUKAPath) = False Then
                 'ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌéûÇÕÅAñﬂÇËílÇ…FalseÇê›íËÇ∑ÇÈÅB
                  fDataFileCheck = False
                  Close #iFileNumber        'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB   'V1.11.0.1 ADD
                  Exit Function
               End If
            End If
        End If
  Loop
  
  Close #iFileNumber        'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB

  fDataFileCheck = True     'ñﬂÇËílÇê≥èÌÇ∆Ç∑ÇÈ

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:               ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    fDataFileCheck = False  'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fKishuCheck
'//  ã@î\ñºèÃ  : é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ëŒè€Ç∆Ç»ÇÈÉfÅ[É^ÇÃã@éÌê≥ìñê´É`ÉFÉbÉNÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.6.0.1) 2009-06-16   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃã@éÌê≥ìñê´É`ÉFÉbÉNïœçX
'//                Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fKishuCheck(sFileList As String) As Boolean
    Dim sKisyu       As String * 8     'éÊìæã@éÌñº
    Dim sMyName      As String         'ã@éÌê≥ìñê´É`ÉFÉbÉNÉäÉXÉgÉtÉ@ÉCÉãñº
    Dim sFileName    As String         'ÉtÉ@ÉCÉãÉäÉXÉgãLç⁄ÉtÉ@ÉCÉãñº
    Dim sChkFileName As String         'ã@éÌê≥ìñê´É`ÉFÉbÉNÉtÉ@ÉCÉãÉpÉX
    Dim sVerChkFile  As String         'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñº
    
    Dim lLen         As Long           'ÉtÉ@ÉCÉãÉTÉCÉY
    Dim lPos         As Long           'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
           
    Dim i            As Integer        'ÉJÉEÉìÉ^Å[
    Dim iCnt         As Integer        'ìoò^ÉåÉRÅ[Éhêî
    Dim iListCnt     As Integer        'ÉtÉ@ÉCÉãäiî[êî
    Dim iFileNumber  As Integer        'ÉtÉ@ÉCÉãî‘çÜ

    Dim bRet         As Boolean        'ã@éÌê≥ìñê´É`ÉFÉbÉNåãâ 

    Dim uHeder       As MN_HEDER       'ÉwÉbÉ_èÓïÒäiî[ÉGÉäÉA
    Dim uFotter      As MN_FOOT        'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
    
    Dim sChkData As String             'î‰ärï∂éöíäèo    'V1.20.0.1 ADD
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
     
    'èâä˙âª
    iCnt = 0
    iListCnt = 0
    iFileNumber = 0
    fKishuCheck = False
        
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)
    
    'ÉoÅ[ÉWÉáÉìÉfÅ[É^(ã@éÌê≥ìñê´É`ÉFÉbÉNÉäÉXÉgÉtÉ@ÉCÉãÉpÉX)çÏê¨
    sVerChkFile = fSelectFile
    
    'ÉtÉ@ÉCÉãñºéÊìæïsâ¬=ã@éÌê≥ìñê´É`ÉFÉbÉNÉtÉ@ÉCÉãÇ»Çµ
    If sVerChkFile = "" Then
       'ê≥ìñê´É`ÉFÉbÉNÇçsÇ§ïKóvÇ»Ç¢ÇΩÇﬂÅAê≥èÌÇï‘Ç∑ÅB
       fKishuCheck = True
       Set objFso = Nothing    'V1.20.0.1 ADD
       Exit Function
    End If
    
    sMyName = sFileList & sVerChkFile
    
    'If Dir(sMyName) <> "" Then              'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?     'V1.20.0.1 DEL
    If objFso.FileExists(sMyName) = True Then    'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?  'V1.20.0.1 ADD
       
       iFileNumber = FreeFile               'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
       
       Open sMyName For Input Access Read As #iFileNumber     'ÉoÅ[ÉWÉáÉìÉfÅ[É^ÇÃÉIÅ[ÉvÉì
       
       'ÉfÅ[É^ì«Ç›çûÇ›
       Line Input #iFileNumber, sFileName
          
       'ì«Ç›çûÇ›ÉfÅ[É^ÇÊÇËÅAÉwÉbÉ_ïîÇèúÇ≠ÅB
       sFileName = Mid(sFileName, Len(uHeder) - 3)
       
       'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
       Do While Not EOF(iFileNumber)
          
          'ì«Ç›çûÇ›ÅB
          Line Input #iFileNumber, sFileName
           
           'éÊìæèÓïÒÇ™Åu/Åvà»ç~ÇÃÉRÉÅÉìÉgÇ»ÇÁëŒè€äOÅB
           'ÉfÅ[É^ïîñ{ï∂à»äOÇ»ÇÁëŒè€äO
           'ÉfÅ[É^ïîñ{ï∂ÇÃÇ›ÇÃèÍçáÇÃÇ›ÅAÉtÉ@ÉCÉãñºéÊìæÇçsÇ§ÅB
           If sFileName <> "" And Left$(sFileName, 1) <> "/" _
                              And " " = Mid(sFileName, 2, 1) Then   'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
              iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
              ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
              ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
              'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
              FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
              FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 12)
              'ìoò^ÉåÉRÅ[ÉhêîÇÉJÉEÉìÉg
              iCnt = iCnt + 1
            End If
       Loop
       
       Close #iFileNumber                                     'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
       iFileNumber = 0
    Else
       'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçáÅFê≥ìñê´É`ÉFÉbÉNÇçsÇÌÇ»Ç¢ÅB
       fKishuCheck = True
       Set objFso = Nothing    'V1.20.0.1 ADD
       Exit Function
    End If
    
    'V1.20.0.1 ADD  START
    If iCnt = 0 Then
       'ÉtÉ@ÉCÉãÉäÉXÉgÉRÅ[ÉhÇ™ë∂ç›ÇµÇ»Ç¢èÍçáÅFê≥ìñê´É`ÉFÉbÉNÇçsÇÌÇ»Ç¢ÅB
       fKishuCheck = True
       Set objFso = Nothing    'V1.20.0.1 ADD
       Exit Function
    End If
    'V1.20.0.1 ADD  END
    
    'ÉtÉ@ÉCÉãã@éÌê≥ìñê´É`ÉFÉbÉNÇçsÇ§ÅB
    For i = 0 To iCnt - 1
         'É`ÉFÉbÉNëŒè€ÉtÉ@ÉCÉãÉpÉXçÏê¨
        sChkFileName = sFileList & FileList(i)
    
        'If Dir(sChkFileName) <> "" Then              'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?  'V1.20.0.1 DEL
        If objFso.FileExists(sChkFileName) = True Then  'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?   'V1.20.0.1 ADD
            
            lLen = FileLen(sChkFileName)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ

            iFileNumber = FreeFile                   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
            'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉìÇçsÇ§ÅB
            Open sChkFileName For Binary Access Read As #iFileNumber
            'ÉtÉbÉ^èÓïÒÇÃéÊìæ
            Get #iFileNumber, lLen - Len(uFotter) + 1, uFotter
            
            Close #iFileNumber                       'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
            iFileNumber = 0
            
            'ã@éÌñºÉZÉbÉg
            sKisyu = uFotter.sKisyu
            
            sChkData = "" 'èâä˙âªÅ@'V1.20.0.1 ADD
            
' EG20 V3.0.0.2 í«â¡äJén
            'ï∂éöíäèo
            'sChkData = Left(sKisyu, Len(EG20_JIKAI_KISHU))     'EG20 V30.1.0.1 DEL
            sChkData = Left(sKisyu, Len(EG30_JIKAI_KISHU))      'EG20 V30.1.0.1 ADD
            'If EG20_JIKAI_KISHU = sChkData Then            'EG20 V30.1.0.1 DEL
            If EG30_JIKAI_KISHU = sChkData Then             'EG20 V30.1.0.1 ADD
                bRet = True  'ã@éÌê≥ìñê´ÅFê≥èÌ
            Else
                bRet = False 'ã@éÌê≥ìñê´ÅFàŸèÌ
                fKishuCheck = bRet
                Set objFso = Nothing    'V1.20.0.1 ADD
                Exit Function
            End If
' EG20 V3.0.0.2 í«â¡èIóπ
            
' EG20 V3.0.0.2 çÌèúäJén
'            'é©â¸É`ÉFÉbÉN
'            If gStrCurrentForm = sFormName_EJVer Then
'               'EG-Ré©â¸éû
'               'If EGR_JIKAI_KISHU = Trim(sKisyu) Then  'V1.20.0.1 DEL
'               'V1.20.0.1 ADD START
'               'ï∂éöíäèo
'               sChkData = Left(sKisyu, Len(EGR_JIKAI_KISHU))
'               If EGR_JIKAI_KISHU = sChkData Then
'               'V1.20.0.1 ADD END
'                   bRet = True  'ã@éÌê≥ìñê´ÅFê≥èÌ
'               Else
'                   bRet = False 'ã@éÌê≥ìñê´ÅFàŸèÌ
'                   fKishuCheck = bRet
'                   Set objFso = Nothing    'V1.20.0.1 ADD
'                   Exit Function
'               End If
'            Else
'               'NEGé©â¸éû
'               'If NEG_JIKAI_KISHU = Trim(sKisyu) Then    'V1.20.0.1 DEL
'               'V1.20.0.1 ADD START
'               'ï∂éöíäèo
'               sChkData = Left(sKisyu, Len(NEG_JIKAI_KISHU))
'               If NEG_JIKAI_KISHU = sChkData Then
'               'V1.20.0.1 ADD END
'                   bRet = True  'ã@éÌê≥ìñê´ÅFê≥èÌ
'               Else
'                   bRet = False 'ã@éÌê≥ìñê´ÅFàŸèÌ
'                   fKishuCheck = bRet
'                   Set objFso = Nothing    'V1.20.0.1 ADD
'                   Exit Function
'               End If
'            End If
' EG20 V3.0.0.2 çÌèúèIóπ

        End If
    Next

  fKishuCheck = bRet
  
  Set objFso = Nothing    'V1.20.0.1 ADD
  
 Exit Function

ErrorHandler:
   If iFileNumber <> 0 Then
       Close #iFileNumber                                     'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
   End If
    
   'ñﬂÇËílÇàŸèÌÇ∆Ç∑ÇÈ
   fKishuCheck = False
       
   Set objFso = Nothing    'V1.20.0.1 ADD

End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fHankukaChck
'//  ã@î\ñºèÃ  : HAN_KUKA.KUKê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ëŒè€Ç∆Ç»ÇÈHAN_KUKA.KUKÇÃì‡óeÇÉ`ÉFÉbÉNÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-04-06   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(1.16.0.1) 2009-12-21   REVISED BY [TCC] S.Terao
'//                 ïsãÔçáëŒâû
'//     REVISIONS :(V2.5.0.1) 2010-10-29  REVISED BY [TCC] S.Terao
'//                 EG-R(KK)Å@î™íöìÎëŒâûÅ@KUKê≥ìñê´É`ÉFÉbÉNïœçX
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fHankukaChck(sFilePath As String) As Boolean
    Dim iFileNumber As Integer           'ÉtÉ@ÉCÉãî‘çÜ
    Dim i As Integer
    Dim lSts As Long
    Dim sKeyName As String
    Dim lPos As Long                     'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
    Dim lLen As Long                     'ÉtÉ@ÉCÉãÉTÉCÉY
    'Dim uFooter As MN_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA      'EG20 V30.1.0.1 DEL
    Dim uFooter As MN_KAN_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA   'EG20 V30.1.0.1 ADD
'    Dim uHeder As MN_FOOT           'ÉwÉbÉ_èÓïÒäiî[ÉGÉäÉA     'V1.4.0.1 DEL
    Dim sDateTime As String
    Dim j As Integer
    Dim lngErrCode As Long          'ÉGÉâÅ[ÉRÅ[Éh
    'V1.4.0.1 ADD START
    Dim uHeder As HAN_KUKA_KUK_HEADER       'ÉwÉbÉ_èÓïÒäiî[ÉGÉäÉA
    Dim sGetInfo As String * MAX_PATH_SIZE  'INIÉtÉ@ÉCÉãéÊìæóp
    Dim sChkFileData As String
    Dim iMojisu As Integer
    
    'V1.16.0.1 ADD Start
    Dim bChkSts As Boolean              'É`ÉFÉbÉNåãâ ÉtÉâÉO
    Dim sChkData As String              'î‰ärï∂éöíäèo
    'V1.16.0.1 ADD End
    
   'èâä˙âªÅFê≥èÌ(ÉuÉâÉìÉNÅj
    sNGSts = ""
    sNGKoumoku = ""
    'V1.4.0.1 ADD END
    Dim oFs As New FileSystemObject 'V2.5.0.1 ADD
    
    fHankukaChck = False
    
'V2.5.0.1 ADD START
 'ÉtÉ@ÉCÉãóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
 If oFs.FileExists(sFilePath) = False Then
    'ÉtÉ@ÉCÉãÇ™ñ≥ÇØÇÍÇŒê≥ìñê´É`ÉFÉbÉNÇçsÇÌÇ»Ç¢ÅB
    fHankukaChck = True
    Set oFs = Nothing
    Exit Function
 End If
'V2.5.0.1 ADD END

 'V1.4.0.1 DEL START
'   For i = 0 To INI_MAX
'      'ÉwÉbÉ_ÅFä˙ë“ílã@éÌñºéÊìæ
'      sKeyName = Format(HEDER_KISHU_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sHederKisyu(i), _
'                                     Len(HAN_KUKA_DATA.sHederKisyu(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'      'ÉwÉbÉ_ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
'      sKeyName = Format(HEDER_FILE_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sHederFile(i), _
'                                     Len(HAN_KUKA_DATA.sHederFile(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'      'ÉtÉbÉ^ÅFä˙ë“ílã@éÌñºéÊìæ
'      sKeyName = Format(FOTTER_KISHU_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sFotterKisyu(i), _
'                                     Len(HAN_KUKA_DATA.sFotterKisyu(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'      'ÉtÉbÉ^ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
'      sKeyName = Format(FOTTER_FILE_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sFotterFile(i), _
'                                     Len(HAN_KUKA_DATA.sFotterFile(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'    Next i
    'V1.4.0.1 DEL END
    'V1.4.0.1 ADD START
    'èâä˙âª
    For i = 0 To INI_MAX - 1
        HAN_KUKA_DATA.sHederKisyu(i) = ""
        HAN_KUKA_DATA.sHederFile(i) = ""
        HAN_KUKA_DATA.sFotterKisyu(i) = ""
        HAN_KUKA_DATA.sFotterFile(i) = ""
    Next
    For i = 0 To INI_MAX - 1
      'ÉwÉbÉ_ÅFä˙ë“ílã@éÌñºéÊìæ
      sKeyName = Format(HEDER_KISHU_NAME & "0" & i + 1)
      'EG20 V30.1.0.1 DEL START
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     sGetInfo, _
'                                     Len(sGetInfo), _
'                                     GATE_HANTEI_CHK_FILE)
      'EG20 V30.1.0.1 DEL END
      'EG20 V30.1.0.1 ADD START
      lSts = GetPrivateProfileString(EG30_HANTEI_CHK, _
                                     sKeyName, _
                                     "", _
                                     sGetInfo, _
                                     Len(sGetInfo), _
                                     GATE_HANTEI_CHK_FILE)
      'EG20 V30.1.0.1 ADD END
      If lSts = False Then
       
      Else
        HAN_KUKA_DATA.sHederKisyu(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
      End If
      'ÉwÉbÉ_ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
      sKeyName = Format(HEDER_FILE_NAME & "0" & i + 1)
      'EG20 V30.1.0.1 DEL START
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     sGetInfo, _
'                                     Len(sGetInfo), _
'                                     GATE_HANTEI_CHK_FILE)
      'EG20 V30.1.0.1 DEL END
      'EG20 V30.1.0.1 ADD START
      lSts = GetPrivateProfileString(EG30_HANTEI_CHK, _
                                     sKeyName, _
                                     "", _
                                     sGetInfo, _
                                     Len(sGetInfo), _
                                     GATE_HANTEI_CHK_FILE)
      'EG20 V30.1.0.1 ADD END
      If lSts = False Then
        
      Else
         HAN_KUKA_DATA.sHederFile(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
      End If
      'EG20 V30.1.0.1 DEL STARTÅiêVä≤ê¸ÇÕÉtÉbÉ^ñ≥ÇµÅj
'      'ÉtÉbÉ^ÅFä˙ë“ílã@éÌñºéÊìæ
'      ÉtÉbÉ^ÇÕÇ»Çµ
'      sKeyName = Format(FOTTER_KISHU_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     sGetInfo, _
'                                     Len(sGetInfo), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'
'      Else
'        HAN_KUKA_DATA.sFotterKisyu(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
'      End If
'      'ÉtÉbÉ^ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
'      ÉtÉbÉ^ÇÕñ≥Çµ
'      sKeyName = Format(FOTTER_FILE_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     sGetInfo, _
'                                     Len(sGetInfo), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'
'      Else
'        HAN_KUKA_DATA.sFotterFile(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
'      End If
      'EG20 V30.1.0.1 DEL END
    Next i
    'V1.4.0.1 ADD END

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
    
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÉTÉCÉYéÊìæ
    lLen = FileLen(sFilePath)
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
    iFileNumber = FreeFile
    
    'V1.4.0.1 DEL START
'    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
'    Open sFilePath For Input Access Read As #iFileNumber
'
'    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÃÉwÉbÉ_èÓïÒÇéÊìæÇ∑ÇÈÅB
''    Get #iFileNumber, 1, uHeder
    'V1.4.0.1 DEL END

    'V1.4.0.1 ADD START
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
    Open sFilePath For Binary Access Read As #iFileNumber
            
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÃÉwÉbÉ_èÓïÒÇéÊìæÇ∑ÇÈÅB
    Get #iFileNumber, 1, uHeder
    'V1.4.0.1 ADD END

   'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÃÉtÉbÉ^èÓïÒÇéÊìæÇ∑ÇÈÅB
    Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter

    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    Close #iFileNumber
    
    iFileNumber = 0                          'V1.4.0.1 ADD
'V1.4.0.1 DEL START
    'ã@éÌñº/ÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'    For i = 0 To 5
'       'ÉwÉbÉ_èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
'       If uHeder.sKisyu <> HAN_KUKA_DATA.sHederKisyu(i) Then
'          Exit Function
'       End If
'       'ÉwÉbÉ_èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'       If uHeder.sFileName <> HAN_KUKA_DATA.sHederFile(i) Then
'          Exit Function
'       End If
'       'ÉtÉbÉ^èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
'       If uFooter.sKisyu <> HAN_KUKA_DATA.sFotterKisyu(i) Then
'          Exit Function
'       End If
'       'ÉtÉbÉ^èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'       If uFooter.sFileName <> HAN_KUKA_DATA.sFotterFile(i) Then
'          Exit Function
'       End If
'     Next
'V1.4.0.1 DEL END
   'V1.4.0.1 ADD START
   'ÉwÉbÉ_èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
   iMojisu = InStr(uHeder.sKisyuName, " ") - 1
   If iMojisu < 0 Then
     sChkFileData = Mid(uHeder.sKisyuName, 1)
   Else
     sChkFileData = Mid(uHeder.sKisyuName, 1, iMojisu)
   End If
'V1.16.0.1 DEL START
'    For i = 0 To INI_MAX - 1
'      If sChkFileData <> HAN_KUKA_DATA.sHederKisyu(i) Then
'         If i = INI_MAX - 1 Then
'            'ã@éÌñºä˙ë“ílëSïsàÍívÅF
'            sNGSts = ERROR_HEDER
'            sNGKoumoku = KISHU_NAME_ERROR
'            GoTo ErrorHandler
'         End If
'      Else
'        Exit For
'      End If
'    Next
'V1.16.0.1 DEL END
'V1.16.0.1 ADD START
    bChkSts = False
    For i = 0 To INI_MAX - 1
       If HAN_KUKA_DATA.sHederKisyu(i) <> "" Then
          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sHederKisyu(i)))
          If sChkData = HAN_KUKA_DATA.sHederKisyu(i) Then
             bChkSts = True
           Exit For
          End If
      End If
    Next
    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
    If bChkSts = False Then
       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
        sNGSts = ERROR_HEDER
        sNGKoumoku = KISHU_NAME_ERROR
         GoTo ErrorHandler
    End If
'V1.16.0.1 ADD END

   'ÉwÉbÉ_èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
   iMojisu = InStr(uHeder.sProgrumName, " ") - 1
   If iMojisu < 0 Then
     sChkFileData = Mid(uHeder.sProgrumName, 1)
   Else
     sChkFileData = Mid(uHeder.sProgrumName, 1, iMojisu)
   End If

'V1.16.0.1 DEL START
'   For i = 0 To INI_MAX - 1
'       If sChkFileData <> HAN_KUKA_DATA.sHederFile(i) Then
'         If i = INI_MAX - 1 Then
'            'ÉtÉ@ÉCÉãñºä˙ë“ílëSïsàÍívÅF
'            sNGSts = ERROR_HEDER
'            sNGKoumoku = FILE_NAME_ERRORE
'            GoTo ErrorHandler
'         End If
'      Else
'         Exit For
'      End If
'    Next
'V1.16.0.1 DEL END
'V1.16.0.1 ADD START
    bChkSts = False
    For i = 0 To INI_MAX - 1
       If HAN_KUKA_DATA.sHederFile(i) <> "" Then
          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sHederFile(i)))
          If sChkData = HAN_KUKA_DATA.sHederFile(i) Then
             bChkSts = True
           Exit For
          End If
      End If
    Next
    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
    If bChkSts = False Then
       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
        sNGSts = ERROR_HEDER
        sNGKoumoku = FILE_NAME_ERRORE
         GoTo ErrorHandler
    End If
'V1.16.0.1 ADD END
    
   'çÏê¨ì˙ïtÉ`ÉFÉbÉN
   'ÉwÉbÉ_èÓïÒÅFçÏê¨ì˙ïtÇ™êîílÇ©Ç«Ç§Ç©
    sDateTime = ""
    For j = 0 To 3
        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
    Next
    For j = 4 To 5
        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
    Next
    If IsNumeric(sDateTime) = False Then
       sNGSts = ERROR_HEDER
       sNGKoumoku = CREATE_DATA_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    
    'ÉoÅ[ÉWÉáÉìêîílÉ`ÉFÉbÉN
    If IsNumeric(uHeder.sVersion) = False Then
       sNGSts = ERROR_HEDER
       sNGKoumoku = VERSION_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    
   'EG20 V30.1.0.1 DEL START êVä≤ê¸Ç≈ÇÕÉtÉbÉ^èÓïÒÇ…ã@éÌñºÅAÉfÅ[É^ñºÇÕë∂ç›ÇµÇ»Ç¢ÅB
'   'ÉtÉbÉ^èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
'   iMojisu = InStr(uFooter.sKisyu, " ") - 1
'   If iMojisu < 0 Then
'     sChkFileData = Mid(uFooter.sKisyu, 1)
'   Else
'     sChkFileData = Mid(uFooter.sKisyu, 1, iMojisu)
'   End If
''V1.16.0.1 DEL START
''    For i = 0 To INI_MAX - 1
''      If sChkFileData <> HAN_KUKA_DATA.sFotterKisyu(i) Then
''         If i = INI_MAX - 1 Then
''             'ã@éÌñºä˙ë“ílëSïsàÍívÅF
''             sNGSts = ERROR_FOTTER
''             sNGKoumoku = KISHU_NAME_ERROR
''             GoTo ErrorHandler
''          End If
''       Else
''         Exit For
''       End If
''    Next
''V1.16.0.1 DEL END
''V1.16.0.1 ADD START
'   bChkSts = False
'    For i = 0 To INI_MAX - 1
'       If HAN_KUKA_DATA.sFotterKisyu(i) <> "" Then
'          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sFotterKisyu(i)))
'          If sChkData = HAN_KUKA_DATA.sFotterKisyu(i) Then
'             bChkSts = True
'           Exit For
'          End If
'      End If
'    Next
'    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
'    If bChkSts = False Then
'       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
'        sNGSts = ERROR_FOTTER
'        sNGKoumoku = KISHU_NAME_ERROR
'         GoTo ErrorHandler
'    End If
''V1.16.0.1 ADD END
'
'   'ÉtÉbÉ^èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'   iMojisu = InStr(uFooter.sFileName, " ") - 1
'   If iMojisu < 0 Then
'     sChkFileData = Mid(uFooter.sFileName, 1)
'   Else
'     sChkFileData = Mid(uFooter.sFileName, 1, iMojisu)
'   End If
''V1.16.0.1 DEL START
''    For i = 0 To INI_MAX - 1
''       If sChkFileData <> HAN_KUKA_DATA.sFotterFile(i) Then
''          If i = INI_MAX - 1 Then
''             'ã@éÌñºä˙ë“ílëSïsàÍívÅF
''             sNGSts = ERROR_FOTTER
''             sNGKoumoku = FILE_NAME_ERRORE
''             GoTo ErrorHandler
''          End If
''       Else
''         Exit For
''       End If
''    Next
''   'V1.4.0.1 ADD END
''V1.16.0.1 DEL END
''V1.16.0.1 ADD START
'   bChkSts = False
'    For i = 0 To INI_MAX - 1
'       If HAN_KUKA_DATA.sFotterFile(i) <> "" Then
'          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sFotterFile(i)))
'          If sChkData = HAN_KUKA_DATA.sFotterFile(i) Then
'             bChkSts = True
'           Exit For
'          End If
'      End If
'    Next
'    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
'    If bChkSts = False Then
'       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
'        sNGSts = ERROR_FOTTER
'        sNGKoumoku = FILE_NAME_ERRORE
'         GoTo ErrorHandler
'    End If
''V1.16.0.1 ADD END
    'EG20 V30.1.0.1 DEL END

'V1.4.0.1 DEL START
'   'çÏê¨ì˙ïtÉ`ÉFÉbÉN
'   'ÉwÉbÉ_èÓïÒÅFçÏê¨ì˙ïtÇ™êîílÇ©Ç«Ç§Ç©
'    sDateTime = ""
'    For j = 0 To 3
'        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
'    Next
'    sDateTime = sDateTime & " "
'    For j = 4 To 5
'        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
'    Next
'    If (Chr(sDateTime) >= "A" And Chr(sDateTime) <= "Z") And _
'        (Chr(sDateTime) >= "a" And Chr(sDateTime) <= "z") Then
'         Exit Function
'    End If
'V1.4.0.1 DEL END
      
    'ÉtÉbÉ^èÓïÒÅFçÏê¨ì˙ïtÇ™êîílÇ©Ç«Ç§Ç©
     sDateTime = ""
     For j = 0 To 3
         sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
     Next
    'sDateTime = sDateTime & " " 'V1.4.0.1 DEL
     For j = 4 To 5
        sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
    Next
    'V1.4.0.1 DEL START
'    If (Chr(sDateTime) >= "A" And Chr(sDateTime) <= "Z") And _
'       (Chr(sDateTime) >= "a" And Chr(sDateTime) <= "z") Then
'        Exit Function
'    End If
    'V1.4.0.1 DEL END
    
    'V1.4.0.1 ADD START
    If IsNumeric(sDateTime) = False Then
       sNGSts = ERROR_FOTTER
       sNGKoumoku = CREATE_DATA_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    'V1.4.0.1 ADD END
    'V1.4.0.1 DEL START
'      'ÉoÅ[ÉWÉáÉìílÉ`ÉFÉbÉN
'    'ÉwÉbÉ_èÓïÒÅFÉoÅ[ÉWÉáÉìílÇ™êîílÇ©Ç«Ç§Ç©
'    If (Chr(uHeder.sVersion) >= "A" And Chr(uHeder.sVersion) <= "Z") And _
'        (Chr(uHeder.sVersion) >= "a" And Chr(uHeder.sVersion) <= "z") Then
'        Exit Function
'    End If
'
'    'ÉtÉbÉ^èÓïÒÅFÉoÅ[ÉWÉáÉìílÇ™êîílÇ©Ç«Ç§Ç©
'    If (Chr(uFooter.sVersion) >= "A" And Chr(uFooter.sVersion) <= "Z") And _
'       (Chr(uFooter.sVersion) >= "a" And Chr(uFooter.sVersion) <= "z") Then
'        Exit Function
'    End If
    'V1.4.0.1 DEL END
    
    'EG20 V30.1.0.1 DEL START êVä≤ê¸ÇÃÉtÉbÉ^èÓïÒÇ…ÇÕÉoÅ[ÉWÉáÉìÇÕë∂ç›ÇµÇ»Ç¢
'    'V1.4.0.1 ADD START
'    'ÉoÅ[ÉWÉáÉìílÉ`ÉFÉbÉN
'    'ÉtÉbÉ^èÓïÒÅFÉoÅ[ÉWÉáÉìílÇ™êîílÇ©Ç«Ç§Ç©
'    If IsNumeric(uFooter.sVersion) = False Then
'       sNGSts = ERROR_FOTTER
'       sNGKoumoku = VERSION_ERROR
'       GoTo ErrorHandler
'       Exit Function
'    End If
'    'V1.4.0.1 ADD END
    'EG20 V30.1.0.1 DEL END
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFê≥ìñÉ`ÉFÉbÉNê≥èÌÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_FILESTS_OK, 0)
    
    'Ç∑Ç◊ÇƒOKÇÃèÍçáÅATRUEÇ≈Ç©Ç¶ÇÈÅB
    fHankukaChck = True

Exit Function 'V1.4.0.1 ADD
'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'V1.4.0.1 ADD START
    If iFileNumber > 0 Then
       'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
       Close #iFileNumber
    End If
    iFileNumber = 0
    'V1.4.0.1 ADD END
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFê≥ìñÉ`ÉFÉbÉNàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
   ' Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_FILESTS_OK, 0) 'V1.4.0.1 DEL
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILESTS_ERROR, lngErrCode)  'V1.4.0.1 ADD
    fHankukaChck = False   'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    'Close #iFileNumber                        'V1.4.0.1 DEL
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fOldVersion
'//  ã@î\ñºèÃ  : ãåÉoÅ[ÉWÉáÉìèàóù
'//  ã@î\äTóv  : àÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇé¿çs(é¿çs)ÉoÅ[ÉWÉáÉìÇ…ï‘Ç∑ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.6.0.1) 2009-06-29   REVISED BY [TCC] S.Terao
'//                ÉtÉFÅ[ÉYÇRëŒâûÅ@ä«óùÇ÷ÇÃÉÅÅ[ÉãëóêMèàóùÇÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[ÅvéûÇ…Ç†ÇÌÇπÇΩ
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V3.6.0.1) 2012-02-18  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.6.0.1) 2012-03-28  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.11.0.1) 2012-05-10  CODED BY  [TCC] H.Sugimoto
'//                Åyâ^â¸ï\é¶â¸ëPëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fOldVersion() As Boolean
    Dim bRet As Boolean                     'ñﬂÇËíl
    Dim lngCnt                  As Long     'ÉJÉEÉìÉ^Å[
    Dim sSrcFileName            As String   'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãÉäÉXÉg
    Dim lngSumRet               As Long
    Dim lngErrCode              As Long     'ÉGÉâÅ[ÉRÅ[Éh
    Dim iKansiAplChk As Integer              'ÉAÉvÉäãNìÆÉ`ÉFÉbÉNñﬂÇËílÅ@'V1.6.0.1 ADD

    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    Dim sCorner As String                      'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                    'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String                    'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    
    On Error Resume Next
 
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

   'ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÉäÉXÉgÇåüçıÇ∑ÇÈÅB
'    sSrcFileName = FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST
    sSrcFileName = sGatePath & FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST
                                    'ÅuãåÅvÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ  'V1.20.0.1 DEL
    'V1.20.0.1 ADD START
    If objFso.FileExists(sSrcFileName) = True Then
        Set objFso = Nothing
    'V1.20.0.1 ADD END
    Else                                'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
        
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉtÉ@ÉCÉãÉäÉXÉgñ≥ÇµÅvÉçÉOèoóÕ
        lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOTFOUND_FILELIST, lngErrCode)
 
        fOldVersion = False
        Set objFso = Nothing    'V1.20.0.1 ADD
        Exit Function                   'èàóùÇèIóπÇ∑ÇÈ
    End If
    
    '¢ãå£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    sFilePath = sGatePath & FolderName(MN_FOLD_OLD, FolderSyubetu)

'    bRet = fReadFileList(FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST)
    bRet = fReadFileList(sFilePath & "\" & MN_FILELIST)
  
' EG20 V3.6.0.1 ÅyìùçáTR-No.260Åzí«â¡äJén
    bRet = fDataFileCheck(sFilePath & "\" & MN_FILELIST)
    If bRet = False Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
       
       If sNGSts <> "" And sNGKoumoku <> "" Then
          'EG20 V30.1.0.1 DEL START
'          MsgBox "â^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌ(" & sNGSts & "ÅF" & sNGKoumoku & "Åj", _
'                 vbOKOnly + vbExclamation, _
'                 "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          MsgBox "â^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌ(" & sNGSts & "ÅF" & sNGKoumoku & "Åj", _
                 vbOKOnly + vbExclamation, _
                 "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 ADD END
       Else
          MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                 vbOKOnly + vbExclamation, _
                 TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
       End If
       Call pubfuncErrorOccur(MN_FOLD_OLD)
       fOldVersion = False
       Exit Function
    End If
' EG20 V3.6.0.1 ÅyìùçáTR-No.260Åzí«â¡èIóπ
  
' EG20 V3.0.0.2 í«â¡äJén
    If pubfuncCommonGateCheck(MN_FOLD_OLD) = False Then
        fOldVersion = False
       Exit Function
    End If
' EG20 V3.0.0.2 í«â¡èIóπ
  
    '¢é¿çs£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇëSÇƒçÌèúÇ∑ÇÈ
    If sNowFolderRemove <> True Then
        Call pubfuncErrorOccur(MN_FOLD_NOW)     ' EG20 V3.0.0.2í«â¡
        fOldVersion = False
        Exit Function
    End If
    
    '¢ãå£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇ¢é¿çs£ÉtÉHÉãÉ_ÇÃì‡óeÇ…íuä∑Ç¶ÇÈ
    If sCopyOLDtoNOW <> True Then
        Call pubfuncErrorOccur(MN_FOLD_NOW)     ' EG20 V3.0.0.2í«â¡
        fOldVersion = False
        Exit Function
    End If

    Call pubfuncCommonAreaUpdate                ' EG20 V3.0.0.2 í«â¡

'V1.6.0.1 DEL START
'   'é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇä«óùÉvÉçÉZÉXÇ÷ëóêMÇ∑ÇÈÅB
'     If gStrCurrentForm = sFormName_EJVer Then
'        psVersionUpdateReqest (ML_REQUEST_EGATE)
'     Else
'        psVersionUpdateReqest (ML_REQUEST_NGATE)
'     End If
'V1.6.0.1 DEL END
'V1.6.0.1 ADD START
    'é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇä«óùÉvÉçÉZÉXÇ÷ëóêMÇ∑ÇÈÅB
    'äƒéãî’ãNìÆ/ñ¢ãNìÆÉ`ÉFÉbÉNÇçsÇ§ÅBÉ`ÉFÉbÉNèÛë‘Ç…ÇÊÇËèàóùï™äÚÇçsÇ§ÅB
     iKansiAplChk = CheckAppStart(PROC_KANRI)
     If iKansiAplChk <> 0 Then
        'äƒéãî’ãNìÆéûÅFä«óùÉvÉçÉZÉXÇ…é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇëóêMÇ∑ÇÈÅB
      'If gStrCurrentForm = sFormName_EJVer Then        'EG20 V30.1.0.1 DEL
         'psVersionUpdateReqest (ML_REQUEST_EGATE)      'EG20 V30.1.0.1 DEL
         psVersionUpdateReqest (ML_REQUEST_EG30GATE)       'EG20 V30.1.0.1 ADD
      ' EG20 V30.1.0.1 DEL START
'      Else
'         psVersionUpdateReqest (ML_REQUEST_NGATE)
'      End If
      ' EG20 V30.1.0.1 DEL END
    Else
        'äƒéãî’ñ¢ãNìÆéûÅFâ¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùåãâ Ç…ê≥èÌÇê›íËÇ∑ÇÈÅB
        gintGateVerInfUpdRes = MailSts.stsNormal
    End If
'V1.6.0.1 ADD END
     
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
     
     'â¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùàŸèÌ
    If gintGateVerInfUpdRes = MailSts.stsNormal Then
' EG20 V5.8.0.1í«â¡äJén
        ' â^â¸èÛë‘çXêV
        Call pubFuncUpdateUnkaiStatus(BootInfoHoshuType.TYPE_GATE, BOOTINFO_UNKAI_KIRIKAE)
' EG20 V5.8.0.1í«â¡èIóπ
'        Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_KIRIKAE, iTab_index + 1)   ' EG20 V5.6.0.1í«â¡           ' EG20 V5.11.0.1çÌèú
        Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_KIRIKAE, iTab_index + 1, gintUnkaiKind(FolderSyubetu))    ' EG20 V5.11.0.1í«â¡
        'ê≥èÌ
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ÇÃì‡óeÇÅAÅué¿çsÅvÉtÉHÉãÉ_Ç…ñﬂÇµÇƒÅA" _
                    & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & "ÇÃàÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇÅA" _
                    & Chr(vbKeyReturn) & "é¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        fOldVersion = True
    Else
        'àŸèÌ
        'If gStrCurrentForm = sFormName_EJVer Then      ' EG20 V30.1.0.1 DEL
          'EG20 V30.1.0.1 DEL START
'          MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
'                  vbOKOnly + vbExclamation, _
'                  "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
                  vbOKOnly + vbExclamation, _
                  "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
          'EG20 V30.1.0.1 DEL END
        ' EG20 V30.1.0.1 DEL START
'        Else
'           MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
'                   vbOKOnly + vbExclamation, _
'                   "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'        End If
        fOldVersion = False
    End If

    fOldVersion = True
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sCopyOLDtoNOW
'//  ã@î\ñºèÃ  : ãåÉoÅ[ÉWÉáÉìÇ…ñﬂÇ∑èàóù
'//  ã@î\äTóv  : ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.5.0.1) 2012-02-07  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sCopyOLDtoNOW() As Boolean
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim sSrcFileName As String      'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãñº
    Dim sDstFileName As String      'ÉRÉsÅ[êÊÉtÉ@ÉCÉãñº
    Dim bError As Boolean           'ÉGÉâÅ[ÉtÉâÉO
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD

    Dim sCorner As String                      'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                    'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    
    On Error GoTo ErrorHandler
    
    'èâä˙ílê›íË
    sCopyOLDtoNOW = True

    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

    '****************************
    '* ÉtÉ@ÉCÉãÉäÉXÉgÇÉRÉsÅ[Ç∑ÇÈ *
    '****************************
'    sSrcFileName = FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST
    sSrcFileName = sGatePath & FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST
                                    'ÅuãåÅvÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'    sDstFileName = FolderName(MN_FOLD_NOW, FolderSyubetu) & "\" & MN_FILELIST
    sDstFileName = sGatePath & FolderName(MN_FOLD_NOW, FolderSyubetu) & "\" & MN_FILELIST
                                    'Åué¿çsÅvÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ  'V1.20.0.1 DEL
    If objFso.FileExists(sSrcFileName) = True Then 'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
        'ÉtÉ@ÉCÉãÉäÉXÉgÇÅuãåÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        FileCopy sSrcFileName, sDstFileName
    Else
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
       
       'ÅuãåÉtÉHÉãÉ_ÉtÉ@ÉCÉãÉäÉXÉgÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        sCopyOLDtoNOW = False
        Set objFso = Nothing    'V1.20.0.1 ADD
        Exit Function                   'èàóùÇèIóπÇ∑ÇÈ
    End If

    bError = False                  'ÉGÉâÅ[ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To UBound(FileList) - 1
                                    'ÉtÉ@ÉCÉãÉäÉXÉgêîï™åJÇËï‘Ç∑
        'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'        sSrcFileName = FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & FileList(i)
        sSrcFileName = sGatePath & FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & FileList(i)

        'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'        sDstFileName = FolderName(MN_FOLD_NOW, FolderSyubetu) & "\" & FileList(i)
        sDstFileName = sGatePath & FolderName(MN_FOLD_NOW, FolderSyubetu) & "\" & FileList(i)

        'ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ  'V1.20.0.1 DEL
        If objFso.FileExists(sSrcFileName) = True Then 'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
            'ÉtÉ@ÉCÉãÇÅuãåÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
            FileCopy sSrcFileName, sDstFileName
        Else                                'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
            bError = True                   'ÉGÉâÅ[ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
        End If
    Next
    If bError = True Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
        
        'ÅuãåÉtÉHÉãÉ_ÉtÉ@ÉCÉãÉäÉXÉgìoò^Ç»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ…ìoò^Ç≥ÇÍÇƒÇ¢ÇƒÅAë∂ç›ÇµÇ»Ç¢ÉtÉ@ÉCÉãÇ™Ç†ÇËÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        sCopyOLDtoNOW = False
        Set objFso = Nothing    'V1.20.0.1 ADD
        Exit Function
    End If

    Set objFso = Nothing    'V1.20.0.1 ADD
    
' EG20 V3.0.0.2í«â¡äJén
    If pfuncCopyPASSINF(iTab_index, MN_FOLD_OLD) = False Then
' EG20 V3.5.0.1í«â¡äJén
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
        MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
               vbOKOnly + vbExclamation, _
               TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
' EG20 V3.5.0.1í«â¡èIóπ
        sCopyOLDtoNOW = False
    End If
' EG20 V3.0.0.2í«â¡èIóπ
    
    Exit Function       'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    'ÅuãåÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        
    sCopyOLDtoNOW = False
    Set objFso = Nothing    'V1.20.0.1 ADD
End Function
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fMakeOutPutFile
'//  ã@î\ñºèÃ  : î}ëÃèoóÕèàóùÇçsÇ§ÅB
'//  ã@î\äTóv  : î}ëÃèoóÕÉtÉ@ÉCÉãçÏê¨Ç∆èoóÕÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ÉtÉHÉãÉ_ëIëÉ|ÉbÉvÉAÉbÉvâÊñ ÇÃèâä˙ÉtÉHÉãÉ_ïœçX
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(EG20 V2.0.1.1) 2011-11-17  REVISED BY [TCC] T.Koyama
'//                 ÇdÇfÇQÇOÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V2.0.1.1) 2011-12-16  REVISED BY [TCC] M.Matsumoto
'//                 Åyìù-273ëŒâûÅz
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fMakeOutPutFile()
   Dim sOutFileName As String 'î}ëÃèoóÕÉtÉ@ÉCÉãñº[éÌï ï ]
   Dim iFileNumber As Integer 'ÉtÉ@ÉCÉãî‘çÜ
   Dim i As Integer           'ÉJÉEÉìÉ^Å[
   Dim bFlag As Boolean       'ÉtÉâÉO
   Dim iResponse As Integer   'MsgBoxñﬂÇËíl
   Dim lngErrCode As Long     'ÉGÉâÅ[ÉRÅ[Éh
   Dim fso         As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
   Dim strWriteDir As String               'èoóÕêÊÉtÉHÉãÉ_
   Dim strStationName As String
' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
   Dim iTab_index  As Integer
   Dim strSyubetu As String     ' éÌï ñº
' EG20 V2.0.1.1 ADD ENDÅyécåèáÇ60Åz
    
   On Error Resume Next 'V1.21.0.1 ADD

' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz

  'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
  bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
  For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
     If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
        bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
        Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
     End If
  Next
              
  If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
     'If gStrCurrentForm = sFormName_EJVer Then     'EG20 V30.1.0.1 DEL
       'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
       'EG20 V30.1.0.1 DEL START
'         MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
'                 vbOKOnly + vbExclamation, _
'                 "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
       'EG20 V30.1.0.1 DEL END
       'EG20 V30.1.0.1 ADD START
         MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                 vbOKOnly + vbExclamation, _
                 "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 ADD END
     'EG20 V30.1.0.1 DEL START
'     Else
'       'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
'         MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
'                vbOKOnly + vbExclamation, _
'                "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'     End If
         'èàóùÇî≤ÇØÇÈ
     Exit Function
   End If
  
  
    'EG20 V2.1.0.1 ADD START Åyìù-273ëŒâûÅz
    If lstKan(iTab_index).ListCount = 0 Then
        'ÉtÉ@ÉCÉãñ≥ÇµàŸèÌÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
        MsgBox "î}ëÃèoóÕÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB", vbExclamation, "ÉfÅ[É^ñ≥åxçê"
        Exit Function
    End If
    'EG20 V2.1.0.1 ADD END
  
  'ÉtÉHÉãÉ_ëIëÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
'  strWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", "")                         'V1.12.0.1 DEL
  strWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)    'V1.12.0.1 ADD

  'éwíËÉtÉHÉãÉ_Ç»Çµ
  If Len(strWriteDir) = 0 Then
       Exit Function
  End If

' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
  'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
  Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_VERSION_KANRI)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ

  'ÉRÉsÅ[êÊÉtÉHÉãÉ_ÇÃóLñ≥ämîF
  If fso.FolderExists(strWriteDir) = False Then
     'ÉRÉsÅ[êÊÉtÉHÉãÉ_çÏê¨
     fso.CreateFolder (strWriteDir)
  End If
   
  'âwñºéÊìæ
   strStationName = gsGetStationEkiName
  
   
   strSyubetu = ""
   'èàóùíÜÉtÉHÅ[ÉÄÇ…ÇÊÇËÅAî}ëÃèoóÕÇ∑ÇÈÉtÉ@ÉCÉãñºçÏê¨
'   If gStrCurrentForm = sFormName_EJVer Then
       'ÉäÉ\Å[ÉXëIëïîï™äÚ
       Select Case FolderSyubetu
        Case 0      'îªíËCPU-Pro
'        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & VER_TXT_EJHANTEIPRO
'          'strWriteDir = strWriteDir & VER_TXT_EJHANTEIPRO      'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJHANTEIPRO 'V1.8.0.1 ADD
        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
          'EG20 V30.1.0.1 DEL START
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJHANTEIPRO
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJHANTEIPRO 'V1.8.0.1 ADD
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          sOutFileName = PATH_WORK & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJHANTEIPRO
          strWriteDir = strWriteDir & "\" & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJHANTEIPRO
          'EG20 V30.1.0.1 ADD END
          strSyubetu = "îªíËÉfÅ[É^"
        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
        Case 1      'ÉÅÉCÉìCPU-Pro
'        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & VER_TXT_EJMAINPRO
'          'strWriteDir = strWriteDir & VER_TXT_EJMAINPRO        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJMAINPRO   'V1.8.0.1 ADD
        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
          'EG20 V30.1.0.1 DEL START
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJMAINPRO
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJMAINPRO   'V1.8.0.1 ADD
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          sOutFileName = PATH_WORK & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJMAINPRO
          strWriteDir = strWriteDir & "\" & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJMAINPRO
          'EG20 V30.1.0.1 ADD END
          strSyubetu = "ÉvÉçÉOÉâÉÄ"
        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
        Case 2      'ÉTÉuCPU-Pro1
'        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & VER_TXT_EJSUBPRO
'          'strWriteDir = strWriteDir & VER_TXT_EJSUBPRO        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJSUBPRO   'V1.8.0.1 ADD
         ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
          'EG20 V30.1.0.1 DEL START
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJSUBPRO1
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJSUBPRO1   'V1.8.0.1 ADD
'          strSyubetu = "ÉTÉuCPU-Pro1"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          sOutFileName = PATH_WORK & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJSUBPRO
          strWriteDir = strWriteDir & "\" & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJSUBPRO
          strSyubetu = "ÉTÉuCPU-Pro"
          'EG20 V30.1.0.1 DEL END
        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
        Case 3      'ÉTÉuCPU-Pro2
'        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & VER_TXT_EJMAINOS
'          'strWriteDir = strWriteDir & VER_TXT_EJMAINOS        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJMAINOS   'V1.8.0.1 ADD
        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
          'EG20 V30.1.0.1 DEL START
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJSUBPRO2
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJSUBPRO2   'V1.8.0.1 ADD
'          strSyubetu = "ÉTÉuCPU-Pro2"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          sOutFileName = PATH_WORK & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJMAINOS
          strWriteDir = strWriteDir & "\" & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJMAINOS
          strSyubetu = "é©â¸ÅiÇnÇrÅj"
          'EG20 V30.1.0.1 ADD END
        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
        Case 4      'ÉTÉuCPU-Pro3
'        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & VER_TXT_EJYOBI1
'          'strWriteDir = strWriteDir & VER_TXT_EJYOBI1         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJYOBI1    'V1.8.0.1 ADD
        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
          'EG20 V30.1.0.1 DEL START
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJSUBPRO3
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJSUBPRO3    'V1.8.0.1 ADD
'          strSyubetu = "ÉTÉuCPU-Pro3"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          sOutFileName = PATH_WORK & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJYOBI1
          strWriteDir = strWriteDir & "\" & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJYOBI1
          strSyubetu = "ó\îıÇP"
          'EG20 V30.1.0.1 ADD END
        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
        Case 5      'ÉÅÉCÉìCPU-OS
'        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & VER_TXT_EJMAINOS
'          'strWriteDir = strWriteDir & VER_TXT_EJMAINOS        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJMAINOS   'V1.8.0.1 ADD
        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
          'EG20 V30.1.0.1 DEL START
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJMAINOS
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJMAINOS   'V1.8.0.1 ADD
'          strSyubetu = "é©â¸ÅiÇnÇrÅj"
          'EG20 V30.1.0.1 DEL END
          'EG20 V30.1.0.1 ADD START
          sOutFileName = PATH_WORK & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJYOBI
          strWriteDir = strWriteDir & "\" & strStationName & "_" & gstrCornerName(iTab_index) & VER_TXT_KJYOBI
          strSyubetu = "ó\îı"
          'EG20 V30.1.0.1 ADD END
        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
        'EG20 V30.1.0.1 DEL START
'        Case 6      'ó\îı1
''        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
''          sOutFileName = PATH_WORK & VER_TXT_EJYOBI1
''          'strWriteDir = strWriteDir & VER_TXT_EJYOBI1         'V1.8.0.1 DEL
''          strWriteDir = strWriteDir & "\" & VER_TXT_EJYOBI1    'V1.8.0.1 ADD
'        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
'        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJYOBI1
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJYOBI1    'V1.8.0.1 ADD
'          strSyubetu = "ó\îıÇP"
'        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
'        Case 7      'ó\îı2
''        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
''          sOutFileName = PATH_WORK & VER_TXT_EJYOBI2
''          'strWriteDir = strWriteDir & VER_TXT_EJYOBI2         'V1.8.0.1 DEL
''          strWriteDir = strWriteDir & "\" & VER_TXT_EJYOBI2    'V1.8.0.1 ADD
'        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
'        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJYOBI2
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJYOBI2    'V1.8.0.1 ADD
'          strSyubetu = "ó\îıÇQ"
'        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
'        Case 8      'ó\îı3
''        ' EG20 V2.0.1.1 DEL STARTÅyécåèáÇ60Åz
''          sOutFileName = PATH_WORK & VER_TXT_EJYOBI3
''          'strWriteDir = strWriteDir & VER_TXT_EJYOBI2         'V1.8.0.1 DEL
''          strWriteDir = strWriteDir & "\" & VER_TXT_EJYOBI3    'V1.8.0.1 ADD
'        ' EG20 V2.0.1.1 DEL END   ÅyécåèáÇ60Åz
'        ' EG20 V2.0.1.1 ADD STARTÅyécåèáÇ60Åz
'          sOutFileName = PATH_WORK & strStationName & VER_TXT_EJYOBI3
'          strWriteDir = strWriteDir & "\" & strStationName & VER_TXT_EJYOBI3    'V1.8.0.1 ADD
'          strSyubetu = "ó\îıÇR"
'        ' EG20 V2.0.1.1 ADD END  ÅyécåèáÇ60Åz
         'EG20 V30.1.0.1 DEL END
        End Select
'  Else
'       'ÉäÉ\Å[ÉXëIëïîï™äÚ
'       Select Case FolderSyubetu
'        Case 0      'îªíËCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_NJHANTEIPRO
'          'strWriteDir = strWriteDir & VER_TXT_NJHANTEIPRO      'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJHANTEIPRO 'V1.8.0.1 ADD
'        Case 1      'ÉÅÉCÉìCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_NJMAINPRO
'          'strWriteDir = strWriteDir & VER_TXT_NJMAINPRO        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJMAINPRO   'V1.8.0.1 ADD
'        Case 2      'ÉTÉuCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_NJSUBPRO
'          'strWriteDir = strWriteDir & VER_TXT_NJSUBPRO         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJSUBPRO    'V1.8.0.1 ADD
'        Case 3      'ÉÅÉCÉìCPU-OS
'          sOutFileName = PATH_WORK & VER_TXT_NJMAINOS
'          'strWriteDir = strWriteDir & VER_TXT_NJMAINOS         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJMAINOS    'V1.8.0.1 ADD
'        Case 4      'ó\îı1
'          sOutFileName = PATH_WORK & VER_TXT_NJYOBI1
'          'strWriteDir = strWriteDir & VER_TXT_NJYOBI1          'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJYOBI1     'V1.8.0.1 ADD
'        Case 5      'ó\îı2
'          sOutFileName = PATH_WORK & VER_TXT_NJYOBI2
'          'strWriteDir = strWriteDir & VER_TXT_NJYOBI2          'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJYOBI2     'V1.8.0.1 ADD
'        End Select
'  End If

  iFileNumber = FreeFile              'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
 
  'ëŒè€ÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
  Open sOutFileName For Output Access Write As #iFileNumber
  
  ' ê›íuâwñºèëÇ´çûÇ›
   Print #iFileNumber, "ê›íuâwÅF" & strStationName
   Print #iFileNumber, ""
     
  ' ÉfÅ[É^éÌï ÅiÉèÅ[ÉNÅjèëÇ´çûÇ›
   Print #iFileNumber, "ÉfÅ[É^éÌï ÅF" & strSyubetu
   Print #iFileNumber, ""

  ' ëSëÃÉoÅ[ÉWÉáÉìèëÇ´çûÇ›
   Print #iFileNumber, "ëSëÃÉoÅ[ÉWÉáÉìÅiÉèÅ[ÉNÅjÅF" & DispTitleVersion(MN_FOLD_WRK)
   Print #iFileNumber, "Å@Å@Å@Å@Å@Å@Å@Åié¿çsÅjÅ@ÅF" & DispTitleVersion(MN_FOLD_NOW)
   Print #iFileNumber, "Å@Å@Å@Å@Å@Å@Å@ÅiãåÅjÅ@Å@ÅF" & DispTitleVersion(MN_FOLD_OLD)
   Print #iFileNumber, ""

'  For i = 0 To lstKan(0).ListCount - 1
  For i = 0 To lstKan(iTab_index).ListCount - 1
  'ÉäÉXÉgÉ{ÉbÉNÉXÇ…ï\é¶Ç≥ÇÍÇƒÇ¢ÇÈï™ÇæÇØÅAèëÇ´çûÇﬁÅB
'       Print #iFileNumber, lstKan(0).List(i) & Chr(vbKeyReturn)
'       Print #iFileNumber, lstKan(iTab_index).List(i) & Chr(vbKeyReturn)   ' EG20 V3.0.0.2çÌèú
       Print #iFileNumber, lstKan(iTab_index).List(i)                       ' EG20 V3.0.0.2í«â¡
  Next
 
  'ëŒè€ÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
  Close #iFileNumber

  'ÉtÉ@ÉCÉãÇÃóLñ≥ämîF
  If fso.FileExists(sOutFileName) = False Then
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
     'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
     Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
     'ÉtÉ@ÉCÉãñ≥ÇµàŸèÌÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "î}ëÃèoóÕÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB", vbExclamation, "ÉfÅ[É^ñ≥åxçê"
     Exit Function
  End If
    
  On Error GoTo COPY_ERROR
  'ÉtÉ@ÉCÉãÉRÉsÅ[
  fso.CopyFile sOutFileName, strWriteDir
  'Åuî}ëÃèoóÕê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
  'V1.8.0.1 DEL START
  'iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly, _
  '                   "èoóÕåãâ ")
  'V1.8.0.1 DEL END
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
  'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
  Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
  
  MsgBox "ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbInformation, "èoóÕåãâ "   'V1.8.0.1 ADD
                   
  'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃèoóÕèàóùê≥èÌÅvÉçÉOèoóÕ
  Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_OUTPUT_OK, 0)
  
  Set fso = Nothing

  Exit Function
    
'*******************************
'VBÉGÉâÅ[èàóù
COPY_ERROR:
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
        'èàóùàŸèÌÇÃèÍçáÅAèoóÕåãâ É|ÉbÉvÉAÉbÉv(àŸèÌ)ï\é¶
        MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbCritical, "èoóÕåãâ "
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃèoóÕèàóùàŸèÌÅvÉçÉOèoóÕ
        lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_OUTPUT_ERROR, lngErrCode)
        Set fso = Nothing
'*******************************
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sFDInstall
'//  ã@î\ñºèÃ  : î}ëÃÉCÉìÉXÉgÅ[Éãèàóù
'//  ã@î\äTóv  : ÉCÉìÉXÉgÅ[Éãî}ëÃÉtÉ@ÉCÉãÇÅAÉèÅ[ÉNÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.6.0.1) 2009-06-16   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQïsãÔçáèCê≥
'//                 ÉtÉFÅ[ÉYÇRëŒâû
'//     REVISIONS :(1.12.0.1) 2009-11-11   REVISED BY [TCC] C.Terui
'//                 ì¸óÕÉtÉ@ÉCÉãäiî[ÉfÉBÉåÉNÉgÉäà íuïœçX
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                 ÉtÉHÉãÉ_ëIëâÊñ ÇOSédólÇ…ïœçX
'//                 ÉtÉ@ÉCÉãëIëâÊñ ÇOSédólÇ…ïœçX
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                  EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(EG20 V5.5.0.1) 2012-03-28  CODED BY  [TCC] H.Sugimoto
'//     REVISIONS :(EG20 V5.11.0.1) 2012-05-10  CODED BY  [TCC] H.Sugimoto
'//                Åyâ^â¸ï\é¶â¸ëPëŒâûÅz
'//     REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V6.9.0.1) 2012-12-05  CODED BY  [TCC] H.Sugimoto
'//                 ó éYëŒâûÅyTOMASópóÃàÊÉRÉsÅ[ëŒâûÅz
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//     REVISIONS :(EG20 V30.3.0.1) 2014-10-16  CODED BY  [TCC] T.Nakajima
'//                  ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇQëŒâû ÅyHKRK_Kansi06_004_02Åz
'//     REVISIONS :(EG20 V30.4.0.1) 2015-01-15 CODED BY  [TCC] S.Kuroda
'//                 ñkó§êVä≤ê¸ÉtÉFÅ[ÉYÇRëŒâûÅyHKRK_kansi02_001_01Åz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sFDInstall(sFlag As String)
    Dim MyName As String            'ÉtÉ@ÉCÉãÉtÉãÉpÉXñº
    Dim sSrcFileName As String      'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãñº
    Dim sDstFileName As String      'ÉRÉsÅ[êÊÉtÉ@ÉCÉãñº
    Dim iResponse As Integer        'MsgBoxÉ{É^ÉìÉRÅ[Éh
    Dim sInputPass As String        'ÉCÉìÉXÉgÅ[Éãå≥ÉfÉBÉåÉNÉgÉäñº(STD)orÉtÉ@ÉCÉãñº(LZH)
    Dim sInputFolder As String      'ÉCÉìÉXÉgÅ[Éãå≥ÉtÉHÉãÉ_ñºÅBLZHÇÃéûÅAâìÄêÊÉtÉHÉãÉ_ÅB
    Dim lngErrCode As Long          'ÉGÉâÅ[ÉRÅ[Éh
    'V1.6.0.1 ADD START
    Dim bRet As Boolean             'ê≥ìñê´É`ÉFÉbÉNñﬂÇËíl
    Dim sChkName As String          'É`ÉFÉbÉNÉtÉ@ÉCÉã
    'V1.6.0.1 ADD END
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                    'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    Dim sCorner As String            'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String          'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String          'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    Dim lngPgmHanteiStsWork As Long     'ÉvÉçÉOÉâÉÄîªíËèÛë‘ÅiÉèÅ[ÉNÅj   ' EG20 V3.0.0.2í«â¡
    Dim szTargetFolder As String     ' ëÆê´ïœçXêÊÉtÉHÉãÉ_ñº             ' EG20 V5.8.0.1í«â¡
    
    Dim sTomasPath As String         ' TOMASópóÃàÊÉtÉ@ÉCÉãÉpÉX
    
    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner

' EG20 V5.8.0.1í«â¡äJén
    szTargetFolder = sGatePath & FolderName(0, FolderSyubetu)
' EG20 V5.8.0.1í«â¡èIóπ

    If sFlag = "STD" Then
    'ïWèÄÅiîÒà≥èkÅjÉtÉ@ÉCÉãéwíËÇÃéû:
    'ÉfÉBÉåÉNÉgÉäëIëâÊñ Çï\é¶Ç≥ÇπÅAì¸óÕÉtÉ@ÉCÉãäiî[ÉfÉBÉåÉNÉgÉäñºÇìæÇÈÅB
'       sInputPass = pfDirSelection("a:", "ÉCÉìÉXÉgÅ[Éãî}ëÃÇÃÉfÉBÉåÉNÉgÉäëIë")     'V1.12.0.1 DEL
        'sInputPass = pfDirSelection("H:", "ÉCÉìÉXÉgÅ[Éãî}ëÃÇÃÉfÉBÉåÉNÉgÉäëIë")      'V1.12.0.1 ADD    'V1.20.0.1 DEL
        sInputPass = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)    'V1.20.0.1 ADD
        If sInputPass = "" Then
        'ÉfÉBÉåÉNÉgÉäÇ™éwíËÇ»ÇµéûÇÕèàóùèIóπ
            'V1.20.0.1 ADD START
            Set objFso = Nothing
            Set objFi = Nothing
            'V1.20.0.1 ADD END
            Exit Sub
        End If
        sInputFolder = sInputPass
    Else
    'à≥èkÉtÉ@ÉCÉãéwíËÇÃéû:
    'à≥èkÉtÉ@ÉCÉãëIëâÊñ Çï\é¶Ç≥ÇπÅALZHÉtÉ@ÉCÉãÉtÉãÉpÉXñºÇìæÇÈÅiÉfÉtÉHÉãÉgÇÕÇeÇcÇï\é¶ÅBÅjÅB
'       sInputPass = pfCabFileSelection("a:")     'V1.12.0.1 DEL
        'V1.20.0.1 DEL START
       'sInputPass = pfCabFileSelection("H:")      'V1.12.0.1 ADD
        'If sInputPass = "" Then Exit Sub 'ÉtÉ@ÉCÉãÇ™ëIëÇ≥ÇÍÇ»ÇØÇÍÇŒñﬂÇÈÅB
        'V1.20.0.1 DEL END
        'V1.20.0.1 ADD START
        'éÊìæÉtÉ@ÉCÉãñºÇèâä˙âª
        CommonDialog1.FileName = ""
        'èâä˙ÉfÉBÉåÉNÉgÉäÇê›íË
        If objFso.FolderExists(SHOWFILE_DEFAULTFOLDER1) = True Then    'ÉtÉHÉãÉ_ëIëâÊñ ÉfÉtÉHÉãÉgÉpÉXÇPÇ™ë∂ç›Ç∑ÇÈÇ©
            'ë∂ç›Ç∑ÇÈÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇPÅiH:ÅjÇê›íË
            CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER1
        Else
            'ë∂ç›ÇµÇ»Ç¢ÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇQÅiC:ÅjÇê›íË
            CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER2
        End If
        'ägí£éqÇê›íË
        CommonDialog1.Filter = "à≥èkÉtÉ@ÉCÉãÅi*.cabÅj|*.cab|"
        'ÉtÉ@ÉCÉãëIëâÊñ ÇäJÇ≠
        CommonDialog1.ShowOpen
        'ëIëÇµÇΩÉtÉ@ÉCÉãñºÇéÊìæ
        sInputPass = CommonDialog1.FileName
        If sInputPass = "" Then 'ÉtÉ@ÉCÉãñ¢ëIë
            Set objFso = Nothing
            Set objFi = Nothing
            Exit Sub    'ÉtÉ@ÉCÉãÇ™ëIëÇ≥ÇÍÇ»ÇØÇÍÇŒèàóùíÜíf
        End If
        
        Call ChDrive("D")  'V2.5.0.1 ADD
        
        'V1.20.0.1 ADD END
       'âìÄópàÍéûÉtÉHÉãÉ_ÇçÏê¨Ç∑ÇÈÅB
       psMakeFolder MELTED_FOLDER_FULLPASS
       'à≥èkÉtÉ@ÉCÉãÇÅAâìÄópàÍéûÉtÉHÉãÉ_Ç…âìÄÅEäiî[Ç≥ÇπÇÈÅB
        Call psCabReqest(CABREQEST.CAB_THAW, sInputPass, MELTED_FOLDER_FULLPASS)
        If glngCabErrCd <> 0 Then
            psDeleteFolder MELTED_FOLDER_FULLPASS
            'V1.20.0.1 ADD START
            Set objFso = Nothing
            Set objFi = Nothing
            'V1.20.0.1 ADD END
            Exit Sub
        End If
        sInputFolder = MELTED_FOLDER_FULLPASS
    End If
    
    'ÅuÉèÅ[ÉNÉRÉsÅ[ämîFÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    iResponse = MsgBox(sInputPass & " ÇÃëSÇƒÇÃÉtÉ@ÉCÉãÇÅA" _
                       & Chr(vbKeyReturn) & Chr(vbKeyReturn) _
                       & TitleBox(FolderSyubetu) & "ÇÃÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[ÇµÇ‹Ç∑ÅB " _
                       & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                       vbYesNo + vbExclamation, _
                       TitleBox(FolderSyubetu) & "  î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ[")
    If iResponse = vbNo Then
    '[Ç¢Ç¢Ç¶] É{É^ÉìÇëIë:âΩÇ‡ÇµÇ»Ç¢ÅB
    'íAÇµÅAà≥èkÉtÉ@ÉCÉãéwíËÇÃéûÇÕÅAâìÄópàÍéûÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈÅB
       If sFlag = "LZH" Then
           psDeleteFolder MELTED_FOLDER_FULLPASS
       End If
        'V1.20.0.1 ADD START
        Set objFso = Nothing
        Set objFi = Nothing
        'V1.20.0.1 ADD END
        Exit Sub
    End If
    
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çï\é¶Ç∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_SHOW_REQ, PRG_VERSION_KANRI)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
    'V1.6.0.1 ADD START
    'äOïîì¸óÕÉvÉçîªê≥ìñê´É`ÉFÉbÉN
    If sFlag = "STD" Then
       'î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ[éû
       bRet = pfInstallSeitouseiChck(sInputPass)
    Else
       'à≥èkÉtÉ@ÉCÉãÅ®ÉèÅ[ÉN ÉRÉsÅ[éû
       bRet = pfInstallSeitouseiChck(MELTED_FOLDER_FULLPASS & "\")
    End If
    If bRet = False Then
        Call pubfuncErrorOccur(MN_FOLD_WRK)         ' EG20 V3.0.0.2í«â¡
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD Start
       If sFlag = "LZH" Then
           psDeleteFolder MELTED_FOLDER_FULLPASS
       End If
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD End
       'V1.20.0.1 ADD START
       Set objFso = Nothing
       Set objFi = Nothing
       'V1.20.0.1 ADD END
       Exit Sub
    End If
    
    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
    sChkName = fSelectFile
    'V1.20.0.1 DEL START
'    sChkName = Dir(FolderName(0, FolderSyubetu) & "\" & sChkName)
'    If sChkName <> "" Then
'      Kill FolderName(0, FolderSyubetu) & "\" & sChkName
'    End If
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    
    sFilePath = sGatePath & FolderName(0, FolderSyubetu)
    
'    If objFso.FileExists(FolderName(0, FolderSyubetu) & "\" & sChkName) = True Then
    If objFso.FileExists(sFilePath & "\" & sChkName) = True Then
        'éwíËÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ
'        sChkName = objFso.GetFileName(FolderName(0, FolderSyubetu) & "\" & sChkName)
        sChkName = objFso.GetFileName(sFilePath & "\" & sChkName)
'        Kill FolderName(0, FolderSyubetu) & "\" & sChkName
        Kill sFilePath & "\" & sChkName
    Else
        sChkName = ""
    End If
    'V1.20.0.1 ADD END
    'V1.6.0.1 ADD START
    
    'éwíËÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAëSÇƒÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
    'V1.20.0.1 DEL START
'    MyName = Dir(sInputFolder & "\*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            'î}ëÃì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'            sSrcFileName = sInputFolder & "\" & MyName
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(sSrcFileName) And vbDirectory) <> vbDirectory Then
'                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sDstFileName = FolderName(0, FolderSyubetu) & "\" & MyName
'                'î}ëÃì‡ÇÃÉtÉ@ÉCÉãÇÉèÅ[ÉNÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
'                FileCopy sSrcFileName, sDstFileName
'            End If
'        End If
'        MyName = Dir                    ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(sInputFolder).files   'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then  'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            'î}ëÃì‡ÉtÉ@ÉCÉãñºÇçÏê¨
            sSrcFileName = sInputFolder & "\" & MyName
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(sSrcFileName) And vbDirectory) <> vbDirectory Then
                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sDstFileName = FolderName(0, FolderSyubetu) & "\" & MyName
                sDstFileName = sGatePath & FolderName(0, FolderSyubetu) & "\" & MyName

                'î}ëÃì‡ÇÃÉtÉ@ÉCÉãÇÉèÅ[ÉNÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
                FileCopy sSrcFileName, sDstFileName
            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
    'à≥èkÉtÉ@ÉCÉãéwíËÇÃéûÇÕÅAâìÄópàÍéûÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈÅB(égópçœÇ›ÇÃÇΩÇﬂ)
    If sFlag = "LZH" Then
        psDeleteFolder MELTED_FOLDER_FULLPASS
    End If
    
' EG20 V5.8.0.1çÌèúäJén
'    ' â^â¸èÛë‘çXêV                                              ' EG20 V5.5.0.1í«â¡
'    Call pubFuncUpdateUnkaiStatus(BOOTINFO_UNKAI_ARI)           ' EG20 V5.5.0.1í«â¡
' EG20 V5.8.0.1çÌèúèIóπ
' EG20 V5.8.0.1í«â¡äJén
    'ì«Ç›éÊÇËäOÇµÇÃä÷êîÇé¿çs
    dllChangeAttributeContents (szTargetFolder)

' EG20 V6.9.0.1 Åyó éYëŒâûÅFTOMASópóÃàÊÉRÉsÅ[ëŒâûÅzADD START
    ' èàóùÇ∑Ç◊Ç´ëŒè€Ç™ÉRÅ[Éi1ÇÃèÍçá
    ' TOMASóÃàÊÅiN_GATE00ÅjÇ‡N_GATE01ÇÃì‡óeÇ≈ÉRÉsÅ[
    'If iTab_index = 0 Then     'EG20 V30.1.0.1 DEL
    'EG20 V30.3.0.1 ÅyHKRK_Kansi06_004_02Åz DEL START
    'ÉèÅ[ÉNÉRÉsÅ[ÇµÇÊÇ§Ç∆Ç∑ÇÈÇΩÇ—Ç…ÇªÇÃÉRÅ[ÉiÇ©ÇÁ00Ç÷ÉRÉsÅ[Ç∑ÇÈÇΩÇﬂÅAêÊì™ÉRÅ[ÉiÇÃîªíËÇçÌèú
    'If iTab_index = gintKansenFirstCornerIdx Then  'EG20 V30.1.0.1 ADD
    'EG20 V30.3.0.1 ÅyHKRK_Kansi06_004_02Åz DEL END
        ' çÌèúêÊÇÃÉtÉHÉãÉ_ÅiTOMASóÃàÊÅjÇéwíË
        sTomasPath = PATH_N_GATE & "00" & FolderName(0, FolderSyubetu) & "\"
        sInputFolder = sGatePath & FolderName(0, FolderSyubetu) & "\"
        
        ' TOMASóÃàÊÇçÌèú
        If funcRemoveFile(sTomasPath) = False Then
            
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
            
            'EG20 V30.1.0.1 DEL START
'            MsgBox "ÇsÇnÇlÇ`ÇrópóÃàÊÉRÉsÅ[àŸèÌèIóπ", _
'                    vbOKOnly + vbExclamation, _
'                    "é©ìÆâ¸éDã@Å@ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 DEL END
            'EG20 V30.1.0.1 ADD START
            MsgBox "ÇsÇnÇlÇ`ÇrópóÃàÊÉRÉsÅ[àŸèÌèIóπ", _
                    vbOKOnly + vbExclamation, _
                    "êVä≤ê¸é©ìÆâ¸éDã@Å@ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 ADD END
            
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFTOMASÃ´Ÿ¿ﬁÃß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
            lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_TOMASFILE_DELETE_ERROR, lngErrCode)
        
            GoTo TomasErrorHandler
        End If
        
        ' TOMASóÃàÊÇ÷ÉRÉsÅ[
        If funcCopyFile(sInputFolder, sTomasPath, lngErrCode) = False Then
            
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
            
            'EG20 V30.1.0.1 DEL START
'            MsgBox "ÇsÇnÇlÇ`ÇrópóÃàÊÉRÉsÅ[àŸèÌèIóπ", _
'                    vbOKOnly + vbExclamation, _
'                    "é©ìÆâ¸éDã@Å@ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 DEL END
            'EG20 V30.1.0.1 ADD START
            MsgBox "ÇsÇnÇlÇ`ÇrópóÃàÊÉRÉsÅ[àŸèÌèIóπ", _
                    vbOKOnly + vbExclamation, _
                    "êVä≤ê¸é©ìÆâ¸éDã@Å@ÉoÅ[ÉWÉáÉìä«óù"
            'EG20 V30.1.0.1 ADD END
            
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFTOMASóÃàÊ∫Àﬂ∞èàóùàŸèÌÅvÉçÉOèoóÕ
            lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_TOMASFILE_COPY_ERROR, lngErrCode)
        
            GoTo TomasErrorHandler
        End If
    'EG20 V30.3.0.1ÅyHKRK_Kansi06_004_02Åz DEL START
    'End If
    'EG20 V30.3.0.1ÅyHKRK_Kansi06_004_02Åz DEL END
' EG20 V6.9.0.1 Åyó éYëŒâûÅFTOMASópóÃàÊÉRÉsÅ[ëŒâûÅzADD END

    ' â^â¸èÛë‘çXêV
    Call pubFuncUpdateUnkaiStatus(BootInfoHoshuType.TYPE_GATE, BOOTINFO_UNKAI_ARI)
' EG20 V5.8.0.1í«â¡èIóπ
'    Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_ARI, iTab_index + 1)   ' EG20 V5.6.0.1í«â¡           ' EG20 V5.11.0.1çÌèú
    Call pubFuncGateUpdateUnkaiStatus(BOOTINFO_UNKAI_ARI, iTab_index + 1, gintUnkaiKind(FolderSyubetu))    ' EG20 V5.11.0.1í«â¡
    
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    
    'ÅuÉèÅ[ÉNÉRÉsÅ[ê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇÃëSÇƒÇÃÉtÉ@ÉCÉãÇÅA" _
            & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & "ÇÃÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…" _
            & Chr(vbKeyReturn) & "ÉRÉsÅ[ÇµÇ‹ÇµÇΩÅB", _
            vbOKOnly + vbExclamation, _
            TitleBox(FolderSyubetu) & "  î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ["
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃÅ®‹∞∏∫Àﬂ∞èàóùê≥èÌÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_LZH_COPY_WRK_OK, 0)
    
    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
    lstKan(0).Clear
    lstKan(1).Clear
    lstKan(2).Clear
    lstKan(3).Clear
    lstKan(4).Clear
    lstKan(5).Clear
  
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox
    
    'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËàŸèÌèÛë‘ÅiÉèÅ[ÉNÅjÅvÇÃèÛë‘ÇéÊìæÇ∑ÇÈ
    lngPgmHanteiStsWork = pfGetKansiSet(IdKansiSet.PG_HANTEI_ERR_STS_WORK)

    'ÅuÉvÉçÉOÉâÉÄîªíËàŸèÌèÛë‘ÅiÉèÅ[ÉNÅjÅvÅiê≥èÌÅj
    Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_ERR_STS_WORK, ErrCode.Normal)
    
    'ïœâªÇ™Ç†Ç¡ÇΩèÍçáÅAÅuèÛë‘ïœâªí ímÅvÇëóêMÇ∑ÇÈ
    If lngPgmHanteiStsWork <> ErrCode.Normal Then
        Call sSendMailStsChgInf(MailSts.stsNormal, lngPgmHanteiStsWork)
    End If
    
    Exit Sub    'èàóùÇèIóπÇ∑ÇÈ

ErrorHandler:   ' ÉGÉâÅ[èàóùÅB
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
    'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
    Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
    'V1.20.0.1 ADD END
    Select Case Err.Number
        Case 53 ' ÅuéwíËéÌï ÉtÉ@ÉCÉãÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇ… " & TitleBox(FolderSyubetu) & "ÇÕÅA" _
                   & Chr(vbKeyReturn) & "Ç–Ç∆Ç¬Ç‡ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  Å®ÉèÅ[ÉN ÉRÉsÅ["
            Exit Sub
        Case 71 'Åuî}ëÃÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            iResponse = MsgBox("î}ëÃÇ™èÄîıÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                    vbRetryCancel + vbExclamation, _
                    TitleBox(FolderSyubetu) & "  Å®ÉèÅ[ÉN ÉRÉsÅ[")
            If iResponse = vbRetry Then    'ÅuÇ‚ÇËíºÇµÅvÉ{É^ÉìÇëIëÇµÇΩèÍçá
                Resume      ' ÉGÉâÅ[Ç™î≠ê∂ÇµÇΩçsÇ©ÇÁèàóùçƒäJ
            Else                            'ÅuÉLÉÉÉìÉZÉãÅvÉ{É^ÉìÇëIëÇµÇΩèÍçá
                Exit Sub    'èàóùÇèIóπÇ∑ÇÈ
            End If
        Case Else  'ÅuÉèÅ[ÉNÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
           MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇ©ÇÁÇÃÉRÉsÅ[ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB" _
                   & Chr(vbKeyReturn) & "ÉGÉâÅ[ÉRÅ[ÉhÅÅ" _
                   & str$(Err.Number), _
                   vbOKOnly + vbExclamation, _
                   "Å®ÉèÅ[ÉN ÉRÉsÅ["
    End Select
    
    Call pubfuncErrorOccur(MN_FOLD_WRK)         ' EG20 V3.0.0.2í«â¡

' EG20 V5.8.0.1í«â¡äJén
    dllChangeAttributeContents (szTargetFolder)
' EG20 V5.8.0.1í«â¡èIóπ
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD Start
    'à≥èkÉtÉ@ÉCÉãéwíËÇÃéûÇÕÅAâìÄópàÍéûÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈÅB
    If sFlag = "LZH" Then
        psDeleteFolder MELTED_FOLDER_FULLPASS
    End If
' EG20 V30.4.0.1ÅyHKRK_kansi02_001_01Åz ADD End

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃÅ®‹∞∏∫Àﬂ∞èàóùàŸèÌÅvÉçÉOèoóÕ
   lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
   Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_LZH_COPY_WRK_ERROR, lngErrCode)

' EG20 V6.9.0.1 Åyó éYëŒâûÅFTOMASópóÃàÊÉRÉsÅ[ëŒâûÅzADD START
    Exit Sub    'èàóùÇèIóπÇ∑ÇÈ

TomasErrorHandler:   ' TOMASèàóùópÉGÉâÅ[èàóùÅB
' EG20 V6.9.0.1 Åyó éYëŒâûÅFTOMASópóÃàÊÉRÉsÅ[ëŒâûÅzADD END
    
    Call pubfuncErrorOccur(MN_FOLD_WRK)
    
    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
    lstKan(0).Clear
    lstKan(1).Clear
    lstKan(2).Clear
    lstKan(3).Clear
    lstKan(4).Clear
    lstKan(5).Clear
  
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox

End Sub


'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : SSTab1_Click
'//  ã@î\ñºèÃ  : ÉRÅ[ÉiÉ^ÉuëIëèàóù
'//  ã@î\äTóv  : ÉRÅ[Éiï\é¶ÇêÿÇËë÷Ç¶ÇÈ
'//
'//              å^        ñºèÃ             à”ñ°
'//  à¯êî      : Integer   PreviousTab      ëIëÉ^Éu
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'/  REVISIONS    : (EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'/                  EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub SSTab1_Click(PreviousTab As Integer)
    
    On Error GoTo ErrorHandle
    
    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
    lstKan(0).Clear
    lstKan(1).Clear
    lstKan(2).Clear
    lstKan(3).Clear
    lstKan(4).Clear
    lstKan(5).Clear
    
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox
ErrorHandle:

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pubfuncCommonGateCheck
'//  ã@î\ñºèÃ  : â¸éDã@ã§í îªíËèàóù
'//  ã@î\äTóv  : ÉTÉÄílÉ`ÉFÉbÉNÅAÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉNÇÃé¿çs
'//
'//              å^         ñºèÃ            à”ñ°
'//  à¯êî      : Integer    nKind           MN_FOLD_WRK(0):ÉèÅ[ÉN
'//                                         MN_FOLD_NOW(1):é¿çs
'//                                         MN_FOLD_OLD(2):ãå
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : BOOL      TRUE      ê≥èÌ
'//                        FALSE     àŸèÌ
'//
'//  ORIGINAL  :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                  EG20ÉtÉFÅ[ÉYÇQëŒâû
'//  REVISIONS :(EG20 V5.13.0.1) 2012-06-02 REVISED BY  [TCC] H.Sugimoto
'//                 ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅz
'//  REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//     REVISIONS :(EG20 V30.1.0.1) 2014-02-17  CODED BY  [TCC] T.Nakajima
'//                 ñkó§êVä≤ê¸äJã∆ëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pubfuncCommonGateCheck(nKind As Integer) As Boolean

    Dim lngSumRet As Long
    Dim lngCnt As Long
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim i As Integer
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim bRet As Boolean
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim sCorner As String                    'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                  'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim sFilePath As String                  'ÉtÉ@ÉCÉãÉtÉ@ÉCÉãÉpÉX
    Dim lTotalCount As Long                  ' åãâ åèêî

    Dim lngPgmHanteiRcvErrSts   As Long     'ÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘
    Dim lngPgmHanteiSndErrSts   As Long     'ÉvÉçÉOÉâÉÄîªíËîzêMàŸèÌèÛë‘
    Dim lngPgmHanteiErrSts      As Long     'ÉvÉçÉOÉâÉÄîªíËàŸèÌèÛë‘Åié¿çsÅj
    Dim lngPgmHanteiErrStsOld   As Long     'ÉvÉçÉOÉâÉÄîªíËàŸèÌèÛë‘ÅiãåÅj
    Dim lngPgmHanteiElseErrSts  As Long     'ÉvÉçÉOÉâÉÄîªíËÇªÇÃëºàŸèÌèÛë‘

    
    On Error Resume Next

    ' ëIëíÜÇÃÉRÅ[ÉiÅ[î‘çÜéÊìæ
    iTab_index = SSTab1.Tab
    
    sCorner = Format(iTab_index + 1, "00")
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sGatePath = PATH_N_GATE & sCorner


    ' /////////////////////////////////////////////////////
    ' // ÉTÉÄílÉ`ÉFÉbÉN
    For lngCnt = 0 To UBound(FileList) - 1
        sFilePath = sGatePath & FolderName(nKind, FolderSyubetu)
        If pfFileSumChk(sFilePath & "\" & FileList(lngCnt), lngSumRet) <> True Then
            
            'ÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘ÅvéÊìæ
            lngPgmHanteiRcvErrSts = pfGetKansiSet(IdKansiSet.PG_HANTEI_RCVERR_STS)
        
            'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘ÅvÇçXêV
            Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_RCVERR_STS, ErrCode.PgmHantei_SumChk)
                    
            'äƒÉ}ÉvÉçÉZÉXÇ…ÅuèÛë‘ïœâªí ímÅvÇëóêM
            If lngPgmHanteiRcvErrSts <> ErrCode.PgmHantei_SumChk Then
                Call sSendMailStsChgInf(MailSts.stsErr, ErrCode.PgmHantei_SumChk)
            End If
            
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
            'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
            Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
            'ÉTÉÄílàŸèÌ
            If lngSumRet = SUM_CHK.SumErr Then
               'EG20 V30.1.0.1 DEL START
'               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
'                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                      vbOKOnly + vbExclamation, _
'                      "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
               'EG20 V30.1.0.1 DEL END
               'EG20 V30.1.0.1 ADD START
               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
                      vbOKOnly + vbExclamation, _
                      "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
               'EG20 V30.1.0.1 ADD END
            
            'ÉTÉÄílàŸèÌà»äOàŸèÌ
            ElseIf lngSumRet = SUM_CHK.SumErr_Else Then
               'EG20 V30.1.0.1 DEL START
'               MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
'                     vbOKOnly + vbExclamation, _
'                      "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
               'EG20 V30.1.0.1 DEL END
               'EG20 V30.1.0.1 ADD START
               MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                     vbOKOnly + vbExclamation, _
                      "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
               'EG20 V30.1.0.1 ADD END
            End If
            pubfuncCommonGateCheck = False
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_SUMCHK_ERROR, 0)
            Exit Function
        End If
    Next

    ' /////////////////////////////////////////////////////
    ' // ÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉN
    If UBound(FileList) > FILECNT_MAX Then

        'ÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘Åv
        lngPgmHanteiRcvErrSts = pfGetKansiSet(IdKansiSet.PG_HANTEI_RCVERR_STS)

        'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘ÅvÇçXêV
        Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_RCVERR_STS, ErrCode.PgmHantei_FileMaxChk)
                
        'äƒÉ}ÉvÉçÉZÉXÇ…ÅuèÛë‘ïœâªí ímÅvÇëóêM
        If lngPgmHanteiRcvErrSts <> ErrCode.PgmHantei_FileMaxChk Then
            Call sSendMailStsChgInf(MailSts.stsErr, ErrCode.PgmHantei_FileMaxChk)
        End If
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ

        'EG20 V30.1.0.1 DEL START
'        MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
'                & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                vbOKOnly + vbExclamation, _
'                "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 ADD START
        MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
                & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
                vbOKOnly + vbExclamation, _
                "êVä≤ê¸é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        'EG20 V30.1.0.1 ADD END
        pubfuncCommonGateCheck = False

        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_MAXFILECHK_ERROR, 0)
        Exit Function
    End If

    'EG20 V30.1.0.1 DEL START ñkó§êVä≤ê¸Ç≈ÇÕëSéÌï ÇÃè„å¿ílÇéùÇ¡ÇƒÇ¢Ç»Ç¢ÇÃÇ≈É`ÉFÉbÉNÇÕïsóvÇ∆Ç∑ÇÈ
'    ' /////////////////////////////////////////////////////
'    ' // ëSÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉNÅié¿çsÅ{í«â¡ï™Åj
'    bRet = True
'    lTotalCount = pfuncTotalListCount()
'    lTotalCount = lTotalCount + UBound(FileList)
'    If lTotalCount > TOTALFILECNT_MAX Then
'        bRet = False
'    End If
'    If bRet = False Then
'        'ÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘Åv
'        lngPgmHanteiRcvErrSts = pfGetKansiSet(IdKansiSet.PG_HANTEI_RCVERR_STS)
'
'        'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘ÅvÇçXêV
'        Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_RCVERR_STS, ErrCode.PgmHantei_FileMaxChk)
'
'        'äƒÉ}ÉvÉçÉZÉXÇ…ÅuèÛë‘ïœâªí ímÅvÇëóêM
'        If lngPgmHanteiRcvErrSts <> ErrCode.PgmHantei_FileMaxChk Then
'            Call sSendMailStsChgInf(MailSts.stsErr, ErrCode.PgmHantei_FileMaxChk)
'        End If
'
'' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡äJén
'        'ÉvÉçÉOÉåÉXÉoÅ[Çè¡ãéÇ∑ÇÈ
'        Call SendMessageProgress(ML_ID_PRGBAR_HIDE_REQ)
'' EG20 V5.13.0.1ÅyÉvÉçÉOÉåÉXÉoÅ[ï\é¶ã@î\å©íºÇµëŒâûÅzí«â¡èIóπ
'        MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
'                & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                vbOKOnly + vbExclamation, _
'                "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'        pubfuncCommonGateCheck = False
'
'        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_MAXFILECHK_ERROR, 0)
'        Exit Function
'    End If
    'EG20 V30.1.0.1 DEL END

    pubfuncCommonGateCheck = True
    Exit Function

' ñ¢é¿é{
'    ' /////////////////////////////////////////////////////
'    ' // ÉtÉ@ÉCÉãñºÉTÉCÉYÉ`ÉFÉbÉN
'    lngFileListCnt = UBound(FileList)
'
'    On Error GoTo FileGetError
'
'    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'
'    sFilePath = sGatePath & FolderName(nKind, FolderSyubetu)
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉIÅ[ÉvÉìÅB
'    Open sFilePath & "\" & MN_FILELIST For Input As #iFileNumber
'
'    bRet = True
'    For i = 0 To lngFileListCnt
'        If i = lngFileListCnt Then
'            Exit For
'        End If
'
'        'ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'        Input #iFileNumber, strWork
'        If strWork <> "" And Left$(strWork, 1) <> "/" Then  'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
'            'ÉtÉ@ÉCÉãñºíËã`Ç»Çµ
'            If strWork = "" Then
'                'ÉãÅ[Évî≤ÇØ
'                MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                        & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                        vbOKOnly + vbExclamation, _
'                        "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'                bRet = False
'                Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'                Exit For
'            'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'            ElseIf " " <> Mid(strWork, 2, 1) Then
'              'ÉãÅ[Évî≤ÇØ
'                MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                        & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                        vbOKOnly + vbExclamation, _
'                        "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'                bRet = False
'                Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'                Exit For
'            ElseIf (InStr(strWork, ".") - 1) = -1 Then
'                MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                        & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                        vbOKOnly + vbExclamation, _
'                        "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'                bRet = False
'                Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'                Exit For
'            Else
'                'ÉtÉ@ÉCÉãñºÇÃÇ›Çíäèo
'                sGetFileListName = Mid(strWork, 3, 16)
'                'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
'                myLen = LenB(StrConv(sGetFileListName, vbFromUnicode))      'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
'                If FILE_NAME_MAX_SIZE < myLen Then
'                    '13ÉoÉCÉgà»è„ÇÃèÍçá
'                    MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                            & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                            vbOKOnly + vbExclamation, _
'                            "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'                    bRet = False
'                    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'                    Exit For
'                End If
'            End If
'        End If
'    Next
'
'    If bRet = False Then
'        'ÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘Åv
'        lngPgmHanteiRcvErrSts = pfGetKansiSet(IdKansiSet.PG_HANTEI_RCVERR_STS)
'
'        'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘ÅvÇçXêV
'        Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_RCVERR_STS, ErrCode.PgmHantei_FileMaxChk)
'
'        'äƒÉ}ÉvÉçÉZÉXÇ…ÅuèÛë‘ïœâªí ímÅvÇëóêM
'        If lngPgmHanteiRcvErrSts <> ErrCode.PgmHantei_FileMaxChk Then
'            Call sSendMailStsChgInf(MailSts.stsErr, ErrCode.PgmHantei_FileMaxChk)
'        End If
'    End If
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉNÉçÅ[ÉYÅB
'    Close #iFileNumber
'    pubfuncCommonGateCheck = bRet

FileGetError:
    If iFileNumber > 0 Then
       Close #iFileNumber
    End If
    iFileNumber = 0
    pubfuncCommonGateCheck = False
    
    'ÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘Åv
    lngPgmHanteiRcvErrSts = pfGetKansiSet(IdKansiSet.PG_HANTEI_RCVERR_STS)

    'äƒéãê›íËÉGÉäÉAÅuÉvÉçÉOÉâÉÄîªíËéÛêMàŸèÌèÛë‘ÅvÇçXêV
    Call gspfSetKansiSts(IdKansiSet.PG_HANTEI_RCVERR_STS, ErrCode.PgmHantei_FileMaxChk)
            
    'äƒÉ}ÉvÉçÉZÉXÇ…ÅuèÛë‘ïœâªí ímÅvÇëóêM
    If lngPgmHanteiRcvErrSts <> ErrCode.PgmHantei_FileMaxChk Then
        Call sSendMailStsChgInf(MailSts.stsErr, ErrCode.PgmHantei_FileMaxChk)
    End If

End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfuncTotalListCount
'//  ã@î\ñºèÃ  : ëçÉäÉXÉgêîÇÃéÊìæ
'//  ã@î\äTóv  : éwíËéÌï à»äOÇÃëçÉtÉ@ÉCÉãêîÇéZèoÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl               à”ñ°
'//  ñﬂÇËíl    : LONG      lResultCount     åèêî
'//
'//     ORIGINAL  :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅFfrmJVer.fReadFileListó¨óp
'///////////////////////////////////////////////////////////////////
Private Function pfuncTotalListCount() As Long
    Dim lResultCount As Long                ' åãâ åèêî
    Dim iLoop As Integer                    ' ÉãÅ[Év
    
    Dim iFileNumber As Integer              'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String                 'ÉtÉ@ÉCÉãñº
    Dim sSrcFileName As String              'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer                 'ÉtÉ@ÉCÉãäiî[êî
    Dim sCorner As String                   'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String                 'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX
    Dim objFso As New FileSystemObject      ' ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
    
    
    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sCorner = Format(iTab_index + 1, "00")
    sGatePath = PATH_N_GATE & sCorner
    
    lResultCount = 0
    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
    For iLoop = 0 To 8
        
        iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
        sSrcFileName = sGatePath & FolderName(1, iLoop) & "\" & MN_FILELIST
   
        If objFso.FileExists(sSrcFileName) = True Then
   
            Open sSrcFileName For Input Access Read As #iFileNumber     'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
            iListCnt = 0
            Do While Not EOF(iFileNumber)                               'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
                Line Input #iFileNumber, sFileName                      'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
                If sFileName <> "" And Left$(sFileName, 1) <> "/" Then  'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
                    iListCnt = iListCnt + 1                             'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
                End If
            Loop
            Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
            iFileNumber = 0
            If iLoop <> FolderSyubetu Then
                lResultCount = lResultCount + iListCnt
            End If
        End If
    Next

    pfuncTotalListCount = lResultCount    'ñﬂÇËílÇê›íËÇ∑ÇÈ
    Set objFso = Nothing

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    pfuncTotalListCount = 0    'ñﬂÇËílÇê›íËÇ∑ÇÈ
    Set objFso = Nothing
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2011 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfuncCopyPASSINF
'//  ã@î\ñºèÃ  : é¿çsÉtÉHÉãÉ_Ç÷ÇÃPASSINFÉRÉsÅ[
'//  ã@î\äTóv  : éwíËéÌï à»äOÇÃëçÉtÉ@ÉCÉãêîÇéZèoÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Integer   nCorner   ÉRÅ[Éiî‘çÜÅi0Å`5Åj
'//  à¯êî      : Integer    nKind           MN_FOLD_WRK(0):ÉèÅ[ÉN
'//                                         MN_FOLD_NOW(1):é¿çs
'//                                         MN_FOLD_OLD(2):ãå
'//
'//              å^        íl               à”ñ°
'//  ñﬂÇËíl    : BOOL      TRUE             ê≥èÌ
'//            : BOOL      FALSE            àŸèÌ
'//
'//     ORIGINAL  :(EG20 V3.0.0.2) 2011-12-22  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅFfrmJVer.fReadFileListó¨óp
'///////////////////////////////////////////////////////////////////
Private Function pfuncCopyPASSINF(nCorner As Integer, nKind As Integer) As Boolean
    
    Dim objFso As New FileSystemObject      ' ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim szSrcFile As String                 ' ÉRÉsÅ[å≥ÉtÉ@ÉCÉã
    Dim szDstFile As String                 ' ÉRÉsÅ[êÊÉtÉ@ÉCÉã
    Dim sCorner As String           'ÉRÅ[ÉiÅ[î‘çÜ
    Dim sGatePath As String         'ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉX

    On Error GoTo ErrorHandler              ' ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    ' ëŒè€Ç™îªíËÉfÅ[É^ÇÃèÍçáÇÃÇ›èàóùÇçsÇ§
    ' è„ãLÇ…äYìñÇµÇ»Ç¢èÍçáÇÕê≥èÌèIóπ
    If FolderSyubetu <> 0 Then
        pfuncCopyPASSINF = True
        Set objFso = Nothing
        Exit Function
    End If

    ' ÉRÅ[ÉiÅ[î‘çÜïtÉtÉ@ÉCÉãÉpÉXçÏê¨
    sCorner = Format(nCorner + 1, "00")
    sGatePath = PATH_N_GATE & sCorner
    ' ÉRÉsÅ[å≥ÉtÉ@ÉCÉã
    szSrcFile = sGatePath & FolderName(nKind, 0) & "\" & "PASSINF"
    szDstFile = sGatePath & FolderName(MN_FOLD_NOW, 0) & "\" & "PASSINF"

    If objFso.FileExists(szSrcFile) = True Then
        'ÉtÉ@ÉCÉãÉRÉsÅ[Åiä˘Ç…ë∂ç›ÇµÇΩèÍçáÇÕè„èëÇ´Ç∑ÇÈÇ∑ÇÈÅj
        objFso.CopyFile szSrcFile, szDstFile, True
        pfuncCopyPASSINF = True
    Else
        pfuncCopyPASSINF = False
    End If

    Set objFso = Nothing
    Exit Function

ErrorHandler:
    pfuncCopyPASSINF = False
    Set objFso = Nothing
End Function

