VERSION 5.00
Begin VB.Form frmPing 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "í êMämîF"
   ClientHeight    =   9000
   ClientLeft      =   0
   ClientTop       =   -105
   ClientWidth     =   12000
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   11.25
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   ScaleHeight     =   9000
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   Begin VB.Timer tmrMail 
      Left            =   10800
      Top             =   6360
   End
   Begin VB.Frame frmKekka 
      Caption         =   "ÇoÇhÇmÇfåãâ "
      Height          =   2775
      Left            =   120
      TabIndex        =   7
      Top             =   6120
      Width           =   8535
      Begin VB.CommandButton cmdZikko 
         Caption         =   "ÇoÇhÇmÇfé¿çs"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   12
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   780
         Left            =   240
         TabIndex        =   9
         Top             =   480
         Width           =   1905
      End
      Begin VB.ListBox LstStatus 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   9
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2040
         Left            =   2400
         TabIndex        =   8
         Top             =   360
         Width           =   6015
      End
   End
   Begin VB.TextBox txtDummy 
      BeginProperty Font 
         Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   1320
      TabIndex        =   0
      Text            =   "Text1"
      Top             =   15000
      Width           =   2895
   End
   Begin VB.Frame frmkiki 
      Caption         =   "ã@äÌëIë"
      Enabled         =   0   'False
      Height          =   4455
      Left            =   6120
      TabIndex        =   6
      Top             =   1440
      Width           =   5415
      Begin VB.ListBox LstKiki 
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   14.25
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   3195
         ItemData        =   "í êMämîFâÊñ .frx":0000
         Left            =   240
         List            =   "í êMämîFâÊñ .frx":0002
         TabIndex        =   37
         Top             =   1080
         Width           =   4935
      End
      Begin VB.TextBox txtIP2 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   3840
         Locked          =   -1  'True
         MaxLength       =   3
         TabIndex        =   33
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.TextBox txtIP2 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   2640
         Locked          =   -1  'True
         MaxLength       =   3
         TabIndex        =   32
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.TextBox txtIP2 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   1440
         Locked          =   -1  'True
         MaxLength       =   3
         TabIndex        =   31
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.TextBox txtIP2 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   0
         Left            =   240
         Locked          =   -1  'True
         MaxLength       =   3
         TabIndex        =   30
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.Label lblIP20 
         Caption         =   "ÅD"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1080
         TabIndex        =   36
         Top             =   600
         Width           =   255
      End
      Begin VB.Label lblIP21 
         Caption         =   "ÅD"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2280
         TabIndex        =   35
         Top             =   600
         Width           =   255
      End
      Begin VB.Label lblIP22 
         Caption         =   "ÅD"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   3480
         TabIndex        =   34
         Top             =   600
         Width           =   255
      End
   End
   Begin VB.Frame frmTe 
      Caption         =   "ÇhÇoÉAÉhÉåÉXéËì¸óÕ"
      Height          =   4455
      Left            =   120
      TabIndex        =   5
      Top             =   1440
      Width           =   5775
      Begin VB.CommandButton cmdC 
         Caption         =   "ÉNÉäÉA"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Left            =   360
         TabIndex        =   26
         Top             =   960
         Width           =   1875
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "9"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   9
         Left            =   4080
         TabIndex        =   25
         Top             =   960
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "8"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   8
         Left            =   3240
         TabIndex        =   24
         Top             =   960
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "7"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   7
         Left            =   2400
         TabIndex        =   23
         Top             =   960
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "4"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   4
         Left            =   2400
         TabIndex        =   22
         Top             =   1800
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "5"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   5
         Left            =   3240
         TabIndex        =   21
         Top             =   1800
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "6"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   6
         Left            =   4080
         TabIndex        =   20
         Top             =   1800
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   1
         Left            =   2400
         TabIndex        =   19
         Top             =   2640
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "2"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   2
         Left            =   3240
         TabIndex        =   18
         Top             =   2640
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "3"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   3
         Left            =   4080
         TabIndex        =   17
         Top             =   2640
         Width           =   800
      End
      Begin VB.CommandButton cmdNum 
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Index           =   0
         Left            =   2400
         TabIndex        =   16
         Top             =   3480
         Width           =   800
      End
      Begin VB.CommandButton cmdOct 
         Caption         =   "."
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Left            =   3240
         TabIndex        =   15
         Top             =   3480
         Width           =   800
      End
      Begin VB.CommandButton cmdBs 
         Caption         =   "BS"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   800
         Left            =   4080
         TabIndex        =   14
         Top             =   3480
         Width           =   800
      End
      Begin VB.TextBox txtIP1 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Index           =   3
         Left            =   3960
         MaxLength       =   3
         TabIndex        =   13
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.TextBox txtIP1 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Index           =   2
         Left            =   2760
         MaxLength       =   3
         TabIndex        =   12
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.TextBox txtIP1 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Index           =   1
         Left            =   1560
         MaxLength       =   3
         TabIndex        =   11
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.TextBox txtIP1 
         Alignment       =   2  'íÜâõëµÇ¶
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         IMEMode         =   3  'µÃå≈íË
         Index           =   0
         Left            =   360
         MaxLength       =   3
         TabIndex        =   10
         Text            =   "123"
         Top             =   480
         Width           =   855
      End
      Begin VB.Label lblIP10 
         Caption         =   "ÅD"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1200
         TabIndex        =   29
         Top             =   600
         Width           =   255
      End
      Begin VB.Label lblIP11 
         Caption         =   "ÅD"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   2400
         TabIndex        =   28
         Top             =   600
         Width           =   255
      End
      Begin VB.Label lblIP12 
         Caption         =   "ÅD"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   15.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   3600
         TabIndex        =   27
         Top             =   600
         Width           =   255
      End
   End
   Begin VB.Frame frmSentaku 
      Caption         =   "ÇhÇoÉAÉhÉåÉXì¸óÕï˚ñ@ëIë"
      Height          =   855
      Left            =   120
      TabIndex        =   4
      Top             =   480
      Width           =   11535
      Begin VB.OptionButton OptTe 
         Caption         =   "éËì¸óÕ"
         Height          =   255
         Left            =   960
         TabIndex        =   1
         Top             =   360
         Value           =   -1  'True
         Width           =   1095
      End
      Begin VB.OptionButton OptKiki 
         Caption         =   "ã@äÌëIë"
         Height          =   255
         Left            =   2880
         TabIndex        =   2
         Top             =   360
         Width           =   1335
      End
   End
   Begin VB.CommandButton cmdCancel 
      Caption         =   $"í êMämîFâÊñ .frx":0004
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   9120
      TabIndex        =   3
      Top             =   7800
      Width           =   2415
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "í êMämîF"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Left            =   0
      TabIndex        =   38
      Top             =   0
      Width           =   12015
   End
End
Attribute VB_Name = "frmPing"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFfrmPing.frm
'//  ÉpÉbÉPÅ[ÉWñºÅFí êMämîFâÊñ 
'//
'//  äTóvÅFí êMämîFâÊñ 
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//               EG10ÇÊÇËÅAí êMämîF(frmPing.frm)âÊñ ó¨óp
'//     REVISIONS :(1.3.0.1) 2009-03-16   REVISED BY [TCC] S.Terao
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(EG20 V3.4.0.1) 2012-02-13  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyê⁄ë±ã@äÌå©íºÇµëŒâûÅz
'//     REVISIONS :(EG30 31.2.0.1) 2015-07-17   REVISED BY [TCC] T.Nakajima
'//                 pingÇÃÉXÉeÅ[É^ÉXÇï\é¶Ç≈Ç´ÇÈÇÊÇ§èCê≥
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit

Private bIP0 As Boolean
Private bIP1 As Boolean
Private bIP2 As Boolean

Private Const MAXIPKIKIINFO = 96            'ã@äÌç\ê¨èÓïÒç≈ëÂ

'Private sKikiIP(45) As String              'IPÉAÉhÉåÉXäiî[ÉGÉäÉA   ' EG20 V3.4.0.1çÌèú
Private sKikiIP(MAXIPKIKIINFO) As String    'IPÉAÉhÉåÉXäiî[ÉGÉäÉA   ' EG20 V3.4.0.1í«â¡
Private Const MN_MAIL_INTERVAL = 1000   'ÉÅÉCÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl '1.3.0.1 ADD

' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡äJén
' è„à ã@äÌê›íËç\ê¨
Private Type TRANSKIKI_INFO
    bStatus As Boolean              ' ê›íËóLñ≥ÅiTRUE:óLÇË,FALSE:ñ≥ÇµÅj
    sGetInf As String               ' âÊñ ï\é¶ópñºèÃ
    iAreaID As Integer              ' ëŒè€äOïîã@äÌè„à ã@äÌí êMèÛë‘ÉGÉäÉAID
    nIniListNo As Integer           ' äOïîã@äÌÉäÉXÉgî‘çÜ
    nCorner As Integer              ' ÉRÅ[Éiî‘çÜ
End Type
Private gTransKikiInfo(1 To CONECT_KIKI_INI_MAX) As TRANSKIKI_INFO

' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡èIóπ

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : í êMämîFâÊñ (ÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÅAÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()
On Error Resume Next
    'É^ÉCÉ}ÇãNìÆÇ∑ÇÈ
    tmrMail.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : í êMämîFâÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÅAÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
On Error Resume Next
    'É^ÉCÉ}Çí‚é~Ç∑ÇÈ
    tmrMail.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : í êMämîFâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : èâä˙èàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.3.0.1) 2009-03-16   REVISED BY [TCC] S.Terao
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(EG20 V3.4.0.1) 2012-02-13  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyê⁄ë±ã@äÌå©íºÇµëŒâûÅz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()
   
    Dim sKeyName As String
    Dim sGateData As String * 128    'ÇPçsï™ÉtÉ@ÉCÉãì‡óeéÊìæóp
    Dim sFData() As String
    Dim iFCnt As Integer
    Dim iFLoop As Integer
    Dim iFLoop2 As Integer
    Dim i As Integer
    Dim iRet As Integer
    Dim sIP As String * 15
    Dim sCPUReg As String           'LDU_APLROOTÉåÉWÉXÉgÉäéÊìæóp
    Dim sCPUData As String * 128    'ÇPçsï™ÉtÉ@ÉCÉãì‡óeéÊìæóp
    
    'îzíuê›íË
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000
    
    'èâä˙âª
    LstStatus.Clear
    LstKiki.Clear
    
    txtIP1(0).Text = ""
    txtIP1(1).Text = ""
    txtIP1(2).Text = ""
    txtIP1(3).Text = ""
    txtIP2(0).Text = ""
    txtIP2(1).Text = ""
    txtIP2(2).Text = ""
    txtIP2(3).Text = ""

    OptTe.Value = True
    frmTe.Enabled = True
    txtIP1(0).Enabled = True
    txtIP1(1).Enabled = True
    txtIP1(2).Enabled = True
    txtIP1(3).Enabled = True
    lblIP10.Enabled = True
    lblIP11.Enabled = True
    lblIP12.Enabled = True
    cmdNum(0).Enabled = True
    cmdNum(1).Enabled = True
    cmdNum(2).Enabled = True
    cmdNum(3).Enabled = True
    cmdNum(4).Enabled = True
    cmdNum(5).Enabled = True
    cmdNum(6).Enabled = True
    cmdNum(7).Enabled = True
    cmdNum(8).Enabled = True
    cmdNum(9).Enabled = True
    cmdOct.Enabled = True
    cmdBs.Enabled = True
    cmdC.Enabled = True
    
    frmkiki.Enabled = False
    txtIP2(0).Enabled = False
    txtIP2(1).Enabled = False
    txtIP2(2).Enabled = False
    txtIP2(3).Enabled = False
    lblIP20.Enabled = False
    lblIP21.Enabled = False
    lblIP22.Enabled = False
    LstKiki.Enabled = False
    
    bIP0 = False
    bIP1 = False
    bIP2 = False
    
' EG20 V3.4.0.1í«â¡äJén
    'çÜã@èÓïÒéÊìæ
    Call gsGetGateInfo
    ' ÉRÅ[ÉiñºèÃê›íËèàóù
    Call gsGetCornerName
' EG20 V3.4.0.1í«â¡èIóπ
    
    'V1.8.0.1 ADD START
'    For i = 0 To 45                    ' EG20 V3.4.0.1çÌèú
    For i = 0 To MAXIPKIKIINFO          ' EG20 V3.4.0.1í«â¡
     sKikiIP(i) = ""
    Next
    'V1.8.0.1 ADD END
    
    'V1.3.0.1 ADD START
    'ÉÅÉCÉãéÛêMópÇÃÉÅÉCÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈ
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False
    'V1.3.0.1 ADD END
    
    On Error GoTo FileError
   
    'äOïîã@äÌèÓïÒ(OUTKIKI_LIST.ini)éÊìæï\é¶
    OverKikiPing
    'é©ìÆâ¸éDã@(Gate.ini)èÓïÒÇÊÇËé©â¸èÓïÒéÊìæï\é¶
    GatePing
    'é©ìÆâ¸éDã@(Gate.ini)èÓïÒÇÊÇËîªíËICMèÓïÒéÊìæìæï\é¶
    ICMPing
    
    ' ëÄçÏëÏèÓïÒï\é¶
    OperatePing
    
    'Åuí êMämîFâÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, CONECT_GAMEN_START, 0)
    
FileError:
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : OverKikiPing
'//  ã@î\ñºèÃ  : í êMämîFâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : äOïîã@äÌèÓïÒÇéÊìæï\é¶Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.3.0.1) 2009-03-17   REVISED BY [TCC] C.Terui
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(EG20 V3.4.0.1) 2012-02-13  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyê⁄ë±ã@äÌå©íºÇµëŒâûÅz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub OverKikiPing()
  Dim sIniFilPath As String              'ëŒè€äOïîã@äÌêÍópINIÉtÉ@ÉCÉã
  Dim iCnt As Integer                    'ÉJÉEÉìÉ^Å[
  Dim sKey As String                     'ÉLÅ[ñº
  Dim sGetInf As String * PING_SIZE      'éÊìæèÓïÒ(ï\é¶ñºèÃ)
  Dim sFilePath As String * PING_SIZE    'éÊìæèÓïÒ(ëŒè€äOïîã@äÌINIÉpÉX)
  Dim sSectionName As String * PING_SIZE 'éÊìæèÓïÒ(ÉZÉNÉVÉáÉìñº)
  Dim sKeyName As String * PING_SIZE     'éÊìæèÓïÒ(ÉLÅ[ñº)
  Dim lSts As Long                       'INIéÊìæèàóùñﬂÇËíl
'  Dim sIP As String * PING_IP_SIZE       'éÊìæIPÉAÉhÉåÉX           ' EG20 V6.1.0.1çÌèú
  Dim sIP As String                      ' éÊìæIPÉAÉhÉåÉX           ' EG20 V6.1.0.1í«â¡
  Dim iType As Integer                   'éÊìæèÓïÒ(ã@äÌÉ^ÉCÉv)
  Dim sTargetPath As String              'ëŒè€äOïîã@äÌINIÉtÉ@ÉCÉãÉpÉX
  Dim iAreaID As Integer                 'éÊìæèÓïÒ(ÉGÉäÉAID)        ' EG20 V3.4.0.1í«â¡
    
  Dim sGetString As String * 128         ' INIéÊìæï∂éöóÒ
  Dim nNullIndex As Integer              ' ï∂éöêîÉèÅ[ÉN
    
  On Error Resume Next
 
  'èâä˙âª
  sIP = ""
  
'  For iCnt = 1 To 10                               ' EG20 V3.4.0.1çÌèú

' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡äJén
  For iCnt = 1 To CONECT_KIKI_INI_MAX
    gTransKikiInfo(iCnt).bStatus = False               ' ê›íËóLñ≥ÅiTRUE:óLÇË,FALSE:ñ≥ÇµÅj
    gTransKikiInfo(iCnt).sGetInf = ""                  ' âÊñ ï\é¶ópñºèÃ
    gTransKikiInfo(iCnt).iAreaID = 0                   ' ëŒè€äOïîã@äÌè„à ã@äÌí êMèÛë‘ÉGÉäÉAID
    gTransKikiInfo(iCnt).nIniListNo = 0                ' äOïîã@äÌÉäÉXÉgî‘çÜ
    gTransKikiInfo(iCnt).nCorner = 0                   ' ÉRÅ[Éiî‘çÜ

    ' OUTKIKI_LIST.iniÇ©ÇÁè„à í êMÉGÉäÉAIDÇéÊìæÇ∑ÇÈÅB
    sKey = ""
    sKey = PROFILE_KEY_KIKIAREA_NAME & Format(iCnt, "00")
    iAreaID = GetPrivateProfileInt(PROFILE_SECTION_LIST_NAME, _
                                sKey, _
                                DEFAILT_Int, _
                                OUTKIKI_LIST_FILE)

' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡èIóπ

    ' OUTKIKI_LIST.iniÇ©ÇÁï\é¶ópäOïîã@äÌñºèÃÇéÊìæÇ∑ÇÈÅB
    sGetInf = ""
    sKey = ""
    sKey = PROFILE_KEY_KIKINAME & Format(iCnt, "00")
    lSts = GetPrivateProfileString(PROFILE_SECTION_LIST_NAME, _
                                  sKey, _
                                  DEFAILT, _
                                  sGetInf, _
                                  Len(sGetInf), _
                                  OUTKIKI_LIST_FILE)
     If lSts = False Then
        'âΩÇ‡ÇµÇ»Ç¢
     Else
'       LstKiki.AddItem sGetInf                             ' EG20 V3.4.0.1çÌèú
        Call psAddKikiCornerName(sGetInf, iAreaID, iCnt)    ' EG20 V3.4.0.1í«â¡
     End If

    If gTransKikiInfo(iCnt).bStatus = True Then             ' EG20 V3.4.0.1í«â¡

        sKey = ""
        sFilePath = ""
        ' OUTKIKI_LIST.iniÇ©ÇÁï\é¶ëŒè€äOïîã@äÌINIÉtÉ@ÉCÉãÉpÉXÇéÊìæÇ∑ÇÈÅB
        sKey = PROFILE_KEY_KIKIPATH & Format(iCnt, "00")
        lSts = GetPrivateProfileString(PROFILE_SECTION_LIST_NAME, _
                                       sKey, _
                                       DEFAILT, _
                                       sFilePath, _
                                       Len(sFilePath), _
                                       OUTKIKI_LIST_FILE)
                                   
        sKey = ""
        ' OUTKIKI_LIST.iniÇ©ÇÁã@äÌÉ^ÉCÉv(äƒéãî’orIDUorLDU)ÇéÊìæÇ∑ÇÈÅB
        sKey = PROFILE_KEY_TYPE & Format(iCnt, "00")
        iType = GetPrivateProfileInt(PROFILE_SECTION_LIST_NAME, _
                                     sKey, _
                                     DEFAILT_Int, _
                                     OUTKIKI_LIST_FILE)
        
        sTargetPath = ""
        If iType = 1 Then  'ã@äÌÉ^ÉCÉvÇ™äƒéãî’ÇÃèÍçá
           sTargetPath = PATH_KANSI & sFilePath
        End If
        If iType = 2 Then  'ã@äÌÉ^ÉCÉvÇ™IDUÇÃèÍçá
           sTargetPath = PATH_IDU_APP & "\\" & sFilePath
        End If
        If iType = 3 Then  'ã@äÌÉ^ÉCÉvÇ™LDUÇÃèÍçá
           sTargetPath = PATH_LDU_APP & "\\" & sFilePath
        End If
        sKey = ""

        ' OUTKIKI_LIST.iniÇ©ÇÁëŒè€äOïîã@äÌINIÉtÉ@ÉCÉãÇÃÉZÉNÉVÉáÉìñºÇéÊìæÇ∑ÇÈÅB
        sKey = PROFILE_KEY_SECTION_NAME & Format(iCnt, "00")
        lSts = GetPrivateProfileString(PROFILE_SECTION_LIST_NAME, _
                                       sKey, _
                                       DEFAILT, _
                                       sSectionName, _
                                       Len(sSectionName), _
                                       OUTKIKI_LIST_FILE)

         sKey = ""

        ' OUTKIKI_LIST.iniÇ©ÇÁëŒè€äOïîã@äÌINIÉtÉ@ÉCÉãÇÃÉLÅ[ñºÇéÊìæÇ∑ÇÈÅB
        sKey = PROFILE_KEY_KEY_NAME & Format(iCnt, "00")
        lSts = GetPrivateProfileString(PROFILE_SECTION_LIST_NAME, _
                                       sKey, _
                                       DEFAILT, _
                                       sKeyName, _
                                       Len(sKeyName), _
                                       OUTKIKI_LIST_FILE)
        sKey = ""
        sIP = "" 'V1.8.0.1 ADD
        ' ëŒè€äOïîã@äÌINIÉtÉ@ÉCÉãÇ©ÇÁIPÉAÉhÉåÉXÇéÊìæÇ∑ÇÈÅB
        lSts = GetPrivateProfileString(sSectionName, _
                                       sKeyName, _
                                       DEFAILT, _
                                       sGetString, _
                                       Len(sGetString), _
                                       sTargetPath)
        If lSts > 0 Then                             ' V1.3.0.1 ADD
            LstKiki.AddItem gTransKikiInfo(iCnt).sGetInf    ' EG20 V3.4.0.1í«â¡
            
            nNullIndex = InStr(sGetString, Chr(0))
            If nNullIndex <> 0 Then
                sIP = Left(sGetString, nNullIndex - 1)
            Else
                sIP = sGetString
            End If
            sKikiIP(LstKiki.ListCount - 1) = Trim(sIP)
        End If                                       ' V1.3.0.1 ADD
    End If                                                  ' EG20 V3.4.0.1í«â¡
  Next iCnt
  
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GatePing
'//  ã@î\ñºèÃ  : í êMämîFâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : é©ìÆâ¸éDã@èÓïÒÇéÊìæï\é¶Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG20 V3.4.0.1) 2012-02-13  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyê⁄ë±ã@äÌå©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V6.1.0.1) 2012-06-12  CODED BY  [TCC] H.Sugimoto
'//                 Åyï\é¶çÜã@â¸ëPëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub GatePing()
    Dim sKeyName As String
    Dim sGateData As String * PING_GATE_SIZE    'ÇPçsï™ÉtÉ@ÉCÉãì‡óeéÊìæóp
    Dim sFData() As String
    Dim iFCnt As Integer
    Dim iFLoop As Integer
    Dim iFLoop2 As Integer
    Dim i As Integer
    Dim iRet As Integer
    Dim sIP As String * PING_IP_SIZE
    Dim nCorner As Integer                      ' ÉRÅ[Éiî‘çÜ    ' EG20 V6.1.0.1í«â¡

    On Error Resume Next

   'é©ìÆâ¸éDã@èÓïÒéÊìæ
    For i = 1 To MAX_GATE_NO
        sKeyName = "gate" & Format(i, "00")
        iRet = GetPrivateProfileString(SETTEIFILE_INZ_SECTION_NAME, _
                                       sKeyName, _
                                       DEFAILT, sGateData, Len(sGateData), _
                                       PATH_GATE_FILE)
        If iRet = 0 Then
            'Åuí êMämîFâÊñ ÅFé©ìÆâ¸éDã@INIÉtÉ@ÉCÉãì«çûàŸèÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, GATE_INI_READ_ERROR, 0)
            Exit Sub
        End If
          If Len(sGateData) <> 0 Then
            'ÉfÅ[É^ÇÃéÊìæ
            ReDim sFData(15)
            iFCnt = 1
            
            For iFLoop = 1 To Len(sGateData)
                If Mid(sGateData, iFLoop, 1) <> " " And Mid(sGateData, iFLoop, 1) <> "," Then
                    iFLoop2 = iFLoop
                    Do
                        iFLoop2 = iFLoop2 + 1
                        If iFLoop2 > Len(sGateData) Then
                            sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
                            iFCnt = iFCnt + 1
                            If iFCnt >= 16 Then
                                Exit For
                            End If
                            iFLoop = iFLoop2
                            Exit Do
                        End If
                        
                        If Mid(sGateData, iFLoop2, 1) = " " Or Mid(sGateData, iFLoop2, 1) = "," Then
                            sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
                            iFCnt = iFCnt + 1
                            If iFCnt >= 16 Then
                                Exit For
                            End If
                            iFLoop = iFLoop2
                            Exit Do
                        End If
                    Loop
                End If
            Next
            
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúäJén
'            'ã@éÌÉ^ÉCÉvÇ…ÇÊÇ¡Çƒï\é¶ÇçsÇ§ÅB
'            'EÅFEG-Ré©ìÆâ¸éDã@ÅñÅFï\é¶ÇµÇ»Ç¢ÅB
'            If Trim(sFData(4)) = EGR Then
'                LstKiki.AddItem "EG-Ré©ìÆâ¸éDã@" & "#" & i
'                sKikiIP(LstKiki.ListCount - 1) = Trim(sFData(5))
'            End If
'            If Trim(sFData(4)) = MISETI Then
'               'èàóùÇçsÇÌÇ»Ç¢ÅB
'            End If
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúèIóπ
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡äJén
            ' EG20â¸éDã@Ç≈Ç†ÇÍÇŒï\é¶
            If Trim(sFData(GATE_IDX.IDX_KISHU)) = EG20 Then
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzçÌèúäJén
'                LstKiki.AddItem "é©ìÆâ¸éDã@" & "#" & i
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzçÌèúèIóπ
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzí«â¡äJén
                nCorner = CInt(Trim(sFData(GATE_IDX.IDX_RONRI_CORNER)))
                LstKiki.AddItem "é©ìÆâ¸éDã@" & "#" & Trim(sFData(GATE_IDX.IDX_DISP_GOKI)) & _
                                    "(" & Format(nCorner, "00") & ")"
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzí«â¡èIóπ
                sKikiIP(LstKiki.ListCount - 1) = Trim(sFData(GATE_IDX.IDX_ADDRESS))
            End If
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡èIóπ
       End If
    Next
    
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúäJén
'      'é©ìÆâ¸éDã@èÓïÒéÊìæ(NEG)
'    For i = 1 To MAX_GATE_NO
'        sKeyName = "gate" & Format(i, "00")
'        iRet = GetPrivateProfileString(SETTEIFILE_INZ_SECTION_NAME, _
'                                       sKeyName, _
'                                       DEFAILT, sGateData, Len(sGateData), _
'                                       PATH_GATE_FILE)
'        If iRet = 0 Then
'            'Åuí êMämîFâÊñ ÅFé©ìÆâ¸éDã@INIÉtÉ@ÉCÉãì«çûàŸèÌÅvÉçÉOèoóÕ
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, GATE_INI_READ_ERROR, 0)
'            Exit Sub
'        End If
'
'        If Len(sGateData) <> 0 Then
'            'ÉfÅ[É^ÇÃéÊìæ
'            ReDim sFData(15)
'            iFCnt = 1
'
'            For iFLoop = 1 To Len(sGateData)
'                If Mid(sGateData, iFLoop, 1) <> " " And Mid(sGateData, iFLoop, 1) <> "," Then
'                    iFLoop2 = iFLoop
'                    Do
'                        iFLoop2 = iFLoop2 + 1
'                        If iFLoop2 > Len(sGateData) Then
'                            sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
'                            iFCnt = iFCnt + 1
'                            If iFCnt >= 16 Then
'                                Exit For
'                            End If
'                            iFLoop = iFLoop2
'                            Exit Do
'                        End If
'
'                        If Mid(sGateData, iFLoop2, 1) = " " Or Mid(sGateData, iFLoop2, 1) = "," Then
'                            sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
'                            iFCnt = iFCnt + 1
'                            If iFCnt >= 16 Then
'                                Exit For
'                            End If
'                            iFLoop = iFLoop2
'                            Exit Do
'                        End If
'                    Loop
'                End If
'            Next
'
'            'ã@éÌÉ^ÉCÉvÇ…ÇÊÇ¡Çƒï\é¶ÇçsÇ§ÅB
'            'NÅFNEGé©ìÆâ¸éDã@ÅBÅñÅFï\é¶ÇµÇ»Ç¢ÅB
'            If Trim(sFData(4)) = NEG Then
'                LstKiki.AddItem "NEGé©ìÆâ¸éDã@" & "#" & i
'                sKikiIP(LstKiki.ListCount - 1) = Trim(sFData(5))
'            End If
'            If Trim(sFData(4)) = MISETI Then
'               'èàóùÇçsÇÌÇ»Ç¢ÅB
'            End If
'       End If
'    Next
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúèIóπ

FileError:
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : GatePing
'//  ã@î\ñºèÃ  : í êMämîFâÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : é©ìÆâ¸éDã@èÓïÒÇéÊìæï\é¶Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(EG20 V3.4.0.1) 2012-02-13  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyê⁄ë±ã@äÌå©íºÇµëŒâûÅz
'//     REVISIONS :(EG20 V6.1.0.1) 2012-06-12  CODED BY  [TCC] H.Sugimoto
'//                 Åyï\é¶çÜã@â¸ëPëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub ICMPing()
    Dim sKeyName As String
    Dim sGateData As String * PING_GATE_SIZE    'ÇPçsï™ÉtÉ@ÉCÉãì‡óeéÊìæóp
    Dim sFData() As String
    Dim iFCnt As Integer
    Dim iFLoop As Integer
    Dim iFLoop2 As Integer
    Dim i As Integer
    Dim iRet As Integer
    Dim sIP As String * PING_IP_SIZE
    Dim szIniFilePath As String     ' INIÉtÉ@ÉCÉãÉpÉX   ' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡
    Dim nCorner As Integer                      ' ÉRÅ[Éiî‘çÜ    ' EG20 V6.1.0.1í«â¡

    On Error Resume Next

   'é©ìÆâ¸éDã@èÓïÒéÊìæ
    For i = 1 To MAX_GATE_NO
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúäJén
'        sKeyName = "gate" & Format(i, "00")
'        iRet = GetPrivateProfileString(SETTEIFILE_INZ_SECTION_NAME, _
'                                       sKeyName, _
'                                       DEFAILT, sGateData, Len(sGateData), _
'                                       PATH_GATE_FILE)
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúèIóπ
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡äJén
        ' IDUÇÃICM.INIÇ©ÇÁâ¸éDã@èÓïÒÇéÊìæ
        szIniFilePath = PATH_IDU_APP & IDU_ICM_FILE
        sKeyName = "icm" & Format(i, "00")
        iRet = GetPrivateProfileString(IDU_PROFILE_SECTION_NAME_ICM, _
                                    sKeyName, _
                                    DEFAILT, sGateData, Len(sGateData), _
                                    szIniFilePath)
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡èIóπ
        If iRet = 0 Then
            'Åuí êMämîFâÊñ ÅFé©ìÆâ¸éDã@INIÉtÉ@ÉCÉãì«çûàŸèÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, GATE_INI_READ_ERROR, 0)
            Exit Sub
        End If
        
        If Len(sGateData) <> 0 Then
            'ÉfÅ[É^ÇÃéÊìæ
            ReDim sFData(15)
            iFCnt = 1
            
            For iFLoop = 1 To Len(sGateData)
                If Mid(sGateData, iFLoop, 1) <> " " And Mid(sGateData, iFLoop, 1) <> "," Then
                    iFLoop2 = iFLoop
                    Do
                        iFLoop2 = iFLoop2 + 1
                        If iFLoop2 > Len(sGateData) Then
                            sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
                            iFCnt = iFCnt + 1
                            If iFCnt >= 16 Then
                                Exit For
                            End If
                            iFLoop = iFLoop2
                            Exit Do
                        End If
                        
                        If Mid(sGateData, iFLoop2, 1) = " " Or Mid(sGateData, iFLoop2, 1) = "," Then
                            sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
                            iFCnt = iFCnt + 1
                            If iFCnt >= 16 Then
                                Exit For
                            End If
                            iFLoop = iFLoop2
                            Exit Do
                        End If
                    Loop
                End If
            Next
                       
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúäJén
'            If Trim(sFData(4)) <> MISETI Then   'V1.8.0.1 ADD
'            'îªíËIC-MÇÃÉAÉhÉåÉXÉ`ÉFÉbÉNÇçsÇ§ÅB
'             LstKiki.AddItem "îªíËIC-MÉÇÉWÉÖÅ[Éã" & "#" & i
'             sKikiIP(LstKiki.ListCount - 1) = Trim(sFData(14))
'             End If  'V1.8.0.1 ADD
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzçÌèúèIóπ
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡äJén
            If Trim(sFData(5)) <> MISETI Then   'V1.8.0.1 ADD
                'îªíËIC-MÇÃÉAÉhÉåÉXÉ`ÉFÉbÉNÇçsÇ§ÅB
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzçÌèúäJén
'                LstKiki.AddItem "ÇhÇbÇl" & "#" & i
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzçÌèúèIóπ
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzí«â¡äJén
                nCorner = CInt(Trim(sFData(3)))
                LstKiki.AddItem "ÇhÇbÇl" & "#" & Trim(sFData(1)) & _
                                    "(" & Format(nCorner, "00") & ")"
' EG20 V6.1.0.1Åyï\é¶çÜã@â¸ëPëŒâûÅzí«â¡èIóπ
                sKikiIP(LstKiki.ListCount - 1) = Trim(sFData(7))
             End If  'V1.8.0.1 ADD
' EG20 V3.4.0.1Åyê⁄ë±ã@äÌå©íºÇµëŒâûÅzí«â¡èIóπ
       End If
    Next
        
FileError:
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : OptTe_Click
'//  ã@î\ñºèÃ  : ÉâÉWÉIñtÅFéËì¸óÕëIëéûèàóù
'//  ã@î\äTóv  : âÊñ ÇçXêVÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub OptTe_Click()
    
    On Error Resume Next
   
    'Åuí êMämîFâÊñ ÅFéËì¸óÕëIëÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, CONECT_GAMEN_HAND_PING, 0)
 
    frmTe.Enabled = True
    txtIP1(0).Enabled = True
    txtIP1(1).Enabled = True
    txtIP1(2).Enabled = True
    txtIP1(3).Enabled = True
    lblIP10.Enabled = True
    lblIP11.Enabled = True
    lblIP12.Enabled = True
    cmdNum(0).Enabled = True
    cmdNum(1).Enabled = True
    cmdNum(2).Enabled = True
    cmdNum(3).Enabled = True
    cmdNum(4).Enabled = True
    cmdNum(5).Enabled = True
    cmdNum(6).Enabled = True
    cmdNum(7).Enabled = True
    cmdNum(8).Enabled = True
    cmdNum(9).Enabled = True
    cmdOct.Enabled = True
    cmdBs.Enabled = True
    cmdC.Enabled = True
    
    frmkiki.Enabled = False
    txtIP2(0).Enabled = False
    txtIP2(1).Enabled = False
    txtIP2(2).Enabled = False
    txtIP2(3).Enabled = False
    lblIP20.Enabled = False
    lblIP21.Enabled = False
    lblIP22.Enabled = False
    LstKiki.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : OptKiki_Click
'//  ã@î\ñºèÃ  : ÉâÉWÉIñtÅFã@äÌëIëëIëéûèàóù
'//  ã@î\äTóv  : âÊñ ÇçXêVÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub OptKiki_Click()
    
    On Error Resume Next
    
    'Åuí êMämîFâÊñ ÅFã@äÌëIëÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, CONECT_GAMEN_KIKI_PING, 0)
    
    frmTe.Enabled = False
    txtIP1(0).Enabled = False
    txtIP1(1).Enabled = False
    txtIP1(2).Enabled = False
    txtIP1(3).Enabled = False
    lblIP10.Enabled = False
    lblIP11.Enabled = False
    lblIP12.Enabled = False
    cmdNum(0).Enabled = False
    cmdNum(1).Enabled = False
    cmdNum(2).Enabled = False
    cmdNum(3).Enabled = False
    cmdNum(4).Enabled = False
    cmdNum(5).Enabled = False
    cmdNum(6).Enabled = False
    cmdNum(7).Enabled = False
    cmdNum(8).Enabled = False
    cmdNum(9).Enabled = False
    cmdOct.Enabled = False
    cmdBs.Enabled = False
    cmdC.Enabled = False
    
    frmkiki.Enabled = True
    txtIP2(0).Enabled = True
    txtIP2(1).Enabled = True
    txtIP2(2).Enabled = True
    txtIP2(3).Enabled = True
    lblIP20.Enabled = True
    lblIP21.Enabled = True
    lblIP22.Enabled = True
    LstKiki.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdNum_Click
'//  ã@î\ñºèÃ  : äeêîéöñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ÉeÉLÉXÉgÉ{ÉbÉNÉXÇ…IPï\é¶
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      :IntegerÅ@Å@IndexÅ@Å@[IN]âüâ∫ñtÉCÉìÉfÉbÉNÉX
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdNum_Click(Index As Integer)

    If Len(txtIP1(0).Text) <> 3 And bIP0 = False Then
        txtIP1(0).Text = txtIP1(0).Text & Trim(str(Index))
        Exit Sub
    End If
    If Len(txtIP1(1).Text) <> 3 And bIP1 = False Then
        txtIP1(1).Text = txtIP1(1).Text & Trim(str(Index))
        Exit Sub
    End If
    If Len(txtIP1(2).Text) <> 3 And bIP2 = False Then
        txtIP1(2).Text = txtIP1(2).Text & Trim(str(Index))
        Exit Sub
    End If
    If Len(txtIP1(3).Text) <> 3 Then
        txtIP1(3).Text = txtIP1(3).Text & Trim(str(Index))
        Exit Sub
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdOct_Click
'//  ã@î\ñºèÃ  : ÉIÉNÉeÉbÉh(Åu.Åv)ñtâüâ∫éûèàóù
'//  ã@î\äTóv  :
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdOct_Click()

    If Len(txtIP1(0).Text) <> 3 And bIP0 = False And Len(txtIP1(0)) <> 0 Then
        bIP0 = True
        Exit Sub
    End If
    If Len(txtIP1(1).Text) <> 3 And bIP1 = False And Len(txtIP1(1)) <> 0 Then
        bIP1 = True
        Exit Sub
    End If
    If Len(txtIP1(2).Text) <> 3 And bIP2 = False And Len(txtIP1(2)) <> 0 Then
        bIP2 = True
        Exit Sub
    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdBs_Click
'//  ã@î\ñºèÃ  : ÅuBSÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  :
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdBs_Click()

    If Len(txtIP1(3).Text) <> 0 Then
        txtIP1(3).Text = Left(txtIP1(3).Text, Len(txtIP1(3).Text) - 1)
        Exit Sub
    End If
    
    If bIP2 = True Then
        bIP2 = False
    End If

    If Len(txtIP1(2).Text) <> 0 Then
        txtIP1(2).Text = Left(txtIP1(2).Text, Len(txtIP1(2).Text) - 1)
        Exit Sub
    End If
    
    If bIP1 = True Then
        bIP1 = False
    End If

    If Len(txtIP1(1).Text) <> 0 Then
        txtIP1(1).Text = Left(txtIP1(1).Text, Len(txtIP1(1).Text) - 1)
        Exit Sub
    End If
    
    If bIP0 = True Then
        bIP0 = False
    End If

    If Len(txtIP1(0).Text) <> 0 Then
        txtIP1(0).Text = Left(txtIP1(0).Text, Len(txtIP1(0).Text) - 1)
        Exit Sub
    End If

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdC_Click
'//  ã@î\ñºèÃ  : ÅuÉNÉäÉAÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : IPÉeÉLÉXÉgÉ{ÉbÉNÉXÇÉNÉäÉAÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdC_Click()

    txtIP1(0).Text = ""
    txtIP1(1).Text = ""
    txtIP1(2).Text = ""
    txtIP1(3).Text = ""
    
    bIP0 = False
    bIP1 = False
    bIP2 = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : txtIP1_KeyPress
'//  ã@î\ñºèÃ  : ÉeÉLÉXÉgÉ{ÉbÉNÉXéËì¸óÕèàóù
'//  ã@î\äTóv  :
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub txtIP1_KeyPress(Index As Integer, KeyAscii As Integer)
  If KeyAscii = 46 Then
        If Index <> 3 Then
            txtIP1(Index + 1).SetFocus
        End If
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : txtIP1_Change
'//  ã@î\ñºèÃ  : ÉeÉLÉXÉgÉ{ÉbÉNÉXéËì¸óÕèàóù
'//  ã@î\äTóv  :
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : IntegerÅ@Index
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub txtIP1_Change(Index As Integer)
    If InStr(txtIP1(Index).Text, ".") <> 0 Then
        txtIP1(Index).Text = Replace(txtIP1(Index).Text, ".", "")
        Select Case Index
            Case 0:
                bIP0 = True
            Case 1:
                bIP1 = True
            Case 2:
                bIP2 = True
        End Select
    End If
    If Len(txtIP1(Index).Text) = 3 Then
        If Index <> 3 Then
            txtIP1(Index + 1).SetFocus
        End If
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : LstKiki_Click
'//  ã@î\ñºèÃ  : ã@äÌÉäÉXÉgÉ{ÉbÉNÉXâüâ∫éûèàóù
'//  ã@î\äTóv  : ã@äÌì¸óÕÉeÉLÉXÉgÉ{ÉbÉNÉXÇ…IPÉAÉhÉåÉXï\é¶ÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : IntegerÅ@Index
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub LstKiki_Click()
    Dim sText As String
    Dim i As Integer
    Dim iTop As Integer
    Dim iText As Integer
    
    For i = 0 To 3
      txtIP2(i).Text = " "
    Next
    
    sText = sKikiIP(LstKiki.ListIndex)
    iTop = 1
    iText = 0
    
    'sTextÇ™Ç»Ç¢èÍçáÅAÉeÉLÉXÉgÇ…ÉuÉâÉìÉNÇÉZÉbÉgÇµÅAèàóùèIóπ
    If Len(sText) = 0 Then
        For i = 0 To 3
            txtIP2(i).Text = ""
        Next
        Exit Sub
    End If
        
    'IPÉAÉhÉåÉXÇÉeÉLÉXÉgÇ…ÉZÉbÉg
    For i = 1 To Len(sText)
        If Mid(sText, i, 1) = "." Then
            txtIP2(iText).Text = Mid(sText, iTop, i - iTop)
            iTop = i + 1
            iText = iText + 1
        End If
    Next
       
    txtIP2(iText).Text = Right(sText, Len(sText) - iTop + 1)
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdZikko_Click
'//  ã@î\ñºèÃ  : ÉeÉLÉXÉgÉ{ÉbÉNÉXéËì¸óÕèàóù
'//  ã@î\äTóv  :
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : IntegerÅ@Index
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(EG30 31.2.0.1) 2015-07-17   REVISED BY [TCC] T.Nakajima
'//                 pingÇÃÉXÉeÅ[É^ÉXÇï\é¶Ç≈Ç´ÇÈÇÊÇ§èCê≥
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdZikko_Click()
  Dim host_path As String
  Dim wsaDD As wsaDATA
  Dim i As Integer
  Dim VerReq As Integer
  Dim rc As Long
  Dim HostAddress As Long
  Dim IcmpHandle As Long
  Dim RepryBuffer As ICMP_REPRY_BUFFER  'ICMPâûìöéÛêMÉoÉbÉtÉ@

    On Error GoTo ERR_SPACE
    
    'Åuí êMämîFâÊñ ÅFPINGé¿çsñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, CONECT_GAMEN_PING_BUTTOM, 0)
    
    LstStatus.Clear
    DoEvents

    Me.Enabled = False
    cmdZikko.Enabled = False
    If OptTe.Value = True Then
        host_path = Trim(txtIP1(0).Text) & "." & _
                    Trim(txtIP1(1).Text) & "." & _
                    Trim(txtIP1(2).Text) & "." & _
                    Trim(txtIP1(3).Text)
        If Len(Trim(txtIP1(0).Text)) = 0 Or _
            Len(Trim(txtIP1(1).Text)) = 0 Or _
            Len(Trim(txtIP1(2).Text)) = 0 Or _
            Len(Trim(txtIP1(3).Text)) = 0 Then
            
            LstStatus.AddItem "Unknown host " & host_path
            Me.Enabled = True
            cmdZikko.Enabled = True
            Exit Sub
        End If
    Else
        host_path = txtIP2(0).Text & "." & _
                    txtIP2(1).Text & "." & _
                    txtIP2(2).Text & "." & _
                    txtIP2(3).Text
        If Len(txtIP2(0).Text) = 0 Or _
            Len(txtIP2(1).Text) = 0 Or _
            Len(txtIP2(2).Text) = 0 Or _
            Len(txtIP2(3).Text) = 0 Then

            LstStatus.AddItem "Unknown host " & host_path
            Me.Enabled = True
            cmdZikko.Enabled = True
            Exit Sub
        End If
    End If
    DoEvents
    
    'á@WinSockAPIÇÃèâä˙âª
    VerReq = MakeInteger(1, 1)                      'WinSock1.1ÇóvãÅ
    rc = WSAStartup(VerReq, wsaDD)
    If rc <> 0 Then
        'WinsockÉäÉ\Å[ÉXÇÃämï€Ç…é∏îs
        Me.Enabled = True
        cmdZikko.Enabled = True
        Exit Sub
    End If
    
    'áAëóêMêÊÇÃIPÉAÉhÉåÉXÇÃéÊìæ
    HostAddress = inet_addr(host_path)              'IPÉAÉhÉåÉXÇ…ïœä∑(êîílÇÃèÍçá ex:127.0.0.1)
    
    Call WSACleanup                                 'WinSockÇÃÉNÉçÅ[ÉY

    'áBICMPÇégÇ¡ÇƒÉGÉRÅ[ÇëóÇÈ
    If HostAddress <> INADDR_NONE Then
        'ICMPëÄçÏÉnÉìÉhÉãéÊìæ
        IcmpHandle = IcmpCreateFile()
        
        LstStatus.AddItem "Pinging " & host_path & " with 32 bytes of data:"
        DoEvents
        
        'ÉGÉRÅ[ÇÇSâÒëóÇÈ
        For i = 1 To 4
            'EG30 V31.2.0.1 DEL START
            'rc = IcmpSendEcho(IcmpHandle, HostAddress, 8, 0, 0, RepryBuffer, Len(RepryBuffer), 300)
            'If rc = 0 Then
            '    LstStatus.AddItem "Request timed out."
            'Else
            '    LstStatus.AddItem "Reply From " & host_path & _
            '                     ": bytes=32 " & _
            '                     "time=" & RepryBuffer.EchoRepry.RoundTripTime & "ms " & _
            '                     "TTL=" & CByte("128")
            'End If
            'EG30 V31.2.0.1 DEL END
            'EG30 V31.2.0.1 ADD START
            call IcmpSendEcho(IcmpHandle, HostAddress, 8, 0, 0, RepryBuffer, Len(RepryBuffer), 300)
            If RepryBuffer.EchoRepry.Status = ICMP_SUCCESS Then
                LstStatus.AddItem "Reply From " & host_path & _
                                 ": bytes=32 " & _
                                 "time=" & RepryBuffer.EchoRepry.RoundTripTime & "ms " & _
                                 "TTL=" & CByte("128")
            Else
                LstStatus.AddItem EvaluatePingResponse(RepryBuffer.EchoRepry.Status)
            End If
            'EG30 V31.2.0.1 ADD END
            DoEvents
        Next
        
        'ICMPëÄçÏÉnÉìÉhÉãÉNÉçÅ[ÉY
        rc = IcmpCloseHandle(IcmpHandle)
    Else
        LstStatus.AddItem "Unknown host " & host_path
    End If
    Me.Enabled = True
    cmdZikko.Enabled = True
ERR_SPACE:
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdCancel_Click
'//  ã@î\ñºèÃ  : ÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  :Å@é©âÊñ Çè¡ãéÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdCancel_Click()
    On Error Resume Next
    
    'Åuí êMämîFâÊñ ÅFè¡ãéÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, CONECT_GAMEN_END, 0)
    Unload Me
End Sub

'V1.3.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMÉ^ÉCÉ}ÅAÉ^ÉCÉÄÉAÉbÉvèàóù
'//  ã@î\äTóv  : ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()
  'ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
    If pfComMailRecieve = ML_ID_HOSHU_ACTIVE_REQ Then
       'ï€éÁâÊñ ÉAÉNÉeÉBÉuóvãÅÇéÛêMÇµÇΩÇÁÅAé©âÊñ ÇëOñ Ç…ï\é¶Ç≥ÇπÇÈÅB
        AppActivate frmPing.Caption, False
        pfFormActive (frmPing.hwnd)
    End If
End Sub
'V1.3.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2012 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : psAddKikiCornerName
'//  ã@î\ñºèÃ  : è„à ã@äÌÉRÅ[ÉiñºèÃí«â¡èàóù
'//  ã@î\äTóv  : è„à ã@äÌñºèÃÇ…ëŒÇµÇƒÉRÅ[ÉiñºèÃÇïtâ¡Ç∑ÇÈïKóvÇ™Ç†ÇÍÇŒí«â¡Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : String Å@ sName     [IN]è„à ã@äÌñºèÃ
'//  à¯êî      : IntegerÅ@ iAreaID   [IN]è„à ã@äÌí êMèÛë‘ÉGÉäÉAID
'//  à¯êî      : IntegerÅ@ nIndex    [IN]è„à ã@äÌê›íËç\ê¨
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V3.4.0.1) 2012-02-21  CODED BY  [TCC] H.Sugimoto
'//                 EG20ÉtÉFÅ[ÉYÇQëŒâûÅyê⁄ë±ã@äÌå©íºÇµëŒâûÅz
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub psAddKikiCornerName(sName As String, iAreaID As Integer, nIndex As Integer)

    Dim nCorner As Integer                  ' ÉRÅ[ÉiÉCÉìÉfÉbÉNÉX
    Dim szCornerName As String              ' ÉRÅ[ÉiñºèÃ
    Dim szResultName As String              ' èoóÕñºèÃ

    szResultName = ""
    nCorner = 0                                         ' ÉRÅ[Éiê›íËïsóv
    gTransKikiInfo(nIndex).nIniListNo = nIndex          ' äOïîã@äÌÉäÉXÉgî‘çÜ
    gTransKikiInfo(nIndex).iAreaID = iAreaID            ' éQè∆ÉGÉäÉA
    gTransKikiInfo(nIndex).nCorner = nCorner
    gTransKikiInfo(nIndex).bStatus = True
    ' 1.ëŒè€äOïîã@äÌè„à ã@äÌí êMèÛë‘ÉGÉäÉAIDÇÉ`ÉFÉbÉNÇµÇƒ
    '   ê⁄ë±ëŒè€ÇëIï Ç∑ÇÈÅB
    Select Case iAreaID
    Case IdKikiComSts.ID_DESYU_COM                                       ' 1:ÉfèWí êMèÛë‘
        nCorner = 1
    Case IdKikiComSts.ID_DESYU2_COM                                      ' 9:ÉfèW2í êMèÛë‘
        nCorner = 2
    Case IdKikiComSts.ID_DESYU3_COM                                      ' 10:ÉfèW3í êMèÛë‘
        nCorner = 3
    Case IdKikiComSts.ID_DESYU4_COM                                      ' 11:ÉfèW4í êMèÛë‘
        nCorner = 4
    Case IdKikiComSts.ID_DESYU5_COM                                      ' 12:ÉfèW5í êMèÛë‘
        nCorner = 5
    Case IdKikiComSts.ID_DESYU6_COM                                      ' 13:ÉfèW6í êMèÛë‘
        nCorner = 6
    Case IdKikiComSts.ID_ENKAKU_COM                                      ' 2:âìäuí êMèÛë‘
        gTransKikiInfo(nIndex).bStatus = False
        nCorner = 1
    Case IdKikiComSts.ID_ENKAKU2_COM                                     ' 21:âìäu2í êMèÛë‘ÅiÉGÉäÉAíËã`Ç»ÇµÅj
        gTransKikiInfo(nIndex).bStatus = False
        nCorner = 2
    Case IdKikiComSts.ID_ENKAKU3_COM                                     ' 22:âìäu3í êMèÛë‘ÅiÉGÉäÉAíËã`Ç»ÇµÅj
        gTransKikiInfo(nIndex).bStatus = False
        nCorner = 3
    Case IdKikiComSts.ID_ENKAKU4_COM                                     ' 23:âìäu4í êMèÛë‘ÅiÉGÉäÉAíËã`Ç»ÇµÅj
        gTransKikiInfo(nIndex).bStatus = False
        nCorner = 4
    Case IdKikiComSts.ID_ENKAKU5_COM                                     ' 24:âìäu5í êMèÛë‘ÅiÉGÉäÉAíËã`Ç»ÇµÅj
        gTransKikiInfo(nIndex).bStatus = False
        nCorner = 5
    Case IdKikiComSts.ID_ENKAKU6_COM                                     ' 25:âìäu6í êMèÛë‘ÅiÉGÉäÉAíËã`Ç»ÇµÅj
        gTransKikiInfo(nIndex).bStatus = False
        nCorner = 6
    Case Else
    End Select

    If nCorner <> 0 Then
        If gblnCornerSet(nCorner - 1) <> True Then
            gTransKikiInfo(nIndex).bStatus = False
        End If
        szCornerName = "(" & Format(nCorner, "00") & ")"
    End If
    szResultName = Left(sName, InStr(sName, Chr(0)) - 1)
    szResultName = szResultName + szCornerName
    gTransKikiInfo(nIndex).sGetInf = szResultName

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : OperatePing
'//  ã@î\ñºèÃ  : ëÄçÏëÏê›íËçÏê¨
'//  ã@î\äTóv  : ëÄçÏëÏèÓïÒÇéÊìæï\é¶Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(EG20 V6.1.0.1) 2012-06-08  CODED BY  [TCC] H.Sugimoto
'//                 ÅyëÄçÏëÏÇoÇhÇmÇfëŒâûÅz
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub OperatePing()
  
    Dim iLoop As Integer                ' ÉãÅ[Év
    Dim lSts As Long                    ' INIéÊìæèàóùñﬂÇËíl
    Dim ikousei As Integer              ' ê›íuç\ê¨
    Dim szSection As String             ' ÉZÉNÉVÉáÉì
    Dim sIP As String                   ' éÊìæIPÉAÉhÉåÉX
    Dim sGetString As String * 128      ' INIéÊìæï∂éöóÒ
    Dim szDispName As String            ' ï\é¶ñº
    Dim nNullIndex As Integer           ' ï∂éöêîÉèÅ[ÉN
  
    On Error Resume Next
  
  
    ' ëÄçÏëÏÉRÅ[Éiêîï™ÉãÅ[Év
    For iLoop = 1 To 6
        szSection = "KOUSEI" & Format(iLoop, "0") & "_INFO"
        szDispName = "ëÄçÏëÏ" & "(" & Format(iLoop, "00") & ")"
        
        ' ÉRÅ[Éiê›íËóLÇË
        ' OPERATE.INIÉtÉ@ÉCÉãÇ©ÇÁÅuê⁄ë±óLñ≥(0:ê›íuÇ»ÇµÅA1:ê›íuÇ†ÇËÅjÅvÇéÊìæÇ∑ÇÈÅB
        ikousei = GetPrivateProfileInt(szSection, "kousei", _
                                           0, OPERATEINI_FILE)
        
        If ikousei = 1 Then
            ' OPERATE.INIÉtÉ@ÉCÉãÇ©ÇÁÅuÇhÇoÉAÉhÉåÉXÅvÇéÊìæÇ∑ÇÈÅB
            lSts = GetPrivateProfileString(szSection, _
                                           "ip_address", _
                                           "0.0.0.0", _
                                           sGetString, _
                                           Len(sGetString), _
                                           OPERATEINI_FILE)
        
            LstKiki.AddItem szDispName
            
            nNullIndex = InStr(sGetString, Chr(0))
            If nNullIndex <> 0 Then
                sIP = Left(sGetString, nNullIndex - 1)
            Else
                sIP = sGetString
            End If
            sKikiIP(LstKiki.ListCount - 1) = Trim(sIP)
        End If
    Next iLoop
  
End Sub


