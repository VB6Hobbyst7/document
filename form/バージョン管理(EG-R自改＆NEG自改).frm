VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "COMDLG32.OCX"
Begin VB.Form frmJVer 
   BorderStyle     =   0  'Ç»Çµ
   Caption         =   "é©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óù"
   ClientHeight    =   9000
   ClientLeft      =   165
   ClientTop       =   -210
   ClientWidth     =   12000
   ClipControls    =   0   'False
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÇoÉSÉVÉbÉN"
      Size            =   9.75
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   Moveable        =   0   'False
   NegotiateMenus  =   0   'False
   PaletteMode     =   1  'Z µ∞¿ﬁ∞
   ScaleHeight     =   9000
   ScaleWidth      =   12000
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows ÇÃä˘íËíl
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   8640
      Top             =   8040
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.CommandButton cmdReturn 
      Caption         =   "   ÉÅÉjÉÖÅ[     âÊñ Ç÷ñﬂÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1095
      Left            =   9360
      TabIndex        =   30
      Top             =   7800
      Width           =   2415
   End
   Begin VB.CommandButton cmdVer 
      Caption         =   "î}ëÃèoóÕ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   2
      Left            =   9720
      TabIndex        =   29
      Top             =   4080
      Width           =   2055
   End
   Begin VB.CommandButton cmdVer 
      Caption         =   "ÉeÉLÉXÉgï\é¶"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   1
      Left            =   9720
      TabIndex        =   28
      Top             =   3240
      Width           =   2055
   End
   Begin VB.CommandButton cmdInstall 
      Caption         =   "î}ëÃéÊäO"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   9720
      TabIndex        =   27
      Top             =   5760
      Width           =   2055
   End
   Begin VB.CommandButton cmdLzhFileCopy 
      Caption         =   " à≥èkÉtÉ@ÉCÉã      Å®ÉèÅ[ÉN ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Left            =   2760
      TabIndex        =   26
      Top             =   7200
      Width           =   2295
   End
   Begin VB.ListBox lstKan 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   5580
      Left            =   120
      TabIndex        =   15
      Top             =   1440
      Width           =   7335
   End
   Begin VB.Frame fraResource 
      Caption         =   "ï\é¶ÉäÉ\Å[ÉXéwíË"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   1575
      Left            =   7560
      TabIndex        =   17
      Top             =   720
      Width           =   4215
      Begin VB.OptionButton optSyubetu 
         Caption         =   "îªíËCPU-Pro"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   240
         TabIndex        =   0
         Top             =   360
         Value           =   -1  'True
         Width           =   1815
      End
      Begin VB.OptionButton optSyubetu 
         Caption         =   "ÉÅÉCÉìCPU-Pro"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   2160
         TabIndex        =   1
         Top             =   360
         Width           =   1935
      End
      Begin VB.OptionButton optSyubetu 
         Caption         =   "ÉTÉuCPU-Pro"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   2
         Left            =   240
         TabIndex        =   2
         Top             =   720
         Width           =   1815
      End
      Begin VB.OptionButton optSyubetu 
         Caption         =   "ÉÅÉCÉìCPU-OS"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   3
         Left            =   2160
         TabIndex        =   3
         Top             =   720
         Width           =   1935
      End
      Begin VB.OptionButton optSyubetu 
         Caption         =   "ó\îı1"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   4
         Left            =   240
         TabIndex        =   4
         Top             =   1080
         Width           =   1815
      End
      Begin VB.OptionButton optSyubetu 
         Caption         =   "ó\îı2"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   5
         Left            =   2160
         TabIndex        =   5
         Top             =   1080
         Width           =   1935
      End
   End
   Begin VB.CommandButton cmdUpdate 
      Caption         =   "ãåÅ®é¿çs ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   3
      Left            =   5400
      TabIndex        =   14
      Top             =   8160
      Width           =   2295
   End
   Begin VB.CommandButton cmdUpdate 
      Caption         =   "ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   2
      Left            =   5400
      TabIndex        =   13
      Top             =   7200
      Width           =   2295
   End
   Begin VB.CommandButton cmdUpdate 
      Caption         =   "î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ["
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   1
      Left            =   2760
      TabIndex        =   12
      Top             =   8160
      Width           =   2295
   End
   Begin VB.CommandButton cmdUpdate 
      Caption         =   "ÉèÅ[ÉN ÉNÉäÉA"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   0
      Left            =   120
      TabIndex        =   11
      Top             =   7200
      Width           =   2295
   End
   Begin VB.CommandButton cmdVer 
      Caption         =   "ï\é¶çXêV"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   0
      Left            =   9720
      TabIndex        =   9
      Top             =   2400
      Width           =   2055
   End
   Begin VB.CommandButton cmdVer 
      Caption         =   "é©â¸êÿÇËó£Çµ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   3
      Left            =   9720
      TabIndex        =   10
      Top             =   4920
      Width           =   2055
   End
   Begin VB.Frame fraVersion 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   1815
      Left            =   7560
      TabIndex        =   16
      Top             =   2520
      Width           =   2055
      Begin VB.CheckBox chkFolder 
         Caption         =   "W ÉèÅ[ÉN"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   6
         Top             =   360
         Value           =   1  '¡™Ø∏
         Width           =   1815
      End
      Begin VB.CheckBox chkFolder 
         Caption         =   "O ãå"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   8
         Top             =   1320
         Value           =   1  '¡™Ø∏
         Width           =   1815
      End
      Begin VB.CheckBox chkFolder 
         Caption         =   "N é¿çs"
         BeginProperty Font 
            Name            =   "ÇlÇr ÉSÉVÉbÉN"
            Size            =   11.25
            Charset         =   128
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   7
         Top             =   840
         Value           =   1  '¡™Ø∏
         Width           =   1815
      End
   End
   Begin VB.Timer tmrMail 
      Left            =   8160
      Top             =   8040
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00800000&
      Caption         =   "NEGé©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óù"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   375
      Left            =   0
      TabIndex        =   31
      Top             =   0
      Width           =   12015
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ÉRÉÅÉìÉg"
      Height          =   255
      Index           =   6
      Left            =   2880
      TabIndex        =   25
      Top             =   1200
      Width           =   4575
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "Ver"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   6840
      TabIndex        =   24
      Top             =   840
      Width           =   615
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "çÏê¨ì˙éû"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   5190
      TabIndex        =   23
      Top             =   840
      Width           =   1665
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ÉtÉ@ÉCÉã"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3930
      TabIndex        =   22
      Top             =   840
      Width           =   1350
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ã@éÌñº"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   2880
      TabIndex        =   21
      Top             =   840
      Width           =   1095
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "Ã´Ÿ¿ﬁ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Index           =   1
      Left            =   2040
      TabIndex        =   20
      Top             =   840
      Width           =   855
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ÉtÉ@ÉCÉãñº"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Index           =   0
      Left            =   360
      TabIndex        =   19
      Top             =   840
      Width           =   1695
   End
   Begin VB.Label lblKan 
      Alignment       =   2  'íÜâõëµÇ¶
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "É^ÉCÉv"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Index           =   7
      Left            =   120
      TabIndex        =   18
      Top             =   840
      Width           =   255
   End
End
Attribute VB_Name = "frmJVer"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 ALL Rights Reserved
'//
'//  ÉtÉ@ÉCÉãñº  ÅFfrmJVer.frm
'//  ÉpÉbÉPÅ[ÉWñºÅFÉoÅ[ÉWÉáÉìä«óù(EG-Ré©â¸/NEGé©â¸)âÊñ 
'//
'//  äTóvÅFÉoÅ[ÉWÉáÉìä«óù(EG-Ré©â¸/NEGé©â¸)âÊñ 
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@ÉvÉçîªê≥ìñê´É`ÉFÉbÉNèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-11   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRëŒâû
'//                     ÅEã@éÌê≥ìñê´É`ÉFÉbÉNèàóùí«â¡/ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Åvéû
'//                     ÅEÉtÉFÅ[ÉYÇQïsãÔçáèCê≥
'//                     ÅEÉtÉFÅ[ÉYÇPïsãÔçáèCê≥
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.11.0.1) 2009-10-23  CODED   BY [TCC] D.Yamashita
'//                 ÅEÉtÉFÅ[ÉYÇRécåèçÄñ⁄ëŒâû
'//     REVISIONS :(1.12.0.1) 2009-11-11  REVISED BY [TCC] C.Terui
'//                 ì¸óÕÉtÉ@ÉCÉãäiî[ÉfÉBÉåÉNÉgÉäà íuïœçX
'//                 ÉtÉHÉãÉ_ëIëÉ|ÉbÉvÉAÉbÉvâÊñ ÇÃèâä˙ÉtÉHÉãÉ_ïœçX
'//     REVISIONS :(1.16.0.1) 2009-12-21   REVISED BY [TCC] S.Terao
'//                 ïsãÔçáëŒâû
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                á@ ÉtÉHÉãÉ_ëIëâÊñ ÇOSédólÇ…ïœçX
'//                áAÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫Ç…ÇƒÅA
'//                 Å@ÉoÅ[ÉWÉáÉìä«óùâÊñ ÇÃÉoÅ[ÉWÉáÉìï\é¶çXêVÇçsÇ§
'//                áBï\é¶ÉäÉ\Å[ÉXÉâÉWÉIñtëIëÇ≈ÉäÉXÉgÇÃï\é¶çXêV
'//                áCÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃã@éÌê≥ìñê´É`ÉFÉbÉNïœçX
'//                áDÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃê≥ìñê´É`ÉFÉbÉNiniÉtÉ@ÉCÉãâª
'//                áEDirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//                áFÉtÉ@ÉCÉãëIëâÊñ ÇOSédólÇ…ïœçX
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(V2.5.0.1) 2010-10-29  REVISED BY [TCC] S.Terao
'//                 EG-R(KK)Å@î™íöìÎëŒâûÅ@KUKê≥ìñê´É`ÉFÉbÉNïœçX
'//                 î}ëÃéÊäOïsãÔçáèCê≥
'//     REVISIONS :(2.6.0.1) 2010-11-16  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãñºÉ`ÉFÉbÉNïsãÔçáèCê≥
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Option Explicit

Dim FolderSyubetu As Integer                 'ëIëÉäÉ\Å[ÉXéÌï 

Dim FolderName(0 To 2, 0 To 7) As String     'ÉtÉHÉãÉ_ñº
Dim TitleBox(0 To 7) As String               'É^ÉCÉgÉãñº
Dim LogBox(0 To 7) As String                 'ÉçÉOèoóÕópÉ^ÉCÉgÉãñº
Dim FileList() As String                     'ÉtÉ@ÉCÉãñºÉäÉXÉgàÍóóäiî[ÉGÉäÉA
Dim FileListType() As String                 'ÉtÉ@ÉCÉãÉäÉXÉgàÍóóäiî[ÉGÉäÉAÅiéüê¢ë„é©â¸É^ÉCÉvÇä‹ÇﬁÅj
Dim uVersion() As MN_VERSION_JIKAI           'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉA

'ëIëíÜÉäÉ\Å[ÉXéÌï  =0=MN_RSOC_PROÅFÉvÉçÉOÉâÉÄÅA=1=MN_RSOC_HAN:îªíËÉfÅ[É^
Dim iSelResource As Integer

Private Const MN_MAIL_INTERVAL = 1000       'ÉÅÅ[ÉãÉ^ÉCÉ}ÇÃÉCÉìÉ^Å[ÉoÉãíl

Private Const MN_FOLD_WRK = 0               'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_
Private Const MN_FOLD_NOW = 1               'Åué¿çsÅvÉtÉHÉãÉ_
Private Const MN_FOLD_OLD = 2               'ÅuãåÅvÉtÉHÉãÉ_

'ÉoÅ[ÉWÉáÉìÉfÅ[É^ÉtÉ@ÉCÉãópÇÃç\ë¢ëÃ
Private Type MN_VERSION_FILE
    sFileName As String * 12                'ÉtÉ@ÉCÉãñº
    uFooter As MN_FOOT_BYTE                 'ÉtÉbÉ^èÓïÒ
End Type

Private Type MN_VERSION_DAT
    strFolder(0 To 5) As String * 8         'ÉtÉHÉãÉ_ñº
    intFileNum(0 To 5) As Integer           'ÉtÉ@ÉCÉãêî
End Type
'ÉoÅ[ÉWÉáÉìÉfÅ[É^ÉtÉ@ÉCÉãèÓïÒ(ÉoÅ[ÉWÉáÉì2)
Private Type MN_FILE_INFO_V2
    udtInfo As MN_VERSION_DAT               'ÉtÉHÉãÉ_ñºÇ∆ÉtÉ@ÉCÉãêî
    uFileInfo() As MN_VERSION_FILE          'ÉtÉ@ÉCÉãñºÇ∆ÉtÉbÉ^èÓïÒ
End Type

Dim uVerdataFile As MN_FILE_INFO_V2

Private Const HANKUKA_KUK = "HAN_KUKA.KUK"
Private Const INI_MAX = 5
Dim HAN_KUKA_DATA As HANTEI_DATA
Private Type HANTEI_DATA
    sHederKisyu(0 To 4) As String
    sHederFile(0 To 4) As String
    sFotterKisyu(0 To 4) As String
    sFotterFile(0 To 4) As String
End Type

'V1.4.0.1Å@ADDÅ@START
Private Const FILE_NAME_MAX_SIZE = 12
Private Const FILE_NAME_SIZE = 19
'Åyâ^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌÉXÉeÅ[É^ÉXíËã`Åz
Private sNGSts As String        'NGà íu
Private sNGKoumoku As String    'NGçÄñ⁄
'ÅyNGà íuÅz
Private Const ERROR_HEDER = "ÉwÉbÉ_"  'ÉwÉbÉ_
Private Const ERROR_FOTTER = "ÉtÉbÉ^" 'ÉtÉbÉ^
'ÅyNGçÄñ⁄Åz
Private Const KISHU_NAME_ERROR = "ã@éÌñº"       'ã@éÌñº
Private Const FILE_NAME_ERRORE = "ÉtÉ@ÉCÉãñº"   'ÉtÉ@ÉCÉãñº
Private Const CREATE_DATA_ERROR = "çÏê¨ì˙ït"    'çÏê¨ì˙ït
Private Const VERSION_ERROR = "ÉoÅ[ÉWÉáÉì"      'ÉoÅ[ÉWÉáÉì
Private sJverName As String                     'ï\é¶ÉÅÉbÉZÅ[ÉWÉ{ÉbÉNÉXÉ^ÉCÉgÉã
Private Const EGR_JIKAI = "EG-R"                'EG-R
Private Const NEG_JIKAI = "NEG"                 'NEG
'V1.4.0.1Å@ADDÅ@END
'V1.6.0.1 ADD START
Private Const EGR_JIKAI_KISHU = "EG5000"        'EG-Ré©â¸ã@éÌñº
Private Const NEG_JIKAI_KISHU = "EG2000"        'NEGé©â¸ã@éÌñº
'V1.20.0.1 DEL START
'EG-Ré©â¸
'Private Const EHANTEI_CPU_CHK_FILE = "ko_gateh.vef"
'Private Const EMAIN_CPU_CHK_FILE = "ko_gatep.vef"
'Private Const ESUB_CPU_CHK_FILE = "ko_gatef.vef"
'Private Const EMAIN_OS_CHK_FILE = "ko_gateo.vef"
''NEGé©â¸
'Private Const NHANTEI_CPU_CHK_FILE = "KO_GATEH.VEF"
'Private Const NMAIN_CPU_CHK_FILE = "KO_GATEP.VEF"
'Private Const NSUB_CPU_CHK_FILE = "KO_GATEF.VEF"
'Private Const NMAIN_OS_CHK_FILE = "KO_GATEO.VEF"
'V1.20.0.1 DEL END
'V1.20.0.1 ADD START
'EG-Ré©â¸
Private EHANTEI_CPU_CHK_FILE As String
Private EMAIN_CPU_CHK_FILE As String
Private ESUB_CPU_CHK_FILE As String
Private EMAIN_OS_CHK_FILE As String
'NEGé©â¸
Private NHANTEI_CPU_CHK_FILE As String
Private NMAIN_CPU_CHK_FILE As String
Private NSUB_CPU_CHK_FILE As String
Private NMAIN_OS_CHK_FILE As String
'V1.20.0.1 ADD END
'V1.6.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdInstall_Click
'//  ã@î\ñºèÃ  : Åuî}ëÃéÊäOÅvñtâüâ∫éûèàóù
'//  ã@î\äTóv  : î}ëÃÇÃéÊäOÇµÇçsÇ§
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdInstall_Click()
   On Error Resume Next
   
   'Åuî}ëÃéÊäOñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, USB_OUT, 0)
 
   'î}ëÃéÊäOèàóù
    Call pfRemove(Me)
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Activate
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óù(EG-R/NEGé©â¸)âÊñ (ÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ãNìÆ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Activate()
   On Error Resume Next
    
    'ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ÇãNìÆÇ∑ÇÈÅB
    tmrMail.Enabled = True
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Deactivate
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óù(EG-R/NEGé©â¸)âÊñ (ÉfÉBÉAÉNÉeÉBÉuéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Deactivate()
   On Error Resume Next
    
    If blnCabfrmOpenFlg = True Then
        Call fnTsbCabCallDiverge
        Exit Sub
    End If

    'ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}Çé~ÇﬂÇÈÅB
    tmrMail.Enabled = False
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : Form_Load
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìä«óù(EG-R/NEGé©â¸)âÊñ (ÉçÅ[Éhéû)
'//  ã@î\äTóv  : ÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}í‚é~
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-04-10   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub Form_Load()
   
   On Error Resume Next
 
    If gStrCurrentForm = sFormName_EJVer Then
       sJverName = EGR_JIKAI                        'V1.4.0.1 ADD
       Label1.Caption = "EG-Ré©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óù"
       'ÅuEG-Ré©ìÆâ¸éDã@ ﬁ∞ºﬁÆ›âÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, EJIKAI_VERASION_KANRI_GAMEN_START, 0)
    Else
       sJverName = NEG_JIKAI                        'V1.4.0.1 ADD
       'ÅuNEGé©ìÆâ¸éDã@ ﬁ∞ºﬁÆ›âÊñ ÅFï\é¶ÅvÉçÉOèoóÕ
       Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, NJIKAI_VERASION_KANRI_GAMEN_START, 0)
    End If
  
    'ÉfÅ[É^ìWäJ
    sSetFolderName

    'ïœêîÇÃèâä˙âª
    FolderSyubetu = 0

    'ÉoÅ[ÉWÉáÉìèÓïÒÇÃÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox

    'ÉÅÅ[ÉãéÛêMópÇÃÉÅÅ[ÉãéÛêMópÇÃÉ^ÉCÉ}ílÇê›íËÇ∑ÇÈ
    tmrMail.Interval = MN_MAIL_INTERVAL
    tmrMail.Enabled = False
    
    Me.Top = 0
    Me.Left = 0
    Me.Height = 9000
    Me.Width = 12000

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdUpdate_Click
'//  ã@î\ñºèÃ  : äeñtâüâ∫èàóù
'//  ã@î\äTóv  : äeñtâüâ∫Ç…ÇÊÇÈèàóùÇçsÇ§ÅB
'//             ÅuÉèÅ[ÉNÉNÉäÉAÅvÅuî}ëÃÅ®ÉèÅ[ÉNÉRÉsÅ[ÅvÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Åv
'//             ÅuãåÅ®é¿çsÉRÉsÅ[Åv
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Integer   Index     [IN]âüâ∫ñtÉCÉìÉfÉbÉNÉXíl
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.6.0.1) 2009-06-11   REVISED BY [TCC] S.Terao
'//                  ÅEÉtÉFÅ[ÉYÇPïsãÔçáëŒâû
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdUpdate_Click(Index As Integer)
   Dim iResponse As Integer         'MsgBoxÉ{É^ÉìÉRÅ[Éh
   Dim lngErrCode As Long           'ÉGÉâÅ[ÉRÅ[Éh

   On Error Resume Next

' âüÇ≥ÇÍÇΩÉ{É^ÉìÇîªíËÇ∑ÇÈÅB
Select Case Index
   Case 0
        'ÅuÉèÅ[ÉNÉNÉäÉAÅvÉ{É^ÉìÇÃèÍçáÅB
        'Åué©â¸ ﬁ∞ºﬁÆ›ä«óùÅFÉèÅ[ÉNÉNÉäÉAñtâüâ∫ÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_WRK_CREA_BUTTOM, 0)

        'ämîFÉ|ÉbÉvÉAÉbÉvÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈÅB
        iResponse = MsgBox("ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "ÇÅA" _
               & Chr(vbKeyReturn) & "ëSÇƒçÌèúÇµÇ‹Ç∑ÅB    ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
               vbYesNo + vbExclamation, _
               TitleBox(FolderSyubetu) & "  ÉèÅ[ÉN ÉNÉäÉA")
        If iResponse = vbYes Then
            '[ÇÕÇ¢] É{É^ÉìÇëIëÇµÇΩèÍçá
            'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
           If sWrkFolderRemove <> True Then
              'Åué©â¸ ﬁ∞ºﬁÆ›ä«óùÅFÉèÅ[ÉNÉNÉäÉAèàóùàŸèÌÅvÉçÉOèoóÕ
              lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
              Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_CREA_ERROR, lngErrCode)
              Exit Sub
           End If
           'Åué©â¸ ﬁ∞ºﬁÆ›ä«óùÅFÉèÅ[ÉNÉNÉäÉAèàóùê≥èÌÅvÉçÉOèoóÕ
           Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_CREA_OK, 0)
           'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
           fMakeListbox
        End If
        
   Case 1
        'Åuî}ëÃÅ®ÉèÅ[ÉNÉRÉsÅ[ÅvÉ{É^ÉìÇÃèÍçáÅB
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃÅ®ÉèÅ[ÉNÉRÉsÅ[ñtâüâ∫ÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_LZH_COPY_WRK_BUTTOM, 0)
        'ÉCÉìÉXÉgÅ[Éãî}ëÃÇÉèÅ[ÉNÉtÉHÉãÉ_ì‡Ç…ÉRÉsÅ[Ç∑ÇÈ
        sFDInstall "STD"
        
   Case 2
        'ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[ÅvÉ{É^ÉìÇÃèÍçáÅB
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[ñtâüâ∫ÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_WRK_COPY_NOW_BUTTOM, 0)
 
        'ämîFÉ|ÉbÉvÉAÉbÉvÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈÅB
        iResponse = MsgBox("ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ÇÃì‡óeÇÅAÅué¿çsÅvÉtÉHÉãÉ_Ç…ìoò^Ç∑ÇÈÇ±Ç∆Ç…ÇÊÇËÅA" _
                & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & " ÇÃç≈êVÇÃÉoÅ[ÉWÉáÉìÇÅAé¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹Ç∑ÅB" _
                & Chr(vbKeyReturn) & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
               vbYesNo + vbExclamation, _
               TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ[")
        If iResponse = vbYes Then
        '[ÇÕÇ¢] É{É^ÉìÇëIëÇµÇΩèÍçá
            'V1.6.0.1Å@DEL START
            'If CheckAppStart(PROC_KANRI) <> 0 Then
            '   'àŸèÌ
            '   If gStrCurrentForm = sFormName_EJVer Then
            '      MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
            '             vbOKOnly + vbExclamation, _
            '             "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            '      Exit Sub
            '   Else
            '      MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
            '             vbOKOnly + vbExclamation, _
            '             "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            '      Exit Sub
            '   End If
            'End If
            'V1.6.0.1Å@DEL END
            'ç≈êVÉoÅ[ÉWÉáÉìÇé¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇƒìoò^Ç∑ÇÈ
            If fNewVersion <> True Then
               'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[èàóùàŸèÌÅvÉçÉOèoóÕ
               lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
               Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_COPY_NOW_ERROR, lngErrCode)
               Exit Sub
            End If
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[èàóùê≥èÌÅvÉçÉOèoóÕ
             Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_WRK_COPY_NOW_OK, 0)
            'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
            fMakeListbox
        End If
        
   Case Else
        'ÅuãåÅ®é¿çsÉRÉsÅ[ÅvÉ{É^ÉìÇÃèÍçáÅB
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFãåÅ®é¿çsÉRÉsÅ[ñtâüâ∫ÅvÉçÉOèoóÕ
        Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_OLD_COPY_NOW_BUTTOM, 0)
       'ämîFÉ|ÉbÉvÉAÉbÉvÉEÉBÉìÉhÉEÇï\é¶Ç∑ÇÈÅB
       iResponse = MsgBox("ÅuãåÅvÉtÉHÉãÉ_ÇÃì‡óeÇÅAÅué¿çsÅvÉtÉHÉãÉ_Ç…ñﬂÇ∑Ç±Ç∆Ç…ÇÊÇËÅA" _
                & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & "ÇÃàÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇÅA" _
                & Chr(vbKeyReturn) & "é¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹Ç∑ÅB  ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
               vbYesNo + vbExclamation, _
               TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ[")
       If iResponse = vbYes Then
       '[ÇÕÇ¢] É{É^ÉìÇëIëÇµÇΩèÍçá
            'àÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇé¿çsÉoÅ[ÉWÉáÉìÇ…ñﬂÇ∑
           If fOldVersion <> True Then
              'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[èàóùàŸèÌÅvÉçÉOèoóÕ
              lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
              Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_OLD_COPY_NOW_ERROR, lngErrCode)
              Exit Sub
            End If
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFãåÅ®é¿çsÉRÉsÅ[èàóùê≥èÌÅvÉçÉOèoóÕ
             Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_OLD_COPY_NOW_OK, 0)
            'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
            fMakeListbox
       End If
       
  End Select
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdLzhFileCopy_Click
'//  ã@î\ñºèÃ  : äeñtâüâ∫èàóù
'//  ã@î\äTóv  : äeñtâüâ∫Ç…ÇÊÇÈèàóùÇçsÇ§ÅB
'//             Åuà≥èkÉtÉ@ÉCÉãÅ®ÉèÅ[ÉNÉRÉsÅ[Åv
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdLzhFileCopy_Click()
   
   On Error Resume Next
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFà≥èkÃß≤ŸÅ®‹∞∏∫Àﬂ∞ñtâüâ∫ÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_CAB_COPY_WRK_BUTTOM, 0)
 
    'à≥èkÉtÉ@ÉCÉãÇ©ÇÁÉCÉìÉXÉgÅ[ÉãÇ∑ÇÈÅB
    sFDInstall "LZH"
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdVer_Click
'//  ã@î\ñºèÃ  : äeñtâüâ∫èàóù
'//  ã@î\äTóv  : äeñtâüâ∫Ç…ÇÊÇÈèàóùÇçsÇ§ÅB
'//             Åuï\é¶çXêVÅvÅuÉeÉLÉXÉgï\é¶ÅvÅuî}ëÃèoóÕÅv
'//             Åué©â¸êÿÇËó£ÇµÅv
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Integer   Index     [IN]âüâ∫ñtÉCÉìÉfÉbÉNÉXíl
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdVer_Click(Index As Integer)
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim bFlag As Boolean            'ÉtÉâÉO
    Dim lRetVal As Long             'ñﬂÇËíl
    Dim sCommand As String          'ÉRÉ}ÉìÉhï∂éöóÒ
    Dim sWriteDir As String
    
    On Error GoTo ErrorHandle

    Select Case Index
        Case 0  'Åuï\é¶çXêVÅvñt
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFï\é¶çXêVñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, UPDATE_BUTTOM, 0)

           'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
            bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
            For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
               If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
                  bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
                  Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
                End If
             Next
              
              If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
                If gStrCurrentForm = sFormName_EJVer Then
                  'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
                   MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                          vbOKOnly + vbExclamation, _
                          "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
                Else
                  'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
                   MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                          vbOKOnly + vbExclamation, _
                          "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
                End If
                'èàóùÇî≤ÇØÇÈ
                Exit Sub
              End If
              'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
              fMakeListbox
              
        Case 1 'ÅuÉeÉLÉXÉgï\é¶Åvñt
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉeÉLÉXÉgï\é¶ñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_TXT_BUTTOM, 0)

            'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
            bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
            For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
               If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
                  bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
                  Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
               End If
            Next
                        
            If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
               If gStrCurrentForm = sFormName_EJVer Then
                 'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
                   MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                           vbOKOnly + vbExclamation, _
                           "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
               Else
                 'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
                   MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                          vbOKOnly + vbExclamation, _
                          "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
               End If
                   'èàóùÇî≤ÇØÇÈ
               Exit Sub
             End If


            'ÉäÉXÉgÉ{ÉbÉNÉXÇÃì‡óeÇÉtÉ@ÉCÉãÇ…èëÇ´çûÇ›
            sWriteListbox
            sCommand = MN_EXE_MEMO & MN_VERSI_FILE 'ÉÅÉÇí†é¿çsÉRÉ}ÉìÉhÇçÏê¨Ç∑ÇÈ
            'ÉÅÉÇí†ÇãNìÆÇ∑ÇÈ°
            lRetVal = Shell(sCommand, vbMaximizedFocus)
            'ÉÅÉÇí†ÇÉAÉNÉeÉBÉuÅiëOñ ï\é¶ÅjÇ…Ç∑ÇÈ
            AppActivate lRetVal, True
            SendKeys "{LEFT}", True
           
        Case 2 'Åuî}ëÃèoóÕÅvñt
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃèoóÕñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_OUTPUT_BUTTOM, 0)
 
            'î}ëÃèoóÕèàóù
             fMakeOutPutFile
           
        Case 3  'Åué©â¸êÿÇËó£ÇµÅvñt
            'Åué©â¸ ﬁ∞ºﬁÆ›ÅFé©â¸êÿÇËó£Çµñtâüâ∫ÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, KAISATU_VERSION_KANRI_KIRIHANASI_BUTTOM, 0)

            'í êMê⁄ë±ÅEêÿífâÊñ Çï\é¶Ç∑ÇÈÅB
            Load frmConectSts
            frmConectSts.Show 1
        Case Else
   End Select
ErrorHandle:
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : optSyubetu_Click
'//  ã@î\ñºèÃ  : ÉäÉ\Å[ÉXñtâüâ∫éûèàóù
'//  ã@î\äTóv  : ëŒè€ÉäÉ\Å[ÉXéÌï ÇïœçXÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ï\é¶ÉäÉ\Å[ÉXÉâÉWÉIñtëIëÇ≈ÉäÉXÉgÇÃï\é¶çXêV
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub optSyubetu_Click(Index As Integer)
    'V1.20.0.1 ADD START
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim bFlag As Boolean            'ÉtÉâÉO
    'V1.20.0.1 ADD END

    'ÉäÉ\Å[ÉXéÌï ÇïœçXÇ∑ÇÈÅB'
    FolderSyubetu = Index
    
    'V1.20.0.1 ADD START
    'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
    bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
        If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
            bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
            Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
        End If
    Next
    
    If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
        If gStrCurrentForm = sFormName_EJVer Then
            'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
            MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                    vbOKOnly + vbExclamation, _
                    "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        Else
            'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
            MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                    vbOKOnly + vbExclamation, _
                    "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        End If
        'èàóùÇî≤ÇØÇÈ
        Exit Sub
    End If
    
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox
    'V1.20.0.1 ADD END

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : cmdReturn_Click
'//  ã@î\ñºèÃ  : ÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫èàóù
'//  ã@î\äTóv  : é©âÊñ Çè¡ãéÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                áAÅuÉÅÉjÉÖÅ[âÊñ Ç÷ñﬂÇÈÅvñtâüâ∫Ç…ÇƒÅA
'//                 Å@ÉoÅ[ÉWÉáÉìä«óùâÊñ ÇÃÉoÅ[ÉWÉáÉìï\é¶çXêVÇçsÇ§
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub cmdReturn_Click()
   
   On Error Resume Next
    
   If gStrCurrentForm = sFormName_EJVer Then
      'ÅuEG-Ré©ìÆâ¸éDã@ ﬁ∞ºﬁÆ›âÊñ ÅFè¡ãéÅvÉçÉOèoóÕ
      Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, EJIKAI_VERASION_KANRI_GAMEN_END, 0)
   Else
      'ÅuNEGé©ìÆâ¸éDã@ ﬁ∞ºﬁÆ›âÊñ ÅFè¡ãéÅvÉçÉOèoóÕ
      Call sLogTraceReq(LTYP_NORMAL, L3AN_ETC, NJIKAI_VERASION_KANRI_GAMEN_END, 0)
   End If
   
   'V1.20.0.1 ADD START
   'ÉoÅ[ÉWÉáÉìä«óùâÊñ ÇÃÉoÅ[ÉWÉáÉìï\é¶çXêVèàóùÇçsÇ§ÅB
   frmVersion.psGetVersion
   'V1.20.0.1 ADD END
   
   'NEG/EG-Ré©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óùâÊñ Çï¬Ç∂ÇÈ
   Unload Me
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fMakeListbox
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXçÏê¨
'//  ã@î\äTóv  : äeÉtÉHÉãÉ_Ç©ÇÁÉoÅ[ÉWÉáÉìéÊìæÇçsÇ¢ÅAÉäÉXÉgÉ{ÉbÉNÉXçÏê¨
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fMakeListbox() As Boolean
    Dim bRet As Boolean                        'ñﬂÇËíl

    On Error Resume Next

    '***********************************************
    '* éüê¢ë„é©â¸ÉtÉHÉãÉ_Ç©ÇÁëSÇƒÇÃÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ *
    '***********************************************
    ReDim uVersion(0)

    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    bRet = fReadFileList(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)
    If bRet = True Then
        'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
        sVersionInfo FolderName(0, FolderSyubetu), MN_FLDWRK
    End If

    '¢é¿çs£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    bRet = fReadFileList(FolderName(1, FolderSyubetu) & "\" & MN_FILELIST)
    If bRet = True Then
        'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
        sVersionInfo FolderName(1, FolderSyubetu), MN_FLDNOW
    End If

    '¢ãå£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    bRet = fReadFileList(FolderName(2, FolderSyubetu) & "\" & MN_FILELIST)
    If bRet = True Then
        'ÉtÉ@ÉCÉãÉäÉXÉgÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈ
        sVersionInfo FolderName(2, FolderSyubetu), MN_FLDOLD
    End If

    'ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºèáÇ…É\Å[ÉgÇ∑ÇÈ
    sListboxSort

    'ÉoÅ[ÉWÉáÉìèÓïÒÇÉäÉXÉgÉ{ÉbÉNÉXÇ…ÉZÉbÉgÇ∑ÇÈ
    sVerListDisp
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sVerListDisp
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXê›íË
'//  ã@î\äTóv  : éÊìæÇµÇΩÉoÅ[ÉWÉáÉìèÓïÒÇÅAÉäÉXÉgÉ{ÉbÉNÉXÇ…ê›íË
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sVerListDisp()
    Dim i As Integer                        'ÉJÉEÉìÉ^
    Dim uVerData(2) As MN_VERSION_JIKAI     'ÉoÅ[ÉWÉáÉìèÓïÒÅiäeÉtÉHÉãÉ_Åj
    Dim lDataNum As Long                    'ÉoÅ[ÉWÉáÉìèÓïÒêî

    On Error Resume Next

    'ÉäÉXÉgÉ{ÉbÉNÉXÇèâä˙âªÇ∑ÇÈ
    lstKan.Clear

    lDataNum = UBound(uVersion)             'ÉoÅ[ÉWÉáÉìèÓïÒêîéÊìæ
    For i = 1 To lDataNum

        uVerData(0).sFileName = ""          'ÉtÉ@ÉCÉãñºÇÉNÉäÉAÇ∑ÇÈ
        uVerData(1).sFileName = ""          'ÉtÉ@ÉCÉãñºÇÉNÉäÉAÇ∑ÇÈ
        uVerData(2).sFileName = ""          'ÉtÉ@ÉCÉãñºÇÉNÉäÉAÇ∑ÇÈ

        Select Case uVersion(i).iFolder     'ÉtÉHÉãÉ_ñºÇëŒè€Ç∆Ç∑ÇÈ
        Case MN_FLDWRK                      'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ÇÃèÍçá
            uVerData(0) = uVersion(i)       'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
            If i + 1 <= lDataNum Then       'éüÇÃÉfÅ[É^Ç™Ç†ÇÈ?
                If uVersion(i).sFileName = uVersion(i + 1).sFileName Then
                                                        'ÉtÉ@ÉCÉãñºÇ™ìØÇ∂?
                    Select Case uVersion(i + 1).iFolder 'ÉtÉHÉãÉ_ñºÇëŒè€Ç∆Ç∑ÇÈ
                    Case MN_FLDNOW                      'Åué¿çsÅvÉtÉHÉãÉ_ÇÃèÍçá
                        uVerData(1) = uVersion(i + 1)   'Åué¿çsÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                        If i + 2 <= lDataNum Then       'éüÇÃÉfÅ[É^Ç™Ç†ÇÈ?
                            If uVersion(i + 1).sFileName = uVersion(i + 2).sFileName Then
                                                        'ÉtÉ@ÉCÉãñºÇ™ìØÇ∂?
                                uVerData(2) = uVersion(i + 2)
                                                        'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                                i = i + 2               'ÉJÉEÉìÉ^ÇéüÅXÇ…Ç∑ÇÈ
                            Else
                                i = i + 1               'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                            End If
                        Else
                            i = i + 1                   'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                        End If
                    Case MN_FLDOLD                      'ÅuãåÅvÉtÉHÉãÉ_ÇÃèÍçá
                        uVerData(2) = uVersion(i + 1)   'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                        i = i + 1                       'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                    End Select
                End If
            End If
        Case MN_FLDNOW                      'Åué¿çsÅvÉtÉHÉãÉ_ÇÃèÍçá
            uVerData(1) = uVersion(i)       'Åué¿çsÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
            If i + 1 <= lDataNum Then       'éüÇÃÉfÅ[É^Ç™Ç†ÇÈ
                If uVersion(i).sFileName = uVersion(i + 1).sFileName Then
                                                    'ÉtÉ@ÉCÉãñºÇ™ìØÇ∂?
                    uVerData(2) = uVersion(i + 1)   'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
                    i = i + 1                       'ÉJÉEÉìÉ^ÇéüÇ…Ç∑ÇÈ
                End If
            End If
        Case MN_FLDOLD                      'ÅuãåÅvÉtÉHÉãÉ_ÇÃèÍçá
            uVerData(2) = uVersion(i)       'ÅuãåÅvÉtÉHÉãÉ_ì‡Ç…äiî[Ç∑ÇÈ
        End Select
        'ÉtÉ@ÉCÉãñºÇÇ‹Ç∆ÇﬂÇƒÉäÉXÉgÉ{ÉbÉNÉXÇ…ê›íË
        sVersionDisp uVerData()
    Next
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sListboxSort
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÇÃÉ\Å[Ég
'//  ã@î\äTóv  : ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºèáÇ…É\Å[ÉgÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sListboxSort()
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim j As Integer                'ÉJÉEÉìÉ^
    Dim uBuff As MN_VERSION_JIKAI   'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉoÉbÉtÉ@

    On Error Resume Next
   
    For i = 1 To UBound(uVersion) - 1
        For j = i + 1 To UBound(uVersion)
            'ÉtÉ@ÉCÉãñºÇÃî‰ärÇçsÇ§
            If uVersion(j).sFileName < uVersion(i).sFileName Then
                'ÉtÉ@ÉCÉãñºÇ™è¨Ç≥ÇØÇÍÇŒà⁄Çµë÷Ç¶ÇÈ
                uBuff = uVersion(i)
                uVersion(i) = uVersion(j)
                uVersion(j) = uBuff
            ElseIf uVersion(j).sFileName = uVersion(i).sFileName Then
                'ÉtÉHÉãÉ_ÇÃî‰ärÇçsÇ§
                If uVersion(j).iFolder = MN_FLDWRK And uVersion(i).iFolder = MN_FLDNOW Then
                    uBuff = uVersion(i)
                    uVersion(i) = uVersion(j)
                    uVersion(j) = uBuff
                ElseIf uVersion(j).iFolder = MN_FLDNOW And uVersion(i).iFolder = MN_FLDOLD Then
                    uBuff = uVersion(i)
                    uVersion(i) = uVersion(j)
                    uVersion(j) = uBuff
                ElseIf uVersion(j).iFolder = MN_FLDWRK And uVersion(i).iFolder = MN_FLDOLD Then
                    uBuff = uVersion(i)
                    uVersion(i) = uVersion(j)
                    uVersion(j) = uBuff
                End If
            End If
        Next
    Next
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sVersionDisp
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXí«â¡
'//  ã@î\äTóv  : ÉoÅ[ÉWÉáÉìèÓïÒÇÉtÉ@ÉCÉãñºíPà Ç≈ÉäÉXÉgÉ{ÉbÉNÉXÇ…í«â¡Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sVersionDisp(uVerData() As MN_VERSION_JIKAI)
    Dim sFileName As String         'ÉtÉ@ÉCÉãñºï∂éöóÒÅiéüê¢ë„é©â¸É^ÉCÉvÇä‹ÇﬁÅj
    Dim sFileSize As String         'ÉtÉ@ÉCÉãÉTÉCÉYï∂éöóÒ
    Dim sFileInfo(2) As String      'ÉoÅ[ÉWÉáÉìèÓïÒï∂éöóÒ
    Dim sComment1(2) As String      'ÉRÉÅÉìÉgï∂éöóÒ
    Dim sComment2(2) As String      'ÉRÉÅÉìÉgï∂éöóÒ

   On Error Resume Next
    
    If uVerData(0).sFileName <> "" Then     'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉtÉ@ÉCÉãñºäiî[
        sFileName = StrConv(MidB(StrConv(uVerData(0).sFileName & Space(12), vbFromUnicode), 1, 16), vbUnicode)
    ElseIf uVerData(1).sFileName <> "" Then 'Åué¿çsÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉtÉ@ÉCÉãñºäiî[
        sFileName = StrConv(MidB(StrConv(uVerData(1).sFileName & Space(12), vbFromUnicode), 1, 16), vbUnicode)
    Else                                    'ÅuãåÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉtÉ@ÉCÉãñºäiî[
        sFileName = StrConv(MidB(StrConv(uVerData(2).sFileName & Space(12), vbFromUnicode), 1, 16), vbUnicode)
    End If
    sFileName = sFileName & " "

    If uVerData(0).sFileName <> "" Then     'ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉoÅ[ÉWÉáÉìèÓïÒäiî[
        sFileInfo(0) = " " & StrConv(MidB(StrConv(uVerData(0).sMachineName & Space(10), vbFromUnicode), 1, 9), vbUnicode)
        sFileInfo(0) = sFileInfo(0) & StrConv(MidB(StrConv(uVerData(0).sFooterFile & Space(8), vbFromUnicode), 1, 10), vbUnicode)
        sFileInfo(0) = sFileInfo(0) & StrConv(MidB(StrConv(uVerData(0).sFileDate & Space(15), vbFromUnicode), 1, 14), vbUnicode)
        sFileInfo(0) = sFileInfo(0) & uVerData(0).sVersion
        sComment1(0) = " " & StrConv(MidB(StrConv(uVerData(0).sComment, vbFromUnicode), 1, 32), vbUnicode)
        sComment2(0) = " " & StrConv(MidB(StrConv(uVerData(0).sComment, vbFromUnicode), 33, 32), vbUnicode)
    End If
    If uVerData(1).sFileName <> "" Then     'Åué¿çsÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉoÅ[ÉWÉáÉìèÓïÒäiî[
        sFileInfo(1) = " " & StrConv(MidB(StrConv(uVerData(1).sMachineName & Space(10), vbFromUnicode), 1, 9), vbUnicode)
        sFileInfo(1) = sFileInfo(1) & StrConv(MidB(StrConv(uVerData(1).sFooterFile & Space(8), vbFromUnicode), 1, 10), vbUnicode)
        sFileInfo(1) = sFileInfo(1) & StrConv(MidB(StrConv(uVerData(1).sFileDate & Space(15), vbFromUnicode), 1, 14), vbUnicode)
        sFileInfo(1) = sFileInfo(1) & uVerData(1).sVersion
        sComment1(1) = " " & StrConv(MidB(StrConv(uVerData(1).sComment, vbFromUnicode), 1, 32), vbUnicode)
        sComment2(1) = " " & StrConv(MidB(StrConv(uVerData(1).sComment, vbFromUnicode), 33, 32), vbUnicode)
    End If
    If uVerData(2).sFileName <> "" Then     'ÅuãåÅvÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç†ÇÈ
        'ÉoÅ[ÉWÉáÉìèÓïÒäiî[
        sFileInfo(2) = " " & StrConv(MidB(StrConv(uVerData(2).sMachineName & Space(10), vbFromUnicode), 1, 9), vbUnicode)
        sFileInfo(2) = sFileInfo(2) & StrConv(MidB(StrConv(uVerData(2).sFooterFile & Space(8), vbFromUnicode), 1, 10), vbUnicode)
        sFileInfo(2) = sFileInfo(2) & StrConv(MidB(StrConv(uVerData(2).sFileDate & Space(15), vbFromUnicode), 1, 14), vbUnicode)
        sFileInfo(2) = sFileInfo(2) & uVerData(2).sVersion
        sComment1(2) = " " & StrConv(MidB(StrConv(uVerData(2).sComment, vbFromUnicode), 1, 32), vbUnicode)
        sComment2(2) = " " & StrConv(MidB(StrConv(uVerData(2).sComment, vbFromUnicode), 33, 32), vbUnicode)
    End If


    If chkFolder(0).Value = CHECKBOX_ON Then               '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_ï\é¶
        If uVerData(0).sFileName <> "" Then         '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
            If chkFolder(1).Value = CHECKBOX_ON Then       '¢é¿çs£ÉtÉHÉãÉ_ï\é¶
                If uVerData(1).sFileName <> "" Then '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç∆¢é¿çs£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                    If sFileInfo(0) = sFileInfo(1) Then
                        If chkFolder(2).Value = CHECKBOX_ON Then   '¢ãå£ÉtÉHÉãÉ_ï\é¶
                            If uVerData(2).sFileName <> "" Then
                                '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                                If sFileInfo(1) = sFileInfo(2) Then
                                    lstKan.AddItem sFileName & "W N O" & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                        lstKan.AddItem Space(22) & sComment1(0)
                                    End If
                                    If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                        lstKan.AddItem Space(22) & sComment2(0)
                                    End If
                                Else
                                    lstKan.AddItem sFileName & "W N  " & sFileInfo(0)
                                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                        lstKan.AddItem Space(22) & sComment1(0)
                                    End If
                                    If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                        lstKan.AddItem Space(22) & sComment2(0)
                                    End If
                                    lstKan.AddItem Space(17) & "    O" & sFileInfo(2)
                                    If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                        lstKan.AddItem Space(22) & sComment1(2)
                                    End If
                                    If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                        lstKan.AddItem Space(22) & sComment2(2)
                                    End If
                                End If
                            Else                            '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                                lstKan.AddItem sFileName & "W N  " & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(1)
                                End If
                                If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                     lstKan.AddItem Space(22) & sComment2(1)
                                End If
                                lstKan.AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                            End If
                        Else                                '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                            lstKan.AddItem sFileName & "W N  " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(0)
                            End If
                            If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(0)
                            End If
                        End If
                    Else                            '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç∆¢é¿çs£ÉtÉHÉãÉ_ÇÃÉoÅ[ÉWÉáÉìÇ™à·Ç§
                        lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                        If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(0)
                        End If
                        If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(0)
                        End If
                        If chkFolder(2).Value = CHECKBOX_ON Then   '¢ãå£ÉtÉHÉãÉ_ï\é¶
                            If uVerData(2).sFileName <> "" Then
                                '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                                If sFileInfo(1) = sFileInfo(2) Then
                                    lstKan.AddItem Space(17) & "  N O" & sFileInfo(1)
                                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                        lstKan.AddItem Space(22) & sComment1(1)
                                    End If
                                    If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                        lstKan.AddItem Space(22) & sComment2(1)
                                    End If
                                Else
                                    lstKan.AddItem Space(17) & "  N  " & sFileInfo(1)
                                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                        lstKan.AddItem Space(22) & sComment1(1)
                                    End If
                                    If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                        lstKan.AddItem Space(22) & sComment2(1)
                                    End If
                                    lstKan.AddItem Space(17) & "    O" & sFileInfo(2)
                                    If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                        lstKan.AddItem Space(22) & sComment1(2)
                                    End If
                                    If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                        lstKan.AddItem Space(22) & sComment2(2)
                                    End If
                                End If
                            Else                            '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                                lstKan.AddItem Space(17) & "  N  " & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(1)
                                End If
                                If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(1)
                                End If
                                lstKan.AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                            End If
                        Else
                            lstKan.AddItem Space(17) & "  N  " & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(1)
                            End If
                            If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(1)
                            End If
                        End If
                    End If
                Else                                    '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                    If chkFolder(2).Value = CHECKBOX_ON Then   '¢ãå£ÉtÉHÉãÉ_ï\é¶
                        If uVerData(2).sFileName <> "" Then
                            If sFileInfo(0) = sFileInfo(2) Then
                                lstKan.AddItem sFileName & "W   O" & sFileInfo(0)
                                If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(0)
                                End If
                                If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(0)
                                End If
                                lstKan.AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                            Else
                                lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                                If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(0)
                                End If
                                If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(0)
                                End If
                                lstKan.AddItem Space(17) & "    O" & sFileInfo(2)
                                If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(2)
                                End If
                                If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(2)
                                End If
                                lstKan.AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                            End If
                        Else                            '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                            lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(0)
                            End If
                            If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(0)
                            End If
                            lstKan.AddItem Space(17) & "  N O" & " -------- --------  -------- ----"
                        End If
                    Else                                '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                        lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                        If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(0)
                        End If
                        If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(0)
                        End If
                        lstKan.AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                    End If
                End If
            Else                                        '¢é¿çs£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then
                        If sFileInfo(0) = sFileInfo(2) Then
                            lstKan.AddItem sFileName & "W   O" & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(0)
                            End If
                            If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(0)
                            End If
                        Else
                            lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                            If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(0)
                            End If
                            If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(0)
                            End If
                            lstKan.AddItem Space(17) & "    O" & sFileInfo(2)
                            If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(2)
                            End If
                            If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(2)
                            End If
                        End If
                    Else                                    '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                        lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                        If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(0)
                        End If
                        If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(0)
                        End If
                        lstKan.AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                    lstKan.AddItem sFileName & "W    " & sFileInfo(0)
                    If Not IsNull(sComment1(0)) Or sComment1(0) <> "" Then
                        lstKan.AddItem Space(22) & sComment1(0)
                    End If
                    If Not IsNull(sComment2(0)) Or sComment2(0) <> "" Then
                        lstKan.AddItem Space(22) & sComment2(0)
                    End If
                End If
            End If
        Else                                '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
            If chkFolder(1).Value = CHECKBOX_ON Then               '¢é¿çs£ÉtÉHÉãÉ_ï\é¶
                If uVerData(1).sFileName <> "" Then         '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                    If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                        If uVerData(2).sFileName <> "" Then '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                            '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                            If sFileInfo(1) = sFileInfo(2) Then
                                lstKan.AddItem sFileName & "  N O" & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(1)
                                End If
                                If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(1)
                                End If
                                lstKan.AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                            Else                            '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_ÇÃÉoÅ[ÉWÉáÉìÇ™à·Ç§
                                lstKan.AddItem sFileName & "  N  " & sFileInfo(1)
                                If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(1)
                                End If
                                If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(1)
                                End If
                                lstKan.AddItem Space(17) & "    O" & sFileInfo(2)
                                If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                    lstKan.AddItem Space(22) & sComment1(2)
                                End If
                                If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                    lstKan.AddItem Space(22) & sComment2(2)
                                End If
                                lstKan.AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                            End If
                        Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ»Ç¢
                            lstKan.AddItem sFileName & "  N  " & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(1)
                            End If
                            If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(1)
                            End If
                            lstKan.AddItem Space(17) & "W   O" & " -------- --------  -------- ----"
                        End If
                    Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                        lstKan.AddItem sFileName & "  N  " & sFileInfo(1)
                        If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(1)
                        End If
                        If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(1)
                        End If
                        lstKan.AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                    End If
                Else                                        '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                    If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                        If uVerData(2).sFileName <> "" Then
                            lstKan.AddItem sFileName & "    O" & sFileInfo(2)
                            If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(2)
                            End If
                            If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(2)
                            End If
                            lstKan.AddItem Space(17) & "W N  " & " -------- --------  -------- ----"
                        Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                            lstKan.AddItem sFileName & "W N O" & " -------- --------  -------- ----"
                        End If
                    Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                        lstKan.AddItem sFileName & "W N  " & " -------- --------  -------- ----"
                    End If
                End If
            Else                                        '¢é¿çs£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then
                        lstKan.AddItem sFileName & "    O" & sFileInfo(2)
                        If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(2)
                        End If
                        If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(2)
                        End If
                        lstKan.AddItem Space(17) & "W    " & " -------- --------  -------- ----"
                    Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                        lstKan.AddItem sFileName & "W   O" & " -------- --------  -------- ----"
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                    lstKan.AddItem sFileName & "W    " & " -------- --------  -------- ----"
                End If
            End If
        End If
    Else                                                '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
        If chkFolder(1).Value = CHECKBOX_ON Then               '¢é¿çs£ÉtÉHÉãÉ_ï\é¶
            If uVerData(1).sFileName <> "" Then         '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                        '¢é¿çs£ÉtÉHÉãÉ_Ç∆¢ãå£ÉtÉHÉãÉ_Çî‰ärÇ∑ÇÈ
                        If sFileInfo(1) = sFileInfo(2) Then
                            lstKan.AddItem sFileName & "  N O" & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(1)
                            End If
                            If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(1)
                            End If
                        Else
                            lstKan.AddItem sFileName & "  N  " & sFileInfo(1)
                            If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(1)
                            End If
                            If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(1)
                            End If
                            lstKan.AddItem Space(17) & "    O" & sFileInfo(2)
                            If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                                lstKan.AddItem Space(22) & sComment1(2)
                            End If
                            If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                                lstKan.AddItem Space(22) & sComment2(2)
                            End If
                        End If
                    Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ»Ç¢
                        lstKan.AddItem sFileName & "  N  " & sFileInfo(1)
                        If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(1)
                        End If
                        If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(1)
                        End If
                        lstKan.AddItem Space(17) & "    O" & " -------- --------  -------- ----"
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                    lstKan.AddItem sFileName & "  N  " & sFileInfo(1)
                    If Not IsNull(sComment1(1)) Or sComment1(1) <> "" Then
                        lstKan.AddItem Space(22) & sComment1(1)
                    End If
                    If Not IsNull(sComment2(1)) Or sComment2(1) <> "" Then
                        lstKan.AddItem Space(22) & sComment2(1)
                    End If
                End If
            Else                                        '¢é¿çs£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                If chkFolder(2).Value = CHECKBOX_ON Then       '¢ãå£ÉtÉHÉãÉ_ï\é¶
                    If uVerData(2).sFileName <> "" Then
                        lstKan.AddItem sFileName & "    O" & sFileInfo(2)
                        If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                            lstKan.AddItem Space(22) & sComment1(2)
                        End If
                        If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                            lstKan.AddItem Space(22) & sComment2(2)
                        End If
                        lstKan.AddItem Space(17) & "  N  " & " -------- --------  -------- ----"
                    Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                        lstKan.AddItem sFileName & "  N O" & " -------- --------  -------- ----"
                    End If
                Else                                    '¢ãå£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
                    lstKan.AddItem sFileName & "  N  " & " -------- --------  -------- ----"
                End If
            End If
        Else                                    '¢é¿çs£ÉtÉHÉãÉ_îÒÉAÉNÉeÉBÉuï\é¶
            If uVerData(2).sFileName <> "" Then '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇÕÇ†ÇÈ
                lstKan.AddItem sFileName & "    O" & sFileInfo(2)
                If Not IsNull(sComment1(2)) Or sComment1(2) <> "" Then
                    lstKan.AddItem Space(22) & sComment1(2)
                End If
                If Not IsNull(sComment2(2)) Or sComment2(2) <> "" Then
                    lstKan.AddItem Space(22) & sComment2(2)
                End If
            Else                                '¢ãå£ÉtÉHÉãÉ_Ç…ÉtÉ@ÉCÉãÇ™Ç»Ç¢
                lstKan.AddItem sFileName & "    O" & " -------- --------  -------- ----"
            End If
        End If
    End If
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sVersionInfo
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìèÓïÒÇÃéÊìæ
'//  ã@î\äTóv  : ÉtÉ@ÉCÉãÉäÉXÉgàÍóóÇ©ÇÁÉoÅ[ÉWÉáÉìèÓïÒÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sPath
'//  Å@Å@Å@    : IntegerÅ@ iFolder
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sVersionInfo(sPath As String, iFolder As Integer)
    Dim i As Integer                    'ÉJÉEÉìÉ^
    Dim j As Integer                    'ÉJÉEÉìÉ^
    Dim sMyName As String               'ÉtÉ@ÉCÉãñº
    Dim iFileNumber As Integer          'ÉtÉ@ÉCÉãî‘çÜ
    Dim lLen As Long                    'ÉtÉ@ÉCÉãÉTÉCÉY
    Dim uFooter As MN_FOOT              'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
    Dim lPos As Long                    'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
    Dim sDateTime As String
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD

   On Error Resume Next

    For i = 0 To UBound(FileList) - 1   'ÉtÉ@ÉCÉãÉäÉXÉgêî

        sMyName = sPath & "\" & FileList(i)     'ÉtÉ@ÉCÉãÉtÉãÉpÉXñºÇÃçÏê¨

        'If Dir(sMyName) <> "" Then              'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?    'V1.20.0.1 DEL
        If objFso.FileExists(sMyName) = True Then  'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?    'V1.20.0.1 ADD
            lLen = FileLen(sMyName)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ

            iFileNumber = FreeFile              'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

            Open sMyName For Binary Access Read As #iFileNumber
                                                'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉì
            Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter
                                                'ÉtÉbÉ^èÓïÒÇÃéÊìæ
            ReDim Preserve uVersion(UBound(uVersion) + 1)
                                                'ÉoÅ[ÉWÉáÉìèÓïÒäiî[ÉGÉäÉAÇÃägí£
            lPos = UBound(uVersion)             'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íuÇÃéÊìæ
            uVersion(lPos).sFileName = UCase(FileListType(i))       'ÉtÉ@ÉCÉãñºÇëÂï∂éöÇ…ÇµÇƒÉZÉbÉg
            uVersion(lPos).iFolder = iFolder                    'ÉtÉHÉãÉ_ñºÉZÉbÉg
            uVersion(lPos).sMachineName = uFooter.sKisyu        'ã@éÌñºÉZÉbÉg
            uVersion(lPos).sFooterFile = uFooter.sFileName      'ÉtÉ@ÉCÉãñºÉZÉbÉg

            sDateTime = ""
            For j = 0 To 3
                sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
            Next
            sDateTime = sDateTime & " "
            For j = 4 To 5
                sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
            Next
            uVersion(lPos).sFileDate = sDateTime
            uVersion(lPos).sVersion = uFooter.sVersion          'ÉoÅ[ÉWÉáÉìèÓïÒÉZÉbÉg
            uVersion(lPos).sComment = uFooter.sHyoji            'ï\é¶ï∂éöóÒÉZÉbÉg

            Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
        End If
    Next
    
    Set objFso = Nothing    'V1.20.0.1 ADD
    
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fNewVersion
'//  ã@î\ñºèÃ  : ç≈êVÉoÅ[ÉWÉáÉìèàóù
'//  ã@î\äTóv  : ç≈êV(ÉèÅ[ÉN)ÉoÅ[ÉWÉáÉìÇÅAé¿çs(é¿çs)ÉoÅ[ÉWÉáÉìÇ…ìoò^
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sPath
'//  Å@Å@Å@    : IntegerÅ@ iFolder
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@ÉvÉçîªê≥ìñê´É`ÉFÉbÉNèàóùí«â¡
'//     REVISIONS :(1.6.0.1) 2009-06-12   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇPëŒâûïsãÔçáèCê≥
'//                 ÉtÉFÅ[ÉYÇRëŒâûÅ@ã@éÌê≥ìñê´É`ÉFÉbÉNèàóùí«â¡
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fNewVersion() As Boolean
    Dim bRet As Boolean                      'ñﬂÇËíl
    Dim lngCnt                  As Long      'ÉJÉEÉìÉ^Å[
    Dim sSrcFileName            As String    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãÉäÉXÉg
    Dim sFileName As String
    Dim lngErrCode As Long                   'ÉGÉâÅ[ÉRÅ[Éh
    'V1.4.0.1 ADD START
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim SysCodeTxt As String                 'ÉoÉCÉgïœä∑å„(ëSäpÅ®îºäp)
    Dim lngSumRet As Long
    Dim i As Integer
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    'V1.4.0.1 ADD END
    Dim iKansiAplChk As Integer              'ÉAÉvÉäãNìÆÉ`ÉFÉbÉNñﬂÇËílÅ@'V1.6.0.1 ADD
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    On Error Resume Next
    
    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_ÇÃÉtÉ@ÉCÉãÉäÉXÉgÇåüçıÇ∑ÇÈ
    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨
    sSrcFileName = FolderName(0, FolderSyubetu) & "\" & MN_FILELIST
    'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'V1.20.0.1 DEL
    'V1.20.0.1 ADD START
    If objFso.FileExists(sSrcFileName) = True Then
      Set objFso = Nothing
    'V1.20.0.1 ADD END
    Else
      'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
      MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
             & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
             vbOKOnly + vbExclamation, _
             TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
     'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉtÉ@ÉCÉãÉäÉXÉgñ≥ÇµÅvÉçÉOèoóÕ
      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOTFOUND_FILELIST, lngErrCode)

      fNewVersion = False
      Set objFso = Nothing    'V1.20.0.1 ADD
      Exit Function
    End If
  
    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    'bRet = fReadFileList(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)Å@'V1.8.0.1 DEL
    
    bRet = pfSeitouseiChck    'V1.4.0.1Å@ADD
    'é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNÇçsÇ§(ëŒè€ÉtÉ@ÉCÉãÅFHAN_KUKA.KUK)
'    bRet = fDataFileCheck(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST) 'V1.4.0.1Å@DEL
'V1.8.0.1 ADD START
    '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇÊÇËÅAìoò^ÉtÉ@ÉCÉãêîÇÉJÉEÉìÉgÇ∑ÇÈ
    If bRet = True Then
       bRet = fReadFileList(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)
    End If
'V1.8.0.1 ADD END

  If bRet = True Then
    '¢ãå£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇëSÇƒçÌèúÇ∑ÇÈ
     If sOldFolderRemove <> True Then
         fNewVersion = False
         Exit Function
     End If

    '¢ãå£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇ¢é¿çs£ÉtÉHÉãÉ_ÇÃì‡óeÇ…íuä∑Ç¶ÇÈ
    If sCopyNOWtoOLD <> True Then
        fNewVersion = False
        Exit Function
    End If

    '¢é¿çs£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇ¢ÉèÅ[ÉN£ÉtÉHÉãÉ_ÇÃì‡óeÇ…íuä∑Ç¶ÇÈ
    If sCopyWRKtoNOW <> True Then
        fNewVersion = False
        Exit Function
    End If
    
 
    'é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇä«óùÉvÉçÉZÉXÇ÷ëóêMÇ∑ÇÈÅB
    'V1.6.0.1Å@ADDÅ@START
    'äƒéãî’ãNìÆ/ñ¢ãNìÆÉ`ÉFÉbÉNÇçsÇ§ÅBÉ`ÉFÉbÉNèÛë‘Ç…ÇÊÇËèàóùï™äÚÇçsÇ§ÅB
     iKansiAplChk = CheckAppStart(PROC_KANRI)
     If iKansiAplChk <> 0 Then
        'äƒéãî’ãNìÆéûÅFä«óùÉvÉçÉZÉXÇ…é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇëóêMÇ∑ÇÈÅB
    'V1.6.0.1 ADD END
      If gStrCurrentForm = sFormName_EJVer Then
         psVersionUpdateReqest (ML_REQUEST_EGATE)
      Else
         psVersionUpdateReqest (ML_REQUEST_NGATE)
      End If
    'V1.6.0.1 ADD START
    Else
        'äƒéãî’ñ¢ãNìÆéûÅFâ¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùåãâ Ç…ê≥èÌÇê›íËÇ∑ÇÈÅB
        gintGateVerInfUpdRes = MailSts.stsNormal
    End If
    'V1.6.0.1 ADD END
    
    'â¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùåãâ 
    If gintGateVerInfUpdRes = MailSts.stsNormal Then
        'ê≥èÌ
        MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ÇÃì‡óeÇ,Åué¿çsÅvÉtÉHÉãÉ_Ç…ìoò^ÇµÇƒÅA" _
                & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & " ÇÃç≈êVÇÃÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹ÇµÇΩÅB", _
                vbOKOnly + vbExclamation, _
                TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
        fNewVersion = True
    Else
        'àŸèÌ
        If gStrCurrentForm = sFormName_EJVer Then
           MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
                  vbOKOnly + vbExclamation, _
                  "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        Else
         MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
                 vbOKOnly + vbExclamation, _
                 "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        End If
        
        fNewVersion = False
    End If
  
    fNewVersion = True
  Else
    fNewVersion = False
  End If
End Function
'V1.4.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfSeitouseiChck
'//  ã@î\ñºèÃ  : ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL :(1.4.0.1) 2009-03-17   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûÅ@ÉvÉçîªê≥ìñê´É`ÉFÉbÉNèàóù
'//     REVISIONS :(1.6.0.1) 2009-06-16  REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûïsãÔçáèCê≥
'//                 ÉtÉFÅ[ÉYÇRëŒâûÅ@ã@éÌê≥ìñê´É`ÉFÉbÉNí«â¡
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfSeitouseiChck() As Boolean
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim SysCodeTxt As String                 'ÉoÉCÉgïœä∑å„(ëSäpÅ®îºäp)
    Dim lngSumRet As Long
    Dim i As Integer
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    Dim bRet As Boolean
    Dim lngCnt As Long
    Dim iRet   As Integer                    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNDLLñﬂÇËíl
    Dim iGouki As Integer                    'çÜã@î‘çÜ
    Dim sVersionInfoPath As String           'ÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉã(çÜã@ï )
    Dim iCnt             As Integer          'çÜã@ÉJÉEÉìÉ^Å[Å@V1.6.0.1Å@ADD
    On Error Resume Next
    
    pfSeitouseiChck = True
    
    '********************************
    '*ÉvÉçîªê≥ìñê´É`ÉFÉbÉN
    '********************************
    'é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNÇçsÇ§(ëŒè€ÉtÉ@ÉCÉãÅFHAN_KUKA.KUK)
    bRet = fDataFileCheck(FolderName(0, FolderSyubetu) & "\" & MN_FILELIST)
    If bRet = False Then
       If sNGSts <> "" And sNGKoumoku <> "" Then
          MsgBox "â^í¿ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌ(" & sNGSts & "ÅF" & sNGKoumoku & "Åj", _
                 vbOKOnly + vbExclamation, _
                 sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
       Else
          MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                 vbOKOnly + vbExclamation, _
                 TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
       End If
       pfSeitouseiChck = False
       Exit Function
    End If

'V1.6.0.1 DEL START
'    'ÉTÉÄílÉ`ÉFÉbÉN
'    For lngCnt = 0 To UBound(FileList) - 1
'        If pfFileSumChk(FolderName(0, FolderSyubetu) & "\" & FileList(lngCnt), lngSumRet) <> True Then
'            'ÉTÉÄílàŸèÌ
'            If lngSumRet = SUM_CHK.SumErr Then
'               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
'                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                      vbOKOnly + vbExclamation, _
'                      sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'            'ÉTÉÄílàŸèÌà»äOàŸèÌ
'            ElseIf lngSumRet = SUM_CHK.SumErr_Else Then
'               MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
'                     vbOKOnly + vbExclamation, _
'                     TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
'            End If
'            pfSeitouseiChck = False
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_SUMCHK_ERROR, 0)
'            Exit Function
'        End If
'    Next
'
'    'ÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉN
'    If UBound(FileList) > FILECNT_MAX Then
'       MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
'              & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'              vbOKOnly + vbExclamation, _
'              sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'      pfSeitouseiChck = False
'
'      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_MAXFILECHK_ERROR, 0)
'
'      Exit Function
'    End If
'
'    'ÉtÉ@ÉCÉãñºÉTÉCÉYÉ`ÉFÉbÉN
'    lngFileListCnt = UBound(FileList)
'
'    On Error GoTo FileGetError
'
'    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉIÅ[ÉvÉìÅB
'    Open FolderName(0, FolderSyubetu) & "\" & MN_FILELIST For Input As #iFileNumber
'    For i = 0 To lngFileListCnt
'       If i = lngFileListCnt Then
'          Exit For
'       End If
'       'ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'       Input #iFileNumber, strWork
'       'ÉtÉ@ÉCÉãñºíËã`Ç»Çµ
'       If strWork = "" Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'          bRet = False
'          Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'          Exit For
'       'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'       ElseIf " " <> Mid(strWork, 2, 1) Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       ElseIf (InStr(strWork, ".") - 1) = -1 Then
'           MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       Else
'          'ÉtÉ@ÉCÉãñºÇÃÇ›Çíäèo
'          sGetFileListName = Mid(strWork, 3, 16)
'          'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
'          myLen = LenB(StrConv(sGetFileListName, vbFromUnicode))                                              'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
'          If FILE_NAME_MAX_SIZE < myLen Then
'            '13ÉoÉCÉgà»è„ÇÃèÍçá
'            MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                   vbOKOnly + vbExclamation, _
'                   sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'            bRet = False
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'            Exit For
'           End If
'        End If
'     Next
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉNÉçÅ[ÉYÅB
'    Close #iFileNumber
'V1.6.0.1 DEL END
'V1.11.0.1 DEL START
'    If gStrCurrentForm = sFormName_EJVer Then
''V1.6.0.1 ADDÅ@START
'   For iCnt = 1 To MAX_GATE_NO
'      'EG-Ré©â¸ÇÃÇ›ÅFé©â¸ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNDLLèàóù
'      iGouki = pfGetGoukiNo(iCnt)
'      If iGouki <> 0 Then
''V1.6.0.1 ADDÅ@END
'       'iGouki = pfGetGoukiNo 'V1.6.0.1 DEL
'       sVersionInfoPath = Replace(GATE_VERSION_INFO_FILE, "##", Format(iGouki, "0#"))
'
'       'iRet = dllVerChk(E_EPRO1WRK & "\\" & GATE_VERSION_KANRI_FILE, PATH_GATE & sVersionInfoPath, PATH_HOSHU_LOG & GATE_VERSION_NGLIST_FILE)Å@Å@Å@Å@Å@Å@Å@Å@Å@'V1.6.0.1Å@DEL
'       iRet = dllVerChk(FolderName(0, FolderSyubetu) & "\" & GATE_VERSION_KANRI_FILE, PATH_GATE & sVersionInfoPath, PATH_HOSHU_LOG & GATE_VERSION_NGLIST_FILE)  'V1.6.0.1Å@ADD
'       If iRet = 1 Then
'          bRet = True
'       Else
'          bRet = False
'          MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
'                 vbOKOnly + vbExclamation, _
'                 TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
'          'V1.6.0.1 ADD START
'           pfSeitouseiChck = False
'           Exit Function
'          'V1.6.0.1 ADD END
'       End If
'       End If 'V1.6.0.1 ADD
'      Next 'V1.6.0.1 ADD
'    End If
''V1.6.0.1 ADD START
'V1.11.0.1 DEL END
    'ã@éÌê≥ìñê´É`ÉFÉbÉN(ëŒè€ÉtÉ@ÉCÉãÅFXX_GATEY.VEFÅ@XX:ÉÜÅ[ÉUÅ[ñºÅ@YÅFÉfÅ[É^éÌï )
    bRet = fKishuCheck(FolderName(0, FolderSyubetu) & "\")
    If bRet = False Then
       MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                  vbOKOnly + vbExclamation, _
                  TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
       pfSeitouseiChck = False
       Exit Function
    End If
'V1.6.0.1 ADD END

    pfSeitouseiChck = bRet
Exit Function

FileGetError:
    If iFileNumber > 0 Then
       Close #iFileNumber
    End If
    iFileNumber = 0
    pfSeitouseiChck = False
End Function
'V1.4.0.1 ADD END
'V1.6.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fKishuCheck
'//  ã@î\ñºèÃ  : é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ëŒè€Ç∆Ç»ÇÈÉfÅ[É^ÇÃã@éÌê≥ìñê´É`ÉFÉbÉNÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.6.0.1) 2009-06-16   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-09  REVISED BY [TCC] S.Yamazaki
'//                ÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃã@éÌê≥ìñê´É`ÉFÉbÉNïœçX
'//                Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fKishuCheck(sFileList As String) As Boolean
    Dim sKisyu       As String * 8     'éÊìæã@éÌñº
    Dim sMyName      As String         'ã@éÌê≥ìñê´É`ÉFÉbÉNÉäÉXÉgÉtÉ@ÉCÉãñº
    Dim sFileName    As String         'ÉtÉ@ÉCÉãÉäÉXÉgãLç⁄ÉtÉ@ÉCÉãñº
    Dim sChkFileName As String         'ã@éÌê≥ìñê´É`ÉFÉbÉNÉtÉ@ÉCÉãÉpÉX
    Dim sVerChkFile  As String         'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñº
    
    Dim lLen         As Long           'ÉtÉ@ÉCÉãÉTÉCÉY
    Dim lPos         As Long           'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
           
    Dim i            As Integer        'ÉJÉEÉìÉ^Å[
    Dim iCnt         As Integer        'ìoò^ÉåÉRÅ[Éhêî
    Dim iListCnt     As Integer        'ÉtÉ@ÉCÉãäiî[êî
    Dim iFileNumber  As Integer        'ÉtÉ@ÉCÉãî‘çÜ

    Dim bRet         As Boolean        'ã@éÌê≥ìñê´É`ÉFÉbÉNåãâ 

    Dim uHeder       As MN_HEDER       'ÉwÉbÉ_èÓïÒäiî[ÉGÉäÉA
    Dim uFotter      As MN_FOOT        'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
    
    Dim sChkData As String             'î‰ärï∂éöíäèo    'V1.20.0.1 ADD
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
     
    'èâä˙âª
    iCnt = 0
    iListCnt = 0
    iFileNumber = 0
    fKishuCheck = False
        
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)
    
    'ÉoÅ[ÉWÉáÉìÉfÅ[É^(ã@éÌê≥ìñê´É`ÉFÉbÉNÉäÉXÉgÉtÉ@ÉCÉãÉpÉX)çÏê¨
    sVerChkFile = fSelectFile
    
    'ÉtÉ@ÉCÉãñºéÊìæïsâ¬=ã@éÌê≥ìñê´É`ÉFÉbÉNÉtÉ@ÉCÉãÇ»Çµ
    If sVerChkFile = "" Then
       'ê≥ìñê´É`ÉFÉbÉNÇçsÇ§ïKóvÇ»Ç¢ÇΩÇﬂÅAê≥èÌÇï‘Ç∑ÅB
       fKishuCheck = True
       Set objFso = Nothing    'V1.20.0.1 ADD
       Exit Function
    End If
    
    sMyName = sFileList & sVerChkFile
    
    'If Dir(sMyName) <> "" Then              'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?     'V1.20.0.1 DEL
    If objFso.FileExists(sMyName) = True Then    'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?  'V1.20.0.1 ADD
       
       iFileNumber = FreeFile               'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
       
       Open sMyName For Input Access Read As #iFileNumber     'ÉoÅ[ÉWÉáÉìÉfÅ[É^ÇÃÉIÅ[ÉvÉì
       
       'ÉfÅ[É^ì«Ç›çûÇ›
       Line Input #iFileNumber, sFileName
          
       'ì«Ç›çûÇ›ÉfÅ[É^ÇÊÇËÅAÉwÉbÉ_ïîÇèúÇ≠ÅB
       sFileName = Mid(sFileName, Len(uHeder) - 3)
       
       'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
       Do While Not EOF(iFileNumber)
          
          'ì«Ç›çûÇ›ÅB
          Line Input #iFileNumber, sFileName
           
           'éÊìæèÓïÒÇ™Åu/Åvà»ç~ÇÃÉRÉÅÉìÉgÇ»ÇÁëŒè€äOÅB
           'ÉfÅ[É^ïîñ{ï∂à»äOÇ»ÇÁëŒè€äO
           'ÉfÅ[É^ïîñ{ï∂ÇÃÇ›ÇÃèÍçáÇÃÇ›ÅAÉtÉ@ÉCÉãñºéÊìæÇçsÇ§ÅB
           If sFileName <> "" And Left$(sFileName, 1) <> "/" _
                              And " " = Mid(sFileName, 2, 1) Then   'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
              iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
              ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
              ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
              'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
              FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
              FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 12)
              'ìoò^ÉåÉRÅ[ÉhêîÇÉJÉEÉìÉg
              iCnt = iCnt + 1
            End If
       Loop
       
       Close #iFileNumber                                     'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
       iFileNumber = 0
    Else
       'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢èÍçáÅFê≥ìñê´É`ÉFÉbÉNÇçsÇÌÇ»Ç¢ÅB
       fKishuCheck = True
       Set objFso = Nothing    'V1.20.0.1 ADD
       Exit Function
    End If
    
    'V1.20.0.1 ADD  START
    If iCnt = 0 Then
       'ÉtÉ@ÉCÉãÉäÉXÉgÉRÅ[ÉhÇ™ë∂ç›ÇµÇ»Ç¢èÍçáÅFê≥ìñê´É`ÉFÉbÉNÇçsÇÌÇ»Ç¢ÅB
       fKishuCheck = True
       Set objFso = Nothing    'V1.20.0.1 ADD
       Exit Function
    End If
    'V1.20.0.1 ADD  END
    
    'ÉtÉ@ÉCÉãã@éÌê≥ìñê´É`ÉFÉbÉNÇçsÇ§ÅB
    For i = 0 To iCnt - 1
         'É`ÉFÉbÉNëŒè€ÉtÉ@ÉCÉãÉpÉXçÏê¨
        sChkFileName = sFileList & FileList(i)
    
        'If Dir(sChkFileName) <> "" Then              'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?  'V1.20.0.1 DEL
        If objFso.FileExists(sChkFileName) = True Then  'ÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ?   'V1.20.0.1 ADD
            
            lLen = FileLen(sChkFileName)             'ÉtÉ@ÉCÉãÉTÉCÉYÇÃéÊìæ

            iFileNumber = FreeFile                   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
            'ÉtÉ@ÉCÉãÇÃÉIÅ[ÉvÉìÇçsÇ§ÅB
            Open sChkFileName For Binary Access Read As #iFileNumber
            'ÉtÉbÉ^èÓïÒÇÃéÊìæ
            Get #iFileNumber, lLen - Len(uFotter) + 1, uFotter
            
            Close #iFileNumber                       'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑
            iFileNumber = 0
            
            'ã@éÌñºÉZÉbÉg
            sKisyu = uFotter.sKisyu
            
            sChkData = "" 'èâä˙âªÅ@'V1.20.0.1 ADD
            
            'é©â¸É`ÉFÉbÉN
            If gStrCurrentForm = sFormName_EJVer Then
               'EG-Ré©â¸éû
               'If EGR_JIKAI_KISHU = Trim(sKisyu) Then  'V1.20.0.1 DEL
               'V1.20.0.1 ADD START
               'ï∂éöíäèo
               sChkData = Left(sKisyu, Len(EGR_JIKAI_KISHU))
               If EGR_JIKAI_KISHU = sChkData Then
               'V1.20.0.1 ADD END
                   bRet = True  'ã@éÌê≥ìñê´ÅFê≥èÌ
               Else
                   bRet = False 'ã@éÌê≥ìñê´ÅFàŸèÌ
                   fKishuCheck = bRet
                   Set objFso = Nothing    'V1.20.0.1 ADD
                   Exit Function
               End If
            Else
               'NEGé©â¸éû
               'If NEG_JIKAI_KISHU = Trim(sKisyu) Then    'V1.20.0.1 DEL
               'V1.20.0.1 ADD START
               'ï∂éöíäèo
               sChkData = Left(sKisyu, Len(NEG_JIKAI_KISHU))
               If NEG_JIKAI_KISHU = sChkData Then
               'V1.20.0.1 ADD END
                   bRet = True  'ã@éÌê≥ìñê´ÅFê≥èÌ
               Else
                   bRet = False 'ã@éÌê≥ìñê´ÅFàŸèÌ
                   fKishuCheck = bRet
                   Set objFso = Nothing    'V1.20.0.1 ADD
                   Exit Function
               End If
            End If

        End If
    Next

  fKishuCheck = bRet
  
  Set objFso = Nothing    'V1.20.0.1 ADD
  
 Exit Function

ErrorHandler:
   If iFileNumber <> 0 Then
       Close #iFileNumber                                     'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
   End If
    
   'ñﬂÇËílÇàŸèÌÇ∆Ç∑ÇÈ
   fKishuCheck = False
       
   Set objFso = Nothing    'V1.20.0.1 ADD

End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fSelectFile
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñº
'//  ã@î\äTóv  : ëŒè€ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈ
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fSelectFile() As String
 
 If gStrCurrentForm = sFormName_EJVer Then
    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñºÇê›íËÇ∑ÇÈÅB
    Select Case FolderSyubetu
       Case 0 'îªíËCPU-Pro
            fSelectFile = EHANTEI_CPU_CHK_FILE
       
       Case 1 'ÉÅÉCÉìCPU-Pro
            fSelectFile = EMAIN_CPU_CHK_FILE
       
       Case 2 'ÉTÉuCPU-Pro
            fSelectFile = ESUB_CPU_CHK_FILE
       
       Case 3 'ÉÅÉCÉìCPU-OS
            fSelectFile = EMAIN_OS_CHK_FILE
     
     End Select
  Else
    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãñºÇê›íËÇ∑ÇÈÅB
    Select Case FolderSyubetu
       Case 0 'îªíËCPU-Pro
             fSelectFile = NHANTEI_CPU_CHK_FILE
      
       Case 1 'ÉÅÉCÉìCPU-Pro
            fSelectFile = NMAIN_CPU_CHK_FILE
       
       Case 2 'ÉTÉuCPU-Pro
            fSelectFile = NSUB_CPU_CHK_FILE
       
       Case 3 'ÉÅÉCÉìCPU-OS
            fSelectFile = NMAIN_OS_CHK_FILE
     
    End Select
   End If

End Function
'V.1.6.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fOldVersion
'//  ã@î\ñºèÃ  : ãåÉoÅ[ÉWÉáÉìèàóù
'//  ã@î\äTóv  : àÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇé¿çs(é¿çs)ÉoÅ[ÉWÉáÉìÇ…ï‘Ç∑ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.6.0.1) 2009-06-29   REVISED BY [TCC] S.Terao
'//                ÉtÉFÅ[ÉYÇRëŒâûÅ@ä«óùÇ÷ÇÃÉÅÅ[ÉãëóêMèàóùÇÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[ÅvéûÇ…Ç†ÇÌÇπÇΩ
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fOldVersion() As Boolean
    Dim bRet As Boolean                     'ñﬂÇËíl
    Dim lngCnt                  As Long     'ÉJÉEÉìÉ^Å[
    Dim sSrcFileName            As String   'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãÉäÉXÉg
    Dim lngSumRet               As Long
    Dim lngErrCode              As Long     'ÉGÉâÅ[ÉRÅ[Éh
    Dim iKansiAplChk As Integer              'ÉAÉvÉäãNìÆÉ`ÉFÉbÉNñﬂÇËílÅ@'V1.6.0.1 ADD

    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    On Error Resume Next
 
   'ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÉäÉXÉgÇåüçıÇ∑ÇÈÅB
    sSrcFileName = FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST
                                    'ÅuãåÅvÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ  'V1.20.0.1 DEL
    'V1.20.0.1 ADD START
    If objFso.FileExists(sSrcFileName) = True Then
        Set objFso = Nothing
    'V1.20.0.1 ADD END
    Else                                'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉtÉ@ÉCÉãÉäÉXÉgñ≥ÇµÅvÉçÉOèoóÕ
        lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOTFOUND_FILELIST, lngErrCode)
 
        fOldVersion = False
        Set objFso = Nothing    'V1.20.0.1 ADD
        Exit Function                   'èàóùÇèIóπÇ∑ÇÈ
    End If
    
    '¢ãå£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    bRet = fReadFileList(FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST)
  
    '¢é¿çs£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇëSÇƒçÌèúÇ∑ÇÈ
    If sNowFolderRemove <> True Then
        fOldVersion = False
        Exit Function
    End If
    
    '¢ãå£ÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇ¢é¿çs£ÉtÉHÉãÉ_ÇÃì‡óeÇ…íuä∑Ç¶ÇÈ
    If sCopyOLDtoNOW <> True Then
        fOldVersion = False
        Exit Function
    End If
'V1.6.0.1 DEL START
'   'é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇä«óùÉvÉçÉZÉXÇ÷ëóêMÇ∑ÇÈÅB
'     If gStrCurrentForm = sFormName_EJVer Then
'        psVersionUpdateReqest (ML_REQUEST_EGATE)
'     Else
'        psVersionUpdateReqest (ML_REQUEST_NGATE)
'     End If
'V1.6.0.1 DEL END
'V1.6.0.1 ADD START
    'é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇä«óùÉvÉçÉZÉXÇ÷ëóêMÇ∑ÇÈÅB
    'äƒéãî’ãNìÆ/ñ¢ãNìÆÉ`ÉFÉbÉNÇçsÇ§ÅBÉ`ÉFÉbÉNèÛë‘Ç…ÇÊÇËèàóùï™äÚÇçsÇ§ÅB
     iKansiAplChk = CheckAppStart(PROC_KANRI)
     If iKansiAplChk <> 0 Then
        'äƒéãî’ãNìÆéûÅFä«óùÉvÉçÉZÉXÇ…é©â¸ÉoÅ[ÉWÉáÉìèÓïÒçXêVóvãÅÉÅÅ[ÉãÇëóêMÇ∑ÇÈÅB
      If gStrCurrentForm = sFormName_EJVer Then
         psVersionUpdateReqest (ML_REQUEST_EGATE)
      Else
         psVersionUpdateReqest (ML_REQUEST_NGATE)
      End If
    Else
        'äƒéãî’ñ¢ãNìÆéûÅFâ¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùåãâ Ç…ê≥èÌÇê›íËÇ∑ÇÈÅB
        gintGateVerInfUpdRes = MailSts.stsNormal
    End If
'V1.6.0.1 ADD END
     
     'â¸éDã@ÉoÅ[ÉWÉáÉìçXêVèàóùàŸèÌ
    If gintGateVerInfUpdRes = MailSts.stsNormal Then
        'ê≥èÌ
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ÇÃì‡óeÇÅAÅué¿çsÅvÉtÉHÉãÉ_Ç…ñﬂÇµÇƒÅA" _
                    & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & "ÇÃàÍê¢ë„ëOÇÃÉoÅ[ÉWÉáÉìÇÅA" _
                    & Chr(vbKeyReturn) & "é¿çsÉoÅ[ÉWÉáÉìÇ∆ÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        fOldVersion = True
    Else
        'àŸèÌ
        If gStrCurrentForm = sFormName_EJVer Then
          MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
                  vbOKOnly + vbExclamation, _
                  "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        Else
           MsgBox "â¸éDã@ÇÃÉoÅ[ÉWÉáÉìçÏê¨Ç≈àŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
        End If
        fOldVersion = False
    End If

    fOldVersion = True
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sSetFolderName
'//  ã@î\ñºèÃ  : ÉfÅ[É^ìWäJ
'//  ã@î\äTóv  : ÉtÉHÉãÉ_ñºÇ»Ç«ÇÃÉfÅ[É^ÇÉOÉçÅ[ÉoÉãÉGÉäÉAÇ…ìWäJÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//                ÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈ÇÃê≥ìñê´É`ÉFÉbÉNINIì«çûÇ›
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sSetFolderName()

        TitleBox(0) = "îªíËCPU-Pro"
        TitleBox(1) = "ÉÅÉCÉìCPU-Pro"
        TitleBox(2) = "ÉTÉuCPU-Pro"
        TitleBox(3) = "ÉÅÉCÉìCPU-OS"
        TitleBox(4) = "ó\îı1"
        TitleBox(5) = "ó\îı2"
    
        LogBox(0) = "îªíË"
        LogBox(1) = "ÉÅÉCÉì"
        LogBox(2) = "ÉTÉu"
        LogBox(3) = "OS"
        LogBox(4) = "ó\îı1"
        LogBox(5) = "ó\îı2"
        
  If gStrCurrentForm = sFormName_EJVer Then
        'ÉtÉHÉãÉ_ñºÇ…ê›íËÇçsÇ§
        FolderName(0, 0) = E_EHAN1WRK
        FolderName(1, 0) = E_EHAN1NOW
        FolderName(2, 0) = E_EHAN1OLD
        FolderName(0, 1) = E_EPRO1WRK
        FolderName(1, 1) = E_EPRO1NOW
        FolderName(2, 1) = E_EPRO1OLD
        FolderName(0, 2) = E_ESCPUWRK
        FolderName(1, 2) = E_ESCPUNOW
        FolderName(2, 2) = E_ESCPUOLD
        FolderName(0, 3) = E_EOSWRK
        FolderName(1, 3) = E_EOSNOW
        FolderName(2, 3) = E_EOSOLD
        FolderName(0, 4) = E_EYOBI1WRK
        FolderName(1, 4) = E_EYOBI1NOW
        FolderName(2, 4) = E_EYOBI1OLD
        FolderName(0, 5) = E_EYOBI2WRK
        FolderName(1, 5) = E_EYOBI2NOW
        FolderName(2, 5) = E_EYOBI2OLD
    Else
        'ÉtÉHÉãÉ_ñºÇ…ê›íËÇçsÇ§
        FolderName(0, 0) = N_NHAN1WRK
        FolderName(1, 0) = N_NHAN1NOW
        FolderName(2, 0) = N_NHAN1OLD
        FolderName(0, 1) = N_NPRO1WRK
        FolderName(1, 1) = N_NPRO1NOW
        FolderName(2, 1) = N_NPRO1OLD
        FolderName(0, 2) = N_NSCPUWRK
        FolderName(1, 2) = N_NSCPUNOW
        FolderName(2, 2) = N_NSCPUOLD
        FolderName(0, 3) = N_NOSWRK
        FolderName(1, 3) = N_NOSNOW
        FolderName(2, 3) = N_NOSOLD
        FolderName(0, 4) = N_NYOBI1WRK
        FolderName(1, 4) = N_NYOBI1NOW
        FolderName(2, 4) = N_NYOBI1OLD
        FolderName(0, 5) = N_NYOBI2WRK
        FolderName(1, 5) = N_NYOBI2NOW
        FolderName(2, 5) = N_NYOBI2OLD
    End If

'V1.20.0.1 ADD START
'-------EG-Ré©â¸-------
    ' ÉLÅ[ñº:îªíËCPU-PROë„ï\
    EHANTEI_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_HANTEI_PRO, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-PROë„ï\
    EMAIN_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_MAIN_PRO, PATH_GATEVER_FILE)
        
    ' ÉLÅ[ñºÅFÉTÉuCPU-PROë„ï\
    ESUB_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_SUB_PRO, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-OSë„ï\
    EMAIN_OS_CHK_FILE = sSetChkFile(GATE_TYPE_E, GATE_MAIN_OS, PATH_GATEVER_FILE)
    
'-------NEGé©â¸-------
    ' ÉLÅ[ñº:îªíËCPU-PROë„ï\
    NHANTEI_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_HANTEI_PRO, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-PROë„ï\
    NMAIN_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_MAIN_PRO, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñºÅFÉTÉuCPU-PROë„ï\
    NSUB_CPU_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_SUB_PRO, PATH_GATEVER_FILE)
    
    ' ÉLÅ[ñº:ÉÅÉCÉìCPU-OSë„ï\
    NMAIN_OS_CHK_FILE = sSetChkFile(GATE_TYPE_N, GATE_MAIN_OS, PATH_GATEVER_FILE)
'V1.20.0.1 ADD END

End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fReadFileList
'//  ã@î\ñºèÃ  : ÉtÉ@ÉCÉãÉäÉXÉgÇÃéÊìæ
'//  ã@î\äTóv  : ÉtÉ@ÉCÉãÉäÉXÉgÇÊÇËÅAÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fReadFileList(sFileList As String) As Boolean
    Dim iFileNumber As Integer      'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String         'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer         'ÉtÉ@ÉCÉãäiî[êî

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË

    iListCnt = 0
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)

    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open sFileList For Input Access Read As #iFileNumber    'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
    Do While Not EOF(iFileNumber)                           'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
        Line Input #iFileNumber, sFileName                  'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
        If sFileName <> "" And Left$(sFileName, 1) <> "/" Then                'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
            iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
            ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
            FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 16)
                                                            'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
        End If
    Loop
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB

    fReadFileList = True    'ñﬂÇËílÇê≥èÌÇ∆Ç∑ÇÈ

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'V1.21.0.1 ADD  START
    If iFileNumber > 0 Then
        Close #iFileNumber
    End If
    'V1.21.0.1 ADD  END
    fReadFileList = False   'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fDataFileCheck
'//  ã@î\ñºèÃ  : é©â¸ÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ëŒè€Ç∆Ç»ÇÈHAN_KUKA.KUKóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.11.0.1) 2009-10-23  CODED   BY [TCC] D.Yamashita
'//                 ÅEÉtÉFÅ[ÉYÇRécåèçÄñ⁄ëŒâûÅ@àŸèÌéûÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fDataFileCheck(sFileList As String) As Boolean
    Dim iFileNumber As Integer      'ÉtÉ@ÉCÉãî‘çÜ
    Dim sFileName As String         'ÉtÉ@ÉCÉãñº
    Dim iListCnt As Integer         'ÉtÉ@ÉCÉãäiî[êî
    Dim sFolderPath As String       'HAN_KUKA.KUKÉtÉHÉãÉ_ÉpÉXóp
    Dim sHANKUKAPath As String      'HAN_KUKA.KUKÉtÉãÉpÉXóp
     
    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË

    iListCnt = 0
    ReDim Preserve FileList(iListCnt)
    ReDim Preserve FileListType(iListCnt)

    iFileNumber = FreeFile   'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open sFileList For Input Access Read As #iFileNumber    'ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉIÅ[ÉvÉì
    Do While Not EOF(iFileNumber)                           'ÉtÉ@ÉCÉãÇÃèIí[Ç‹Ç≈ÉãÅ[ÉvÇåJÇËï‘ÇµÇ‹Ç∑ÅB
        Line Input #iFileNumber, sFileName                  'ÉfÅ[É^Çì«Ç›çûÇ›Ç‹Ç∑ÅB
        If sFileName <> "" And Left$(sFileName, 1) <> "/" Then                'ÉtÉ@ÉCÉãñºÇ™ë∂ç›Ç∑ÇÈ
            iListCnt = iListCnt + 1                         'ÉtÉ@ÉCÉãêîÇÃÉJÉEÉìÉ^ÇÉAÉbÉvÇ∑ÇÈ
            ReDim Preserve FileList(iListCnt)               'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            ReDim Preserve FileListType(iListCnt)           'ÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇägí£Ç∑ÇÈ
            FileListType(iListCnt - 1) = UCase(Trim$(Left$(sFileName, 18)))
            FileList(iListCnt - 1) = Mid$(FileListType(iListCnt - 1), 3, 16)
                                                            'ÉtÉ@ÉCÉãñºÇÉtÉ@ÉCÉãñºäiî[ÉGÉäÉAÇ…ÉZÉbÉg
            If HANKUKA_KUK = FileList(iListCnt - 1) Then
               'HAN_KUKA.KUKÉtÉ@ÉCÉãÇ™óLÇ¡ÇΩèÍçáÅAÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNÇçsÇ§ÅB
               psFolderPathGet sFileList, sFolderPath
               sHANKUKAPath = sFolderPath & HANKUKA_KUK
               If fHankukaChck(sHANKUKAPath) = False Then
                 'ÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNàŸèÌéûÇÕÅAñﬂÇËílÇ…FalseÇê›íËÇ∑ÇÈÅB
                  fDataFileCheck = False
                  Close #iFileNumber        'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB   'V1.11.0.1 ADD
                  Exit Function
               End If
            End If
        End If
  Loop
  
  Close #iFileNumber        'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB

  fDataFileCheck = True     'ñﬂÇËílÇê≥èÌÇ∆Ç∑ÇÈ

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:               ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    fDataFileCheck = False  'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
    Close #iFileNumber      'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fHankukaChck
'//  ã@î\ñºèÃ  : HAN_KUKA.KUKê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : ëŒè€Ç∆Ç»ÇÈHAN_KUKA.KUKÇÃì‡óeÇÉ`ÉFÉbÉNÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : StringÅ@Å@sFileListÅ@[IN]ÉtÉ@ÉCÉãÉäÉXÉgÇÃÉtÉãÉpÉXñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.4.0.1) 2009-04-06   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâû
'//     REVISIONS :(1.16.0.1) 2009-12-21   REVISED BY [TCC] S.Terao
'//                 ïsãÔçáëŒâû
'//     REVISIONS :(V2.5.0.1) 2010-10-29  REVISED BY [TCC] S.Terao
'//                 EG-R(KK)Å@î™íöìÎëŒâûÅ@KUKê≥ìñê´É`ÉFÉbÉNïœçX
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fHankukaChck(sFilePath As String) As Boolean
    Dim iFileNumber As Integer           'ÉtÉ@ÉCÉãî‘çÜ
    Dim i As Integer
    Dim lSts As Long
    Dim sKeyName As String
    Dim lPos As Long                     'ÉoÅ[ÉWÉáÉìèÓïÒäiî[à íu
    Dim lLen As Long                     'ÉtÉ@ÉCÉãÉTÉCÉY
    Dim uFooter As MN_FOOT          'ÉtÉbÉ^èÓïÒäiî[ÉGÉäÉA
'    Dim uHeder As MN_FOOT           'ÉwÉbÉ_èÓïÒäiî[ÉGÉäÉA     'V1.4.0.1 DEL
    Dim sDateTime As String
    Dim j As Integer
    Dim lngErrCode As Long          'ÉGÉâÅ[ÉRÅ[Éh
    'V1.4.0.1 ADD START
    Dim uHeder As HAN_KUKA_KUK_HEADER       'ÉwÉbÉ_èÓïÒäiî[ÉGÉäÉA
    Dim sGetInfo As String * MAX_PATH_SIZE  'INIÉtÉ@ÉCÉãéÊìæóp
    Dim sChkFileData As String
    Dim iMojisu As Integer
    
    'V1.16.0.1 ADD Start
    Dim bChkSts As Boolean              'É`ÉFÉbÉNåãâ ÉtÉâÉO
    Dim sChkData As String              'î‰ärï∂éöíäèo
    'V1.16.0.1 ADD End
    
   'èâä˙âªÅFê≥èÌ(ÉuÉâÉìÉNÅj
    sNGSts = ""
    sNGKoumoku = ""
    'V1.4.0.1 ADD END
    Dim oFs As New FileSystemObject 'V2.5.0.1 ADD
    
    fHankukaChck = False
    
'V2.5.0.1 ADD START
 'ÉtÉ@ÉCÉãóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
 If oFs.FileExists(sFilePath) = False Then
    'ÉtÉ@ÉCÉãÇ™ñ≥ÇØÇÍÇŒê≥ìñê´É`ÉFÉbÉNÇçsÇÌÇ»Ç¢ÅB
    fHankukaChck = True
    Set oFs = Nothing
    Exit Function
 End If
'V2.5.0.1 ADD END

 'V1.4.0.1 DEL START
'   For i = 0 To INI_MAX
'      'ÉwÉbÉ_ÅFä˙ë“ílã@éÌñºéÊìæ
'      sKeyName = Format(HEDER_KISHU_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sHederKisyu(i), _
'                                     Len(HAN_KUKA_DATA.sHederKisyu(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'      'ÉwÉbÉ_ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
'      sKeyName = Format(HEDER_FILE_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sHederFile(i), _
'                                     Len(HAN_KUKA_DATA.sHederFile(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'      'ÉtÉbÉ^ÅFä˙ë“ílã@éÌñºéÊìæ
'      sKeyName = Format(FOTTER_KISHU_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sFotterKisyu(i), _
'                                     Len(HAN_KUKA_DATA.sFotterKisyu(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'      'ÉtÉbÉ^ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
'      sKeyName = Format(FOTTER_FILE_NAME & "0" & i + 1)
'      lSts = GetPrivateProfileString(HANTEI_CHK, _
'                                     sKeyName, _
'                                     "", _
'                                     HAN_KUKA_DATA.sFotterFile(i), _
'                                     Len(HAN_KUKA_DATA.sFotterFile(i)), _
'                                     GATE_HANTEI_CHK_FILE)
'      If lSts = False Then
'        Exit For
'      End If
'
'    Next i
    'V1.4.0.1 DEL END
    'V1.4.0.1 ADD START
    'èâä˙âª
    For i = 0 To INI_MAX - 1
        HAN_KUKA_DATA.sHederKisyu(i) = ""
        HAN_KUKA_DATA.sHederFile(i) = ""
        HAN_KUKA_DATA.sFotterKisyu(i) = ""
        HAN_KUKA_DATA.sFotterFile(i) = ""
    Next
    For i = 0 To INI_MAX - 1
      'ÉwÉbÉ_ÅFä˙ë“ílã@éÌñºéÊìæ
      sKeyName = Format(HEDER_KISHU_NAME & "0" & i + 1)
      lSts = GetPrivateProfileString(HANTEI_CHK, _
                                     sKeyName, _
                                     "", _
                                     sGetInfo, _
                                     Len(sGetInfo), _
                                     GATE_HANTEI_CHK_FILE)
      If lSts = False Then
       
      Else
        HAN_KUKA_DATA.sHederKisyu(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
      End If
      'ÉwÉbÉ_ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
      sKeyName = Format(HEDER_FILE_NAME & "0" & i + 1)
      lSts = GetPrivateProfileString(HANTEI_CHK, _
                                     sKeyName, _
                                     "", _
                                     sGetInfo, _
                                     Len(sGetInfo), _
                                     GATE_HANTEI_CHK_FILE)
      If lSts = False Then
        
      Else
         HAN_KUKA_DATA.sHederFile(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
      End If
      'ÉtÉbÉ^ÅFä˙ë“ílã@éÌñºéÊìæ
      sKeyName = Format(FOTTER_KISHU_NAME & "0" & i + 1)
      lSts = GetPrivateProfileString(HANTEI_CHK, _
                                     sKeyName, _
                                     "", _
                                     sGetInfo, _
                                     Len(sGetInfo), _
                                     GATE_HANTEI_CHK_FILE)
      If lSts = False Then
        
      Else
        HAN_KUKA_DATA.sFotterKisyu(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
      End If
      'ÉtÉbÉ^ÅFä˙ë“ílÉtÉ@ÉCÉãñºéÊìæ
      sKeyName = Format(FOTTER_FILE_NAME & "0" & i + 1)
      lSts = GetPrivateProfileString(HANTEI_CHK, _
                                     sKeyName, _
                                     "", _
                                     sGetInfo, _
                                     Len(sGetInfo), _
                                     GATE_HANTEI_CHK_FILE)
      If lSts = False Then
        
      Else
        HAN_KUKA_DATA.sFotterFile(i) = Left$(sGetInfo, (InStr(sGetInfo, vbNullChar) - 1))
      End If
    Next i
    'V1.4.0.1 ADD END

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
    
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÉTÉCÉYéÊìæ
    lLen = FileLen(sFilePath)
    
    'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
    iFileNumber = FreeFile
    
    'V1.4.0.1 DEL START
'    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
'    Open sFilePath For Input Access Read As #iFileNumber
'
'    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÃÉwÉbÉ_èÓïÒÇéÊìæÇ∑ÇÈÅB
''    Get #iFileNumber, 1, uHeder
    'V1.4.0.1 DEL END

    'V1.4.0.1 ADD START
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
    Open sFilePath For Binary Access Read As #iFileNumber
            
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÃÉwÉbÉ_èÓïÒÇéÊìæÇ∑ÇÈÅB
    Get #iFileNumber, 1, uHeder
    'V1.4.0.1 ADD END

   'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÃÉtÉbÉ^èÓïÒÇéÊìæÇ∑ÇÈÅB
    Get #iFileNumber, lLen - Len(uFooter) + 1, uFooter

    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    Close #iFileNumber
    
    iFileNumber = 0                          'V1.4.0.1 ADD
'V1.4.0.1 DEL START
    'ã@éÌñº/ÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'    For i = 0 To 5
'       'ÉwÉbÉ_èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
'       If uHeder.sKisyu <> HAN_KUKA_DATA.sHederKisyu(i) Then
'          Exit Function
'       End If
'       'ÉwÉbÉ_èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'       If uHeder.sFileName <> HAN_KUKA_DATA.sHederFile(i) Then
'          Exit Function
'       End If
'       'ÉtÉbÉ^èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
'       If uFooter.sKisyu <> HAN_KUKA_DATA.sFotterKisyu(i) Then
'          Exit Function
'       End If
'       'ÉtÉbÉ^èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
'       If uFooter.sFileName <> HAN_KUKA_DATA.sFotterFile(i) Then
'          Exit Function
'       End If
'     Next
'V1.4.0.1 DEL END
   'V1.4.0.1 ADD START
   'ÉwÉbÉ_èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
   iMojisu = InStr(uHeder.sKisyuName, " ") - 1
   If iMojisu < 0 Then
     sChkFileData = Mid(uHeder.sKisyuName, 1)
   Else
     sChkFileData = Mid(uHeder.sKisyuName, 1, iMojisu)
   End If
'V1.16.0.1 DEL START
'    For i = 0 To INI_MAX - 1
'      If sChkFileData <> HAN_KUKA_DATA.sHederKisyu(i) Then
'         If i = INI_MAX - 1 Then
'            'ã@éÌñºä˙ë“ílëSïsàÍívÅF
'            sNGSts = ERROR_HEDER
'            sNGKoumoku = KISHU_NAME_ERROR
'            GoTo ErrorHandler
'         End If
'      Else
'        Exit For
'      End If
'    Next
'V1.16.0.1 DEL END
'V1.16.0.1 ADD START
    bChkSts = False
    For i = 0 To INI_MAX - 1
       If HAN_KUKA_DATA.sHederKisyu(i) <> "" Then
          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sHederKisyu(i)))
          If sChkData = HAN_KUKA_DATA.sHederKisyu(i) Then
             bChkSts = True
           Exit For
          End If
      End If
    Next
    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
    If bChkSts = False Then
       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
        sNGSts = ERROR_HEDER
        sNGKoumoku = KISHU_NAME_ERROR
         GoTo ErrorHandler
    End If
'V1.16.0.1 ADD END

   'ÉwÉbÉ_èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
   iMojisu = InStr(uHeder.sProgrumName, " ") - 1
   If iMojisu < 0 Then
     sChkFileData = Mid(uHeder.sProgrumName, 1)
   Else
     sChkFileData = Mid(uHeder.sProgrumName, 1, iMojisu)
   End If

'V1.16.0.1 DEL START
'   For i = 0 To INI_MAX - 1
'       If sChkFileData <> HAN_KUKA_DATA.sHederFile(i) Then
'         If i = INI_MAX - 1 Then
'            'ÉtÉ@ÉCÉãñºä˙ë“ílëSïsàÍívÅF
'            sNGSts = ERROR_HEDER
'            sNGKoumoku = FILE_NAME_ERRORE
'            GoTo ErrorHandler
'         End If
'      Else
'         Exit For
'      End If
'    Next
'V1.16.0.1 DEL END
'V1.16.0.1 ADD START
    bChkSts = False
    For i = 0 To INI_MAX - 1
       If HAN_KUKA_DATA.sHederFile(i) <> "" Then
          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sHederFile(i)))
          If sChkData = HAN_KUKA_DATA.sHederFile(i) Then
             bChkSts = True
           Exit For
          End If
      End If
    Next
    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
    If bChkSts = False Then
       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
        sNGSts = ERROR_HEDER
        sNGKoumoku = FILE_NAME_ERRORE
         GoTo ErrorHandler
    End If
'V1.16.0.1 ADD END
    
   'çÏê¨ì˙ïtÉ`ÉFÉbÉN
   'ÉwÉbÉ_èÓïÒÅFçÏê¨ì˙ïtÇ™êîílÇ©Ç«Ç§Ç©
    sDateTime = ""
    For j = 0 To 3
        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
    Next
    For j = 4 To 5
        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
    Next
    If IsNumeric(sDateTime) = False Then
       sNGSts = ERROR_HEDER
       sNGKoumoku = CREATE_DATA_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    
    'ÉoÅ[ÉWÉáÉìêîílÉ`ÉFÉbÉN
    If IsNumeric(uHeder.sVersion) = False Then
       sNGSts = ERROR_HEDER
       sNGKoumoku = VERSION_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    
   'ÉtÉbÉ^èÓïÒÅFã@éÌñºÉ`ÉFÉbÉN
   iMojisu = InStr(uFooter.sKisyu, " ") - 1
   If iMojisu < 0 Then
     sChkFileData = Mid(uFooter.sKisyu, 1)
   Else
     sChkFileData = Mid(uFooter.sKisyu, 1, iMojisu)
   End If
'V1.16.0.1 DEL START
'    For i = 0 To INI_MAX - 1
'      If sChkFileData <> HAN_KUKA_DATA.sFotterKisyu(i) Then
'         If i = INI_MAX - 1 Then
'             'ã@éÌñºä˙ë“ílëSïsàÍívÅF
'             sNGSts = ERROR_FOTTER
'             sNGKoumoku = KISHU_NAME_ERROR
'             GoTo ErrorHandler
'          End If
'       Else
'         Exit For
'       End If
'    Next
'V1.16.0.1 DEL END
'V1.16.0.1 ADD START
   bChkSts = False
    For i = 0 To INI_MAX - 1
       If HAN_KUKA_DATA.sFotterKisyu(i) <> "" Then
          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sFotterKisyu(i)))
          If sChkData = HAN_KUKA_DATA.sFotterKisyu(i) Then
             bChkSts = True
           Exit For
          End If
      End If
    Next
    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
    If bChkSts = False Then
       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
        sNGSts = ERROR_FOTTER
        sNGKoumoku = KISHU_NAME_ERROR
         GoTo ErrorHandler
    End If
'V1.16.0.1 ADD END

   'ÉtÉbÉ^èÓïÒÅFÉtÉ@ÉCÉãñºÉ`ÉFÉbÉN
   iMojisu = InStr(uFooter.sFileName, " ") - 1
   If iMojisu < 0 Then
     sChkFileData = Mid(uFooter.sFileName, 1)
   Else
     sChkFileData = Mid(uFooter.sFileName, 1, iMojisu)
   End If
'V1.16.0.1 DEL START
'    For i = 0 To INI_MAX - 1
'       If sChkFileData <> HAN_KUKA_DATA.sFotterFile(i) Then
'          If i = INI_MAX - 1 Then
'             'ã@éÌñºä˙ë“ílëSïsàÍívÅF
'             sNGSts = ERROR_FOTTER
'             sNGKoumoku = FILE_NAME_ERRORE
'             GoTo ErrorHandler
'          End If
'       Else
'         Exit For
'       End If
'    Next
'   'V1.4.0.1 ADD END
'V1.16.0.1 DEL END
'V1.16.0.1 ADD START
   bChkSts = False
    For i = 0 To INI_MAX - 1
       If HAN_KUKA_DATA.sFotterFile(i) <> "" Then
          sChkData = Left(sChkFileData, Len(HAN_KUKA_DATA.sFotterFile(i)))
          If sChkData = HAN_KUKA_DATA.sFotterFile(i) Then
             bChkSts = True
           Exit For
          End If
      End If
    Next
    'É`ÉFÉbÉNåãâ ÉtÉâÉOîªíË
    If bChkSts = False Then
       'ã@éÌñºä˙ë“ílëSïsàÍívÅF
        sNGSts = ERROR_FOTTER
        sNGKoumoku = FILE_NAME_ERRORE
         GoTo ErrorHandler
    End If
'V1.16.0.1 ADD END

'V1.4.0.1 DEL START
'   'çÏê¨ì˙ïtÉ`ÉFÉbÉN
'   'ÉwÉbÉ_èÓïÒÅFçÏê¨ì˙ïtÇ™êîílÇ©Ç«Ç§Ç©
'    sDateTime = ""
'    For j = 0 To 3
'        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
'    Next
'    sDateTime = sDateTime & " "
'    For j = 4 To 5
'        sDateTime = sDateTime & Right$("0" & Hex(uHeder.byWriteTime(j)), 2)
'    Next
'    If (Chr(sDateTime) >= "A" And Chr(sDateTime) <= "Z") And _
'        (Chr(sDateTime) >= "a" And Chr(sDateTime) <= "z") Then
'         Exit Function
'    End If
'V1.4.0.1 DEL END
      
    'ÉtÉbÉ^èÓïÒÅFçÏê¨ì˙ïtÇ™êîílÇ©Ç«Ç§Ç©
     sDateTime = ""
     For j = 0 To 3
         sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
     Next
    'sDateTime = sDateTime & " " 'V1.4.0.1 DEL
     For j = 4 To 5
        sDateTime = sDateTime & Right$("0" & Hex(uFooter.byWriteTime(j)), 2)
    Next
    'V1.4.0.1 DEL START
'    If (Chr(sDateTime) >= "A" And Chr(sDateTime) <= "Z") And _
'       (Chr(sDateTime) >= "a" And Chr(sDateTime) <= "z") Then
'        Exit Function
'    End If
    'V1.4.0.1 DEL END
    
    'V1.4.0.1 ADD START
    If IsNumeric(sDateTime) = False Then
       sNGSts = ERROR_FOTTER
       sNGKoumoku = CREATE_DATA_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    'V1.4.0.1 ADD END
    'V1.4.0.1 DEL START
'      'ÉoÅ[ÉWÉáÉìílÉ`ÉFÉbÉN
'    'ÉwÉbÉ_èÓïÒÅFÉoÅ[ÉWÉáÉìílÇ™êîílÇ©Ç«Ç§Ç©
'    If (Chr(uHeder.sVersion) >= "A" And Chr(uHeder.sVersion) <= "Z") And _
'        (Chr(uHeder.sVersion) >= "a" And Chr(uHeder.sVersion) <= "z") Then
'        Exit Function
'    End If
'
'    'ÉtÉbÉ^èÓïÒÅFÉoÅ[ÉWÉáÉìílÇ™êîílÇ©Ç«Ç§Ç©
'    If (Chr(uFooter.sVersion) >= "A" And Chr(uFooter.sVersion) <= "Z") And _
'       (Chr(uFooter.sVersion) >= "a" And Chr(uFooter.sVersion) <= "z") Then
'        Exit Function
'    End If
    'V1.4.0.1 DEL END
    
    'V1.4.0.1 ADD START
    'ÉoÅ[ÉWÉáÉìílÉ`ÉFÉbÉN
    'ÉtÉbÉ^èÓïÒÅFÉoÅ[ÉWÉáÉìílÇ™êîílÇ©Ç«Ç§Ç©
    If IsNumeric(uFooter.sVersion) = False Then
       sNGSts = ERROR_FOTTER
       sNGKoumoku = VERSION_ERROR
       GoTo ErrorHandler
       Exit Function
    End If
    'V1.4.0.1 ADD END
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFê≥ìñÉ`ÉFÉbÉNê≥èÌÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_FILESTS_OK, 0)
    
    'Ç∑Ç◊ÇƒOKÇÃèÍçáÅATRUEÇ≈Ç©Ç¶ÇÈÅB
    fHankukaChck = True

Exit Function 'V1.4.0.1 ADD
'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'V1.4.0.1 ADD START
    If iFileNumber > 0 Then
       'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
       Close #iFileNumber
    End If
    iFileNumber = 0
    'V1.4.0.1 ADD END
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFê≥ìñÉ`ÉFÉbÉNàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
   ' Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_FILESTS_OK, 0) 'V1.4.0.1 DEL
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILESTS_ERROR, lngErrCode)  'V1.4.0.1 ADD
    fHankukaChck = False   'ñﬂÇËílÇÉGÉâÅ[Ç∆Ç∑ÇÈ
    'HAN_KUKA.KUKÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
    'Close #iFileNumber                        'V1.4.0.1 DEL
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sWriteListbox
'//  ã@î\ñºèÃ  : ÉoÅ[ÉWÉáÉìÉeÉLÉXÉgÉtÉ@ÉCÉãèëçûÇ›ÅB
'//  ã@î\äTóv  : ÉäÉXÉgÉ{ÉbÉNÉXÇÃì‡óeÇÅAÉoÅ[ÉWÉáÉìÉeÉLÉXÉgÉtÉ@ÉCÉãÇ…èëÇ´çûÇﬁÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sWriteListbox()
    Dim iFileNumber As Integer
    Dim i As Integer

    On Error Resume Next
    
    iFileNumber = FreeFile              'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ

    Open MN_VERSI_FILE For Output Access Write As #iFileNumber
                                        'ÉtÉ@ÉCÉãñºÇçÏê¨ÇµÇ‹Ç∑ÅB

    For i = 0 To lstKan.ListCount - 1

        Print #iFileNumber, lstKan.List(i) & Chr(vbKeyReturn)
                                        'ÉfÅ[É^ÇèëÇ´çûÇﬁ
    Next

    Close #iFileNumber                  'ÉtÉ@ÉCÉãÇï¬Ç∂Ç‹Ç∑ÅB
End Sub

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sFDInstall
'//  ã@î\ñºèÃ  : î}ëÃÉCÉìÉXÉgÅ[Éãèàóù
'//  ã@î\äTóv  : ÉCÉìÉXÉgÅ[Éãî}ëÃÉtÉ@ÉCÉãÇÅAÉèÅ[ÉNÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.6.0.1) 2009-06-16   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQïsãÔçáèCê≥
'//                 ÉtÉFÅ[ÉYÇRëŒâû
'//     REVISIONS :(1.12.0.1) 2009-11-11   REVISED BY [TCC] C.Terui
'//                 ì¸óÕÉtÉ@ÉCÉãäiî[ÉfÉBÉåÉNÉgÉäà íuïœçX
'//     REVISIONS :(1.20.0.1) 2010-03-10  REVISED BY [TCC] S.Yoshimori
'//                 ÉtÉHÉãÉ_ëIëâÊñ ÇOSédólÇ…ïœçX
'//                 ÉtÉ@ÉCÉãëIëâÊñ ÇOSédólÇ…ïœçX
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub sFDInstall(sFlag As String)
    Dim MyName As String            'ÉtÉ@ÉCÉãÉtÉãÉpÉXñº
    Dim sSrcFileName As String      'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãñº
    Dim sDstFileName As String      'ÉRÉsÅ[êÊÉtÉ@ÉCÉãñº
    Dim iResponse As Integer        'MsgBoxÉ{É^ÉìÉRÅ[Éh
    Dim sInputPass As String        'ÉCÉìÉXÉgÅ[Éãå≥ÉfÉBÉåÉNÉgÉäñº(STD)orÉtÉ@ÉCÉãñº(LZH)
    Dim sInputFolder As String      'ÉCÉìÉXÉgÅ[Éãå≥ÉtÉHÉãÉ_ñºÅBLZHÇÃéûÅAâìÄêÊÉtÉHÉãÉ_ÅB
    Dim lngErrCode As Long          'ÉGÉâÅ[ÉRÅ[Éh
    'V1.6.0.1 ADD START
    Dim bRet As Boolean             'ê≥ìñê´É`ÉFÉbÉNñﬂÇËíl
    Dim sChkName As String          'É`ÉFÉbÉNÉtÉ@ÉCÉã
    'V1.6.0.1 ADD END
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                    'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    If sFlag = "STD" Then
    'ïWèÄÅiîÒà≥èkÅjÉtÉ@ÉCÉãéwíËÇÃéû:
    'ÉfÉBÉåÉNÉgÉäëIëâÊñ Çï\é¶Ç≥ÇπÅAì¸óÕÉtÉ@ÉCÉãäiî[ÉfÉBÉåÉNÉgÉäñºÇìæÇÈÅB
'       sInputPass = pfDirSelection("a:", "ÉCÉìÉXÉgÅ[Éãî}ëÃÇÃÉfÉBÉåÉNÉgÉäëIë")     'V1.12.0.1 DEL
        'sInputPass = pfDirSelection("H:", "ÉCÉìÉXÉgÅ[Éãî}ëÃÇÃÉfÉBÉåÉNÉgÉäëIë")      'V1.12.0.1 ADD    'V1.20.0.1 DEL
        sInputPass = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)    'V1.20.0.1 ADD
        If sInputPass = "" Then
        'ÉfÉBÉåÉNÉgÉäÇ™éwíËÇ»ÇµéûÇÕèàóùèIóπ
            'V1.20.0.1 ADD START
            Set objFso = Nothing
            Set objFi = Nothing
            'V1.20.0.1 ADD END
            Exit Sub
        End If
        sInputFolder = sInputPass
    Else
    'à≥èkÉtÉ@ÉCÉãéwíËÇÃéû:
    'à≥èkÉtÉ@ÉCÉãëIëâÊñ Çï\é¶Ç≥ÇπÅALZHÉtÉ@ÉCÉãÉtÉãÉpÉXñºÇìæÇÈÅiÉfÉtÉHÉãÉgÇÕÇeÇcÇï\é¶ÅBÅjÅB
'       sInputPass = pfCabFileSelection("a:")     'V1.12.0.1 DEL
        'V1.20.0.1 DEL START
       'sInputPass = pfCabFileSelection("H:")      'V1.12.0.1 ADD
        'If sInputPass = "" Then Exit Sub 'ÉtÉ@ÉCÉãÇ™ëIëÇ≥ÇÍÇ»ÇØÇÍÇŒñﬂÇÈÅB
        'V1.20.0.1 DEL END
        'V1.20.0.1 ADD START
        'éÊìæÉtÉ@ÉCÉãñºÇèâä˙âª
        CommonDialog1.FileName = ""
        'èâä˙ÉfÉBÉåÉNÉgÉäÇê›íË
        If objFso.FolderExists(SHOWFILE_DEFAULTFOLDER1) = True Then    'ÉtÉHÉãÉ_ëIëâÊñ ÉfÉtÉHÉãÉgÉpÉXÇPÇ™ë∂ç›Ç∑ÇÈÇ©
            'ë∂ç›Ç∑ÇÈÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇPÅiH:ÅjÇê›íË
            CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER1
        Else
            'ë∂ç›ÇµÇ»Ç¢ÇΩÇﬂÅAÉfÉtÉHÉãÉgÉpÉXÇQÅiC:ÅjÇê›íË
            CommonDialog1.InitDir = SHOWFILE_DEFAULTFOLDER2
        End If
        'ägí£éqÇê›íË
        CommonDialog1.Filter = "à≥èkÉtÉ@ÉCÉãÅi*.cabÅj|*.cab|"
        'ÉtÉ@ÉCÉãëIëâÊñ ÇäJÇ≠
        CommonDialog1.ShowOpen
        'ëIëÇµÇΩÉtÉ@ÉCÉãñºÇéÊìæ
        sInputPass = CommonDialog1.FileName
        If sInputPass = "" Then 'ÉtÉ@ÉCÉãñ¢ëIë
            Set objFso = Nothing
            Set objFi = Nothing
            Exit Sub    'ÉtÉ@ÉCÉãÇ™ëIëÇ≥ÇÍÇ»ÇØÇÍÇŒèàóùíÜíf
        End If
        
        Call ChDrive("D")  'V2.5.0.1 ADD
        
        'V1.20.0.1 ADD END
       'âìÄópàÍéûÉtÉHÉãÉ_ÇçÏê¨Ç∑ÇÈÅB
       psMakeFolder MELTED_FOLDER_FULLPASS
       'à≥èkÉtÉ@ÉCÉãÇÅAâìÄópàÍéûÉtÉHÉãÉ_Ç…âìÄÅEäiî[Ç≥ÇπÇÈÅB
        Call psCabReqest(CABREQEST.CAB_THAW, sInputPass, MELTED_FOLDER_FULLPASS)
        If glngCabErrCd <> 0 Then
            psDeleteFolder MELTED_FOLDER_FULLPASS
            'V1.20.0.1 ADD START
            Set objFso = Nothing
            Set objFi = Nothing
            'V1.20.0.1 ADD END
            Exit Sub
        End If
        sInputFolder = MELTED_FOLDER_FULLPASS
    End If
    
    'ÅuÉèÅ[ÉNÉRÉsÅ[ämîFÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    iResponse = MsgBox(sInputPass & " ÇÃëSÇƒÇÃÉtÉ@ÉCÉãÇÅA" _
                       & Chr(vbKeyReturn) & Chr(vbKeyReturn) _
                       & TitleBox(FolderSyubetu) & "ÇÃÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[ÇµÇ‹Ç∑ÅB " _
                       & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH", _
                       vbYesNo + vbExclamation, _
                       TitleBox(FolderSyubetu) & "  î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ[")
    If iResponse = vbNo Then
    '[Ç¢Ç¢Ç¶] É{É^ÉìÇëIë:âΩÇ‡ÇµÇ»Ç¢ÅB
    'íAÇµÅAà≥èkÉtÉ@ÉCÉãéwíËÇÃéûÇÕÅAâìÄópàÍéûÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈÅB
       If sFlag = "LZH" Then
           psDeleteFolder MELTED_FOLDER_FULLPASS
       End If
        'V1.20.0.1 ADD START
        Set objFso = Nothing
        Set objFi = Nothing
        'V1.20.0.1 ADD END
        Exit Sub
    End If
    
    'V1.6.0.1 ADD START
    'äOïîì¸óÕÉvÉçîªê≥ìñê´É`ÉFÉbÉN
    If sFlag = "STD" Then
       'î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ[éû
       bRet = pfInstallSeitouseiChck(sInputPass)
    Else
       'à≥èkÉtÉ@ÉCÉãÅ®ÉèÅ[ÉN ÉRÉsÅ[éû
       bRet = pfInstallSeitouseiChck(MELTED_FOLDER_FULLPASS & "\")
    End If
    If bRet = False Then
       'V1.20.0.1 ADD START
       Set objFso = Nothing
       Set objFi = Nothing
       'V1.20.0.1 ADD END
       Exit Sub
    End If
    
    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNÉtÉ@ÉCÉãóLñ≥É`ÉFÉbÉNÇçsÇ§ÅB
    sChkName = fSelectFile
    'V1.20.0.1 DEL START
'    sChkName = Dir(FolderName(0, FolderSyubetu) & "\" & sChkName)
'    If sChkName <> "" Then
'      Kill FolderName(0, FolderSyubetu) & "\" & sChkName
'    End If
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    If objFso.FileExists(FolderName(0, FolderSyubetu) & "\" & sChkName) = True Then
        'éwíËÉtÉ@ÉCÉãÇ™ë∂ç›Ç∑ÇÈ
        sChkName = objFso.GetFileName(FolderName(0, FolderSyubetu) & "\" & sChkName)
        Kill FolderName(0, FolderSyubetu) & "\" & sChkName
    Else
        sChkName = ""
    End If
    'V1.20.0.1 ADD END
    'V1.6.0.1 ADD START
    
    'éwíËÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAëSÇƒÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
    'V1.20.0.1 DEL START
'    MyName = Dir(sInputFolder & "\*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            'î}ëÃì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'            sSrcFileName = sInputFolder & "\" & MyName
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(sSrcFileName) And vbDirectory) <> vbDirectory Then
'                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sDstFileName = FolderName(0, FolderSyubetu) & "\" & MyName
'                'î}ëÃì‡ÇÃÉtÉ@ÉCÉãÇÉèÅ[ÉNÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
'                FileCopy sSrcFileName, sDstFileName
'            End If
'        End If
'        MyName = Dir                    ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(sInputFolder).files   'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then  'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            'î}ëÃì‡ÉtÉ@ÉCÉãñºÇçÏê¨
            sSrcFileName = sInputFolder & "\" & MyName
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(sSrcFileName) And vbDirectory) <> vbDirectory Then
                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
                sDstFileName = FolderName(0, FolderSyubetu) & "\" & MyName
                'î}ëÃì‡ÇÃÉtÉ@ÉCÉãÇÉèÅ[ÉNÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
                FileCopy sSrcFileName, sDstFileName
            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
    'à≥èkÉtÉ@ÉCÉãéwíËÇÃéûÇÕÅAâìÄópàÍéûÉtÉHÉãÉ_ÇçÌèúÇ∑ÇÈÅB(égópçœÇ›ÇÃÇΩÇﬂ)
    If sFlag = "LZH" Then
        psDeleteFolder MELTED_FOLDER_FULLPASS
    End If
    
    'ÅuÉèÅ[ÉNÉRÉsÅ[ê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇÃëSÇƒÇÃÉtÉ@ÉCÉãÇÅA" _
            & Chr(vbKeyReturn) & TitleBox(FolderSyubetu) & "ÇÃÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç…" _
            & Chr(vbKeyReturn) & "ÉRÉsÅ[ÇµÇ‹ÇµÇΩÅB", _
            vbOKOnly + vbExclamation, _
            TitleBox(FolderSyubetu) & "  î}ëÃÅ®ÉèÅ[ÉN ÉRÉsÅ["
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃÅ®‹∞∏∫Àﬂ∞èàóùê≥èÌÅvÉçÉOèoóÕ
    Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_LZH_COPY_WRK_OK, 0)
    
    'ÉoÅ[ÉWÉáÉìèÓïÒÉäÉXÉgÉ{ÉbÉNÉXÇçÏê¨Ç∑ÇÈ
    fMakeListbox
    Exit Sub    'èàóùÇèIóπÇ∑ÇÈ

ErrorHandler:   ' ÉGÉâÅ[èàóùÅB
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    Select Case Err.Number
        Case 53 ' ÅuéwíËéÌï ÉtÉ@ÉCÉãÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇ… " & TitleBox(FolderSyubetu) & "ÇÕÅA" _
                   & Chr(vbKeyReturn) & "Ç–Ç∆Ç¬Ç‡ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  Å®ÉèÅ[ÉN ÉRÉsÅ["
            Exit Sub
        Case 71 'Åuî}ëÃÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            iResponse = MsgBox("î}ëÃÇ™èÄîıÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
                    vbRetryCancel + vbExclamation, _
                    TitleBox(FolderSyubetu) & "  Å®ÉèÅ[ÉN ÉRÉsÅ[")
            If iResponse = vbRetry Then    'ÅuÇ‚ÇËíºÇµÅvÉ{É^ÉìÇëIëÇµÇΩèÍçá
                Resume      ' ÉGÉâÅ[Ç™î≠ê∂ÇµÇΩçsÇ©ÇÁèàóùçƒäJ
            Else                            'ÅuÉLÉÉÉìÉZÉãÅvÉ{É^ÉìÇëIëÇµÇΩèÍçá
                Exit Sub    'èàóùÇèIóπÇ∑ÇÈ
            End If
        Case Else  'ÅuÉèÅ[ÉNÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
           MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇ©ÇÁÇÃÉRÉsÅ[ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB" _
                   & Chr(vbKeyReturn) & "ÉGÉâÅ[ÉRÅ[ÉhÅÅ" _
                   & str$(Err.Number), _
                   vbOKOnly + vbExclamation, _
                   "Å®ÉèÅ[ÉN ÉRÉsÅ["
    End Select
    
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃÅ®‹∞∏∫Àﬂ∞èàóùàŸèÌÅvÉçÉOèoóÕ
   lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
   Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_LZH_COPY_WRK_ERROR, lngErrCode)
End Sub

'V1.6.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfInstallSeitouseiChck
'//  ã@î\ñºèÃ  : äOïîì¸óÕÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóù
'//  ã@î\äTóv  : äOïîì¸óÕÉvÉçÉOÉâÉÄîªíËÉfÅ[É^ê≥ìñê´É`ÉFÉbÉNèàóùÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL :(1.6.0.1) 2009-06-16   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇQëŒâûïsãÔçáèCê≥
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(2.6.0.1) 2010-11-16  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãñºÉ`ÉFÉbÉNïsãÔçáèCê≥
'//     REVISIONS :(X.X.X.X)----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function pfInstallSeitouseiChck(sInputPass As String) As Boolean
    Dim lngFileListCnt As Long               'ÉtÉ@ÉCÉãÉäÉXÉgêî
    Dim strWork     As String                'çÏã∆ÉGÉäÉA
    Dim iFileNumber As Integer               'ñ¢égópÉtÉ@ÉCÉãî‘çÜ
    Dim myLen As Long                        'ï∂éöóÒÇÃí∑Ç≥
    Dim SysCodeTxt As String                 'ÉoÉCÉgïœä∑å„(ëSäpÅ®îºäp)
    Dim lngSumRet As Long
    Dim i As Integer
    Dim sGetFileListName As String           'ÉtÉ@ÉCÉãÉäÉXÉgì‡ãLç⁄ÉtÉ@ÉCÉãñº
    Dim bRet As Boolean
    Dim lngCnt As Long
    Dim iRet   As Integer                    'ÉoÅ[ÉWÉáÉìÉ`ÉFÉbÉNDLLñﬂÇËíl
    Dim iGouki As Integer                    'çÜã@î‘çÜ
    Dim sVersionInfoPath As String           'ÉoÅ[ÉWÉáÉìèÓïÒÉtÉ@ÉCÉã(çÜã@ï )
    Dim sSrcFileName As String               'ÉtÉ@ÉCÉãÉäÉXÉgñº
    Dim lngErrCode   As Long
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD
    
    On Error Resume Next
    
    pfInstallSeitouseiChck = True
    
    '********************************
    '*ÉvÉçîªê≥ìñê´É`ÉFÉbÉN
    '********************************
    'äOïîî}ëÃÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨
    sSrcFileName = sInputPass & MN_FILELIST
    'äOïîî}ëÃÇÃåüçıÇÇ∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'V1.20.0.1 DEL
    'V1.20.0.1 ADD START
    If objFso.FileExists(sSrcFileName) = True Then
        Set objFso = Nothing
    'V1.20.0.1 ADD END
    Else
      'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
      MsgBox "î}ëÃì‡Ç…ÅAÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
             vbOKOnly + vbExclamation, _
             "Å®ÉèÅ[ÉN ÉRÉsÅ["
     'Åué©â¸ ﬁ∞ºﬁÆ›ÅFÉtÉ@ÉCÉãÉäÉXÉgñ≥ÇµÅvÉçÉOèoóÕ
      lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOTFOUND_FILELIST, lngErrCode)

      pfInstallSeitouseiChck = False
      Set objFso = Nothing    'V1.20.0.1 ADD
      Exit Function
    End If

   '¢ÉèÅ[ÉN£ÉtÉHÉãÉ_Ç©ÇÁÉtÉ@ÉCÉãÉäÉXÉgÇéÊìæÇ∑ÇÈ
    bRet = fReadFileList(sInputPass & MN_FILELIST)

    'ÉTÉÄílÉ`ÉFÉbÉN
    For lngCnt = 0 To UBound(FileList) - 1
        If pfFileSumChk(sInputPass & FileList(lngCnt), lngSumRet) <> True Then
            'ÉTÉÄílàŸèÌ
            If lngSumRet = SUM_CHK.SumErr Then
               MsgBox "ÉTÉÄílÇ™àŸèÌÇ≈Ç∑ÅB" _
                      & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
                      vbOKOnly + vbExclamation, _
                      sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
            'ÉTÉÄílàŸèÌà»äOàŸèÌ
            ElseIf lngSumRet = SUM_CHK.SumErr_Else Then
                   'ÅuÉèÅ[ÉNÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
               MsgBox "ÉCÉìÉXÉgÅ[Éãî}ëÃÇ©ÇÁÇÃÉRÉsÅ[ÉGÉâÅ[Ç™î≠ê∂ÇµÇ‹ÇµÇΩÅB" _
                     & Chr(vbKeyReturn) & "ÉGÉâÅ[ÉRÅ[ÉhÅÅ" _
                     & str$(Err.Number), _
                     vbOKOnly + vbExclamation, _
                    "Å®ÉèÅ[ÉN ÉRÉsÅ["
            End If
            pfInstallSeitouseiChck = False
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_SUMCHK_ERROR, 0)
            Exit Function
        End If
    Next

    'ÉtÉ@ÉCÉãêîç≈ëÂÉ`ÉFÉbÉN
    If UBound(FileList) > FILECNT_MAX Then
       MsgBox "ÉtÉ@ÉCÉãêîÇ™è„å¿Çí¥Ç¶ÇƒÇ¢Ç‹Ç∑ÅB" _
              & Chr(vbKeyReturn) & "ÉfÅ[É^ÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
              vbOKOnly + vbExclamation, _
              sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
      pfInstallSeitouseiChck = False

      Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_MAXFILECHK_ERROR, 0)

      Exit Function
    End If
'V2.6.0.1 DEL START
'    'ÉtÉ@ÉCÉãñºÉTÉCÉYÉ`ÉFÉbÉN
'    lngFileListCnt = UBound(FileList)
'
'    On Error GoTo FileGetError
'
'    iFileNumber = FreeFile          'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'
'    bRet = True
'
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉIÅ[ÉvÉìÅB
'    Open sInputPass & MN_FILELIST For Input As #iFileNumber
'    For i = 0 To lngFileListCnt
'       If i = lngFileListCnt Then
'          Exit For
'       End If
'       'ÉtÉ@ÉCÉãñºÇéÊìæÇ∑ÇÈÅB
'       Input #iFileNumber, strWork
'       'ÉtÉ@ÉCÉãñºíËã`Ç»Çµ
'       If strWork = "" Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'          bRet = False
'          Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'          Exit For
'       'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'       ElseIf " " <> Mid(strWork, 2, 1) And Left$(strWork, 1) <> "/" Then
'          'ÉãÅ[Évî≤ÇØ
'          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       'ÉtÉHÅ[É}ÉbÉgàŸèÌ
'       ElseIf (InStr(strWork, ".") - 1) = -1 And Left$(strWork, 1) <> "/" Then
'           MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                  & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                  vbOKOnly + vbExclamation, _
'                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'           bRet = False
'           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'           Exit For
'       'Åu/*--ÅvìôÇÃÉRÉÅÉìÉgïîÇÕèúÇ≠
'       ElseIf Left$(strWork, 1) = "/" Then
'               'âΩÇ‡ÇµÇ»Ç¢ÅB
'       Else
'          'ÉtÉ@ÉCÉãñºÇÃÇ›Çíäèo
'          sGetFileListName = Mid(strWork, 3, 16)
'          'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
'          myLen = LenB(StrConv(Trim(sGetFileListName), vbFromUnicode))                                              'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
'          If FILE_NAME_MAX_SIZE < myLen Then
'            '13ÉoÉCÉgà»è„ÇÃèÍçá
'            MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
'                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
'                   vbOKOnly + vbExclamation, _
'                   sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'            bRet = False
'            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
'            Exit For
'           End If
'        End If
'     Next
'    'ÉtÉ@ÉCÉãÉäÉXÉgÇÉNÉçÅ[ÉYÅB
'    Close #iFileNumber
'V2.6.0.1 DEL END
'V2.6.0.1 ADD START
    For i = 0 To UBound(FileList) - 1
       'éÊìæÉtÉ@ÉCÉãñºÇÃÉTÉCÉYÇéÊìæ
       myLen = LenB(StrConv(Trim(FileList(i)), vbFromUnicode))                                              'îºäpä∑éZÇÃÉoÉCÉgêîÇéÊìæ
       If FILE_NAME_MAX_SIZE < myLen Then
          '13ÉoÉCÉgà»è„ÇÃèÍçá
          MsgBox "ÉtÉ@ÉCÉãñºÇ™àŸèÌÇ≈Ç∑ÅB" _
                 & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", _
                  vbOKOnly + vbExclamation, _
                  sJverName & "é©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
           bRet = False
           Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_FILENAMESIZECHK_ERROR, 0)
           Exit For
       End If
    Next
'V2.6.0.1 ADD END

    pfInstallSeitouseiChck = bRet
Exit Function

FileGetError:
    If iFileNumber > 0 Then
       Close #iFileNumber
    End If
    iFileNumber = 0
    pfInstallSeitouseiChck = False
End Function
'V1.6.0.1 ADD END

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sCopyWRKtoNOW
'//  ã@î\ñºèÃ  : ç≈êVÉoÅ[ÉWÉáÉìÉRÉsÅ[
'//  ã@î\äTóv  : ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sCopyWRKtoNOW() As Boolean
    
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim sSrcFileName As String      'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãñº
    Dim sDstFileName As String      'ÉRÉsÅ[êÊÉtÉ@ÉCÉãñº
    Dim bError As Boolean           'ÉtÉâÉO
    Dim bRet As Boolean             'ñﬂÇËíl
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD

    On Error GoTo ErrorHandler      'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^
  
    'ñﬂÇËílèâä˙âª
    sCopyWRKtoNOW = True
    
    '****************************
    '* ÉtÉ@ÉCÉãÉäÉXÉgÇÉRÉsÅ[Ç∑ÇÈ *
    '****************************
    sSrcFileName = FolderName(0, FolderSyubetu) & "\" & MN_FILELIST
                                    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    sDstFileName = FolderName(1, FolderSyubetu) & "\" & MN_FILELIST
                                    'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 DEL
    If objFso.FileExists(sSrcFileName) = True Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
        'ÉtÉ@ÉCÉãÉäÉXÉgÇÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        FileCopy sSrcFileName, sDstFileName
    Else                                'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
     'ÅuÉèÅ[ÉNÉtÉHÉãÉ_ÉtÉ@ÉCÉãÉäÉXÉgÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
             & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
             vbOKOnly + vbExclamation, _
             TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
     sCopyWRKtoNOW = False
     Set objFso = Nothing    'V1.20.0.1 ADD
     Exit Function                   'èàóùÇèIóπÇ∑ÇÈ
    End If

    bError = False                  'ÉGÉâÅ[ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To UBound(FileList) - 1
                                    'ÉtÉ@ÉCÉãÉäÉXÉgàÍóóêîï™åJÇËï‘Ç∑
        sSrcFileName = FolderName(0, FolderSyubetu) & "\" & FileList(i)
                                    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
        sDstFileName = FolderName(1, FolderSyubetu) & "\" & FileList(i)
                                    'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ

        'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 DEL
        If objFso.FileExists(sSrcFileName) = True Then   'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
            'ÉtÉ@ÉCÉãÇÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
            FileCopy sSrcFileName, sDstFileName
        End If
    Next
    
    Set objFso = Nothing    'V1.20.0.1 ADD
    Exit Function                           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    Select Case Err.Number
        Case 53 'ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
            
            sCopyWRKtoNOW = False
            Set objFso = Nothing    'V1.20.0.1 ADD
            Exit Function
        Case Else
                ' ëºÇÃÉGÉâÅ[èàóùÇÇ±Ç±Ç…ãLèqÇµÇ‹Ç∑ÅB
    End Select
    sCopyWRKtoNOW = False
    Set objFso = Nothing    'V1.20.0.1 ADD
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sCopyNOWtoOLD
'//  ã@î\ñºèÃ  : é¿çsÉoÅ[ÉWÉáÉìï€ë∂èàóù
'//  ã@î\äTóv  : é¿çsÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAãåÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sCopyNOWtoOLD() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim sSrcFileName As String          'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãÇÃÉtÉãÉpÉXñº
    Dim sDstFileName As String          'ÉRÉsÅ[êÊÉtÉ@ÉCÉãÇÃÉtÉãÉpÉXñº
    Dim iResponse As Integer            'MsgBoxÉ{É^ÉìÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    On Error GoTo ErrorHandler              'ÉGÉâÅ[ÉnÉìÉhÉãê›íË
  
    'ñﬂÇËílèâä˙âª
    sCopyNOWtoOLD = True
   
    'é¿çsÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
    gstrMyPath = FolderName(1, FolderSyubetu) & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'
'                'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sSrcFileName = gstrMyPath & MyName
'
'                'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
'                sDstFileName = FolderName(2, FolderSyubetu) & "\" & MyName
'
'                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
'                FileCopy sSrcFileName, sDstFileName
'
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑°
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then

                'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
                sSrcFileName = gstrMyPath & MyName

                'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
                sDstFileName = FolderName(2, FolderSyubetu) & "\" & MyName

                'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
                FileCopy sSrcFileName, sDstFileName

            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
           ' ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
            MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
    
    sCopyNOWtoOLD = False
    
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sCopyOLDtoNOW
'//  ã@î\ñºèÃ  : ãåÉoÅ[ÉWÉáÉìÇ…ñﬂÇ∑èàóù
'//  ã@î\äTóv  : ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇÅAé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sCopyOLDtoNOW() As Boolean
    Dim i As Integer                'ÉJÉEÉìÉ^
    Dim sSrcFileName As String      'ÉRÉsÅ[å≥ÉtÉ@ÉCÉãñº
    Dim sDstFileName As String      'ÉRÉsÅ[êÊÉtÉ@ÉCÉãñº
    Dim bError As Boolean           'ÉGÉâÅ[ÉtÉâÉO
    
    Dim objFso As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg 'V1.20.0.1 ADD

    On Error GoTo ErrorHandler
    
    'èâä˙ílê›íË
    sCopyOLDtoNOW = True

    '****************************
    '* ÉtÉ@ÉCÉãÉäÉXÉgÇÉRÉsÅ[Ç∑ÇÈ *
    '****************************
    sSrcFileName = FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & MN_FILELIST
                                    'ÅuãåÅvÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    sDstFileName = FolderName(MN_FOLD_NOW, FolderSyubetu) & "\" & MN_FILELIST
                                    'Åué¿çsÅvÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
    'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ  'V1.20.0.1 DEL
    If objFso.FileExists(sSrcFileName) = True Then 'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
        'ÉtÉ@ÉCÉãÉäÉXÉgÇÅuãåÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        FileCopy sSrcFileName, sDstFileName
    Else
       'ÅuãåÉtÉHÉãÉ_ÉtÉ@ÉCÉãÉäÉXÉgÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        sCopyOLDtoNOW = False
        Set objFso = Nothing    'V1.20.0.1 ADD
        Exit Function                   'èàóùÇèIóπÇ∑ÇÈ
    End If

    bError = False                  'ÉGÉâÅ[ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
    For i = 0 To UBound(FileList) - 1
                                    'ÉtÉ@ÉCÉãÉäÉXÉgêîï™åJÇËï‘Ç∑
        'ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
        sSrcFileName = FolderName(MN_FOLD_OLD, FolderSyubetu) & "\" & FileList(i)

        'é¿çsÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãñºÇçÏê¨Ç∑ÇÈ
        sDstFileName = FolderName(MN_FOLD_NOW, FolderSyubetu) & "\" & FileList(i)

        'ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇé¿çsÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
        'If Dir(sSrcFileName) <> "" Then     'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ  'V1.20.0.1 DEL
        If objFso.FileExists(sSrcFileName) = True Then 'ÉtÉ@ÉCÉãÇÃåüçıÇÇ∑ÇÈ   'V1.20.0.1 ADD
            'ÉtÉ@ÉCÉãÇÅuãåÅvÉtÉHÉãÉ_Ç©ÇÁÅué¿çsÅvÉtÉHÉãÉ_Ç…ÉRÉsÅ[Ç∑ÇÈ
            FileCopy sSrcFileName, sDstFileName
        Else                                'ÉtÉ@ÉCÉãÇ™ë∂ç›ÇµÇ»Ç¢
            bError = True                   'ÉGÉâÅ[ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
        End If
    Next
    If bError = True Then
        'ÅuãåÉtÉHÉãÉ_ÉtÉ@ÉCÉãÉäÉXÉgìoò^Ç»ÇµÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
        MsgBox "ÅuãåÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "Ç…ÅA" _
                   & Chr(vbKeyReturn) & "ÉtÉ@ÉCÉãÉäÉXÉgÇ…ìoò^Ç≥ÇÍÇƒÇ¢ÇƒÅAë∂ç›ÇµÇ»Ç¢ÉtÉ@ÉCÉãÇ™Ç†ÇËÇ‹ÇµÇΩÅB", _
                   vbOKOnly + vbExclamation, _
                   TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        sCopyOLDtoNOW = False
        Set objFso = Nothing    'V1.20.0.1 ADD
        Exit Function
    End If

    Set objFso = Nothing    'V1.20.0.1 ADD
    Exit Function       'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'ÅuãåÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["
        
    sCopyOLDtoNOW = False
    Set objFso = Nothing    'V1.20.0.1 ADD
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sOldFolderRemove
'//  ã@î\ñºèÃ  : ãåÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãçÌèúèàóù
'//  ã@î\äTóv  : ãåÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sOldFolderRemove() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    On Error GoTo ErrorHandler          'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^
   
   'ñﬂÇËílèâä˙âª
    sOldFolderRemove = True
 
    'Åué¿çsÅvÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
    gstrMyPath = FolderName(2, FolderSyubetu) & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
'                Kill gstrMyPath & MyName
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
                Kill gstrMyPath & MyName
            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'ÅuÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ÉèÅ[ÉNÅ®é¿çs ÉRÉsÅ["
    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFãåÉtÉHÉãÉ_Ãß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_OLDFILE_DELETE_ERROR, lngErrCode)

    sOldFolderRemove = False
    
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sNowFolderRemove
'//  ã@î\ñºèÃ  : é¿çsÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãçÌèúèàóù
'//  ã@î\äTóv  : é¿çsÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sNowFolderRemove() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END

    On Error GoTo ErrorHandler          'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    'èâä˙ílê›íË
    sNowFolderRemove = True
    
    'Åué¿çsÅvÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
    gstrMyPath = FolderName(1, FolderSyubetu) & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'
'                Kill gstrMyPath & MyName        'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
'
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then

                Kill gstrMyPath & MyName        'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ

            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END

    Exit Function           'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'ÅuãåÅ®é¿çsÉRÉsÅ[àŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbExclamation, _
           TitleBox(FolderSyubetu) & "  ãåÅ®é¿çs ÉRÉsÅ["

    'Åué©â¸ ﬁ∞ºﬁÆ›ÅFé¿çsÉtÉHÉãÉ_Ãß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_NOWFILE_DELETE_ERROR, lngErrCode)

    sNowFolderRemove = False
    
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
    
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sWrkFolderRemove
'//  ã@î\ñºèÃ  : ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÉtÉ@ÉCÉãçÌèúèàóù
'//  ã@î\äTóv  : ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.20.0.1) 2010-03-12  REVISED BY [TCC] S.Yoshimori
'//                 Dirä÷êîÇFileSystemObjectÇ…íuÇ´ä∑Ç¶
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sWrkFolderRemove() As Boolean
    Dim MyName As String                'ÉtÉ@ÉCÉãñº
    Dim lngErrCode As Long              'ÉGÉâÅ[ÉRÅ[Éh
    
    'V1.20.0.1 ADD START
    Dim objFso As New FileSystemObject     'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
    Dim objFi As File                     'ÉtÉ@ÉCÉãÉIÉuÉWÉFÉNÉg
    'V1.20.0.1 ADD END
    
    On Error GoTo ErrorHandler          'ÉGÉâÅ[ÉnÉìÉhÉãÇÃìoò^

    'èâä˙ílê›íË
    sWrkFolderRemove = True
   
    'ÉèÅ[ÉNÉtÉHÉãÉ_ì‡ÇÃÉfÉBÉåÉNÉgÉäÇÃñºëOÇï\é¶ÇµÇ‹Ç∑ÅB
    gstrMyPath = FolderName(0, FolderSyubetu) & "\"
    'V1.20.0.1 DEL START
'    MyName = Dir(gstrMyPath & "*.*", vbNormal)  ' ç≈èâÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Do While MyName <> ""                   ' ÉãÅ[ÉvÇäJénÇµÇ‹Ç∑ÅB
'        ' åªç›ÇÃÉfÉBÉåÉNÉgÉäÇ∆êeÉfÉBÉåÉNÉgÉäÇÕñ≥éãÇµÇ‹Ç∑ÅB
'        If MyName <> "." And MyName <> ".." Then
'            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
'            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
'                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
'                Kill gstrMyPath & MyName
'            End If
'        End If
'        MyName = Dir        ' éüÇÃÉfÉBÉåÉNÉgÉäñºÇï‘ÇµÇ‹Ç∑ÅB
'    Loop
    'V1.20.0.1 DEL END
    'V1.20.0.1 ADD START
    For Each objFi In objFso.GetFolder(gstrMyPath).files  'ÉãÅ[ÉvÇäJén
        If objFso.FileExists(objFi.Path) = True Then      'ÉtÉ@ÉCÉãñºÇÃéÊìæÉ`ÉFÉbÉN
            'ÉfÉBÉåÉNÉgÉäñºÇéÊìæ
            MyName = objFi.Name
            ' ÉrÉbÉgíPà ÇÃî‰ärÇçsÇ¢ÅAMyName Ç™ÉfÉBÉåÉNÉgÉäÇ©Ç«Ç§Ç©Çí≤Ç◊Ç‹Ç∑ÅB
            If (GetAttr(gstrMyPath & MyName) And vbDirectory) <> vbDirectory Then
                'ÉtÉ@ÉCÉãÇçÌèúÇ∑ÇÈ
                Kill gstrMyPath & MyName
            End If
        End If
    Next
    
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END

    'ÅuÉèÅ[ÉNÉNÉäÉAê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
    MsgBox "ÅuÉèÅ[ÉNÅvÉtÉHÉãÉ_ì‡ÇÃ " & TitleBox(FolderSyubetu) & "ÇÅA" _
               & Chr(vbKeyReturn) & "ëSÇƒçÌèúÇµÇ‹ÇµÇΩÅB", _
               vbOKOnly + vbExclamation, _
               TitleBox(FolderSyubetu) & "  ÉèÅ[ÉN ÉNÉäÉA"

    Exit Function 'èàóùÇèIóπÇ∑ÇÈ

'*********************
'* ÉGÉâÅ[ÉnÉìÉhÉãèàóù *
'*********************
ErrorHandler:   ' ÉGÉâÅ[èàóùÉãÅ[É`ÉìÅB
    'ÅuÉèÅ[ÉNÉNÉäÉAàŸèÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
     MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", _
           vbOKOnly + vbCritical, _
           "ÉèÅ[ÉN ÉNÉäÉA"
           
   'Åué©â¸ ﬁ∞ºﬁÆ›ÅF‹∞∏Ã´Ÿ¿ﬁÃß≤ŸçÌèúàŸèÌÅvÉçÉOèoóÕ
    lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
    Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_WRKFILE_DELETE_ERROR, lngErrCode)
           
    sWrkFolderRemove = False
    'V1.20.0.1 ADD START
    Set objFso = Nothing
    Set objFi = Nothing
    'V1.20.0.1 ADD END
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : fMakeOutPutFile
'//  ã@î\ñºèÃ  : î}ëÃèoóÕèàóùÇçsÇ§ÅB
'//  ã@î\äTóv  : î}ëÃèoóÕÉtÉ@ÉCÉãçÏê¨Ç∆èoóÕÇçsÇ§ÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.8.0.1) 2009-08-27   REVISED BY [TCC] S.Terao
'//                 ÉtÉFÅ[ÉYÇRÅ@åãçáåüç∏Å@ïsãÔçáèCê≥
'//     REVISIONS :(1.12.0.1) 2009-11-10   REVISED BY [TCC] C.Terui
'//                 ÉtÉHÉãÉ_ëIëÉ|ÉbÉvÉAÉbÉvâÊñ ÇÃèâä˙ÉtÉHÉãÉ_ïœçX
'//     REVISIONS :(1.21.0.1) 2010-04-09  REVISED BY [TCC] S.Terao
'//                 ÉtÉ@ÉCÉãÉNÉçÅ[ÉYèàóùí«â¡
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function fMakeOutPutFile()
'   Dim sOutFileName As String 'î}ëÃèoóÕÉtÉ@ÉCÉãñº[éÌï ï ]
'   Dim iFileNumber As Integer 'ÉtÉ@ÉCÉãî‘çÜ
'   Dim i As Integer           'ÉJÉEÉìÉ^Å[
'   Dim bFlag As Boolean       'ÉtÉâÉO
'   Dim iResponse As Integer   'MsgBoxñﬂÇËíl
'   Dim lngErrCode As Long     'ÉGÉâÅ[ÉRÅ[Éh
'   Dim fso         As New FileSystemObject   'ÉtÉ@ÉCÉãÉVÉXÉeÉÄÉIÉuÉWÉFÉNÉg
'   Dim strWriteDir As String               'èoóÕêÊÉtÉHÉãÉ_
'
'   On Error Resume Next 'V1.21.0.1 ADD
'
'  'ÉtÉHÉãÉ_ëIëïîÇ…éwíËóLñ≥É`ÉFÉbÉN
'  bFlag = False                                 'ÉtÉâÉOÇÅuãUÅvÇ…Ç∑ÇÈ
'  For i = 0 To 2                                'ÉtÉHÉãÉ_êîï™åJÇËï‘Ç∑
'     If chkFolder(i).Value = CHECKBOX_ON Then   'ÅuÅHÅHÅvÉtÉHÉãÉ_Ç™éwíËÇ≥ÇÍÇƒÇ¢ÇÈ
'        bFlag = True                            'ÉtÉâÉOÇÅuê^ÅvÇ…Ç∑ÇÈ
'        Exit For                                'ÉãÅ[ÉvÇî≤ÇØÇÈ
'     End If
'  Next
'
'  If bFlag = False Then                       'ÉtÉHÉãÉ_éwíËñ≥Çµ
'     If gStrCurrentForm = sFormName_EJVer Then
'       'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
'         MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
'                 vbOKOnly + vbExclamation, _
'                 "EG-Ré©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'     Else
'       'Åuï\é¶ÉtÉHÉãÉ_éwíËÇ»ÇµÅvÉ|ÉbÉvÉAÉbÉvï\é¶
'         MsgBox "ï\é¶Ã´Ÿ¿ﬁéwíËÇ™Ç–Ç∆Ç¬Ç‡ëIëÇ≥ÇÍÇƒÇ¢Ç‹ÇπÇÒÅB", _
'                vbOKOnly + vbExclamation, _
'                "NEGé©ìÆâ¸éDã@ ÉoÅ[ÉWÉáÉìä«óù"
'     End If
'         'èàóùÇî≤ÇØÇÈ
'     Exit Function
'   End If
'
'  'ÉtÉHÉãÉ_ëIëÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
''  strWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", "")                         'V1.12.0.1 DEL
'  strWriteDir = ShowFolders(Me.hwnd, "ÉtÉHÉãÉ_ÇéwíËÇµÇƒÇ≠ÇæÇ≥Ç¢", SHOWFOLDER_DEFAULTFOLDER)    'V1.12.0.1 ADD
'
'  'éwíËÉtÉHÉãÉ_Ç»Çµ
'  If Len(strWriteDir) = 0 Then
'       Exit Function
'  End If
'
'  'ÉRÉsÅ[êÊÉtÉHÉãÉ_ÇÃóLñ≥ämîF
'  If fso.FolderExists(strWriteDir) = False Then
'     'ÉRÉsÅ[êÊÉtÉHÉãÉ_çÏê¨
'     fso.CreateFolder (strWriteDir)
'  End If
'
'   'èàóùíÜÉtÉHÅ[ÉÄÇ…ÇÊÇËÅAî}ëÃèoóÕÇ∑ÇÈÉtÉ@ÉCÉãñºçÏê¨
'   If gStrCurrentForm = sFormName_EJVer Then
'       'ÉäÉ\Å[ÉXëIëïîï™äÚ
'       Select Case FolderSyubetu
'        Case 0      'îªíËCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_EJHANTEIPRO
'          'strWriteDir = strWriteDir & VER_TXT_EJHANTEIPRO      'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJHANTEIPRO 'V1.8.0.1 ADD
'        Case 1      'ÉÅÉCÉìCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_EJMAINPRO
'          'strWriteDir = strWriteDir & VER_TXT_EJMAINPRO        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJMAINPRO   'V1.8.0.1 ADD
'        Case 2      'ÉTÉuCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_EJSUBPRO
'          'strWriteDir = strWriteDir & VER_TXT_EJSUBPRO        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJSUBPRO   'V1.8.0.1 ADD
'        Case 3      'ÉÅÉCÉìCPU-OS
'          sOutFileName = PATH_WORK & VER_TXT_EJMAINOS
'          'strWriteDir = strWriteDir & VER_TXT_EJMAINOS        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJMAINOS   'V1.8.0.1 ADD
'        Case 4      'ó\îı1
'          sOutFileName = PATH_WORK & VER_TXT_EJYOBI1
'          'strWriteDir = strWriteDir & VER_TXT_EJYOBI1         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJYOBI1    'V1.8.0.1 ADD
'        Case 5      'ó\îı2
'          sOutFileName = PATH_WORK & VER_TXT_EJYOBI2
'          'strWriteDir = strWriteDir & VER_TXT_EJYOBI2         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_EJYOBI2    'V1.8.0.1 ADD
'        End Select
'  Else
'       'ÉäÉ\Å[ÉXëIëïîï™äÚ
'       Select Case FolderSyubetu
'        Case 0      'îªíËCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_NJHANTEIPRO
'          'strWriteDir = strWriteDir & VER_TXT_NJHANTEIPRO      'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJHANTEIPRO 'V1.8.0.1 ADD
'        Case 1      'ÉÅÉCÉìCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_NJMAINPRO
'          'strWriteDir = strWriteDir & VER_TXT_NJMAINPRO        'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJMAINPRO   'V1.8.0.1 ADD
'        Case 2      'ÉTÉuCPU-Pro
'          sOutFileName = PATH_WORK & VER_TXT_NJSUBPRO
'          'strWriteDir = strWriteDir & VER_TXT_NJSUBPRO         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJSUBPRO    'V1.8.0.1 ADD
'        Case 3      'ÉÅÉCÉìCPU-OS
'          sOutFileName = PATH_WORK & VER_TXT_NJMAINOS
'          'strWriteDir = strWriteDir & VER_TXT_NJMAINOS         'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJMAINOS    'V1.8.0.1 ADD
'        Case 4      'ó\îı1
'          sOutFileName = PATH_WORK & VER_TXT_NJYOBI1
'          'strWriteDir = strWriteDir & VER_TXT_NJYOBI1          'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJYOBI1     'V1.8.0.1 ADD
'        Case 5      'ó\îı2
'          sOutFileName = PATH_WORK & VER_TXT_NJYOBI2
'          'strWriteDir = strWriteDir & VER_TXT_NJYOBI2          'V1.8.0.1 DEL
'          strWriteDir = strWriteDir & "\" & VER_TXT_NJYOBI2     'V1.8.0.1 ADD
'        End Select
'  End If
'
'  iFileNumber = FreeFile              'ñ¢égópÇÃÉtÉ@ÉCÉãî‘çÜÇéÊìæÇ∑ÇÈ
'
'  'ëŒè€ÉtÉ@ÉCÉãÇÉIÅ[ÉvÉìÇ∑ÇÈÅB
'  Open sOutFileName For Output Access Write As #iFileNumber
'
'  For i = 0 To lstKan.ListCount - 1
'  'ÉäÉXÉgÉ{ÉbÉNÉXÇ…ï\é¶Ç≥ÇÍÇƒÇ¢ÇÈï™ÇæÇØÅAèëÇ´çûÇﬁÅB
'       Print #iFileNumber, lstKan.List(i) & Chr(vbKeyReturn)
'  Next
'
'  'ëŒè€ÉtÉ@ÉCÉãÇÉNÉçÅ[ÉYÇ∑ÇÈÅB
'  Close #iFileNumber
'
'  'ÉtÉ@ÉCÉãÇÃóLñ≥ämîF
'  If fso.FileExists(sOutFileName) = False Then
'     'ÉtÉ@ÉCÉãñ≥ÇµàŸèÌÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
'     MsgBox "î}ëÃèoóÕÇ∑ÇÈÉfÅ[É^Ç™Ç†ÇËÇ‹ÇπÇÒÅB", vbExclamation, "ÉfÅ[É^ñ≥åxçê"
'     Exit Function
'  End If
'
'  On Error GoTo COPY_ERROR
'  'ÉtÉ@ÉCÉãÉRÉsÅ[
'  fso.CopyFile sOutFileName, strWriteDir
'  'Åuî}ëÃèoóÕê≥èÌèIóπÅvÉ|ÉbÉvÉAÉbÉvâÊñ ï\é¶
'  'V1.8.0.1 DEL START
'  'iResponse = MsgBox("ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbOKOnly, _
'  '                   "èoóÕåãâ ")
'  'V1.8.0.1 DEL END
'  MsgBox "ê≥èÌèIóπÇµÇ‹ÇµÇΩÅB", vbInformation, "èoóÕåãâ "   'V1.8.0.1 ADD
'
'  'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃèoóÕèàóùê≥èÌÅvÉçÉOèoóÕ
'  Call sLogTraceReq(LTYP_NORMAL, L3AN_FILE, KAISATU_VERSION_KANRI_OUTPUT_OK, 0)
'
'  Set fso = Nothing
'
'  Exit Function
'
''*******************************
''VBÉGÉâÅ[èàóù
'COPY_ERROR:
'        'èàóùàŸèÌÇÃèÍçáÅAèoóÕåãâ É|ÉbÉvÉAÉbÉv(àŸèÌ)ï\é¶
'        MsgBox "àŸèÌèIóπÇµÇ‹ÇµÇΩÅB", vbCritical, "èoóÕåãâ "
'        'Åué©â¸ ﬁ∞ºﬁÆ›ÅFî}ëÃèoóÕèàóùàŸèÌÅvÉçÉOèoóÕ
'        lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_AFILE
'        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, KAISATU_VERSION_KANRI_OUTPUT_ERROR, lngErrCode)
'        Set fso = Nothing
''*******************************
End Function

'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : tmrMail_Timer
'//  ã@î\ñºèÃ  : ÉÅÅ[ÉãéÛêMópÉ^ÉCÉ}ÅAÉ^ÉCÉÄÉAÉbÉvéûèàóù
'//  ã@î\äTóv  : ÉÅÅ[ÉãÇéÛêMÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Ç»Çµ
'//
'//     ORIGINAL  :(1.1.0.1) 2008-12-01   CODED   BY [TCC] S.Terao
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Sub tmrMail_Timer()
   On Error Resume Next
    
    'îƒópÉÅÅ[ÉãéÛêMèàóùÇçsÇ§
    If pfComMailRecieve = ML_ID_HOSHU_ACTIVE_REQ Then
        AppActivate frmJVer.Caption, False
    End If
End Sub
'V1.4.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : pfGetGoukiNo
'//  ã@î\ñºèÃ  : ò_óùçÜã@î‘çÜÇéÊìæÇ∑ÇÈÅB
'//  ã@î\äTóv  : GATE.INIÇÊÇËò_óùçÜã@î‘çÜÇéÊìæÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : Ç»Çµ
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : Integer            [OUT]êÊì™çÜã@î‘çÜ
'//
'//     ORIGINAL  :(1.4.0.1) 2009-04-18   CODED   BY [TCC] S.Terao
'//     REVISIONS :(1.6.0.1) 2009-06-16   REVISED BY [TCC] S.Terao
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
'Private Function pfGetGoukiNo() As Integer                        'V1.6.0.1 DEL
Private Function pfGetGoukiNo(iGoukiCunter As Integer) As Integer  'V1.6.0.1 ADD

    Dim lngRet As Long          'ä÷êîÇÃï‘ÇËíl
    Dim iGate As Integer        'é©â¸INDEX
    Dim j As Integer            'ÉèÅ[ÉNINDEX
    Dim sGoukiNo As String      'GLTÉtÉ@ÉCÉãÉåÉRÅ[ÉhÉfÅ[É^(çÜã@î‘çÜï\é¶ï∂éö)
    Dim cWork As Byte           'ÉèÅ[ÉNÉGÉäÉA
    Dim lngErrCode As Long      'ÉGÉâÅ[ÉRÅ[Éh
    Dim sKeyName As String
    Dim sGateData As String * RMENTE_GATE_SIZE    'ÇPçsï™ÉtÉ@ÉCÉãì‡óeéÊìæóp
    Dim sFData() As String
    Dim iFCnt As Integer
    Dim iFLoop As Integer
    Dim iFLoop2 As Integer
    Dim iRet As Integer
    Dim intGLTFileNo As Integer     'Ãß≤Ÿî‘çÜ
'   Dim iGoukiCunter As IntegerÅ@Å@ 'V1.6.0.1 DEL
    

    On Error Resume Next

 '   For iGoukiCunter = 1 To MAX_GATE_NO   'V1.6.0.1 DEL
         'é©ìÆâ¸éDã@èÓïÒéÊìæ
         sKeyName = "gate" & Format(iGoukiCunter, "00")
         iRet = GetPrivateProfileString(SETTEIFILE_INZ_SECTION_NAME, _
                                        sKeyName, _
                                        DEFAILT, sGateData, Len(sGateData), _
                                        PATH_GATE_FILE)
         If iRet = 0 Then
            'ÅuEG-Ré©ìÆâ¸éDã@ÉoÅ[ÉWÉáÉìä«óùâÊñ ÅFé©ìÆâ¸éDã@INIÉtÉ@ÉCÉãì«çûàŸèÌÅvÉçÉOèoóÕ
            Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, GATE_INI_READ_ERROR, 0)
            pfGetGoukiNo = 0
            Exit Function
         End If
             
         If Len(sGateData) <> 0 Then
            'ÉfÅ[É^ÇÃéÊìæ
            ReDim sFData(15)
            iFCnt = 1
               
            For iFLoop = 1 To Len(sGateData)
              If Mid(sGateData, iFLoop, 1) <> " " And Mid(sGateData, iFLoop, 1) <> "," Then
                iFLoop2 = iFLoop
                   Do
                    iFLoop2 = iFLoop2 + 1
                    If iFLoop2 > Len(sGateData) Then
                       sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
                       iFCnt = iFCnt + 1
                       If iFCnt >= 16 Then
                          Exit For
                       End If
                      
                       iFLoop = iFLoop2
                   Exit Do
                 End If
                            
                 If Mid(sGateData, iFLoop2, 1) = " " Or Mid(sGateData, iFLoop2, 1) = "," Then
                    sFData(iFCnt) = Mid(sGateData, iFLoop, iFLoop2 - iFLoop)
                    iFCnt = iFCnt + 1
                    If iFCnt >= 16 Then
                       Exit For
                    End If
                       
                    iFLoop = iFLoop2
                   Exit Do
                End If
               Loop
             End If
          Next
        End If
'        If Trim(sFData(4)) = EGR Then                          'V1.0.6.1 DEL
        If Trim(sFData(4)) = EGR Or Trim(sFData(4)) = NEG Then  'V1.0.6.1 ADD
           pfGetGoukiNo = iGoukiCunter
           Exit Function
        End If
 'Next 'V1.6.0.1 DEL
End Function
'V1.4.0.1 ADD END

'V1.20.0.1 ADD START
'///////////////////////////////////////////////////////////////////
'//  (C) Copyright TOSHIBA Corporation 2008 All Rights Reserved
'//
'//  ä÷êîñºèÃ  : sSetChkFile
'//  ã@î\ñºèÃ  : ÉèÅ[ÉNÅ®é¿çsÉRÉsÅ[Ç≈égópÇ∑ÇÈê≥ìñê´É`ÉFÉbÉNINIì«çûÇ›
'//  ã@î\äTóv  : INIÉtÉ@ÉCÉãÇ…ÇÃì‡óeÇÉGÉäÉAÇ…ìWäJÇ∑ÇÈÅB
'//
'//              å^        ñºèÃ      à”ñ°
'//  à¯êî      : String    ÉZÉNÉVÉáÉìñº
'//              String    ÉLÅ[ñº
'//              String    ÉtÉ@ÉCÉãñº
'//
'//              å^        íl        à”ñ°
'//  ñﬂÇËíl    : String    ê≥ìñê´É`ÉFÉbÉNINIÇÃì‡óeÅiàŸèÌéûÇÕÉuÉâÉìÉNÅj
'//
'//     ORIGINAL  :(1.20.0.1) 2010-03-11  REVISED BY [TCC] S.Yamazaki
'//     REVISIONS :(X.X.X.X) ----------   REVISED BY []
'//  îıçlÅF
'///////////////////////////////////////////////////////////////////
Private Function sSetChkFile(sSec As String, sKey As String, sFilePath As String) As String

    Dim iRet As Integer             'ä÷êîÇÃñﬂÇËíl
    Dim sIni_Data As String * 128   'INIÉtÉ@ÉCÉãÇÊÇË1çsï™éÊìæ
    
    Dim sErrFile As String             'ÉGÉâÅ[ÉçÉOópINIÉtÉ@ÉCÉãñº
    Dim sErrExe As String              'ÉGÉâÅ[ÉçÉOópINIägí£éq
    Dim lngErrCode As Long             'ÉGÉâÅ[ÉRÅ[Éh

    
    'ÉGÉâÅ[ÉãÅ[É`ÉìÇêÈåæ
    On Error Resume Next

    'iniÉtÉ@ÉCÉãéÊìæ
    sIni_Data = ""
    iRet = GetPrivateProfileString(sSec, sKey, DEFAILT, sIni_Data, Len(sIni_Data), sFilePath)
    
    'àŸèÌèàóù
    If iRet = 0 Then
        
        'ÉçÉOèoóÕÅuINIÉtÉ@ÉCÉãì«çûàŸèÌÅv
        lngErrCode = EDAI_KANSHI + ECHU_HOSHU + ESHO_FILE_IO + ECOD_FREAD
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, LOG_ERR_INI_READ, lngErrCode)
        'ÉçÉOèoóÕÅ@ÑØÉtÉ@ÉCÉãñº
        Call psFileNameGet(sFilePath, sErrFile, sErrExe)             'ÉtÉ@ÉCÉãÉpÉXÇ©ÇÁÉtÉ@ÉCÉãñºÇéÊìæ
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØFile:" & sErrFile & "." & sErrExe, lngErrCode)
        'ÉçÉOèoóÕÅ@ÑØÉLÅ[ñº
        Call sLogTraceReq(LTYP_ERROR, L3AN_FILE, "ÑØKey:" & sKey, lngErrCode)
        
    End If
    
    sSetChkFile = Left$(sIni_Data, iRet)
    
End Function
'V1.20.0.1 ADD END

